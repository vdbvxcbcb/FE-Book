<html>
<head>
  <title>浏览器缓存详解</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/606060 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="6124"/>
<h1>浏览器缓存详解</h1>

<div><span>
  <div style="--en-clipped-content:article; --en-clipped-source-url:https://hddhyq.github.io/2020/04/26/browser-cache-control/; --en-clipped-source-title:浏览器缓存详解;">
<div><br/></div><div style="min-height: 9206px; font-size: 16px; display: block; min-width: 100%; position: relative;"> <div style="box-sizing:inherit;background-color:rgb(247, 247, 247);font-size:14px;-webkit-font-smoothing:antialiased;min-width:300px;overflow:hidden scroll;text-rendering:optimizelegibility;text-size-adjust:100%;"><div style="box-sizing:inherit;font-family:Monda, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif;color:rgb(74, 74, 74);font-size:1em;font-weight:400;line-height:1.5;"><div style="opacity:1;box-sizing:inherit;transition:opacity 0.3s ease-out 0s, transform 0.3s ease-out 0s;"><div style="box-sizing:inherit;"><div style="box-sizing:inherit;"><div style="box-sizing:inherit;"><div style="box-sizing:inherit;background-color:rgb(255, 255, 255);box-shadow:rgba(0, 0, 0, 0.05) 0px 4px 10px, rgba(0, 0, 0, 0.1) 0px 0px 1px;color:rgb(74, 74, 74);border-radius:4px;transition:opacity 0.3s ease-out 0s, transform 0.3s ease-out 0s;opacity:1;transform-origin:center top;"><div style="box-sizing:inherit;background-color:transparent;"><div style="box-sizing:inherit;align-items:center;justify-content:space-between;display:flex;color:rgb(122, 122, 122);overflow-x:auto;margin-bottom:7px;text-transform:uppercase;font-size:12px;"><div style="box-sizing:inherit;flex:0 0 auto;align-items:center;justify-content:flex-start;display:flex;"><span style="box-sizing:inherit;align-items:center;display:flex;flex:0 0 auto;justify-content:center;margin-bottom:0px;margin-right:10.5px;flex-grow:1;">2 年前</span><a href="https://hddhyq.github.io/2020/04/26/browser-cache-control/#comment-container" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;"><img src="浏览器缓存详解_files/chat.png" type="image/png" data-filename="chat.png" height="13" style="box-sizing:inherit;height:auto;max-width:100%;display:inline-block;vertical-align:top;margin-top:2px;border-radius:100px;transition:all 0.5s ease-in 0s;" width="15"/> <span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;">0</span>    </a><span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;align-items:center;display:flex;flex:0 0 auto;justify-content:center;margin-bottom:0px;margin-right:10.5px;flex-grow:1;"><i style="box-sizing:inherit;-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1;font-family:&quot;Font Awesome 5 Free&quot;;font-weight:900;color:rgb(122, 122, 122);"><span style="font-style:normal;font-variant:normal;line-height:1;font-family:Font Awesome 5 Free;font-weight:900;color:rgb(122, 122, 122);"></span> </i><a href="https://hddhyq.github.io/categories/Browser/" style="box-sizing:inherit;cursor:pointer;text-decoration:none;color:inherit;">Browser</a></span><span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;align-items:center;display:flex;flex:0 0 auto;justify-content:center;margin-bottom:0px;margin-right:10.5px;flex-grow:1;">31 分钟 读完 (大约 4634 个字)</span><span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;align-items:center;display:flex;flex:0 0 auto;justify-content:center;flex-grow:1;"><i style="box-sizing:inherit;-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1;font-weight:400;font-family:&quot;Font Awesome 5 Free&quot;;"><span style="font-style:normal;font-variant:normal;line-height:1;font-weight:400;font-family:Font Awesome 5 Free;"></span></i>  <span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;">0</span>次访问</span></div></div><h1 style="margin:0px;padding:0px;box-sizing:inherit;word-break:break-word;line-height:1.125;font-weight:400;color:rgb(36, 36, 36);font-size:28px;margin-bottom:21px;">浏览器缓存详解</h1><div style="box-sizing:inherit;font-size:15.4px;margin-bottom:21px;"><p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">利用周末，完整地整理了浏览器中缓存的机制和使用的相关知识。</p>
<a style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;"></a>
<h2 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.5714em;font-size:1.8em;color:rgba(50, 115, 220, 0.66);margin-top:1.1428em;">前言</h2>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">缓存可以说是性能优化中简单高效的一种优化方式了。一个优秀的缓存策略可以缩短网页请求资源的距离，减少延迟，并且由于缓存文件可以重复利用，还可以减少带宽，降低网络负荷。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">基本的网络请求就是三个步骤：请求，处理，响应。前端缓存是在“请求”和“响应”中进行。在“请求”步骤中，浏览器也可以通过存储结果的方式直接使用资源，直接省去了发送请求；而“响应”步骤需要浏览器和服务器共同配合，减少响应内容来缩短传输时间。</p>
<div style="margin:0px;padding:0px;box-sizing:inherit;display:block;margin-left:2em;margin-right:2em;text-align:center;margin-top:2em;margin-bottom:2em;">
<a href="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/browser/cache_mind.png" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;"><img src="浏览器缓存详解_files/cache_mind.png" type="image/png" data-filename="cache_mind.png" height="381" style="box-sizing:inherit;height:auto;max-width:100%;margin:auto;display:block;" width="798"/></a><div style="box-sizing:inherit;font-style:italic;">思维导图</div>
</div>
<h2 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.5714em;font-size:1.8em;color:rgba(50, 115, 220, 0.66);margin-top:1.1428em;">缓存过程分析</h2>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">浏览器与服务器通信的方式为应答模式，即是：浏览器发起HTTP请求 – 服务器响应该请求。那么浏览器第一次向服务器发起该请求后拿到请求结果，会根据响应报文中HTTP头的缓存标识，决定是否缓存结果，是则将请求结果和缓存标识存入浏览器缓存中，简单的过程如下图：</p>
<div style="margin:0px;padding:0px;box-sizing:inherit;display:block;margin-left:2em;margin-right:2em;text-align:center;margin-top:2em;margin-bottom:2em;">
<a href="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/browser/first_request.png" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;"><img src="浏览器缓存详解_files/first_request.png" type="image/png" data-filename="first_request.png" height="570" style="box-sizing:inherit;height:auto;max-width:100%;margin:auto;display:block;" width="761"/></a><div style="box-sizing:inherit;font-style:italic;">第一次请求</div>
</div>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">由上图我们可以知道：</p>
<ul style="margin:0px;padding:0px;box-sizing:inherit;margin-left:2em;margin-top:1em;list-style:outside disc;margin-bottom:1em;">
<li style="margin:0px;padding:0px;box-sizing:inherit;"><p style="margin:0px;padding:0px;box-sizing:inherit;">浏览器每次发起请求，都会先在浏览器缓存中查找该请求的结果以及缓存标识</p></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;">浏览器每次拿到返回的请求结果都会将该结果和缓存标识存入浏览器缓存中</p></li>
</ul>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">上面两点结论是浏览器缓存机制的关键，浏览器缓存表示浏览器缓存的位置，对应的 Service Worker、Memory Cache、Disk Cache和Push Cache。这种不向浏览器发送请求的机制是强制缓存，而浏览器缓存失效则使用协商缓存，这一部分将在缓存机制中讨论。</p>
<h2 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.5714em;font-size:1.8em;color:rgba(50, 115, 220, 0.66);margin-top:1.1428em;">缓存位置</h2>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">浏览器的缓存位置可以分为四种，并且各自拥有优先级，浏览器发送请求时候依次寻找，找到则返回；找不到则发送网络请求。</p>
<ol style="margin:0px;padding:0px;box-sizing:inherit;list-style-position:outside;margin-left:2em;margin-top:1em;margin-bottom:1em;" type="1">
<li style="margin:0px;padding:0px;box-sizing:inherit;"><p style="margin:0px;padding:0px;box-sizing:inherit;">Service Worker</p></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;">Memory Cache</p></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;">Disk Cache</p></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;">Push Cache</p></li>
</ol>
<h3 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.6666em;font-size:1.3em;color:rgba(50, 115, 220, 0.66);margin-top:1.3333em;">1. Service Worker</h3>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">Service Worker 是运行在浏览器背后的独立线程，一般可以用来实现缓存功能。使用 Service Worker的话，传输协议必须为 HTTPS。因为 Service Worker 中涉及到请求拦截，所以必须使用 HTTPS 协议来保障安全。<strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">Service Worker 的缓存与浏览器其他内建的缓存机制不同，它可以让我们自由控制缓存哪些文件、如何匹配缓存、如何读取缓存，并且缓存是持续性的。</strong></p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">Service Worker 实现缓存功能一般分为三个步骤：首先需要先注册 Service Worker，然后监听到 install 事件以后就可以缓存需要的文件，那么在下次用户访问的时候就可以通过拦截请求的方式查询是否存在缓存，存在缓存的话就可以直接读取缓存文件，否则就去请求数据。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">Service Worker 能够操作的缓存是有别于浏览器内部的 memory cache 或者 disk cache 的。我们可以从 Chrome 的 F12 中，Application -&gt; Cache Storage 找到这个单独的“小金库”。除了位置不同之外，这个缓存是永久性的，即关闭 TAB 或者浏览器，下次打开依然还在(而 memory cache 不是)。有两种情况会导致这个缓存中的资源被清除：手动调用 API cache.delete(resource) 或者容量超过限制，被浏览器全部清空。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">当 Service Worker 没有命中缓存的时候，我们需要去调用 fetch 函数获取数据。也就是说，如果我们没有在 Service Worker 命中缓存的话，会根据缓存查找优先级去查找数据。但是不管我们是从 Memory Cache 中还是从网络请求中获取的数据，浏览器都会显示我们是从 Service Worker 中获取的内容。</p>
<h3 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.6666em;font-size:1.3em;color:rgba(50, 115, 220, 0.66);margin-top:1.3333em;">2. Memory Cache</h3>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">Memory Cache 也就是内存中的缓存, 主要包含的是当前文档中页面中已经抓取到的资源。例如页面上已经下载的样式、脚本、图片等。我们不排除页面可能会对这些资源再次发出请求，所以这些资源都暂存在内存中，<strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">关闭网页时，内存缓存的资源会被释放掉。</strong> <strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">由于计算机内存空间有限，页面能使用的最大内存也是有限的。</strong></p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">关于请求资源如何进入 Memory Cache, 可以细分为两块：</p>
<ol style="margin:0px;padding:0px;box-sizing:inherit;list-style-position:outside;margin-left:2em;margin-top:1em;margin-bottom:1em;" type="1">
<li style="margin:0px;padding:0px;box-sizing:inherit;"><p style="margin:0px;padding:0px;box-sizing:inherit;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">preloader</strong>。浏览器在加载网页的时候，会先请求 HTML 然后解析。之后如果浏览器发现了 js, css 等需要解析和执行的资源时，它会使用 CPU 资源对它们进行解析和执行。preloader 负责缓存请求加载的网络资源，将这些资源放入 Memory Cache 中。</p></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">preload</strong>。例如<code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">&lt;link rel=&quot;preload&quot;&gt;</code>，显式指定的预加载资源，会被放入 Memory Cache 中。</p></li>
</ol>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">Memory Cache 机制保证了一个页面如果有两个相同的请求，资源最多被请求一次。在匹配缓存时，除了 URL 匹配外，还需要考虑对它们的类型、CORS中的域名规则等。例如：一个作为脚本(script)的资源，图片(image)类型的是不能直接使用缓存文件的。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">在从 Memory Cache 获取缓存内容时，浏览器会忽视例如 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">max-age=0</code>, <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">no-cache</code> 等头部配置，因为 Memory Cache 是短期存储，相当于仅当次浏览有效。头部设置为 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">no-store</code> ，则即便是 memory cache 也不会存储。</p>
<h3 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.6666em;font-size:1.3em;color:rgba(50, 115, 220, 0.66);margin-top:1.3333em;">3. Disk Cache</h3>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">Disk Cache是存储在硬盘上的缓存，因此它是持久存储的，是实际存在于文件系统中的。而且它允许相同的资源在跨会话，甚至跨站点的情况下使用，例如两个站点都使用了同一张图片。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">在所有浏览器缓存中，Disk Cache 覆盖面基本是最大的。它会根据 HTTP Header 中的字段判断哪些资源需要缓存，哪些资源可以不请求直接使用，哪些资源已经过期需要重新请求。并且即使在跨站点的情况下，相同地址的资源一旦被硬盘缓存下来，就不会再次去请求数据。绝大部分的缓存都来自 Disk Cache，关于 HTTP 的协议头中的缓存字段，我们会在下文进行详细介绍。</p>
<h3 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.6666em;font-size:1.3em;color:rgba(50, 115, 220, 0.66);margin-top:1.3333em;">4. Push Cache</h3>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">Push Cache（推送缓存）是 HTTP/2 中的内容，当以上三种缓存都没有命中时，它才会被使用。它只在会话（Session）中存在，一旦会话结束就被释放，并且缓存时间也很短暂，在Chrome浏览器中只有5分钟左右，同时它也并非严格执行HTTP头中的缓存指令。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">Push Cache 在国内能够查到的资料很少，也是因为 HTTP/2 在国内不够普及。这里推荐阅读Jake Archibald的 <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fjakearchibald.com%2F2017%2Fh2-push-tougher-than-i-thought%2F" rel="noopener" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;" target="_blank">HTTP/2 push is tougher than I thought</a> 这篇文章，文章中的几个结论：</p>
<ul style="margin:0px;padding:0px;box-sizing:inherit;margin-left:2em;margin-top:1em;list-style:outside disc;margin-bottom:1em;">
<li style="margin:0px;padding:0px;box-sizing:inherit;">所有的资源都能被推送，并且能够被缓存,但是 Edge 和 Safari 浏览器支持相对比较差</li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;">可以推送 no-cache 和 no-store 的资源</li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;">一旦连接被关闭，Push Cache 就被释放</li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;">多个页面可以使用同一个HTTP/2的连接，也就可以使用同一个Push Cache。这主要还是依赖浏览器的实现而定，出于对性能的考虑，有的浏览器会对相同域名但不同的tab标签使用同一个HTTP连接。</li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;">Push Cache 中的缓存只能被使用一次</li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;">浏览器可以拒绝接受已经存在的资源推送</li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;">你可以给其他域名推送资源</li>
</ul>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">如果以上四种缓存都没有命中的话，那么只能发起请求来获取资源了。</p>
<h2 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.5714em;font-size:1.8em;color:rgba(50, 115, 220, 0.66);margin-top:1.1428em;">缓存机制</h2>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">浏览器缓存策略是相对于 Disk Cache 来讲的，主要包括了<strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">强制缓存</strong>和<strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">协商缓存</strong>。</p>
<h3 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.6666em;font-size:1.3em;color:rgba(50, 115, 220, 0.66);margin-top:1.3333em;">强制缓存</h3>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">强制缓存的含义是，客户端需要发送请求的时候，会先访问客户端缓存数据库检查缓存是否存在。如果存在则直接返回缓存；不存在则请求服务器，响应后再写入缓存数据库。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">强制缓存直接减少请求数，是提升最大的缓存策略。</strong>强缓存可以通过设置两种 HTTP Header 实现：<strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">Expires</strong> 和 <strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">Cache-Control</strong>。</p>
<h4 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.8em;font-size:1.2em;color:rgba(50, 115, 220, 0.66);">Expires</h4>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">EXpires 是 HTTP 1.0 的字段，表示缓存到期时间，是一个绝对的时间 (当前时间+缓存时间)，如</p>
<div style="box-sizing:inherit;text-align:center;font-weight:400;max-width:100%;overflow:hidden;width:100%;position:relative;display:block;overflow-x:auto;color:rgb(171, 178, 191);background:rgb(40, 44, 52);padding:0px;margin:1em 0px;"><div style="box-sizing:inherit;align-items:center;justify-content:space-between;background:rgba(200, 200, 200, 0.15);padding:0.3em 0em 0.3em 0.75em;font-size:0.8em;font-style:normal;display:flex;overflow:auto;margin-bottom:0.5rem;margin:0px;"><div style="box-sizing:inherit;flex:0 0 auto;align-items:center;justify-content:flex-start;color:rgb(122, 122, 122);display:flex;"><span style="box-sizing:inherit;font-style:inherit;color:rgb(122, 122, 122);font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;font-weight:500;cursor:pointer;"><i style="box-sizing:inherit;color:rgb(122, 122, 122);-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1;font-family:&quot;Font Awesome 5 Free&quot;;font-weight:900;"><span style="font-style:normal;font-variant:normal;line-height:1;font-family:Font Awesome 5 Free;font-weight:900;color:rgb(122, 122, 122);"></span></i></span></div><div style="box-sizing:inherit;flex:0 0 auto;align-items:center;justify-content:flex-end;color:rgb(122, 122, 122);display:flex;margin-top:0px;"><a href="#" style="box-sizing:inherit;cursor:pointer;text-decoration:none;color:rgb(122, 122, 122);overflow-wrap:break-word;padding:0em 0.75em;" title="Copy"><i style="box-sizing:inherit;color:rgb(122, 122, 122);-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1;font-family:&quot;Font Awesome 5 Free&quot;;font-weight:900;"><span style="font-style:normal;font-variant:normal;line-height:1;font-family:Font Awesome 5 Free;font-weight:900;color:rgb(122, 122, 122);"></span></i></a></div></div><div style="box-sizing:inherit;overflow:auto;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;box-sizing:inherit;border-collapse:collapse;border-spacing:0px;width:auto;"><tbody style="box-sizing:inherit;"><tr style="box-sizing:inherit;"><td style="box-sizing:inherit;border-image:initial;padding:0.5em 0.75em;vertical-align:top;border:none;background:rgba(200, 200, 200, 0.15);border-bottom-width:0px;text-align:right;"><pre style="margin:0px;box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;overflow-x:auto;white-space:pre;overflow-wrap:normal;max-width:100%;font-size:0.85em;background:transparent;color:inherit;padding:0px;overflow:visible;"><span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;line-height:21px;">1</span><br style="box-sizing:inherit;"/></pre></td><td style="box-sizing:inherit;border-image:initial;padding:0.5em 0.75em;vertical-align:top;border:none;text-align:left;border-bottom-width:0px;"><pre style="margin:0px;box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;overflow-x:auto;white-space:pre;overflow-wrap:normal;max-width:100%;font-size:0.85em;background:transparent;color:inherit;padding:0px;overflow:visible;"><span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;line-height:21px;">expires: Sun, 26 Apr 2020 15:39:32 GMT</span><br style="box-sizing:inherit;"/></pre></td></tr></tbody></table></div></div>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">在响应消息头中，设置这个字段之后，就可以告诉浏览器，在未过期之前不需要再次请求。Expires 受限于用户可能将本地时间修改，导致缓存失效。时差、误差等因素也会导致缓存失效。</p>
<h4 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.8em;font-size:1.2em;color:rgba(50, 115, 220, 0.66);">Cache-control</h4>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">在HTTP/1.1中，Cache-Control是最重要的规则，主要用于控制网页缓存。比如当<code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Cache-Control:max-age=300</code> 时，则代表在这个请求正确返回时间（浏览器也会记录下来）的5分钟内再次加载资源，就会命中强缓存。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">Cache-Control 指令包含：</p>
<table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;box-sizing:inherit;border-collapse:collapse;border-spacing:0px;width:100%;margin-bottom:1em;">
<thead style="box-sizing:inherit;">
<tr style="box-sizing:inherit;">
<th style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;padding:0.5em 0.75em;vertical-align:top;color:rgb(54, 54, 54);border-width:0px 0px 2px;text-align:left;">指令</th>
<th style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;padding:0.5em 0.75em;vertical-align:top;color:rgb(54, 54, 54);border-width:0px 0px 2px;text-align:left;">作用</th>
</tr>
</thead>
<tbody style="box-sizing:inherit;">
<tr style="box-sizing:inherit;">
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;"><code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">public</code></td>
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;">响应可以被客户端和代理服务器缓存</td>
</tr>
<tr style="box-sizing:inherit;">
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;"><code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">private</code></td>
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;">响应只可以被客户端缓存</td>
</tr>
<tr style="box-sizing:inherit;">
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;"><code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">max-age=30</code></td>
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;">缓存30s后过期，需要重新请求</td>
</tr>
<tr style="box-sizing:inherit;">
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;"><code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">s-maxage=30</code></td>
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;">覆盖 max-age，作用一样，只在代理服务器中生效</td>
</tr>
<tr style="box-sizing:inherit;">
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;"><code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">no-store</code></td>
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;">不缓存任何响应</td>
</tr>
<tr style="box-sizing:inherit;">
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;"><code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">no-cache</code></td>
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;">资源被缓存，但是下次会发起请求验证资源是否过期</td>
</tr>
<tr style="box-sizing:inherit;">
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;"><code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">max-state=30</code></td>
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;">30s内，即使缓存过期，也使用该缓存</td>
</tr>
<tr style="box-sizing:inherit;">
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;"><code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">max-fresh</code></td>
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;">希望在30s内获取最新响应</td>
</tr>
<tr style="box-sizing:inherit;">
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;border-bottom-width:0px;"><code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">must-revalidate</code></td>
<td style="box-sizing:inherit;border-style:solid;border-color:rgb(219, 219, 219);border-image:initial;border-width:0px 0px 1px;padding:0.5em 0.75em;vertical-align:top;text-align:left;border-bottom-width:0px;">如果超过了 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">max-age</code> 的时间，浏览器必须向服务器发送请求，验证资源是否还有效。</td>
</tr>
</tbody>
</table>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">这些值可以混合使用，例如 Cache-control:public, max-age=2592000。在混合使用时，它们的优先级如下图:</p>
<div style="margin:0px;padding:0px;box-sizing:inherit;display:block;margin-left:2em;margin-right:2em;text-align:center;margin-top:2em;margin-bottom:2em;">
<a href="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/browser/cache_control.png" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;"><img src="浏览器缓存详解_files/cache_control.webp" type="image/webp" data-filename="cache_control.webp" height="615" style="box-sizing:inherit;height:auto;max-width:100%;margin:auto;display:block;" width="626"/></a><div style="box-sizing:inherit;font-style:italic;">cache-control</div>
</div>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">Cache-control 的优先级高于 Expires</strong>，为了兼容 HTTP/1.0 和 HTTP/1.1，实际项目中两个字段我们都会设置。</p>
<h3 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.6666em;font-size:1.3em;color:rgba(50, 115, 220, 0.66);margin-top:1.3333em;">协商缓存</h3>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">当强制缓存失效(超过规定时间)时，就需要使用协商缓存，由服务器决定缓存内容是否失效。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">主要有两种情况：</p>
<ul style="margin:0px;padding:0px;box-sizing:inherit;margin-left:2em;margin-top:1em;list-style:outside disc;margin-bottom:1em;">
<li style="margin:0px;padding:0px;box-sizing:inherit;"><p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">协商缓存生效，返回<code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">304</code>和<code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Not Modified</code></p>
<div style="margin:0px;padding:0px;box-sizing:inherit;display:block;margin-left:2em;margin-right:2em;text-align:center;margin-top:2em;">
<a href="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/browser/force_cache.webp" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;"><img src="浏览器缓存详解_files/force_cache.webp" type="image/webp" data-filename="force_cache.webp" height="539" style="box-sizing:inherit;height:auto;max-width:100%;margin:auto;display:block;" width="709"/></a><div style="box-sizing:inherit;font-style:italic;">force-control</div>
</div></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">协商缓存失效，返回200和请求结果</p>
<div style="margin:0px;padding:0px;box-sizing:inherit;display:block;margin-left:2em;margin-right:2em;text-align:center;margin-top:2em;">
<a href="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/browser/negotiated_cache.webp" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;"><img src="浏览器缓存详解_files/negotiated_cache.webp" type="image/webp" data-filename="negotiated_cache.webp" height="518" style="box-sizing:inherit;height:auto;max-width:100%;margin:auto;display:block;" width="666"/></a><div style="box-sizing:inherit;font-style:italic;">negotiated-control</div>
</div></li>
</ul>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">对比缓存在请求数上和没有缓存是一致的</strong>，但如果是 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">304</code> 的话，返回的仅仅是一个状态码而已，并没有实际的文件内容，因此 <strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">在响应体体积上的节省是它的优化点</strong>。协商缓存可以通过设置两种 HTTP Header 实现：<code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Last-Modified</code> 和 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">ETag</code> 。</p>
<h4 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.8em;font-size:1.2em;color:rgba(50, 115, 220, 0.66);">Last-Modified和If-Modified-Since</h4>
<ol style="margin:0px;padding:0px;box-sizing:inherit;list-style-position:outside;margin-left:2em;margin-top:1em;margin-bottom:1em;" type="1">
<li style="margin:0px;padding:0px;box-sizing:inherit;">服务器通过 Last-Modified 字段告知客户端，资源最后一次被修改的时间，例如</li>
</ol>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;"></p><div style="box-sizing:inherit;text-align:center;font-weight:400;max-width:100%;overflow:hidden;width:100%;position:relative;display:block;overflow-x:auto;color:rgb(171, 178, 191);background:rgb(40, 44, 52);padding:0px;margin:1em 0px;"><div style="box-sizing:inherit;align-items:center;justify-content:space-between;background:rgba(200, 200, 200, 0.15);padding:0.3em 0em 0.3em 0.75em;font-size:0.8em;font-style:normal;display:flex;overflow:auto;margin-bottom:0.5rem;margin:0px;"><div style="box-sizing:inherit;flex:0 0 auto;align-items:center;justify-content:flex-start;color:rgb(122, 122, 122);display:flex;"><span style="box-sizing:inherit;font-style:inherit;color:rgb(122, 122, 122);font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;font-weight:500;cursor:pointer;"><i style="box-sizing:inherit;color:rgb(122, 122, 122);-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1;font-family:&quot;Font Awesome 5 Free&quot;;font-weight:900;"><span style="font-style:normal;font-variant:normal;line-height:1;font-family:Font Awesome 5 Free;font-weight:900;color:rgb(122, 122, 122);"></span></i></span></div><div style="box-sizing:inherit;flex:0 0 auto;align-items:center;justify-content:flex-end;color:rgb(122, 122, 122);display:flex;margin-top:0px;"><a href="#" style="box-sizing:inherit;cursor:pointer;text-decoration:none;color:rgb(122, 122, 122);overflow-wrap:break-word;padding:0em 0.75em;" title="Copy"><i style="box-sizing:inherit;color:rgb(122, 122, 122);-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1;font-family:&quot;Font Awesome 5 Free&quot;;font-weight:900;"><span style="font-style:normal;font-variant:normal;line-height:1;font-family:Font Awesome 5 Free;font-weight:900;color:rgb(122, 122, 122);"></span></i></a></div></div><div style="box-sizing:inherit;overflow:auto;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;box-sizing:inherit;border-collapse:collapse;border-spacing:0px;width:auto;"><tbody style="box-sizing:inherit;"><tr style="box-sizing:inherit;"><td style="box-sizing:inherit;border-image:initial;padding:0.5em 0.75em;vertical-align:top;border:none;background:rgba(200, 200, 200, 0.15);border-bottom-width:0px;text-align:right;"><pre style="margin:0px;box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;overflow-x:auto;white-space:pre;overflow-wrap:normal;max-width:100%;font-size:0.85em;background:transparent;color:inherit;padding:0px;overflow:visible;"><span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;line-height:21px;">1</span><br style="box-sizing:inherit;"/></pre></td><td style="box-sizing:inherit;border-image:initial;padding:0.5em 0.75em;vertical-align:top;border:none;text-align:left;border-bottom-width:0px;"><pre style="margin:0px;box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;overflow-x:auto;white-space:pre;overflow-wrap:normal;max-width:100%;font-size:0.85em;background:transparent;color:inherit;padding:0px;overflow:visible;"><span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;line-height:21px;">Last-Modified: Sun, 26 Apr 2020 15:39:32 GMT</span><br style="box-sizing:inherit;"/></pre></td></tr></tbody></table></div></div><p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;"></p>
<ol start="2" style="margin:0px;padding:0px;box-sizing:inherit;list-style-position:outside;margin-left:2em;margin-top:1em;margin-bottom:1em;" type="1">
<li style="margin:0px;padding:0px;box-sizing:inherit;"><p style="margin:0px;padding:0px;box-sizing:inherit;">浏览器将这个值和内容一起记录在缓存数据库中。</p></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;">下一次请求相同资源时时，浏览器从自己的缓存中找出“不确定是否过期的”缓存。因此在请求头中将上次的 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Last-Modified</code> 的值写入到请求头的 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">If-Modified-Since</code> 字段。</p></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;">服务器会将 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">If-Modified-Since</code> 的值与 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Last-Modified</code> 字段进行对比。如果相等，则表示未修改，响应 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">304</code>；反之，则表示修改了，响应 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">200</code> 状态码，并返回数据。</p></li>
</ol>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">但是 Last-Modified 有一定缺陷的</strong>：</p>
<ul style="margin:0px;padding:0px;box-sizing:inherit;margin-left:2em;margin-top:1em;list-style:outside disc;margin-bottom:1em;">
<li style="margin:0px;padding:0px;box-sizing:inherit;">如果资源更新的速度是秒以下单位，那么该缓存是不能被使用的，因为它的时间单位最低是秒。</li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;">如果文件是通过服务器动态生成的，那么该方法的更新时间永远是生成的时间，尽管文件可能没有变化，所以起不到缓存的作用。</li>
</ul>
<h4 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.8em;font-size:1.2em;color:rgba(50, 115, 220, 0.66);">Etag &amp; If-None-Match</h4>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">Etag是服务器响应请求时，返回当前资源文件的一个唯一标识(由服务器生成)，只要资源有变化，Etag就会重新生成</strong>。<code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Etag</code> 存储的是文件的特殊标识(一般都是 hash 生成的)，服务器存储着文件的 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Etag</code> 字段。之后的流程和 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Last-Modified</code> 一致，只是 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Last-Modified</code> 字段和它所表示的更新时间改变成了 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Etag</code> 字段和它所表示的文件 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">hash</code>，把 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">If-Modified-Since</code> 变成了 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">If-None-Match</code>。服务器同样进行比较，命中返回 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">304</code>, 不命中返回新资源和 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">200</code>。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">Etag 的优先级高于 Last-Modified</strong></p>
<h2 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.5714em;font-size:1.8em;color:rgba(50, 115, 220, 0.66);margin-top:1.1428em;">浏览器行为</h2>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">用户在浏览器如何操作，会触发哪种缓存策略，主要有三种：</p>
<ul style="margin:0px;padding:0px;box-sizing:inherit;margin-left:2em;margin-top:1em;list-style:outside disc;margin-bottom:1em;">
<li style="margin:0px;padding:0px;box-sizing:inherit;"><p style="margin:0px;padding:0px;box-sizing:inherit;">打开网页，地址栏输入地址： 查找 Disk Cache 中是否有匹配。如有则使用；如没有则发送网络请求。</p></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;">普通刷新 (F5)：因为 TAB 页面并没有关闭，因此 Memory Cache 是可用的，会被优先使用(如果匹配的话)。其次才是 Disk Cache。</p></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><p style="margin:0px;padding:0px;box-sizing:inherit;">强制刷新 (Ctrl + F5)：浏览器不使用缓存，因此发送的请求头部均带有 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Cache-control: no-cache</code>(为了兼容，还带了 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Pragma: no-cache</code>)。服务器直接返回 200 和最新内容。</p></li>
</ul>
<h2 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.5714em;font-size:1.8em;color:rgba(50, 115, 220, 0.66);margin-top:1.1428em;">缓存的应用模式</h2>
<h3 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.6666em;font-size:1.3em;color:rgba(50, 115, 220, 0.66);margin-top:1.3333em;">模式1: 不常变化的资源</h3>
<blockquote style="margin:0px;box-sizing:inherit;overflow:auto;padding:1em;background-color:rgb(245, 245, 245);border-left:3px solid rgb(97, 144, 232);margin-bottom:1em;">
<p style="margin:0px;padding:0px;box-sizing:inherit;">Cache-Control: max-age=31536000</p>
</blockquote>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">处理这类资源的时候，给它们的 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Cache-Control</code> 配置一个很大的 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">max-age=31536000</code> (一年)，这样浏览器之后请求相同的 URL 会命中强制缓存。为了解决更新问题，需要在文件名(或者路径)中添加hash、版本号等动态字符，通过更改动态字符，达到更改引用 URL 让之前的强制缓存失效(其实并未立即失效，只是不再使用了而已)。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">在线提供的类库 (如 jquery-3.3.1.min.js, lodash.min.js 等) 均采用这个模式。如果配置中还增加 public 的话，CDN 也可以缓存起来，效果拔群。</p>
<h3 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.6666em;font-size:1.3em;color:rgba(50, 115, 220, 0.66);margin-top:1.3333em;">模式2: 经常变化的资源</h3>
<blockquote style="margin:0px;box-sizing:inherit;overflow:auto;padding:1em;background-color:rgb(245, 245, 245);border-left:3px solid rgb(97, 144, 232);margin-bottom:1em;">
<p style="margin:0px;padding:0px;box-sizing:inherit;">Cache-Control: no-cache</p>
</blockquote>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">这类资源的特点是：URL不能变化，但内容可以(且经常)变化。我们可以设置 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">Cache-Control: no-cache</code> 来迫使浏览器每次请求都必须找服务器验证资源是否有效。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">既然提到了验证，就必须 ETag 或者 Last-Modified 出场。这些字段都会由专门处理静态资源的常用类库(例如 koa-static)自动添加，无需开发者过多关心。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">也正如上文中提到协商缓存那样，这种模式下，节省的并不是请求数，而是请求体的大小。所以它的优化效果不如模式 1 来的显著。</p>
<h3 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.6666em;font-size:1.3em;color:rgba(50, 115, 220, 0.66);margin-top:1.3333em;">模式3(反例): 对变化的资源添加较短的max-age</h3>
<blockquote style="margin:0px;box-sizing:inherit;overflow:auto;padding:1em;background-color:rgb(245, 245, 245);border-left:3px solid rgb(97, 144, 232);margin-bottom:1em;">
<p style="margin:0px;padding:0px;box-sizing:inherit;">Cache-Control: must-revalidate, max-age=600</p>
</blockquote>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">也许有的开发者看完模式1和2，会想自己的应用时效性不强，又不想做过于长久的强制缓存，想配置 <code style="box-sizing:inherit;-webkit-font-smoothing:auto;font-family:&quot;Source Code Pro&quot;, monospace, &quot;Microsoft YaHei&quot;;color:rgb(241, 70, 104);font-size:0.875em;font-weight:normal;background:transparent;padding:0px;">must-revalidate, max-age=600</code> 的折中方案。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">表面上看这很美好：资源可以缓存 10 分钟，10 分钟内读取缓存，10 分钟后和服务器进行一次验证，集两种模式之大成，但实际线上暗存风险。因为上面提过，浏览器的缓存有自动清理机制，开发者并不能控制。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">举个例子：当我们有 3 种资源： index.html, index.js, index.css。我们对这 3 者进行上述配置之后，假设在某次访问时，index.js 已经被缓存清理而不存在，但 index.html, index.css 仍然存在于缓存中。这时候浏览器会向服务器请求新的 index.js，然后配上老的 index.html, index.css 展现给用户。这其中的风险显而易见：不同版本的资源组合在一起，报错是极有可能的结局。</p>
<p style="margin:0px;padding:0px;box-sizing:inherit;margin-bottom:1em;">除了自动清理引发问题，不同资源的请求时间不同也能导致问题。例如 A 页面请求的是 A.js 和 all.css，而 B 页面是 B.js 和 all.css。如果我们以 A -&gt; B 的顺序访问页面，势必导致 all.css 的缓存时间早于 B.js。那么以后访问 B 页面就同样存在资源版本失配的隐患。</p>
<h2 style="margin:0px;padding:0px;box-sizing:inherit;line-height:1.125;font-weight:400;margin-bottom:0.5714em;font-size:1.8em;color:rgba(50, 115, 220, 0.66);margin-top:1.1428em;">参考引用</h2>
<ul style="margin:0px;padding:0px;box-sizing:inherit;margin-left:2em;margin-top:1em;list-style:outside disc;">
<li style="margin:0px;padding:0px;box-sizing:inherit;"><a href="https://calendar.perfplanet.com/2016/a-tale-of-four-caches/" rel="noopener" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;" target="_blank">a-tale-of-four-caches</a></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><a href="https://jakearchibald.com/2017/h2-push-tougher-than-i-thought/" rel="noopener" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;" target="_blank">h2-push-tougher-than-i-thought</a></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><a href="https://jakearchibald.com/2016/caching-best-practices/" rel="noopener" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;" target="_blank">caching-best-practices</a></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><a href="https://zhuanlan.zhihu.com/p/28113197" rel="noopener" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;" target="_blank">设计一个无懈可击的浏览器缓存方案</a></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><a href="https://www.jianshu.com/p/54cc04190252" rel="noopener" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;" target="_blank">深入了解浏览器缓存机制</a></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><a href="https://juejin.im/post/5c22ee806fb9a049fb43b2c5" rel="noopener" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;" target="_blank">一文读懂前端缓存</a></li>
<li style="margin:0px;padding:0px;box-sizing:inherit;margin-top:0.25em;"><a href="https://mp.weixin.qq.com/s?__biz=MjM5MTA1MjAxMQ==&amp;mid=2651228395&amp;idx=1&amp;sn=dcf7e3bd518f1e189ce17eaed94c27bb&amp;chksm=bd49516f8a3ed879221bf28bf68ac00c4733a6048c54ea90e75a9e2315a262c2d66fb29a4a34&amp;mpshare=1&amp;scene=1&amp;srcid=0419jU32MPcOkcBWJJVdgj2J#rd" rel="noopener" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;overflow-wrap:break-word;" target="_blank">彻底理解浏览器的缓存机制</a></li>
</ul>
</div><div style="box-sizing:inherit;color:rgb(122, 122, 122);text-transform:uppercase;margin-bottom:21px;font-size:12px;"><i style="box-sizing:inherit;-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1;font-family:&quot;Font Awesome 5 Free&quot;;font-weight:900;color:rgb(122, 122, 122);"><span style="font-style:normal;font-variant:normal;line-height:1;font-family:Font Awesome 5 Free;font-weight:900;color:rgb(122, 122, 122);"></span></i> <a href="https://hddhyq.github.io/tags/Browser/" rel="tag" style="box-sizing:inherit;cursor:pointer;text-decoration:none;color:inherit;margin-right:7px;">Browser</a><p style="margin:0px;padding:0px;box-sizing:inherit;text-align:right;font-size:15.4px;"><span style="box-sizing:inherit;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;"><em style="box-sizing:inherit;"> 本文最后修改于: 2020-04-26.</em></strong></span></p></div><ul style="list-style:none;box-sizing:inherit;font-size:14px;letter-spacing:0.28px;word-break:break-all;border-left:3px solid rgb(255, 23, 0);background-color:rgb(249, 249, 249);margin:1.5rem 0px;padding:14px;"><li style="margin:0px;padding:0px;box-sizing:inherit;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">本文标题：</strong><a href="https://hddhyq.github.io/2020/04/26/browser-cache-control/" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;">浏览器缓存详解</a></li><li style="margin:0px;padding:0px;box-sizing:inherit;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">本文作者：</strong><a href="https://hddhyq.github.io/" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;">hddhyq</a></li><li style="margin:0px;padding:0px;box-sizing:inherit;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">本文链接：</strong><a href="https://hddhyq.github.io/2020/04/26/browser-cache-control/" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;">https://hddhyq.github.io/2020/04/26/browser-cache-control/</a></li><li style="margin:0px;padding:0px;box-sizing:inherit;"><strong style="box-sizing:inherit;color:rgb(54, 54, 54);font-weight:700;">版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</li></ul><div style="box-sizing:inherit;"><div style="box-sizing:inherit;margin:0px 0px 1.5rem;"><span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;font-size:14px;color:rgb(122, 122, 122);"># 相关文章</span><br style="box-sizing:inherit;"/><span style="box-sizing:inherit;font-style:inherit;font-weight:inherit;">  1.<a href="https://hddhyq.github.io/2020/03/24/%E6%9E%84%E5%BB%BA%E7%AE%80%E6%98%93%E7%BD%91%E9%A1%B5%E6%B5%8F%E8%A7%88%E5%99%A8/" style="box-sizing:inherit;color:rgb(50, 115, 220);cursor:pointer;text-decoration:none;font-size:14px;" target="_blank">构建简易网页浏览器</a><br style="box-sizing:inherit;"/></span></div></div><div style="box-sizing:inherit;text-align:center;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:0.2px;font-family:socialshare;"><a href="http://service.weibo.com/share/share.php?url=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F&amp;title=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;pic=https%3A%2F%2Fimages-1253206717.cos.ap-guangzhou.myqcloud.com%2Fblog%2Flogo.png&amp;appkey=" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(255, 118, 59);border-color:rgb(255, 118, 59);font-family:socialshare;" target="_blank"><span style="color:rgb(255, 118, 59);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="http://connect.qq.com/widget/shareqq/index.html?url=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F&amp;title=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;source=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;desc=&amp;pics=https%3A%2F%2Fimages-1253206717.cos.ap-guangzhou.myqcloud.com%2Fblog%2Flogo.png" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(86, 182, 231);border-color:rgb(86, 182, 231);font-family:socialshare;" target="_blank"><span style="color:rgb(86, 182, 231);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="#" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(123, 197, 73);position:relative;border-color:rgb(123, 197, 73);font-family:socialshare;"><span style="color:rgb(123, 197, 73);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;title=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;url=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F&amp;pic=https%3A%2F%2Fimages-1253206717.cos.ap-guangzhou.myqcloud.com%2Fblog%2Flogo.png" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(86, 182, 231);border-color:rgb(86, 182, 231);font-family:socialshare;" target="_blank"><span style="color:rgb(86, 182, 231);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="http://shuo.douban.com/!service/share?href=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F&amp;name=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;text=&amp;image=https%3A%2F%2Fimages-1253206717.cos.ap-guangzhou.myqcloud.com%2Fblog%2Flogo.png&amp;starid=0&amp;aid=0&amp;style=11" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(51, 176, 69);border-color:rgb(51, 176, 69);font-family:socialshare;" target="_blank"><span style="color:rgb(51, 176, 69);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F&amp;title=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;desc=&amp;summary=&amp;site=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(253, 190, 61);border-color:rgb(253, 190, 61);font-family:socialshare;" target="_blank"><span style="color:rgb(253, 190, 61);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="http://www.linkedin.com/shareArticle?mini=true&amp;ro=true&amp;title=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;url=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F&amp;summary=&amp;source=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;armin=armin" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(0, 119, 181);border-color:rgb(0, 119, 181);font-family:socialshare;" target="_blank"><span style="color:rgb(0, 119, 181);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="http://www.diandian.com/share?lo=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F&amp;ti=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;type=link" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(48, 125, 202);border-color:rgb(48, 125, 202);font-family:socialshare;" target="_blank"><span style="color:rgb(48, 125, 202);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(68, 97, 157);border-color:rgb(68, 97, 157);font-family:socialshare;" target="_blank"><span style="color:rgb(68, 97, 157);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="https://twitter.com/intent/tweet?text=%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E8%AF%A6%E8%A7%A3%20-%20hddhyq%27s%20blog&amp;url=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F&amp;via=https%3A%2F%2Fhddhyq.github.io" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(85, 172, 238);border-color:rgb(85, 172, 238);font-family:socialshare;" target="_blank"><span style="color:rgb(85, 172, 238);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fhddhyq.github.io%2F2020%2F04%2F26%2Fbrowser-cache-control%2F" style="box-sizing:inherit;cursor:pointer;text-decoration:none;margin:4px;outline:none;position:relative;display:inline-block;width:32px;height:32px;font-size:20px;border-radius:50%;line-height:32px;border:1px solid rgb(102, 102, 102);text-align:center;vertical-align:middle;transition:background 0.6s ease-out 0s;color:rgb(219, 68, 55);border-color:rgb(219, 68, 55);font-family:socialshare;" target="_blank"><span style="color:rgb(219, 68, 55);cursor:pointer;font-family:socialshare;font-size:20px;line-height:32px;text-align:center;"></span></a></div></div></div></div></div></div></div></div></div></div>
</div>
</span>
</div></body></html> 