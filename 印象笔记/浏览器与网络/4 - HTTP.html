<html>
<head>
  <title>4 - HTTP</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/606060 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2801"/>
<h1>4 - HTTP</h1>

<div>
<span><div><div><div><div><div><div><div><div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Web</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">互联网是 Web 的基础平台，Web 是互联网平台上的一种应用层服务。除 Web 外，FTP、Telnet、Email 等也是互联网上其他类型的应用层服务。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3.jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"></div><hr/><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">WWW</span></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">1990 年之前人们用电脑只能发发 e-mail，使用 FTP 下载文件，打打文字游戏等</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">蒂姆 · 伯纳斯 </span><span style="font-size: 12pt;">· </span><span style="font-size: 12pt;">李</span><span style="font-size: 12pt;">（李爵士） 在 1989 年至 1992 年间，为了统一电脑的连接方式，不受电脑的系统、软硬件的影响，发明了 WWW。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">WWW（</span><span style="font-size: 12pt;">World Wide Web 万维网</span><span style="font-size: 12pt;">）</span><span style="font-size: 12pt;">：</span><span style="font-size: 12pt;">一种适用于全世界的网络。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [1].jpg" type="image/jpeg" data-filename="3.jpg" width="544"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">最初设想的基本理念是：借助多文档之间相互关联形成的超文本（HyperText），连成可相互参阅的 WWW（World Wide Web，万维网）。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">李爵士除了发明了WWW，还：</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">1. 发明了第一个服务器</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">2. 发明了第一个浏览器</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">3. 写出了第一个网页</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">1989 年，任职于欧洲核子研究中心（CERN）的</span><span style="font-size: 12pt;">李爵士</span><span style="font-size: 12pt;">发表了一篇论文，提出了在互联网上构建超链接文档系统（WWW）的构想，</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">WWW（万维网）主要包含三个概念：</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">1. URI（统一资源标识符），</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">互联网上资源的唯一身份，</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">是一个唯一字符串</span></div><div style="text-align: justify;"><div><br/></div><div><span style="font-size: 12pt;">URI ：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">分为 URL 和 URN，</span><span style="font-size: 12pt;">URN 通过名称来查找资源，而 URL 通过位置查找资源。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [2].jpg" type="image/jpeg" data-filename="3.jpg" width="382"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [3].jpg" type="image/jpeg" data-filename="3.jpg" width="397"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">URN：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">用于标识唯一书目的 ISBN 系统是一个典型的 URN 使用范例。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">例如，ISBN 0-486-27557-4无二义性地标识出莎士比亚的戏剧《罗密欧与朱丽叶》的某一特定版本。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">URL（统一资源定位符）：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">URL 是 URI 的子集（URL一定是 URI，但 URI 不一定是 URL），</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">是一个表示位置的唯一字符串，</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">描述了一台特定服务器上某资源的特定位置。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">现在，几乎所有的 URI 都是 URL 。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">URL 遵守以下的语法规则：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">scheme://host.domain:port/path/filename</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● scheme - 定义因特网服务的类型。常见的协议有 http、https、ftp、file，其中最常见的类型是 http，而 https 则是进行加密的网络传输。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">host - 定义主机（http 的默认主机是 www）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">domain - 定义因特网域名，比如 w3school.com.cn </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">port - 定义主机上的端口号（http 的默认端口号是 80） </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">path - 定义服务器上的路径（如果省略，则文档必须位于网站的根目录中） </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">filename - 定义文档/资源的名称</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">我们一般使用 URL 作为网址</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">，</span><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">作用是能让你访问一个页面 </span> </span></div><div><span style="font-size: 12pt;"><br/></span></div></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> </span><span style="font-size: 12pt;">域名分为 一 二 三 级域名，www.baidu.com 和 baidu.com不是同一个域名，只是共有相同的 二 级和 三 级域名</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> </span><span style="font-size: 12pt;">路径不对应文件，</span><span style="font-size: 12pt;">HTTP 路径</span><span style="font-size: 12pt;">只不过是服务器自定义的路径，</span><span style="font-size: 12pt;">不是文件路径！！！所以 /xxx.html 不一定对应 xxx.html 文件</span><span style="font-size: 12pt;">！！！</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> </span><span style="font-size: 12pt;">锚点是 a 标签的 id</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><img src="4 - HTTP_files/3 [4].jpg" type="image/jpeg" data-filename="3.jpg" width="698"/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">2.</span> <span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">HTTP，两个电脑之间传输内容的协议，</span></span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">作用是</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">用来传输超文本，</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">让你能下载这个页面</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3.png" type="image/png" data-filename="3.png" width="707"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">3. HTML，超文本，主要用来做页面跳转，</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">作用是</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">描述超文本文档，</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">让你能看懂这个页面</span></div><div style="text-align: justify;"><div><br/></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DNS（域名系统，电信移动管）</span></font></div></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">IP 地址是一个 32 位的二进制数，比如 127.0.0.1 为本机 IP。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">TCP/IP 协议中使用 IP 地址来标识计算机，数字形式的地址对于计算机来说是方便了，但对于人类来说却既难以记忆又难以输入</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">于是“域名系统”（Domain Name System）出现了</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">域名是为了便于人们记忆，IP地址是为了便于计算机理解。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">DNS 中，“域名”（Domain Name）又称为“主机名”（Host）</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> </span><span style="font-size: 12pt;">输入域名</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> </span><span style="font-size: 12pt;">输出 IP （服务器的 IP 经常会变）</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">hosts 可以本地指定服务器的 IP</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;"><font><font>nslookup baidu.com     （</font>nslookup</font> 查询 DNS 域名和 IP 地址<font><font>）</font></font></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">ping baidu.com         （ping 就是乒乓的乒，可以显示 IP 地址）</font></div></div></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"></div><hr/><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP</span></span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">文本：图片、音频、视频、甚至是压缩包，在 HTTP 眼里都可以算做是“文本”。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">超文本：</span><span style="font-size: 12pt;">文字、图片、音频和视频等的混合体，包含</span><span style="font-size: 12pt;">“超链接”，能够从一个“超文本”跳跃到另一个“超文本”，</span><span style="font-size: 12pt;">HTML 是超文本的载体</span><span style="font-size: 12pt;">。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">传输（双向的）：“A&lt;===&gt;B”或“A&lt;=&gt;X&lt;=&gt;Y&lt;=&gt;Z&lt;=&gt;B”。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">协议：有两个或多个参与者</span><span style="font-size: 12pt;">为了达成某个共同的目的而</span><span style="font-size: 12pt;">约定该做什么不该做什么，先做什么后做什么，做错了怎么办，有没有补救措施等等。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">例如，“租房协议”里就约定了，租期多少个月，每月租金多少，押金是多少，水电费谁来付，违约应如何处理</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">严格来说协议应该包括语法、语义、同步规则和错误处理。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">HTTP 就是超文本传输协议，也就是HyperText Transfer Protocol，是</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">专门在客户端和服务器之间传输文字、图片、音频、视频等超文本数据的约定和规范</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">HTTP </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">默认使用 80 端口（HTTPS使用 443 端口），</span><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">规定了客户端和服务器之间的通信格式</span></span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">。</span></div><div style="text-align: justify;"><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">HTTP 基于 TCP/IP 协议通信协议来传递数据（HTML 文件, 图片文件, 查询结果等），但是不涉及数据包（packet）传输。</span></span></div></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">服务器也可以当客户端，但浏览器只能是客户端。</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">HTTP 的作用就是指导浏览器和服务器如何进行沟通。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">用脚本就可以提供 HTTP 服务，不管是 Bash 脚本还是 Node.js 脚本都可以。</span></span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP 不是互联网</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">互联网（Internet）是指连接计算机的网络（通过TCP/IP协议）。同理移动互联网是连接移动设备的网络。</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">互联网针对的</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">是</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">计算机（点到点），web 针对的</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">是</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">计算机上的应用（端到端）。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">互联网（Internet）是遍布于全球的许多网络互相连接而形成的一个巨大的国际网络，在它上面存放着各式各样的资源，也对应着各式各样的协议，</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">例如超文本资源使用 HTTP，普</span><span style="font-size: 12pt;">通文件使用 FTP，电子邮件使用 SMTP 和 POP3 等。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">通常的“上网”实际上访问的只是互联网的一个子集“万维网”（World Wide Web），</span></span><b style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold; color: rgb(255, 0, 0);">它基于 HTTP 协议，传输 HTML 等超文本资源，能力被限制在 HTTP 协议之内。</span></b></div><div style="text-align: justify;"><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">HTTP只是互联网占比最大的一部分。</span></span></div></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">互联网上还有许多万维网之外的资源，例如常用的电子邮件（</span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Email</span></span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">）、BT 和 Magnet 点对点（P2P）下载、FTP 文件下载、SSH 安全登录、各种即时通信服务（APP）等等，</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">它们需要用各自的专有协议来访问。</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">现在的互联网 90% 以上的部分都被万维网，也就是 HTTP 所覆盖，所以把互联网约等于万维网或 HTTP 不算大错。</span></span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP 不是编程语言</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">我们无法使用 HTTP 来编程，但是可以用编程语言去实现 HTTP</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">很多流行的编程语言支持编写 HTTP 相关的服务或应用</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">例如使用 Java 在 Tomcat 里编写 Web 服务，使用 PHP 在后端实现页面模板渲染，使用 JavaScript 在前端实现动态页面更新</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP 不是一个孤立的协议</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">HTTP 协议的底层由 TCP 协议和 IP 协议（简称 TCP/IP）构建，</span><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">HTTP 通常跑在 TCP/IP 协议栈之上（在Unix系统会不一样）</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">依靠 IP 协议实现寻址和路由、TCP 协议实现可靠数据传输、DNS 协议实现域名查找、SSL/TLS 协议实现安全通信。</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">此外，还有一些协议依赖于 HTTP，例如 WebSocket、HTTPDNS 等。</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">这些协议相互交织，构成了一个协议网，而HTTP则处于中心地位。</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP 不是网址，也不是软件</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"></div><hr/><div style="text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></font></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">HTTP </span><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">特点：</span></font></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">请求-应答模式，通常而言，就是一方发送消息，另外一方要接受消息，或者做出响应等。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">简单快速：客户端向服务器请求服务时，只需传送请求方法和路径。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">灵活：HTTP允许传输任意类型的数据对象。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">无连接：</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。可以节省传输时间。</span></div><div style="text-align: justify;"><div><br/></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0);">●<span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;"> </span></span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">无状态：</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">每个请求都是独立的，与前面的请求和后面的请求都是没有直接联系的。</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">HTTP协议不保留之前一切的请求报文或 响应报文的信息。可以</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">更快地处理大量事务。</span></div></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">可靠传输，HTTP 是基于 TCP/IP ，因此把这一特性继承了下来。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">状态指的是</span><span style="font-size: 12pt;">客户端和服务器在缓存空间中产生的客户的临时数据！</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/640.jpg" type="image/jpeg" data-filename="640.jpg" width="627"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">对于无状态的问题，解法方案有很多种，其中比较简单的方式用 Cookie 技术。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">Cookie 通过在请求和响应报文中写入 Cookie 信息来控制客户端的状态。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">相当于，在客户端第一次请求后，服务器会下发一个装有客户信息的[小贴纸」，后续客户端请求服务器的时候，带上[小贴纸」，服务器就能认得了。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [5].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">缺点：</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">不安全：</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">通信使用明文（不加密）传输，</span><span style="font-size: 12pt;">协议里的报文（主要指的是头部）不使用二进制数据，而是文本形式。</span><span style="font-size: 12pt;">内容可能会被窃听。比如，账号信息容易泄漏，那你号没了。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">不验证通信方的身份，因此有可能遭遇伪装。比如，访问假的淘宝、拼多多，那你钱没了。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">● 无法证明报文的完整性，所以有可能已遭篡改。比如，网页上植入垃圾广告，视觉污染，眼没了。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">HTTP 的安全问题，可以用 HTTPS 的方式解决，也就是通过引入 SSL/TLS 层，使得在安全上达到了极致。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">队头阻塞：</span></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">当顺序发送的请求序列中的一个请求因为某种原因被阻塞（请求时间过长）时，在后面排队的所有请求也一同被阻塞了，会招致客户端一直请求不到数据，这就是队头阻塞。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">好比上班的路上塞车。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><img src="4 - HTTP_files/3 [6].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"></div><hr/><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">HTTP 版本</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP/1.0 版：</span></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">服务器在确认客户机收到响应的消息就关闭连接（短连接），性能上有很大问题。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">HTTP/1.1 版</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">HTTP/1.1 是当前使用的 HTTP 版本。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">增加了持久连接（长连接）支持，</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">服务器在确认客户机收到响应的消息后并不主动关闭连接，而是由客户端决定是否关闭，这样客户端可以继续使用这个连接向服务器发送 HTTP 请求消息。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">当然，服务器仍认为前后两次请求等同于来自不同的连接。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">● </span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">支持持久连接</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">在 HTTP 1.1 版中，持久连接选项已经成为默认打开的（与1.0 版比较），</span><span style="font-size: 12pt;">持久连接的特点是：只要任意一端没有明确提出断开连接，则保持 TCP 连接状态。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">此方案来弥补创建多次连接产生的延迟，但是同样会给服务器带来压力。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">并且对于单文件被不断请求的服务，Keep-alive 会极大影响性能，因为它在文件被请求之后还保持了不必要的连接很长时间。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [7].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● 支持管道网络传输</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">HTTP/1.1采用了长连接的方式，这使得管道（pipeline）网络传输成为了可能。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">即可在同一个TCP连接里面，客户端可以发起多个请求，只要第一个请求发出去了，不必等其回来，就可以发第二个请求出去，可以减少整体的响应时间。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">举例来说，客户端需要请求两个资源。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">以前的做法是，在同一个TCP连接里面，先发送 A 请求，然后等待服务器做出回应，收到后再发出 B 请求。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">管道机制则是允许浏览器同时发出 A 请求和 B 请求。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [8].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">支持内容协商机制</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">增加了 E-tag，If-Unmodified-Since, If-Match, If-None-Match 等缓存控制消息头来控制缓存失效。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">● </span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">支持断点续传</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">通过使用请求头中的 Range 来实现。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">新增方法</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">PUT、 PATCH、 OPTIONS、 DELETE。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP/2.0 版：</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">重点关注的是性能的大幅优化，以及更强大的服务逻辑远程执行框架。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;"> 二进制分帧 </span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">这是一次彻底的二进制协议，头信息和数据体都是二进制，并且统称为&quot;帧&quot;：头信息帧和数据帧。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">头部压缩 </span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">HTTP 1.1 版本会出现 「User-Agent、Cookie、Accept、Server、Range」 等字段可能会占用几百甚至几千字节，而 Body 却经常只有几十字节，所以导致头部偏重。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">HTTP 2.0 使用 HPACK 算法进行压缩。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;"> 多路复用 </span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">复用TCP连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，且不用按顺序一一对应，这样子解决了队头阻塞的问题。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">服务器推送 </span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">允许服务器未经请求，主动向客户端发送资源，即服务器推送。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">请求优先级 </span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">可以设置数据帧的优先级，让服务端先处理重要资源，优化用户体验。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">总之 HTTP/1.1 的性能一般般，后续的 HTTP/2 和 HTTP/3 就是在优化HTTP的性能。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"></div><div><br/></div><hr/><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">端口</span></span></div><div style="text-align: justify;"><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">一个服务器（硬件）不一定只提供一种服务，比如一个服务器既提供 HTTP 服务，又提供 FTP 服务，还提供 SMTP 服务（邮件服务），</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">只用一个 IP 无法告诉服务器你想要使用</span></span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-family: unset; font-weight: bold;">哪种服务。</span></div></div><div style="text-align: justify;"><font color="#FF0000" style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">所以这里有一个重要的原则：一个端口对应一个服务。</span></span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">比如</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">1. 要提供 HTTP 服务你最好使用 80 端口（能不能使用别的端口？可以，不过不建议你违反约定）</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">2. 要提供 HTTPS 服务你最好使用 443 端口（能不能使用别的端口？可以，不过不建议你违反约定）</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">3. 要提供 FTP 服务你最好使用 21 端口（能不能使用别的端口？可以，不过不建议你违反约定）</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">有多少个端口？</span></font></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">每个机器一共有 65535（2 的 16 次方减 1）个端口（这是协议规定的）。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">0 到 1023（2 的 10 次方减 1）号端口是留给系统使用的，你只有拥有了管理员权限后，才能使用这 1024 个端口。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">其他端口可以给普通用户使用</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">如果一个端口正在提供服务，也就是被占用了，那么就不能再使用这个端口。除非你先停掉正在占用这个端口的服务。以后你们会经常遇到这个问题。</span></div><div style="text-align: justify;"><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">使用 HTTP 协议访问另一个 IP 时，比如同时提供 IP 和端口号，缺一不可</span></font></div></div><div style="text-align: justify;"><div><br/></div><div><br/></div><hr/><div><br/></div></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">服务器与浏览器的交互</span></span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">● 浏览器负责发起请求</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 服务器在 80 端口接收请求</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 服务器负责返回内容（响应）</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浏览器负责下载响应内容</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div><br/></div><hr/><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">Http 报文包括请求报文和响应报文两大部分：</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/3 [1].png" type="image/png" data-filename="3.png"/></span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">请求报文（请求行、请求头、空行、请求体 —— Get 不一定有）</span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">和响应报文（状态行、响应头、空行、响应体）都由四部分组成。</span></span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">请求：</span></font></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">请求行、请求头、空行、请求体</span></font></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [9].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [2].png" type="image/png" data-filename="3.png" width="671"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">1  请求方法 请求URL 协议/版本号   1 </span><span style="font-size: 12pt;">请求行             请求的第一部分</span></div><div><span style="font-size: 12pt;">2  Key1： value1               </span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">2 请求头开始          </span><span style="font-size: 12pt;">请求的</span><span style="font-size: 12pt;">第二部分</span></div><div><span style="font-size: 12pt;">2  Key2： value2</span></div><div><span style="font-size: 12pt;">2  Key3： value3</span></div><div><span style="font-size: 12pt;">2  Content-Type:  application（应用数据）/x（实验属性，未写入规范）-www-form-urlencoded（转译中文，转成</span><span style="font-size: 12pt;">key=value&amp;key=value格式，get请求连接到url后）</span></div><div><font style="font-size: 12pt;">2  Host:  www.baidu.com</font></div><div><span style="font-size: 12pt;">2  User-Agent:  cur1/7.54.0    </span><span style="font-size: 12pt;">2  请求头结束</span></div><div><span style="font-size: 12pt;">3                              3  空行（表示</span><span style="font-size: 12pt;">请求头正式结束</span><span style="font-size: 12pt;">）     </span><span style="font-size: 12pt;">请求的第三部分</span></div><div><span style="font-size: 12pt;">4  要上传的数据                 4  请求体（请求正文或请求数据）   <b>请求的第四部分（GET请求可以有，没必要）</b></span></div></div></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">在 HTTP 协议中，由于服务器是被动接受连接提供服务，要访问的资源必然是服务器的资源，所以</span><span style="font-size: 12pt;">请求URL采用的是相对URL格式，</span><span style="font-size: 12pt;">表示同一台机器上的资源。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><img src="4 - HTTP_files/3 [10].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">请求最多包含四部分，</span><span style="font-size: 12pt; font-weight: bold;">最少包含三部分。（也就是说第四部分可以为空）</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">1、</span><span style="font-size: 12pt; font-weight: bold;">请求方法：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><img src="4 - HTTP_files/3 [11].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">HTTP 支持几种不同的请求命令，这些命令被称为 HTTP 方法（HTTP method）。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">每条 HTTP 请求报文都包含一个方法。这个方法会告诉服务器要执行什么动作（获取一个Web页面、运行一个网关程序、删除一个文件等）。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">1、GET   </span> <span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">请求从服务器获取资源，这个资源既可以是静态的文本、页面、图片、视频，也可以是由 PHP、Java 动态生成的页面或者其他格式的数据。</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">*</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">     GET 方法除了请求URL中可能包含查询参数外，一般不包含请求体，即不会发送其他数据。</span></div><div style="text-align: justify;"><div><br/></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">   （</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">请求指定的页面信息，返回实体主体</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">）</span></div></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">2、POST （</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">向指定资源提交数据处理请求，例如提交表单或者上传文件。数据被包含在请求体中，</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">POST请求可能会导致新的资源的建立和/或已有资源的修改）</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">3、POST 方法通常包含请求体，请求体中携带客户端需要上传给服务器的数据 ( 如页面表单FORM数据 )。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">4、PUT（完全更新）</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">如果该资源已经存在，则替换原资源的内容；</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">如果资源不存在，则服务器创建该资源，并且通知客户端。</span></div></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">5、PATCH（部分更新）</span> </span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">6、DELETE（</span><span style="font-size: 12pt; font-weight: bold;">请求服务器删除指定页面</span><span style="font-size: 12pt; font-weight: bold;">）</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">7、HEAD </span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">HEAD 方法仅仅返回相关的响应头信息，不返回资源内容。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">HEAD 方法常用于测试资源是否存在、是否已经被修改或删除。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">8、OPTIONS</span></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">2、</span><span style="font-size: 12pt; font-weight: bold;">请求URL采用的是相对URL。</span><span style="font-size: 12pt; font-weight: bold;">这里的路径包括「查询参数」，但不包括「锚点」，如：</span><span style="font-size: 12pt; font-weight: bold;">/s?wd=JavaScript 百度关键字，</span><span style="font-size: 12pt; font-weight: bold;">如果你没有写路径，那么路径默认为/</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">3、请求头中的Content-Type 标注了第4部分的内容格式类型</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">4、</span> <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">第三部分永远都是一个回车（\n）</span></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">请求报文</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">curl -s(不显示进度条) -v(显示请求和响应) -H &quot;Frank: xxx&quot;(随便加的) --(请求的网址是) &quot;https://www.baidu.com&quot;</font></div></div></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">请求报文</span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">的格式</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">curl -X POST -s -v -H &quot;Frank: xxx&quot; -- &quot;https://www.baidu.com&quot;</font></div><div><br/></div><div><font style="font-size: 12pt;">GET / HTTP/1.1</font></div><div><font style="font-size: 12pt;">Host: www.baidu.com</font></div><div><font style="font-size: 12pt;">User-Agent: curl/7.54.0</font></div><div><font style="font-size: 12pt;">Accept: */*</font></div><div><font style="font-size: 12pt;">Frank: xxx</font></div></div></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">curl -X POST -s -v -H &quot;Frank: xxx&quot; -- &quot;https://www.baidu.com&quot;</font></div><div><br/></div><div><font style="font-size: 12pt;">POST / HTTP/1.1</font></div><div><font style="font-size: 12pt;">Host: www.baidu.com (域名)</font></div><div><font style="font-size: 12pt;">User-Agent: curl/7.54.0 (什么软件)</font></div><div><font style="font-size: 12pt;">Accept: */* (接受任何内容)</font></div><div><font style="font-size: 12pt;">Frank: xxx</font></div></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">curl -X POST -d &quot;1234567890&quot; -s -v -H &quot;Frank:xxx&quot; -- &quot;https://ww.baidu.com&quot;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">POST / HTTP/1.1</font></div><div><font style="font-size: 12pt;">Host:  www.baidu.com</font></div><div><font style="font-size: 12pt;">User-Agent:  curl/7.54.0</font></div><div><font style="font-size: 12pt;">Accept:  */*</font></div><div><font style="font-size: 12pt;">Frank:  xxx</font></div><div><font style="font-size: 12pt;">Content-Length:10 (内容长度)</font></div><div><font style="font-size: 12pt;">Content-Type:application/x-www-form-urlencoded（内容类型，url方式发送）</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">a = 1 &amp;&amp; b = 2 &amp;&amp; c = 3 （请求体参数）</font></div></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Fiddler测试GET请求和POST请求（约定好接口后）</span></font></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">GET请求（URL参数）查询员工</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><img src="4 - HTTP_files/3 [12].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><img src="4 - HTTP_files/3 [13].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">POST请求（请求体参数）创建员工</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><img src="4 - HTTP_files/3 [14].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><img src="4 - HTTP_files/3 [15].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><hr style="text-align: justify;"/><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">application/x-www-form-urlencoded</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: unset; font-family: unset;">这种编码格式，是我们最常见的一种方式，</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: unset; font-family: unset;">将数据封装成一个字符串，参数名和参数值使用&quot;=&quot;拼接，参数之间使用&quot;&amp;&quot;拼接，最终传递至后台的数据格式形如：key1=value1&amp;key2=value2&amp;...；</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">另外，key 和 value 都会分别使用 encodeURI() 对其进行编码，也就是你所要传递的数据，实际上已经进行了一次编码（默认的），</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">形如：name=Marydon&amp;work=%E7%A8%8B%E5%BA%8F%E5%91%98，</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">服务器接收到后干的第一件事就是使用 URLDdecoder.decode() 对 name 和 value 进行一次解码。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/2021-11-05_165501.jpg" type="image/jpeg" data-filename="2021-11-05_165501.jpg" width="698"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">不管是 form 表单请求还是 ajax 请求，都是这样进行数据组装的。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">当表单数据的编码格式为：application/x-www-form-urlencoded 时：</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">get 请求，浏览器会将数据按照 iso-8859-1 进行重新编码，导致后台接收到中文时必然乱码；</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">post 请求，浏览器会按照 utf-8 对要提交的数据进行编码，由于后台本身就是使用 utf-8 对其进行解析，所以 post 请求不会出现乱码的情况</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">application/json</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">怎样才能通过 ajax 向后台传输 json 数据呢？</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">首先需要明白的是，前端向后台传输数据有且只有两种方式，</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">一种是常见的字符串格式，另一种就是二进制数据，也就是不管你向后台传输什么类型的数据都会被转换成字符串或者二进制。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">所以<span style="font-size: 12pt; font-weight: bold;">向后台传输，并不是传递一个 json 对象，而是应该</span><span style="font-size: 12pt; font-weight: bold;">传一个 json 字符串。</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">$.ajax({</font></div><div><font style="font-size: 12pt;">    type : 'post',// 请求方式</font></div><div><font style="font-size: 12pt;">    url : 'getParams',// 请求地址</font></div><div><font style="font-size: 12pt;">    contentType : 'application/json; charset=UTF-8',// 告知服务器，传递的是json数据</font></div><div><font style="font-size: 12pt;">    data :&quot;{'name' : 'Marydon','work' : '程序员'}&quot;,// json字符串（必要条件）</font></div><div><font style="font-size: 12pt;">    success : function(result){// 请求成功</font></div><div><font style="font-size: 12pt;">        alert(result.work);</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">});　　</font></div></div><div><br/></div></div><div style="text-align: justify;"><span style="font-size: 12pt;">注意：</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">当 ajax 向后台发送 json 字符串的数据时，</span><span style="font-size: 12pt; font-weight: bold;">当参数值为中文时，</span><span style="font-size: 12pt; font-weight: bold;">即使是 post 请求，也会造成乱码问题，</span><span style="font-size: 12pt; font-weight: bold;">后端接收到的将是乱码数据，需要前端手动进行转码</span> <span style="font-size: 12pt; font-weight: bold;">encodeURI()</span><span style="font-size: 12pt; font-weight: bold;">。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">GET与POST区别</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">GET 请求是幂等的，执行一次和执行一万次的影响是一样的，</span><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">幂等指发送 M 和 N 次请求（两者不相同且都大于1），服务器上资源的状态一致。</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">●</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;"> GET 参数一般通过 URL 传递（也可以放在请求体中），POST 参数一般放在请求体中</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">●</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;"> GET 请求在URL中传送的参数是有长度限制的，而 POST 没有限制</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">GET 请求参数会被完整保留在浏览器历史记录里，而 POST 中的参数不会被保留</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">GET 请求会被浏览器</span><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">或中间代理服务器</span></span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">缓存，而 POST 不会，除非手动设置</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● GET 在浏览器回退时是无害的，而 POST 会再次提交请求</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">当用 GET 请求比较大的资源时，可使用断点续传的机制。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP 方法的安全性指的是不会改变服务器状态，也就是说它只是可读的。</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">所以只有 OPTIONS、GET、HEAD 是安全的，其他都是不安全的。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [3].png" type="image/png" data-filename="3.png"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"></div><hr/><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">用 Chrome 查看请求</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">1. 打开 Network</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">2. 地址栏输入网址</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">3. 在 Network 点击，查看 request，点击「view source」，</span><span style="font-size: 12pt;">点击「view source」，</span><span style="font-size: 12pt;">点击「view source」！</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">7. 点了就可以看到请求的前三部分了</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">8. 如果有请求的第四部分(比如是POST请求)，那么在 FormData 或 Payload 里面可以看到（用户名密码等内容）</span></div><div style="text-align: justify;"><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Pre</span></span><span style="font-size: 12pt; font-weight: bold;">serve log：勾选后，刷新页面，之前的请求日志还在（例如登录时POST请求用，Form Data 有用户名密码，HTTPS会加密）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Disable cache：关闭缓存信息</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [16].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><br/></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">响应：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">每条 HTTP 响应报文返回时都会携带一个状态码。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">状态码是一个三位数字的代码，告知客户端请求是否成功，或者是否需要采取其他动作。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">状态行、响应头、空行、响应体</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [17].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [4].png" type="image/png" data-filename="3.png" width="700"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [18].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">1  协议/版本号 状态码 状态说明   状态行 响应的第一部分</span></div><div><span style="font-size: 12pt;">2  Key1：value1                响应头 响应的第二部分</span></div><div><span style="font-size: 12pt;">2  Key2：value2</span></div><div><span style="font-size: 12pt;">2  Content-Length：17931       </span></div><div><span style="font-size: 12pt;">2  Content-Type:  text/html    </span></div><div><span style="font-size: 12pt;">3                              空行   响应的第三部分  </span></div><div><span style="font-size: 12pt;">4  要下载的内容                 响应体 </span><span style="font-size: 12pt;">响应的第四部分  </span></div></div></div><div style="text-align: justify;"><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">响应报文</span></div><div><br/></div></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">响应报文的格式</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">HTTP/1.1 200 OK</span></div><div><span style="font-size: 12pt;">Accept-Ranges: bytes</span></div><div><span style="font-size: 12pt;">Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform</span></div><div><span style="font-size: 12pt;">Connection: Keep-Alive</span> <span style="font-size: 12pt;">（</span><span style="font-size: 12pt;">keepalive，即持久连接，一个连接可以发多个请求，</span><span style="font-size: 12pt;">只要任意一端没有明确提出断开连接，则保持TCP连接状态）</span></div><div><span style="font-size: 12pt;">Content-Length: 2443</span></div><div><span style="font-size: 12pt;">Content-Type: text/html;charset=utf-8</span></div><div><span style="font-size: 12pt;">Date: Tue, 10 Oct 2017 09:14:05 GMT</span></div><div><span style="font-size: 12pt;">Etag: &quot;5886041d-98b&quot;</span></div><div><span style="font-size: 12pt;">Last-Modified: Mon, 23 Jan 2017 13:24:45 GMT</span></div><div><span style="font-size: 12pt;">Pragma: no-cache</span></div><div><span style="font-size: 12pt;">Server: bfe/1.0.8.18</span></div><div><span style="font-size: 12pt;">Set-Cookie: BDORZ=27315; max-age=86400; domain=.<a href="http://baidu.com;/">baidu.com;</a> path=/</span></div><div><br/></div><div><span style="font-size: 12pt;">&lt;!DOCTYPE html&gt;</span></div><div><span style="font-size: 12pt;">&lt;html&gt; &lt;head&gt; 后面太长，省略了……&lt;/html&gt;</span></div></div></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">假如当请求一个包含 10 张图片的 HTML Web 页面，HTTP使请求响应以</span><span style="font-size: 12pt;">管线化方式发送，</span><span style="font-size: 12pt;">请求打包一次传输过去，响应打包一次传递回来</span><span style="font-size: 12pt;">：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">请求1-&gt;请求2-&gt;请求3-&gt;响应1-&gt;响应2-&gt;响应3，而</span><span style="font-size: 12pt;">不是：</span><span style="font-size: 12pt;">请求1-&gt;响应1-&gt;请求2-&gt;响应2-&gt;请求3-&gt;响应3</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">HTTP/1.1 302 Found</span></div><div><span style="font-size: 12pt;">Connection: Keep-Alive</span></div><div><span style="font-size: 12pt;">Content-Length: 17931</span></div><div><span style="font-size: 12pt;">Content-Type: text/html</span><span style="font-size: 12pt;">;charset=utf-8</span><span style="font-size: 12pt;"> </span> <span style="font-size: 12pt;">            </span><span style="font-size: 12pt;">Content-Type：指定了MIME类型的HTML(text/html)，编码类型是UTF-8 </span></div><div><span style="font-size: 12pt;">Date: Tue, 10 Oct 2017 09:19:47 GMT                </span><span style="font-size: 12pt;">Date：生成响应的日期和时间；</span></div><div><span style="font-size: 12pt;">Etag: &quot;54d9749e-460b&quot;</span></div><div><span style="font-size: 12pt;">Server: bfe/1.0.8.18</span></div><div><br/></div><div><span style="font-size: 12pt;">&lt;!DOCTYPE html&gt;</span></div><div><span style="font-size: 12pt;">&lt;html&gt;</span></div><div><span style="font-size: 12pt;">&lt;head&gt;</span></div><div><span style="font-size: 12pt;">&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt; 后面太长，省略了……</span></div></div><div><br/></div></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">1、状态码</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [5].png" type="image/png" data-filename="3.png"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [19].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">要背，是服务器对浏览器说的话：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">1xx  不常用（</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">请求已接收，继续处理中</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">）</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">2xx  成功 —— 表示成功（</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">请求已被成功接收</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">、处理并予以响应</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">）</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">3xx </span> <span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">重定向 —— </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">表示听不懂，滚吧 或 我搬家了到其他地方去找。（请求没有成功，</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">客户端需要进一步操作才能完成请求</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">）</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: unset; font-family: unset;">304 Not Modified：</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: unset; font-family: unset;">用于缓存控制，也称缓存重定向。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: unset; font-family: unset;">如果客户端发送了一个带条件的 GET 请求且该请求已被允许，而文档的内容（自上次访问以来或者根据请求的条件）并没有改变，则服务器应当返回这个 304 状态码。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● 4xx </span> <span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">客户端错误 —— </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">表示你丫错了（客户端的</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">请求有语法错误或请求无法实现</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">）</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">403  Forbidden：</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: unset; font-family: unset;">服务器接收到请求，但是拒绝处理。原因是用户未通过身份验证或未得到访问资源的权限。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">5xx </span> <span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">服务器错误 —— </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">表示好吧，我错了，崩溃或关机了（</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">服务器无法处理合法的请求</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">）</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">2、状态消息（</span><span style="font-size: 12pt; font-weight: bold;">没什么用</span><span style="font-size: 12pt; font-weight: bold;">）</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">3、响应头</span></font></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">第2部分中的Content-Type标注了第4部分的格式，是html、js还是json等。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">第2部分中的Content-Type遵循MIME规范，</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">MIME( Multipurpose Internet Mail Extensions )</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">多用途Internet邮件扩展</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">是一种邮件扩展协议，用于描述所传输的多媒体类型</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">● </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Content-Type和</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Content-Length都是在请求/响应头中用来描述实体的</span></div><div style="text-align: justify;"><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// 设置页面内容是html编码格式是utf-8</font></div><div><font style="font-size: 12pt;">header(&quot;Content-Type:text/plain；charset=utf-8&quot;);</font></div><div><font style="font-size: 12pt;">header(&quot;Content-Type:application/json; charset=utf-8&quot;);</font></div><div><font style="font-size: 12pt;">header(&quot;Content-Type:text/html; charset=utf-8&quot;);</font></div><div><font style="font-size: 12pt;">header(&quot;Content-Type:application/javascript; charset=utf-8&quot;);</font></div></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">4 响应体可以很长很长很长</span></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">GET 请求和 POST 请求对应的响应可以一样，也可以不一样</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">200: '请求被正确处理并返回了结果',  </font></div><div><font style="font-size: 12pt;">201: '新增或修改数据成功',</font></div><div><font style="font-size: 12pt;">202: '请求已进入任务队列，被异步处理',   </font></div><div><font style="font-size: 12pt;">203: '令牌或登录状态失效',   </font></div><div><font style="font-size: 12pt;">204: '删除数据成功',</font></div><div><font style="font-size: 12pt;">301: '请求的资源被永久重定向到新的位置，将从新的地址重新请求',  </font></div><div><font style="font-size: 12pt;">302: '请求的资源被临时重定向到新的位置',  </font></div><div><font style="font-size: 12pt;">400: '请求参数错误，服务器没有对数据做新建或修改',</font></div><div><font style="font-size: 12pt;">401: '无访问权限，用户名、密码、令牌错误',</font></div><div><font style="font-size: 12pt;">403: '得到访问授权，但访问是被禁止',</font></div><div><font style="font-size: 12pt;">404: '访问的是不存在的资源',  </font></div><div><font style="font-size: 12pt;">405: '请求方式不正确',</font></div><div><font style="font-size: 12pt;">406: '请求的数据格式不是服务接收的类型',  </font></div><div><font style="font-size: 12pt;">410: '请求的资源被永久删除',</font></div><div><font style="font-size: 12pt;">422: '服务器创建对象时发生错误',</font></div><div><font style="font-size: 12pt;">500: '服务器不可用，未返回正确的数据',</font></div><div><font style="font-size: 12pt;">502: '服务器网关错误',</font></div><div><font style="font-size: 12pt;">503: '服务器过载或维护中',  </font></div><div><font style="font-size: 12pt;">504: '服务器响应超时',</font></div></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">1xx</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">101 Switching Protocols。在HTTP升级为WebSocket的时候，如果服务器同意变更，就会发送状态码 101。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">2xx</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">200 OK是见得最多的成功状态码。通常在响应体中放有数据。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">204 No Content含义与 200 相同，但响应头后没有 body 数据。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">206 Partial Content顾名思义，表示部分内容，它的使用场景为 HTTP 分块下载和断点续传，当然也会带上相应的响应头字段Content-Range。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">3xx</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">301 Moved Permanently 即永久重定向，对应着302 Found，即临时重定向。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">比如你的网站从 HTTP 升级到了 HTTPS 了，以前的站点再也不用了，应当返回301，这个时候浏览器默认会做缓存优化，在第二次访问的时候自动访问重定向的那个地址。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">而如果只是暂时不可用，那么直接返回302即可，和301不同的是，浏览器并不会做缓存优化。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">304 Not Modified: 当协商缓存命中时会返回这个状态码。详见浏览器缓存</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">4xx</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">400 Bad Request: 开发者经常看到一头雾水，只是笼统地提示了一下错误，并不知道哪里出错了。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">403 Forbidden: 这实际上并不是请求报文出错，而是服务器禁止访问，原因有很多，比如法律禁止、信息敏感。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">404 Not Found: 资源未找到，表示没在服务器上找到相应的资源。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">405 Method Not Allowed: 请求方法不被服务器端允许。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">406 Not Acceptable: 资源无法满足客户端的条件。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">408 Request Timeout: 服务器等待了太长时间。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">409 Conflict: 多个请求发生了冲突。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">413 Request Entity Too Large: 请求体的数据过大。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">414 Request-URI Too Long: 请求行里的 URI 太大。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">429 Too Many Request: 客户端发送的请求过多。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">431 Request Header Fields Too Large请求头的字段内容太大。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">5xx</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">500 Internal Server Error: 仅仅告诉你服务器出错了，出了啥错咱也不知道。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">501 Not Implemented: 表示客户端请求的功能还不支持。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">502 Bad Gateway: 服务器自身是正常的，但访问的时候出错了，啥错误咱也不知道。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">503 Service Unavailable: 表示服务器当前很忙，暂时无法响应服务。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">用 Chrome 查看响应</span></div><div><br/></div><div><span style="font-size: 12pt;">1. 打开 Network</span></div><div><br/></div><div><span style="font-size: 12pt;">2. 输入网址</span></div><div><br/></div><div><span style="font-size: 12pt;">3. 选中第一个响应</span></div><div><br/></div><div><span style="font-size: 12pt;">4. 查看 Response Headers，点击「view source」，</span><span style="font-size: 12pt;">点击「view source」，</span><span style="font-size: 12pt;">点击「view source」！</span></div><div><br/></div><div><span style="font-size: 12pt;">5. 你会看到响应的前两部分</span></div><div><br/></div><div><span style="font-size: 12pt;">6. 查看 Response 或者 Preview，你会看到响应的第 4 部分</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [20].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [21].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [22].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">注意：慕课网这里属于前后端不分离，因为 Response 的 HTML 里有</span><span style="font-size: 12pt; font-weight: bold;">数据显示</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">说一说常见的请求头和相应头都有什么？</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1  请求(客户端-&gt;服务端[request])</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">GET(请求的方式) /newcoder/hello.html(请求的目标资源) HTTP/1.1(请求采用的协议和版本号)</font></div><div><font style="font-size: 12pt;">Accept: */*(客户端能接收的资源类型)</font></div><div><font style="font-size: 12pt;">Accept-Language: en-us(客户端接收的语言类型)</font></div><div><font style="font-size: 12pt;">Connection: Keep-Alive(维护客户端和服务端的连接关系)</font></div><div><font style="font-size: 12pt;">Host: localhost:8080(连接的目标主机和端口号)</font></div><div><font style="font-size: 12pt;">Referer: http://localhost/links.asp(告诉服务器我来自于哪里)</font></div><div><font style="font-size: 12pt;">User-Agent: Mozilla/4.0(客户端版本号的名字)</font></div><div><font style="font-size: 12pt;">Accept-Encoding: gzip, deflate(客户端能接收的压缩数据的类型)</font></div><div><font style="font-size: 12pt;">If-Modified-Since: Tue, 11 Jul 2000 18:23:51 GMT(缓存时间)</font></div><div><font style="font-size: 12pt;">Cookie(客户端暂存服务端的信息)</font></div><div><font style="font-size: 12pt;">Date: Tue, 11 Jul 2000 18:23:51 GMT(客户端请求服务端的时间)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">2  响应(服务端-&gt;客户端[response])</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">HTTP/1.1(响应采用的协议和版本号) 200(状态码) OK(描述信息)</font></div><div><font style="font-size: 12pt;">Location: http://www.baidu.com(服务端需要客户端访问的页面路径)</font></div><div><font style="font-size: 12pt;">Server:apache tomcat(服务端的Web服务端名)</font></div><div><font style="font-size: 12pt;">Content-Encoding: gzip(服务端能够发送压缩编码类型)</font></div><div><font style="font-size: 12pt;">Content-Length: 80(服务端发送的压缩数据的长度)</font></div><div><font style="font-size: 12pt;">Content-Language: zh-cn(服务端发送的语言类型)</font></div><div><font style="font-size: 12pt;">Content-Type: text/html; charset=GB2312(服务端发送的类型及采用的编码方式)</font></div><div><font style="font-size: 12pt;">Last-Modified: Tue, 11 Jul 2000 18:23:51 GMT(服务端对该资源最后修改的时间)</font></div><div><font style="font-size: 12pt;">Refresh: 1;url=http://www.it315.org(服务端要求客户端1秒钟后，刷新，然后访问指定的页面路径)</font></div><div><font style="font-size: 12pt;">Content-Disposition: attachment; filename=aaa.zip(服务端要求客户端以下载文件的方式打开该文件)</font></div><div><font style="font-size: 12pt;">Transfer-Encoding: chunked(分块传递数据到客户端）  </font></div><div><font style="font-size: 12pt;">Set-Cookie:SS=Q0=5Lb_nQ; path=/search(服务端发送到客户端的暂存数据)</font></div><div><font style="font-size: 12pt;">Expires: -1//3种(服务端禁止客户端缓存页面数据)</font></div><div><font style="font-size: 12pt;">Cache-Control: no-***(服务端禁止客户端缓存页面数据)  </font></div><div><font style="font-size: 12pt;">Pragma: no-***(服务端禁止客户端缓存页面数据)   </font></div><div><font style="font-size: 12pt;">Connection: close(1.0)/(1.1)Keep-Alive(维护客户端和服务端的连接关系)  </font></div><div><font style="font-size: 12pt;">Date: Tue, 11 Jul 2000 18:23:51 GMT(服务端响应客户端的时间)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">通用头部字段</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [6].png" type="image/png" data-filename="3.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><br/></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">缓存机制</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">一般缓存 img、css、js</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">强缓存优先级大于协商缓存，</span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">若两种缓存皆存在，且强制缓存命中目标，则协商缓存不再验证标识。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_175929.jpg" type="image/jpeg" data-filename="2021-11-03_175929.jpg" width="523"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_180151.jpg" type="image/jpeg" data-filename="2021-11-03_180151.jpg" width="554"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_180230.jpg" type="image/jpeg" data-filename="2021-11-03_180230.jpg" width="572"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_180547.jpg" type="image/jpeg" data-filename="2021-11-03_180547.jpg" width="522"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">注意：响应头有 cache-control:max-age ，状态码为 200 且有 disk cache 为强制缓存</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_181509.jpg" type="image/jpeg" data-filename="2021-11-03_181509.jpg" width="611"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_181553.jpg" type="image/jpeg" data-filename="2021-11-03_181553.jpg" width="505"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_181910.jpg" type="image/jpeg" data-filename="2021-11-03_181910.jpg" width="589"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_181934.jpg" type="image/jpeg" data-filename="2021-11-03_181934.jpg" width="496"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">协商缓存又称对比缓存</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_182259.jpg" type="image/jpeg" data-filename="2021-11-03_182259.jpg" width="559"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_182443.jpg" type="image/jpeg" data-filename="2021-11-03_182443.jpg" width="550"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_182744.jpg" type="image/jpeg" data-filename="2021-11-03_182744.jpg" width="556"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_183029.jpg" type="image/jpeg" data-filename="2021-11-03_183029.jpg" width="603"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_183227.jpg" type="image/jpeg" data-filename="2021-11-03_183227.jpg" width="584"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_183332.jpg" type="image/jpeg" data-filename="2021-11-03_183332.jpg" width="638"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">注意：响应头有 Etag 和 Last-Modified 且状态码为 304 为协商缓存</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_183438.jpg" type="image/jpeg" data-filename="2021-11-03_183438.jpg" width="534"/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/2021-11-03_183534.jpg" type="image/jpeg" data-filename="2021-11-03_183534.jpg" width="534"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">假设</span></div><div><br/></div><div><span style="font-size: 12pt;">● a.js 大小为 10 KB</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 请求头约定为 1 KB</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 响应头约定为 1 KB</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">原始模型</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浏览器请求静态资源 a.js。（请求头：1KB）</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 服务器读取磁盘文件 a.js，返给浏览器。（10KB（a.js）+1KB（响应头） = 11KB）。</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浏览器再次请求，服务器又重新读取磁盘文件 a.js，返给浏览器。</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 如此循环。</span></div><div><br/></div><div><span style="font-size: 12pt;">执行一个往返，流量为 10（a.js）+1（请求头）+1（响应头） = 12KB。</span></div><div><br/></div><div><span style="font-size: 12pt;">访问 10 次，流量大约为12 * 10 = 120KB。</span></div><div><br/></div><div><span style="font-size: 12pt;">所以，流量与访问次数有关：</span></div><div><br/></div><div><span style="font-size: 12pt;">L（流量） = N（访问次数） * 12。</span></div><div><br/></div><div><span style="font-size: 12pt;">该方式缺点很明显：</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浪费用户流量。</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浪费服务器资源，服务器要读磁盘文件，然后发送文件到浏览器。</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浏览器要等待 a.js 下载并且执行后才能渲染页面，影响用户体验。</span></div><div><br/></div><div><span style="font-size: 12pt;">js 执行时间相比下载时间要快的多，如果能优化下载时间，用户体验会提升很多。</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">浏览器增加缓存机制</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">浏览器第一次请求 a.js，缓存 a.js 到本地磁盘。（1+10+1 =12KB）</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">浏览器再次请求 a.js，直接走浏览器缓存（200，from cache），不再向服务器发起请求。（0KB）</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> ...</span></div><div><br/></div><div><span style="font-size: 12pt;">第一次访问，流量为 1+10+1 = 12KB。 第二次访问，流量为 0。 。。。 第 10000 次访问，流量依然为 0。</span></div><div><br/></div><div><span style="font-size: 12pt;">所以流量与访问次数无关：</span></div><div><br/></div><div><span style="font-size: 12pt;">L（流量） = 12KB。</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">优点：</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> 大大减少带宽。</span></div><div><br/></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> 由于减少了 a.js 下载时间，相应的提高了用户体验。</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">缺点：</span></div><div><br/></div><div><span style="font-size: 12pt;">服务器上 a.js 更新时，浏览器感知不到，拿不到最新的 js 资源。</span></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">服务器和浏览器约定资源过期时间</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">服务器和浏览器约定文件过期时间，用 Expires 字段来控制，时间是 GMT 格式的标准时间，如 Fri, 01 Jan 1990 00:00:00 GMT。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">浏览器第一次请求一个静态资源 a.js。（1KB）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> 服务器把 a.js 和 a.js 的缓存过期时间(Expires：Mon, 26 Sep 2018 05:00:00 GMT)发给浏览器。（10+1=11KB）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">服务器告诉浏览器：你把我发给你的 a.js 文件缓存到你那里，在 2018年9月26日5点之前不要再发请求烦我，直接使用你自己缓存的 a.js 就行了。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">浏览器接收到 a.js，同时记住了过期时间。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">在2018年9月26日5点之前，浏览器再次请求 a.js，便不再请求服务器，直接使用上一次缓存的 a.js 文件。（0KB）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">在2018年9月26日5点01分，浏览器请求 a.js，发现 a.js 缓存时间过了，于是不再使用本地缓存，而是请求服务器，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">    服务器重新读取磁盘文件 a.js，返回给浏览器，同时告诉浏览器一个新的过期时间。（1+10+1=12KB）。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 如此往复。。。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">该种方式较之前的方式有了很大的改善：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 在过期时间以内，为用户省了很多流量。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 减少了服务器重复读取磁盘文件的压力。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 缓存过期后，能够得到最新的 a.js 文件。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">缺点还是有：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 缓存过期以后，服务器不管 a.js有没有变化，都会再次读取 a.js文件，并返给浏览器。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">服务器告诉浏览器资源上次修改时间</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">为了解决上个方案的问题。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">服务器和浏览器经过磋商，制定了一种方案，服务器每次返回 a.js 的时候，还要告诉浏览器 a.js 在服务器上的最近修改时间 Last-Modified （GMT标准格式）。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浏览器访问 a.js 文件。（1KB）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 服务器返回 a.js 的时候，告诉浏览器 a.js 文件。（10+1=11KB） 在服务器的上次修改时间 Last-Modified（GMT标准格式）以及缓存过期时间 Expires（GMT标准格式）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 当 a.js 过期时，浏览器带上 If-Modified-Since（等于上一次请求的 Last-Modified） 请求服务器。（1KB）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 服务器比较浏览器请求头里的 Last-Modified 时间和服务器上 a.js 的上次修改时间：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">   </span><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span> <span style="font-size: 12pt;">如果一致，则告诉浏览器：你可以继续用本地缓存（304）。此时，服务器不再返回 a.js 文件。（1KB）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">   </span><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> 如果不一致，服务器读取磁盘上的 a.js 文件返给浏览器，同时告诉浏览器 a.js 的最近的修改时间 Last-Modified 以及过期时间 Expires。（1+10=11KB）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">   </span><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;">  </span><span style="font-size: 12pt;">如此往复。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">此种方案比上一个方案有了更进一步的优化：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> 缓存过期后，服务器检测如果文件没变化，不再把 a.js 发给浏览器，省去了 10KB 的流量。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> 缓存过期后，服务器检测文件有变化，则把最新的 a.js 发给浏览器，浏览器能够得到最新的 a.js。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">缺点：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> Expires 过期控制不稳定，因为浏览器端可以随意修改时间，导致缓存使用不精准。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;"> Last-Modified 过期时间只能精确到秒。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">精确到秒存在两个问题：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 1、如果 a.js 在一秒时间内经常变动，同时服务器给 a.js 设置无缓存，那浏览器每次访问 a.js，都会请求服务器，</span></div><div><span style="font-size: 12pt;">    </span></div><div><span style="font-size: 12pt;">         此时服务器比较发给浏览器的上次修改时间和 a.js 的最近修改时间，发现都是在同一时间（因为精确到秒），</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">         因此返回给浏览器继续使用本地缓存的消息（304），但事实上服务器上的 a.js 已经改动了好多次了。所以这种情况，浏览器拿不到最新的 a.js 文件。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 2、如果在服务器上 a.js 被修改了，但其实际内容根本没发生改变，会因为 Last-Modified 时间匹配不上而重新返回 a.js 给浏览器。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">继续改进，增加相对时间的控制，引入 Cache-Contorl</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">为了兼容已经实现了上述方案的浏览器，同时加入新的缓存方案，服务器除了告诉浏览器 Expires ，同时告诉浏览器一个相对时间 Cache-Control：max-age=10秒。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">意思是在 10 秒以内，使用缓存到浏览器的 a.js 资源。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">浏览器先检查 Cache-Control，如果有，则以 Cache-Control 为准，忽略 Expires。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果没有 Cache-Control，则以 Expires 为准。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">继续改进，增加文件内容对比，引入Etag</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">为了解决文件修改时间只能精确到秒带来的问题，我们给服务器引入 Etag 响应头，a.js 内容变了，Etag 才变。内容不变，Etag 不变，可以理解为 Etag 是文件内容的唯一 ID。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"> 同时引入对应的请求头 If-None-Match，每次浏览器请求服务器的时候，都带上 If-None-Match 字段，该字段的值就是上次请求 a.js 时，服务器返回给浏览器的 Etag。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浏览器请求 a.js。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 服务器返回 a.js，同时告诉浏览器过期绝对时间（Expires）以及相对时间（Cache-Control：max-age=10），以及 a.js 上次修改时间Last-Modified，以及 a.js 的Etag。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 10秒内浏览器再次请求 a.js，不再请求服务器，直接使用本地缓存。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 11秒时，浏览器再次请求 a.js，请求服务器，带上上次修改时间 If-Modified-Since 和上次的 Etag 值 If-None-Match。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 服务器收到浏览器的 If-Modified-Since 和 Etag，发现有 If-None-Match，则比较 If-None-Match 和 a.js 的 Etag 值，忽略 If-Modified-Since 的比较。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> a.js 文件内容没变化，则 Etag 和 If-None-Match 一致，服务器告诉浏览器继续使用本地缓存（304）。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 如此往复。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">结束了吗？</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">到此就结束了吗？ </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">是的，http的缓存机制就是如此了，但是仍然存在一个问题：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">浏览器无法主动得知服务器上的 a.js 资源变化了。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">不管用 Expires 还是 Cache-Control，它们都只能够控制缓存是否过期，但是在缓存过期之前，浏览器是无法得知服务器上的资源是否变化的。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">只有当缓存过期后，浏览器才会发请求询问服务器。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">最终方案</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">大家可以想象我们使用 a.js 的场景，我们一般都是输入网址，访问一个 html 文件，html文件中会引入 js、css 、图片等资源。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以呢，我们在 html 上做些手脚。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">我们不让 html 文件缓存，每次访问 html 都去请求服务器。所以浏览器每次都能拿到最新的 html 资源。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">a.js 内容更新的时候，我们修改一下 html 中 a.js 的版本号。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 第一次访问 html</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;script src=&quot;http://test.com/a.js?version=0.0.1&quot;&gt;&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浏览器下载 0.0.1 版本的 a.js 文件。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浏览器再次访问 html，发现还是 0.0.1 版本的 a.js 文件，则使用本地缓存。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 某一天 a.js 变了，我们的 html 文件也相应变化如下：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;script src=&quot;http://test.com/a.js?version=0.0.2&quot;&gt;&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 浏览器再次访问html，发现【test.com/a.js?versio… a.js</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">】</span><span style="font-size: 12pt;">。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">如此往复。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以，通过设置 html 不缓存，html 引用资源内容变化则改变资源路径的方式，就解决了无法及时得知资源更新的问题。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当然除了以版本号来区分，也可以以 MD5hash 值来区分。</span><span style="font-size: 12pt; color: unset; font-family: unset;"> 如</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;script src=&quot;http://test.com/a.【hash值】.js&quot;&gt;&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">使用 webpack 打包的话，借助插件可以很方便的处理。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP 缓存控制</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [7].png" type="image/png" data-filename="3.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP 缓存</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">分为 2 种，一种是强缓存，另一种是协商缓存。主要作用是可以加快资源获取速度，提升用户体验，减少网络传输，缓解服务端的压力。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [8].png" type="image/png" data-filename="3.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [9].png" type="image/png" data-filename="3.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">强缓存</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">不需要发送请求到服务端，直接读取浏览器本地缓存，在 Chrome 的 Network 中显示的 HTTP 状态码是 200 。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在 Chrome 中，强缓存又分为 Disk Cache (存放在硬盘中) 和 Memory Cache (存放在内存中)，存放的位置是由浏览器控制的。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">是否强缓存由</span> <span style="font-size: 12pt;">Pragma</span><span style="font-size: 12pt;">、Cache-Control 和</span> <span style="font-size: 12pt;">Expires </span><span style="font-size: 12pt;">3 个 Header 属性共同来控制。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">石器时代的缓存方式</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在 http1.0 时代，给客户端设定缓存方式可通过两个字段—— Pragma 和 Expires 来规范。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">虽然这两个字段早可抛弃，但为了做 http 协议的向下兼容，你还是可以看到很多网站依旧会带上这两个字段。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">例如在访问 腾讯课堂 的时候，通过浏览器调试工具可以看到部分 HTTP 响应是包含 Expires 头部的。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">1、Pragma</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Pragma 只有一个属性值，就是 no-cache ，效果和 Cache-Control 中的 no-cache 一致，不使用强缓存，需要与服务器验证缓存是否新鲜，在 3 个头部属性中的优先级最高。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以，当 Pragma 和 Cache-Control 同时存在的时候，Pragma 的优先级高于 Cache-Control。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">该字段值为 no-cache 时，会通知客户端不要对该资源读缓存，即每次都得向服务器发一次请求才行。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">2、Cache-Control</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Cache-Control 是 HTTP/1.1 中新增的属性，在请求头和响应头中都可以使用</span>，常用的属性值如有：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● max-age：单位是秒，缓存时间计算的方式是距离发起的时间的秒数，超过间隔的秒数缓存失效，</span><span style="font-size: 12pt;">86400 秒是一天</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> no-cache：不使用强缓存，需要与服务器验证缓存是否新鲜</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> no-store：禁止使用缓存（包括协商缓存），每次都向服务器请求最新的资源</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> private：专用于个人的缓存，中间代理、CDN 等不能缓存此响应</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">public：响应可以被中间代理、CDN 等缓存</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> must-revalidate：在缓存过期前可以使用，过期后必须向服务器验证</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">3、Expires</span></span></div><div><br/></div><div><span style="font-size: 12pt;">Expires 的值是一个 HTTP 日期，在浏览器发起请求时，会根据系统时间和 Expires 的值进行比较，如果系统时间超过了 Expires 的值，缓存失效。</span></div><div><br/></div><div><span style="font-size: 12pt;">由于和系统时间进行比较，所以当系统时间和服务器时间不一致的时候，会有缓存有效期不准的问题。Expires 的优先级在三个 Header 属性中是最低的。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">本地通过 express 起一个服务来验证强缓存（Cache-Control: max-age 设置缓存超时的秒数），代码如下：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">const express = require('express');</font></div><div><font style="font-size: 12pt;">const app = express();</font></div><div><font style="font-size: 12pt;">var options = {</font></div><div><font style="font-size: 12pt;">  etag: false, // 禁用协商缓存</font></div><div><font style="font-size: 12pt;">  lastModified: false, // 禁用协商缓存</font></div><div><font style="font-size: 12pt;">  setHeaders: (res, path, stat) =&gt; {</font></div><div><font style="font-size: 12pt;">    res.set('Cache-Control', 'max-age=10'); // 强缓存超时时间为10秒</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">};</font></div><div><font style="font-size: 12pt;">app.use(express.static((__dirname + '/public'), options));</font></div><div><font style="font-size: 12pt;">app.listen(3000);</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第一次加载，页面会向服务器请求数据，并在 Response Header 中添加 Cache-Control ，过期时间为 10 秒</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [10].png" type="image/png" data-filename="3.png" width="521"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第二次加载，Date 头属性未更新，可以看到浏览器直接使用了强缓存，实际没有发送请求</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [11].png" type="image/png" data-filename="3.png" width="519"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">协商缓存</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当浏览器的<span style="font-size: 12pt; font-weight: bold;">强缓存失效或</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">请求头中设置了不走强缓存，并且在请求头中设置了 If-Modified-Since 或 If-None-Match 的时候，</span><span style="font-size: 12pt; font-weight: bold;">服务端</span><span style="font-size: 12pt; font-weight: bold;">会将这两个属性值用来验证是否命中协商缓存，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果命中了协商缓存，会返回 304 状态，加载浏览器缓存，并且响应头会设置 Last-Modified 或者 ETag 属性。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">1、ETag/If-None-Match</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">ETag/If-None-Match 的值是一串 hash 码，代表的是一个资源的标识符，当服务端的文件变化的时候，它的 hash码会随之改变。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">通过请求头中的 If-None-Match 和当前文件的 hash 值进行比较，如果相等则表示命中协商缓存。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">ETag 又有强弱校验之分，如果 hash 码是以 &quot;W/&quot; 开头的一串字符串，说明此时协商缓存的校验是弱校验的。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">只有服务器上的文件差异（根据 ETag 计算方式来决定）达到能够触发 hash 值后缀变化的时候，才会真正地请求资源，hash 值不变则返回 304 并加载浏览器缓存。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">2、Last-Modified/If-Modified-Since</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Last-Modified/If-Modified-Since 的值代表的是文件的最后修改时间。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第一次请求的时候，服务端会把资源的最后修改时间放到 Last-Modified 响应头中。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第二次发起请求的时候，请求头会带上上一次响应头中的 Last-Modified 的时间，并放到 If-Modified-Since 请求头属性中。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">服务端根据第一次请求的文件最后一次修改时间和 If-Modified-Since 的值进行比较，如果相等，返回 304 ，并加载浏览器缓存</span>。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">本地通过 express 起一个服务来验证协商缓存（第一次 的 </span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Last-Modified 时间与 第二次的 </span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">If-Modified-Since 时间比较</span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">），代码如下：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">const express = require('express');</font></div><div><font style="font-size: 12pt;">const app = express();</font></div><div><font style="font-size: 12pt;">var options = {</font></div><div><font style="font-size: 12pt;">  etag: true, // 开启协商缓存</font></div><div><font style="font-size: 12pt;">  lastModified: true, // 开启协商缓存</font></div><div><font style="font-size: 12pt;">  setHeaders: (res, path, stat) =&gt; {</font></div><div><font style="font-size: 12pt;">    res.set({</font></div><div><font style="font-size: 12pt;">      'Cache-Control': 'max-age=00', // 浏览器不走强缓存</font></div><div><font style="font-size: 12pt;">      'Pragma': 'no-cache', // 浏览器不走强缓存</font></div><div><font style="font-size: 12pt;">    });</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">};</font></div><div><font style="font-size: 12pt;">app.use(express.static((__dirname + '/public'), options));</font></div><div><font style="font-size: 12pt;">app.listen(3001);</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第一次请求资源：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [12].png" type="image/png" data-filename="3.png" width="548"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第二次请求资源：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [13].png" type="image/png" data-filename="3.png" width="557"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><br/></div><div><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt;"><span style="font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">验证一下 ETag 在强校验的情况下（第一次请求的 ETag 与第二次请求的</span></span> <span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">If-None-Match 值比较</span></span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt;"><span style="font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">），</span></span></div><div><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt;"><br/></span></div><div><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt;"><span style="font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">只增加一行空格，hash 值如何变化，在代码中，我采用的是对文件进行 MD5 加密来计算其 hash 值。</span></span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">注：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">只是为了演示用，实际计算不是通过 MD5 加密的，Apache 默认通过 FileEtag 中 FileEtag INode Mtime Size 的配置自动生成 ETag，</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">用户可以通过自定义的方式来修改文件生成 ETag 的方式。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">为了让 lastModified 不影响缓存，我把Last-Modified/If-Modified-Since 从请求头删除了，代码如下：</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">test.js</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 8px; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">const express = require('express');</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">const CryptoJS = require('crypto-js/crypto-js');</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">const fs = require('fs');</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">const app = express();</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">var options = {</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">  etag: true, // 只通过Etag来判断</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">  lastModified: false, // 关闭另一种协商缓存</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">  setHeaders: (res, path, stat) =&gt; {</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">    const data = fs.readFileSync(path, 'utf-8'); // 读取文件</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">    const hash = CryptoJS.MD5((JSON.stringify(data))); // MD5加密</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">    res.set({</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">      'Cache-Control': 'max-age=00', // 浏览器不走强缓存</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">      'Pragma': 'no-cache', // 浏览器不走强缓存</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">      'ETag': hash, // 手动设置Etag值为MD5加密后的hash值</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">    });</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">  },</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">};</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">app.use(express.static((__dirname + '/public'), options));</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">app.listen(4000); // 使用新端口号，否则上面验证的协商缓存会一直存在</span></div></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第一次和第二次请求如下：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [14].png" type="image/png" data-filename="3.png" width="534"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [15].png" type="image/png" data-filename="3.png" width="535"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">对 test.js 文件增加一个空格后再删除一个空格，保持文件内容不变，但文件的修改时间改变，发起第三次请求。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">由于我生成 ETag 的方式是通过对文件内容进行 MD5 加密生成，所以虽然修改时间变化了，但请求依然返回了 304 ，读取浏览器缓存。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [16].png" type="image/png" data-filename="3.png" width="530"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">ETag/If-None-Match 的出现主要解决了 Last-Modified/If-Modified-Since 所解决不了的问题：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● 如果文件的修改频率在秒级以下，Last-Modified/If-Modified-Since 会错误地返回 304</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 如果文件被修改了，但是内容没有任何变化的时候，Last-Modified/If-Modified-Since 会错误地返回 304 ，上面的例子就说明了这个问题</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTP 缓存的整体流程</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [17].png" type="image/png" data-filename="3.png" width="852"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">避免 304</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">https://hm.baidu.com/hm.js?e23800c454aa573c0ccb16b52665ac26</font></div><div><font style="font-size: 12pt;">http://tb1.bdstatic.com/tb/_/tbean_safe_ajax_94e7ca2.js</font></div><div><font style="font-size: 12pt;">http://img1.gtimg.com/ninja/2/2016/04/ninja145972803357449.jpg</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">做法实际上很简单，它把服务侧 ETag 的那一套理论搬到了前端来使用。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">页面的静态资源以版本形式发布，常用的方法是在文件名或参数带上一串 md5 或时间标记符：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">可以看到上面的例子中有不同的做法，有的在 URI 后面加上了 md5 参数，有的将 md5 值作为文件名的一部分，有的将资源放在特性版本的目录中。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">那么在文件没有变动的时候，浏览器不用发起请求直接可以使用缓存文件；</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">而在文件有变化的时候，由于文件版本号的变更，导致文件名变化，请求的 url 变了，自然文件就更新了。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这样能确保客户端能及时从服务器收取到新修改的文件。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">通过这样的处理，增长了静态资源，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">特别是图片资源的缓存时间，避免该资源很快过期，客户端频繁向服务端发起资源请求，服务器再返回 304 响应的情况（有 Last-Modified/Etag）。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [18].png" type="image/png" data-filename="3.png" width="831"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">总结：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● 需要兼容 HTTP1.0 的时候需要使用 Expires，不然可以考虑直接使用 Cache-Control。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> 需要处理一秒内多次修改的情况，或者其他 Last-Modified 处理不了的情况，才使用 ETag，否则使用 Last-Modified。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">对于所有可缓存资源，需要指定一个 Expires 或 Cache-Control，同时指定 Last-Modified 或者 Etag。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● </span><span style="font-size: 12pt;">可以通过标识文件版本名、加长缓存时间的方式来减少 304 响应。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Cache-Control 首部功能很强大。服务器和客户端都可以用它来说明新鲜度，并且除了使用期或过期时间之外，还有很多指令可用</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Cache-Control 对缓存的控制粒度更细，包括缓存代理服务器的缓存控制</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">no-cache 和 no-store 的区别：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">no-cache 代表不缓存过期的资源，缓存会向源服务器进行有效期确认后再处理资源。no-store 才是真正的不缓存。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">no-cache 并不代表完全的禁用缓存，而是会每次去核对服务端的 Etag，如果相同，那么就不会去服务端下载完整的资源，返回一个 304 Not Modified。（最长缓存 3 年）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">no-store 才是真正的禁用缓存，它表示每次服务端都会去下载最新的资源。（当然，通常似乎都用不上）。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">public 和 private 的区别：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">主要在于如果是有用户认证环节的页面，设置为 private 就只有终端浏览器会缓存，中间 CDN 并不会缓存，而设置为 public，则会在每一个环节缓存。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">默认不需要设置 public，因为 max-age 已经表明可以由各个环节缓存了（单位为秒）。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">此刻如果命中缓存，则不会再去请求服务器核对 Etag，而是直接返回 200(from disk)。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当然，由于 public 会在每一个环节缓存，如果对修改更新预览有强需求的网页，那么最好不要使用这一缓存策略，否则还需要刷新 CDN 源，很麻烦。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/3 [19].png" type="image/png" data-filename="3.png"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">如何挑选缓存策略，可以见下图：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="4 - HTTP_files/3 [20].png" type="image/png" data-filename="3.png"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">什么是实体</span></div><div><br/></div><div><span style="font-size: 12pt;">实体</span><span style="font-size: 12pt;">是请求或响应的有效数据，</span><span style="font-size: 12pt;">在报文主体内部。</span></div><div><br/></div><div><span style="font-size: 12pt;">实体可以有 0 或多个，实体头部</span><span style="font-size: 12pt;">可以有也可以没有</span><span style="font-size: 12pt;">。</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">HTTP/1.1 200 OK</span></div><div><span style="font-size: 12pt;">Content-Type: text/plain</span></div><div><span style="font-size: 12pt;">Content-Length: 5</span></div><div><br/></div><div><span style="font-size: 12pt;">Zhihu</span></div></div><div><br/></div><div><span style="font-size: 12pt;">实体就是“Zhihu”这一部分内容，没有实体头部。</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">POST /upload HTTP/1.1</span></div><div><span style="font-size: 12pt;">Host: example.com</span></div><div><span style="font-size: 12pt;">Content-Length: xxx</span></div><div><span style="font-size: 12pt;">Content-Type: multipart/form-data; boundary=AaBbCcDd</span></div><div><br/></div><div><span style="font-size: 12pt;">--AaBbCcDd</span></div><div><span style="font-size: 12pt;">Content-Disposition: form-data; name=&quot;username&quot;</span></div><div><span style="font-size: 12pt;">RuphiLau</span></div><div><br/></div><div><span style="font-size: 12pt;">--AaBbCcDd</span></div><div><span style="font-size: 12pt;">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;picture.jpg&quot;</span></div><div><span style="font-size: 12pt;">Content-Type: image/jpeg</span></div><div><br/></div><div><span style="font-size: 12pt;">...(picture.jpg的数据)...</span></div><div><span style="font-size: 12pt;">--AaBbCcDd--</span></div></div><div><br/></div><div><span style="font-size: 12pt;">这个报文里有多个实体</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div></div><div><br/></div><div><br/></div><hr style="box-sizing: content-box; -webkit-tap-highlight-color: transparent; height: 0px; overflow: visible; margin: 1px 0px; padding-top: 1px; border-color: rgb(255, 255, 255); border-style: solid none; border-width: thick 0px; background-color: rgb(153, 153, 153); color: rgb(0, 0, 0); font-family: 微软雅黑; font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">TCP/IP 协议</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">Internet 互联网使用的网络协议是 TCP/IP 协议。</span></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">TCP/IP 协议实际上是一系列网络通信协议的统称，其中最核心的两个协议是 TCP 和 IP，其他的还有 UDP、ICMP、ARP 等等，共同构成了一个复杂但有层次的协议栈。</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">协议栈有四层，最上层是“应用层”，最下层是“链接层”，</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">TCP 和 IP 则在中间：TCP 属于“传输层”，IP 属于“网络层”。</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">四层模型：应用层、传输层、网络层、链接层。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt;"><br/></span></div></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">Http 报文是</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">通过传输控制协议（Transmission Control Protocol，TCP）连接从一个地方搬移到另一个地方的。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">HTTP 是个应用层协议。HTTP 无需操心网络通信的具体细节；它把联网的细节都交给了通用、可靠的互联网传输协议 TCP/IP 。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">只要建立了TCP连接，客户端和服务器之间的报文交换就不会丢失、不会被破坏，也不会在接收时出现错序了。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">在 HTTP 客户端向服务器发送报文之前，需要用网际协议（Internet Protocol，IP）地址和端口号在客户端和服务器之间建立一条 TCP/IP 连接。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">建立一条 TCP 连接的过程与给公司办公室的某个人打电话的过程类似。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">首先，要拨打公司的电话号码。这样就能进入正确的机构了。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">其次，拨打要联系的那个人的分机号。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">在 TCP 中，你需要知道服务器的 IP 地址，以及与服务器上运行的特定软件相关的 TCP 端口号。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">这就行了，但最初怎么获得 HTTP 服务器的 IP 地址和端口号呢？当然是通过 URL 了！</span></div><div style="text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: medium; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"><img src="4 - HTTP_files/3 [23].jpg" type="image/jpeg" data-filename="3.jpg" width="609"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">TCP 传输控制协议（Transmission Control  Protocol）</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">TCP协议一种</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">基于 IP 协议的、面向连接的、可靠的、字节流形式的通信，是 HTTP 协议得以实现的基础。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">“可靠”是指保证数据不丢失，“字节流”是指保证数据完</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">整。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">TCP 是全双工模式。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">你和你女朋友聊天是面向连接的，只有连接起来才可以通信的，</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">可靠就是你发送的信息可以保证送达到对方，</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">全双工意思就是你不仅可以给你女朋友发消息，而且她也可以给你发信息。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">1. TCP 和 UDP 的区别是什么</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">简答：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [24].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">UDP（User Data Protocol，用户数据报协议）</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">是与 TCP 相对应的协议。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">它是面向非连接的协议，它不与对方建立连接，而是直接就把数据包发送过去！</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">UDP适用于一次只传送少量数据、对可靠性要求不高的应用环境。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">比如，我们经常使用“ping”命令来测试两台主机之间 TCP/IP 通信是否正常。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">2. TCP 的三次握手指的是什么</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">简答：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">每次建立连接前，客户端和服务端之前都要先进行三次对话才开始正式传输内容，三次对话大概是这样的：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">1. 客户端：我要连接你了，可以吗</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">2. 服务端：嗯，我准备好了，连接我吧</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">3. 客户端：那我连接你咯</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">4. 开始后面步骤</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: medium;"><img src="4 - HTTP_files/3 [21].png" type="image/png" data-filename="3.png"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">SYN：</span></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">同步序列编号（Synchronize Sequence Numbers）。 是 TCP/IP 建立连接时使用的握手信号。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">ACK：</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">确认字符</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">（Acknowledgement）</span><span style="font-size: 12pt;">，</span><span style="font-size: 12pt;">通常是一个 ASCII 字符，</span><span style="font-size: 12pt;">在数据通信中，接收方发给发送方的一种传输类控制字符，表示发来的数据已确认接受无误。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">当发送方接收到 ACK 信号时，就可以发送下一个数据。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">如果发送方没有收到信号，那么发送方可能会重发当前的数据包，也可能停止传送数据。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">三次握手：</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">第一次握手：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">主机 A 向主机 B 发出连接，请求数据包：“我想给你发数据，可以吗？”；</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">第二次握手：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">主机 B 向主机 A 发送同意连接和要求同步（同步就是两台主机一个在发送，一个在接收，协调工作）的数据包：“可以，你什么时候发？”</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">第三次握手：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">主机 A 再发出一个数据包确认主机 B 的要求同步：“我现在就发，你接着吧！” 。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">SYN 包 ——&gt;</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"> &lt;—— SYN + ACK 包</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">ACK 包 ——&gt;</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">具体的 </span><span style="font-size: 12pt; font-weight: bold;">TCP 三次握手</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [25].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">假设 A 为客户端，B 为服务器端。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">● 首先 B 处于 LISTEN（监听）状态，等待客户的连接请求。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> A 向 B 发送连接请求报文，SYN=1，ACK=0，选择一个初始的序号 x 。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> B 收到连接请求报文，如果同意建立连接，则向 A 发送连接确认报文，SYN=1，ACK=1，确认号为 x+1，同时也选择一个初始的序号 y 。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> A 收到 B 的连接确认报文后，还要向 B 发出确认，确认号为 y+1，序号为 x+1 。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> B 收到 A 的确认后，连接建立。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">三次握手的原因</span></font></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">第三次握手是为了防止失效的连接请求到达服务器，让服务器错误打开连接。</span></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">客户端发送的连接请求如果在网络中滞留，那么就会隔很长一段时间才能收到服务器端发回的连接确认。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">客户端等待一个超时重传时间之后，就会重新请求连接。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">但是这个滞留的连接请求最后还是会到达服务器，如果不进行三次握手，那么服务器就会打开两个连接。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">如果有第三次握手，客户端会忽略服务器之后发送的对滞留连接请求的连接确认，不进行第三次握手，因此就不会再次打开连接。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(118, 0, 216); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">三次“握手”的目的是</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(118, 0, 216); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">使数据包的发送和接收同步，</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(118, 0, 216); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">防止已失效的连接请求报文段突然又传送到了服务端，因而产生错误，导致</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">服务器端一直等待而浪费资源</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(118, 0, 216); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(118, 0, 216); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">经过三次“握手”之后，主机 A 才向主机 B 正式发送数据。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">用故事解释三次握手的原因</span></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">A 中午 12 点给 B 第一次发消息：“走，去食堂吃饭”。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">但是消息滞后了 6 个小时（现实情况基本不会发生 ，这里假设发生了这种情况）。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">A 第一次发的消息滞后了，所以 A 没有收到回复就又重新发了一条， 此时 B 收到了第二条消息建立正确连接，两人就一起去吃中饭了。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">然后到了下午，A 中午发的滞后了 6 个小时的第一条消息（相当于已失效的请求报文段）突然传到 B 的手机里（已经是下午6点），</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">如果只进行两次握手的话，B 回复了：“好，那我去老地方等你”。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">这时 A 收到这条消息心想我没有约你吃饭啊，就没有理他。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">B 去食堂等 A 吃晚饭。结果只留 B 在食堂苦等，浪费时间，B 真可怜。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">TCP 的四次挥手</span></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [26].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 12pt;"> A 发送连接释放报文，FIN=1。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 12pt;"> B 收到之后发出确认，此时 TCP 属于半关闭状态，B 能向 A 发送数据但是 A 不能向 B 发送数据。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 12pt;"> 当 B 不再需要连接时，发送连接释放报文，FIN=1。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 12pt;"> A 收到后发出确认，进入 TIME-WAIT 状态，等待 2 MSL（最大报文存活时间）后释放连接。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">●</span><span style="font-size: 12pt;"> B 收到 A 的确认后释放连接。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">四次挥手的原因</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">客户端发送了 FIN 连接释放报文之后，服务器收到了这个报文，就进入了 CLOSE-WAIT 状态。</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">这个状态是为了让服务器端发送还未传送完毕的数据，传送完毕之后，服务器会发送 FIN 连接释放报文。</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">用故事解释</span></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="text-align: justify;"><span style="font-size: 12pt;">你要给一个女孩子微信发消息，我们分手吧，此时女孩子收到消息，非常伤心，就屏蔽了你</span><span style="font-size: 12pt;">，此时是第一次分手过程</span><span style="font-size: 12pt;">。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">但是，此时你还没有屏蔽她，她完全可以给你继续发消息，她给你发消息说，好吧，此时你收到了确认消息，此时是第二次分手过程。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">那么女孩又给你发送消息，渣男，永远不要来找我，</span><span style="font-size: 12pt;">此时是第三次分手过程</span><span style="font-size: 12pt;">。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">此时你又接收到消息，看到消息之后发了一个拜拜，然后你就直接屏蔽拉黑了对方，此时女孩微信显示你删除了对方，然后就把你也拉黑删除了，</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">此时是第四次分手过程</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><div><span style="font-size: 12pt;">那么四次分手到此为止，恭喜你，成功获得下一个女孩子。</span></div><div><span style="font-size: 12pt;"><br/></span></div></div><div style="text-align: justify;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">男：我们分手吧！</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">       对方已经屏蔽了你！</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">       好吧                  ：女</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">       渣男！永远不要来找我 ！ ：女</font></div><div><font style="font-size: 12pt;">      </font></div><div><font style="font-size: 12pt;">男：拜拜</font></div><div><font style="font-size: 12pt;">   </font></div><div><font style="font-size: 12pt;">       你拉黑并删除了对方！</font></div><div><br/></div><div>     <font style="font-size: 12pt;">   对方拉黑并删除了你！</font></div></div></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">上述过程就阐述了为什么要进行 TCP 四次分手：</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">为了能够让服务器屏蔽客户端直至最后双方互相删除掉，然后客户端又可以和另一个服务器三次握手了。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">为什么建立连接是三次握手，而关闭连接却是四次挥手呢？</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">因为 TCP 是全双工模式，</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">客户端请求关闭连接后，客户端向服务端的连接关闭（一二次挥手），</span></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">服务端继续传输之前没传完的数据给客户端（数据传输），</span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-family: unset; font-weight: bold;">服</span></span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-family: unset; font-weight: bold;">务端向客户端的连接关闭（三四次挥手）。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><b style="font-size: 12pt;"><br/></b></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-family: unset; font-weight: bold;">所以 TCP 释放连接时服务器的 ACK 和 FIN 是分开发送的（中间隔着数据传输），而 TCP 建立连接时服务器的 ACK 和 SYN 是一起发送的（第二次握手），</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><b style="font-size: 12pt;"><br/></b></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-family: unset; font-weight: bold;">所以 TCP 建立连接需要三次，而释放连接则需要四次。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="text-align: justify;"><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">为什么 TCP 连接时可以 ACK 和 SYN 一起发送，而释放时则 ACK 和 FIN 分开发送呢？（ACK 和 FIN 分开是指第二次和第三次挥手）</span></font></div><div style="text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">因为客户端请求释放时，服务器可能还有数据需要传输给客户端，</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">因此服务端要先响应客户端 FIN 请求（服务端发送 ACK），然后数据传输，</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">传输完成后，服务端再提出 FIN 请求（服务端发送 FIN）；</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">而连接时则没有中间的数据传输，因此连接时可以 ACK 和 SYN 一起发送。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">如果双方建立连接，一方出问题怎么办？</span></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">如果双方建立连接，一方出问题怎么办？为了防止出现上述恋爱故事中千年等一回的情况，已经建立连接，但是服务端一直等待接收，发送端出现问题一直不能发送。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">所以设计一个保活的计时器，如果一方出现问题，另一方过了这个计时器的时间，就发送试探报文，以后每隔 75 秒发送一次。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;">若一连发送10个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"></div><hr/><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">IP 网络协议（Internet Protocol）</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">IP 协议使用“IP 地址”的概念来定位互联网上的每一台计算机，</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">主要解决寻址和路由问题。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">通俗上理解，IP 分为「内网 IP」 和「外网 IP」</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">你买了个路由器，又从电信买来带宽和DNS服务，</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">路由器连上电信的服务器，那么路由器就会有一个「外网 IP」，</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> 比如「14.17.32.211」就是一个外网 IP</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">这是你在互联网中的地</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">址</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">重启路由器，你很有「可能」被重新分配一个「外网 IP」，也就是说 你的路由器没有「固定的外网 IP」</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">你可以花每年几千块钱租用一个「固定的外网 IP」，但是显然不会这么浪费钱。像腾讯、阿里这样的大公司就租用了很多外网 IP</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">假设你的路由器的外网 IP 是</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">「14.17.32.211」</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">，那么你的手机和电脑的 IP 就是「内网 IP」</span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> 一般路由器会给自己分配一个好记的</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">「内网 IP」</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">，如 192.168.1.1</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">路由器会在你家创建一个内网，内网中的设备使用</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">「内网 IP」</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">，一般来说这个 IP  的格式都是 192.168.xxx.xxx</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt; box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">内网中的设备可以互相访问（比如你可以用电脑或手机进入</span> <a href="http://192.168.1.1/" style="font-size: 12pt; font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">http://192.168.1.1</a> <span style="font-size: 12pt; box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">来查看你的路由器），但是不能直接访问外网，内网设备想要访问外网，必须经过路由器中转</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="font-size: 12pt; box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">外网中的设备可以互相访问（比如</span> <a href="http://qq.com/" style="font-size: 12pt; font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">qq.com</a> <span style="font-size: 12pt; box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">可以把首页发送给你的路由器，你的路由器有外网 IP），但是无法访问内网，外</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">网设备想要访问内网，也必须经过路由器中转</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">路由器既有外网 IP 也有内网 IP，所以路由器有时候也被叫做「网关」</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">两个特别特殊的 IP</span></div></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">本地 IP：127.0.0.1，本地 IP 永远表示设备自己。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">一个特别特殊的 IP：0.0.0.0，不表示任何设备。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">IP 协议大多数是 v4 版</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">ipv4，地址是四个用“.”分隔的数字，总数有2^32个，大约42亿个可以分配的地址</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="text-align: justify;"><span style="font-size: medium;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">ipv6，地址是八个用“:”分隔的数字，总数有2^128个。</span></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"></div><hr/><div style="text-align: justify;"><span style="font-size: 14pt; box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 14pt; box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">一次完整的 HTTP 请求所经历的步骤：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">即在浏览器中输入 URL 地址 &gt;&gt; 显示主页的过程。</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">总体来说分为以下几个过程：</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">1. DNS 解析：</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">将域名解析成 IP 地址</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">2. 建立TCP 连接：</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">TCP 三次握手</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">3. 浏览器发送 HTTP 请求行和请求头</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">4. 服务器返回 状态行和响应头</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">5. 服务器返回 响应体</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">6. 浏览器</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">通过 content-type </span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">解析渲染页面</span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: justify;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="text-align: justify;"><span style="font-size: medium;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">7.</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> </span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">断开</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">TCP连接：</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">TCP 四次挥手</span></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><hr/><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">网络基础</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">网络七层协议（</span><span style="font-size: 12pt;">OSI</span><span style="font-size: 12pt;">）</span><span style="font-size: 12pt;">是一个开放性的通信系统互连参考模型，</span><span style="font-size: 12pt;">是一个定义得非常好的协议规范。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;">OSI 是一个理论模型，实际应用千变万化，更多时候只是作为分析、评判网络技术的依据。</span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [27].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><br/></span></div><div style="text-align: justify;"><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [22].png" type="image/png" data-filename="3.png"/></span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><img src="4 - HTTP_files/3 [23].png" type="image/png" data-filename="3.png"/></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● 物理层：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">主要定义物理设备标准，如网线的接口类型、光纤的接口类型、各种传输介质的传输速率等。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">它的主要作用是传输比特流(就是由 1、0 转化为电流强弱来进行传输,到达目的地后在转化为 1、0，也就是我们常说的数模转换与模数转换，</span><span style="font-size: 12pt;">将二进制的0和1和电压高低，光的闪灭和电波的强弱信号进行转换</span><span style="font-size: 12pt;">)。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">这一层的数据叫做比特。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">数据链路层：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">定义了如何让格式化数据以进行传输，以及如何让控制对物理介质的访问。这一层通常还提供错误检测和纠正，以确保数据的可靠传输。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">网络层：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">在位于不同地理位置的网络中的两个主机系统之间提供连接和路径选择。Internet 的发展使得从世界各站点访问信息的用户数大大增加，而网络层正是管理这种连接的层。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">传输层：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">定义了一些传输数据的协议和端口号(WWW 端口 80 等)，</span><span style="font-size: 12pt; color: unset; font-family: unset;">如：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">TCP(传输控制协议，传输效率低，可靠性强，用于传输可靠性要求高，数据量大的数据)，</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">UDP(用户数据报协议，与 TCP 特性恰恰相反，用于传输可靠性要求不高，数据量小的数据，如 QQ 聊天数据就是通过这种方式传输的)。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">主要是将从下层接收的数据进行分段和传输，到达目的地址后再进行重组。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">常常把这一层数据叫做段。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">会话层：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">通过传输层(端口号：传输端口与接收端口)建立数据传输的通路。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">主要在你的系统之间发起会话或者接受会话请求(设备之间需要互相认识可以是 IP 也可以是 MAC 或者是主机名)</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">表示层：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">可确保一个系统的应用层所发送的信息可以被另一个系统的应用层读取。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">例如，PC 程序与另一台计算机进行通信，其中一台计算机使用扩展二一十进制交换码(EBCDIC)，而另一台则使用美国信息交换标准码(ASCII)来表示相同的字符。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">如有必要，表示层会通过使用一种通格式来实现多种数据格式之间的转换。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt; font-weight: bold;">● </span><span style="font-size: 12pt; font-weight: bold;">应用层：</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">是最靠近用户的 OSI 层。</span></div><div style="text-align: justify;"><br/></div><div style="text-align: justify;"><span style="font-size: 12pt;">这一层为用户的应用程序(例如电子邮件、文件传输和终端仿真)提供网络服务。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Web 服务器</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">硬件含义就是物理形式或“云”形式的机器</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">，在大多数情况下它可能不是一台服务器，而是利用反向代理、负载均衡等技术组成的庞大集群。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">但从外界看来，它仍然表现为一台机</span><span style="font-size: 12pt; color: unset; font-family: unset;">器，但这个形象是“虚拟的”。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">软件含义</span></span><b style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold; color: rgb(255, 0, 0);">是提供 Web 服务的应用程序，通常会运行在硬件含义的服务器上。</span></b></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">它利用强大的硬件能力响应海量的客户端 HTTP 请求，处理磁盘上的网页、图片等静态文件，或者把请求转发给后面的 Tomcat、Node.js 等业务应用，返回动态的信息。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">专门提供 http 服务的 </span></span><span style="font-size: 12pt; font-weight: bold;">Web 服务器有哪些？</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Apache 是25年老牌的服务器（</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">到2019年</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">），</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">功能完善，相关资料很多，学习门槛低，是许多创业者建站的入门产品。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Nginx 是 Web 服务器里的后起之秀，特点是高性能、高稳定，且易于扩展。自 2004 年推出后就不断蚕食 Apache 的市场份额，在高流量的网站里是不二之选。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Windows 上的 IIS、Java 的 Jetty/Tomcat 等，因为性能不是很高，所以在互联网上应用得较少。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">1. 浏览器是 HTTP 协议里的请求方，即 User Agent；</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">2. 服务器是 HTTP 协议里的应答方，常用的有 Apache 和 Nginx；</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">CDN</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">CDN，全称“Content Delivery Network”，翻译是“内容分发网络”，主要起缓存加速作用。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">浏览器通常不会直接连到服务器，中间会经过“重重关卡”，其中的一个重要角色就是 CDN。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">它应用了 HTTP 协议里的缓存和代理技术，代替源站响应客户端的请求。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">简单来说就是，缓存源站的数据，让浏览器的请求不用“千里迢迢”地到达源站服务器，直接在“半路”就可以获取响应。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">如果 CDN 的调度算法很优秀，更是可以找到离用户最近的节点，大幅度缩短响应时间。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">CDN 也是现在互联网中的一项重要基础设施，除了基本的网络加速外，还提供负载均衡、安全防护、边缘计算、跨运营商网络等功能，能够成倍地“放大”源站服务器的服务能力</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">代理</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">代理（Proxy）是 HTTP 协议中请求方和应答方中间的一个环节，作为“中转站”，既可以转发客户端的请求，也可以转发服务器的响应。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">代理有很多的种类，常见的有：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">  1. 匿名代理：完全“隐匿”了被代理的机器，外界看到的只是代理服务器；</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">  2. 透明代理：顾名思义，它在传输过程中是“透明开放”的，外界既知道代理，也知道客户端；</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">  3. 正向代理：靠近客户端，代表客户端向服务器发送请求；</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">  4. 反向代理：靠近服务器端，代表服务器响应客户端的请求；</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">CDN，实际上就是一种代理，通常扮演着透明代理和反向代理的角色。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">代理还可以做：负载均衡、内容缓存、安全防护、数据处理</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">爬虫</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">是一种可以自动访问 Web 资源的应用程序。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">HTTP 协议并没有规定用户代理后面必须是“真正的人类”，它也完全可以是“机器人”，这些“机器人”的正式名称就叫做“爬虫”（Crawler）.</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">爬虫</span><span style="font-size: 12pt;">绝大多数是由各大搜索引擎“放”出来的，抓取网页存入庞大的数据库，再建立关键字索引，这样我们才能够在搜索引擎中快速地搜索到互联网角落里的页面。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">它们就像是一只只不知疲倦的、辛勤的蚂蚁，在无边无际的网络上爬来爬去，不停地在网站间奔走，搜集抓取各种信息。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">爬虫也有不好的一面，它会过度消耗网络资源，占用服务器和带宽，影响网站对真实数据的分析，甚至导致敏感信息泄漏。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">所以，出现了“反爬虫”技术，通过各种手段来限制爬虫。其中一项就是“君子协定”robots.txt，约定哪些该爬，哪些不该爬。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">浏览某些网站时遇到过要求“验证你不是机器人”的页面，这其实也是一种“反爬虫”手段。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Web Service</span></div><div><br/></div><div><span style="font-size: 12pt;">是一个基于 Web（HTTP）的服务架构技术，既可以运行在内网，也可以在适当保护后运行在外网。</span></div><div><br/></div><div><span style="font-size: 12pt;">由 W3C 定义的应用服务开发规范，使用 client-server 主从架构，通常使用 WSDL 定义服务接口，使用 HTTP 协议传输 XML 或 SOAP 消息。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">WAF</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">WAF是“网络应用防火墙”。与硬件“防火墙”类似，它是应用层面的“防火墙”，专门检测 HTTP 流量，是防护 Web 应用的安全技术。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">通常位于 Web 服务器之前，可以阻止如 SQL 注入、跨站脚本等攻击。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">目前应用较多的一个开源项目是 ModSecurity，它能够完全集成进 Apache 或 Nginx。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Web Service 是网络服务实体，而 Web Server 是网络服务器，后者的存在是为了承载前者。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HTTPS</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">HTTPS 相当于“HTTP+SSL/TLS+TCP/IP”，</span><span style="font-size: 12pt;">也就是运行在 SSL/TLS 协议上的 HTTP。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">SSL/TLS是一个负责加密通信的安全协议，建立在 TCP/IP 之上</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">SSL/TLS，可直接简称为 SSL。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">SSL 使用了许多密码学最先进的研究成果，综合了对称加密、非对称加密、摘要算法、数字签名、数字证书等技术。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">SSL </span><span style="font-size: 12pt;">能够在不安全的环境中为通信的双方创建出一个秘密的、安全的传输通道，为 HTTP 套上一副坚固的盔甲。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [24].png" type="image/png" data-filename="3.png" width="851"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">RFC2616 状态码</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="4 - HTTP_files/3 [25].png" type="image/png" data-filename="3.png"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div></div><hr/><div><br/></div></div><hr/><div><br/></div></div><hr/><div><br/></div></div><hr/><div><br/></div></div><hr/><div><br/></div></div><hr/><div><br/></div></div><hr/><div><br/></div></div><div><br/></div></span>
</div></body></html> 