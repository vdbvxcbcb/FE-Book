<html>
<head>
  <title>7 - 性能优化</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/606060 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1025"/>
<h1>7 - 性能优化</h1>

<div>
<span><div><div><div><span style="font-size: 12pt; font-weight: bold;">waterfall 瀑布图</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">打开工具 Network 选项卡的齿轮设置（勾选除了  Group by frame 的所有选项）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">右键刷新按钮 清空缓存重新加载</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: unset; font-family: unset; font-weight: bold;">指标只能尽量做好，不可能什么网页都能做到极致（永远在优化的路上）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">横向看资源加载过程（色块）：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">SSL 安全验证、SSL协商过程 </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Wating（</span><span style="font-size: 12pt;">TTFB</span><span style="font-size: 12pt;">） 请求发出到响应回来时间：</span><span style="font-size: 12pt; color: unset; font-family: unset;">后台处理能力、</span><span style="font-size: 12pt; color: unset; font-family: unset;">网络延迟</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">竖向看</span><span style="font-size: 12pt; color: unset; font-family: unset; font-weight: bold;">资源的联系：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">（</span><span style="font-size: 12pt; color: unset; font-family: unset;">色块</span><span style="font-size: 12pt; color: unset; font-family: unset;">）串行加载 阻塞，尽量并行</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">两根线：</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">蓝线——Dom加载时间与红线——所有资源加载时间</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">保存 HAR （保存性能测试结果的标准格式） </span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">LightHouse</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">需要翻墙，使用扩展</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">First Contentful Paint 首个有意义的内容出现</span><span style="font-size: 12pt;">（渲染）</span><span style="font-size: 12pt;">时间（白屏时间）  时间长做压缩</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Speed Index 速度指数，以 4S 为标准</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Largest Contentful Paint  最大可见资源绘制时间</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Time to interactive          用户可交互所需时间</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">交互体验</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">1、交互动作反馈时间，比如点击一级菜单显示二级菜单、搜索结果显示</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">2、画面帧率：一秒 60 帧是流畅的标准，一帧 16 ms</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">ctrl+shift+p，</span><span style="font-size: 12pt; color: unset; font-family: unset;">输入 frame</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">show frame per second 即可查看</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">3、异步请求完成要在一秒钟内</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">RAIL 测量模型（Google 的量化指标）</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">1、Response 网站给用户响应的速度    处理事件应在 50 ms 以内完成</span><span style="font-size: 12pt;">（</span><span style="font-size: 12pt;">除去</span><span style="font-size: 12pt;">浏览器处理时间）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">2、Animation 动画流畅度                    每 10 ms 产生一帧（除去浏览器绘制时间）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">3、Idle 浏览器</span><span style="font-size: 12pt;">（主线程）</span><span style="font-size: 12pt;">空闲时间       尽可能增加空闲时间</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">     在 Performance 选项卡下方说明，点击录制按钮之后可以查看 Main 主线程</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">4、Load 加载时间                                 在 5 s 内完成内容加载并可以交互（要求很高） </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">性能测量工具</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Chrome DevTools 开发调试、性能评测</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Lighthouse      网站整体质量评估（提供好建议）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">WebPageTest  可以在不同地点</span><span style="font-size: 12pt;">测试</span><span style="font-size: 12pt;">、全面性报告</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><br/></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-weight: bold; font-size: 12pt;">WebPageTest </span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">First View 首次访问</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Repeat View 二次访问（缓存）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3.jpg" type="image/jpeg" data-filename="3.jpg" width="592"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-weight: bold; font-size: 12pt;">本地部署 WebPageTest </span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">Docker 官网下载安装包</span><span style="font-size: 12pt; color: unset; font-family: unset;">安装 </span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">打开终端</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">拉取镜像 </span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">docker pull webpagetest/server </span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">docker pull webpagetest/agent</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">拉取实例</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">下面代码中，第二行与WARNING是返回结果：</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [1].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">windows 用户就搞定了，可以在浏览器</span><span style="font-size: 12pt;">打开</span> <span style="font-size: 12pt;">localhost:4000，像在网站上一样使用</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 14pt;"><br/></span></div><hr/><div><font style="font-size: 14pt;"><span style="font-size: 14pt;"><br/></span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">npm 安装 lighthouse </span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm i -g lighthouse</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">lighthouse http://www.bilibili.com</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">默认测试的是移动端</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">最后生成测试报告（html 文件）保存在本地</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">ctrl + shift + p , 输入 block </span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">添加规则、比如 log* ，</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">让名称与 log 有关的 js 文件都不能加载（衡量是否在首页必须加载），</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">filter 可以过滤查看 log 有关的 js 有没有被加载</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Disable cache </span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">开发时关闭，查看性能时打开、测试二次访问缓存是否生效</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Online 下拉框调整网络吞吐</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">可以点击 Add ，自定义网络吞吐情况</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">设置配置名、</span><span style="font-size: 12pt; color: unset; font-family: unset;">下载速度上限、上传速度上限、延迟情况</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Network 选项卡之后点击 ESC 之后打开其它功能菜单</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Request Blocking </span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">不加载某些资源是否带来性能提升或异常</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Rendering 下</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">勾选 FPS meter       查看帧率</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">勾选 Paint flashing 查看重绘情况</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Performance monitior</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">查看 CPU 使用情况</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">JS 堆栈</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">DOM 节点数</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">布局</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">样式重新计算</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 14pt;"><br/></span></div><hr/><div><font style="font-size: 14pt;"><span style="font-size: 14pt;"><br/></span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">性能测量 API</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [2].jpg" type="image/jpeg" data-filename="3.jpg" width="515"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">计算可交互时间</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [3].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">DNS 解析耗时: domainLookupEnd - domainLookupStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">TCP 连接耗时: connectEnd - connectStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">SSL 安全连接耗时: connectEnd - secureConnectionStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">网络请求耗时 (TTFB): responseStart - requestStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">数据传输耗时: responseEnd - responseStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">DOM 解析耗时: domInteractive - responseEnd</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">资源加载耗时: loadEventStart - domContentLoadedEventEnd</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">First Byte时间: responseStart - domainLookupStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">白屏时间: responseEnd - fetchStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">首次可交互时间: domInteractive - fetchStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">DOM Ready 时间: domContentLoadEventEnd - fetchStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">页面完全加载时间: loadEventStart - fetchStart</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">http 头部大小： transferSize - encodedBodySize</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">重定向次数：performance.navigation.redirectCount</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">重定向耗时: redirectEnd - redirectStart</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">监听耗时的长任务</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [4].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [5].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">判断用户是否离开当前标签页（离开则在当前标签页控制台打印 hidden，否则打印 visibile）</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [6].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [7].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [8].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">判断用户网络状态是否改变（比如 4G 调整到 3G）</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [9].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [10].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><br/></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">浏览器关键渲染路径</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Performance 选项卡 点击刷新按钮  测试页面加载性能 </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Main 主线程可以查看浏览器做的任务</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">交互 ——&gt; 样式计算 ——&gt; 布局计算（位置和大小） ——&gt; 绘制 ——&gt; 合成</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">查看重排</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Timings 查看关键时间节点，比如 L 表示 onLoad 事件</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Main     放大查看关键节点的任务，过长的任务会用红色标记，Layout 就是重排 </span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">做动画时可以使用 Fast Dom 批量对 DOM 进行读写操作</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">修改前：</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [11].jpg" type="image/jpeg" data-filename="3.jpg" width="674"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [12].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">修改后：</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [13].jpg" type="image/jpeg" data-filename="3.jpg" width="660"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">查看复合线程（合成）</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Performance 选项卡 点击 Frames 的色块，然后勾选 Layers 可以查看图层</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Performance 选项卡 点击录制按钮 暂停即可查看交互性能，</span><span style="font-size: 12pt;">查看任务</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">查看重绘</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">ctrl + shift + p 输入 rendering 打开 Rendering 选项卡，勾选 Paint flashing 后，点击页面，如果发生重绘，重绘元素将被浅绿色覆盖并且闪动</span></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">rAF 配合防抖实现动画</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="7 - 性能优化_files/3 [14].jpg" type="image/jpeg" data-filename="3.jpg" width="602"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">修改前</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="7 - 性能优化_files/3 [15].jpg" type="image/jpeg" data-filename="3.jpg"/></span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">修改后</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="7 - 性能优化_files/3 [16].jpg" type="image/jpeg" data-filename="3.jpg"/></span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><b><br/></b></span></div><hr/><div><b style="font-size: 12pt; color: unset; font-family: unset;"><br/></b></div><div><b style="font-size: 12pt; color: unset; font-family: unset;">React 时间调度实现</b><br/></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [17].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">requestIdleCallback() 发生在页面绘制之后，如果还有空闲时间则完成某些任务，</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">但是 JS 主线程应该留出更多时间跟用户交互（至少 50 ms）</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7 - 性能优化_files/3 [18].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div></div><hr/><div><br/></div></div></span>
</div></body></html> 