<html>
<head>
  <title>10- 购物街</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/606060 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3639"/>
<h1>10- 购物街</h1>

<div>
<span><div><div><span style="font-size: 12pt; font-weight: bold;">Github方式创建项目：</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">cd 项目目录</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">vue create HYMall-master</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><img src="10- 购物街_files/3.jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><img src="10- 购物街_files/3 [1].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><img src="10- 购物街_files/3 [2].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">第一种连接远程仓库方式：</span></div><div><br/></div><div><span style="font-size: 12pt;">新建一个空文件夹 supermall1 放置 vue-cli3 创建的项目（因为仓库名不能与 </span><span style="font-size: 12pt;">vue-cli 创建的项目文件夹</span><span style="font-size: 12pt;">同名）后git clone</span></div><div><br/></div><div><img src="10- 购物街_files/3 [3].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><img src="10- 购物街_files/3 [4].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><span style="font-size: 12pt;">拷贝 vue-cli3 项目文件夹（supermall1）的文件到克隆的仓库项目（supermall）上（.git 和 node_modules 文件夹不需要拷贝 ）</span></div><div><br/></div><div><img src="10- 购物街_files/3 [5].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">cd 到仓库项目目录</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">git status // 红色表示未提交</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">git add .</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">git commit -m 'project initialized'</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">git push</span></div></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">第二种连接</span><span style="font-size: 12pt; font-weight: bold;">远程仓库方式：</span></div><div><br/></div><div><span style="font-size: 12pt;">不需要 git clone</span></div><div><br/></div><div><span style="font-size: 12pt;">确保你的 GitHub 仓库是空的（没有README.md）</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">cd  到 vue-cli3 项目目录</span></div><div><br/></div><div><span style="font-size: 12pt;">git init .</span></div><div><br/></div><div><span style="font-size: 12pt;">git config --global user.name &lt;yourGitHubAccount&gt;</span></div><div><br/></div><div><span style="font-size: 12pt;">git config --global user.email &lt;yourGitHubEmailAccount&gt;</span></div><div><br/></div><div><span style="font-size: 12pt;">git add .</span></div><div><br/></div><div><span style="font-size: 12pt;">git status</span></div><div><br/></div><div><span style="font-size: 12pt;"># edit .gitignore to ignore folder you don't want</span></div><div><br/></div><div><span style="font-size: 12pt;">git commit -m &quot;first commit&quot;</span></div><div><br/></div><div><span style="font-size: 12pt;">git remote add origin <a href="https://github.com/">https://github.com/</a>&lt;yourGitHubAccount&gt;/&lt;yourRepo.git&gt;</span></div><div><br/></div><div><span style="font-size: 12pt;">git push -u origin master</span></div></div><div><br/></div><div><img src="10- 购物街_files/3 [6].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><a href="https://jingyan.baidu.com/article/f3e34a12a25bc8f5ea65354a.html" style="font-size: 12pt;">解决：如果有</a><a href="https://jingyan.baidu.com/article/f3e34a12a25bc8f5ea65354a.html" style="font-size: 12pt;">README.md</a></div><div><br/></div><div><span style="font-size: 12pt;">之后每次更新项目，可以通过下面代码来上传：</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">git add .</span></div><div><br/></div><div><span style="font-size: 12pt;">git commit -m &quot;update&quot;</span></div><div><br/></div><div><span style="font-size: 12pt;">git push -u origin master</span></div></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">cd Desktop/HYMall-master</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">npm install //（看情况）</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">npm run serve</font></div></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><hr/><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">划分目录结构</span></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;">打开 vue-cli3 创建的项目，删掉 APP相关的子组件和样式</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [7].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;">划分目录结构主要针对 src 文件夹（默认有 assets 和 components）</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;">assets 放置</span></span><span style="font-size: 12pt;">公共的 </span><span style="font-size: 12pt;">css 资源 和 </span><span style="font-size: 12pt;">图片资源</span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [8].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;">views 放置页面视图组件</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [9].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;">components 放置公共组件</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;">components/</span><span style="font-size: 12pt;"><span style="font-size: 12pt;">common 放置与本项目无关的公共组件（</span></span><span style="font-size: 12pt;">每个页面（每个项目）都可以使用，</span><span style="font-size: 12pt;">下一个项目仍然可以使用）</span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;">components/</span><span style="font-size: 12pt;"><span style="font-size: 12pt;">content </span></span> <span style="font-size: 12pt;">放置</span><span style="font-size: 12pt;"><span style="font-size: 12pt;">与当前项目业务相关的公共组件（只针对当前项目）</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [10].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;">router 放置 Vue-router 路由相关</span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [11].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;">store 放置 Vuex 公共状态管理</span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [12].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;">network 放置网络请求相关</span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [13].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;">common 放置</span><span style="font-size: 12pt;">公共的 JS 文件，比如公共常量、工具函数util.js、混入mixin.js</span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [14].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><hr/><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">css文件的引入</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">引入初始化CSS</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [15].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">定义并使用CSS变量</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [16].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">base.css</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">-- 表示 CSS 变量，使得原生 CSS 能像预处理工具一样使用</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">@import &quot;./normalize.css&quot;;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">:root {</font></div><div><font style="font-size: 12pt;">  --color-text: #666;</font></div><div><font style="font-size: 12pt;">  --color-high-text: #ff5777;</font></div><div><font style="font-size: 12pt;">  --color-tint: #ff8198;</font></div><div><font style="font-size: 12pt;">  --color-background: #fff;</font></div><div><font style="font-size: 12pt;">  --font-size: 14px;</font></div><div><font style="font-size: 12pt;">  --line-height: 1.5;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">*,</font></div><div><font style="font-size: 12pt;">*::before,</font></div><div><font style="font-size: 12pt;">*::after {</font></div><div><font style="font-size: 12pt;">  margin: 0;</font></div><div><font style="font-size: 12pt;">  padding: 0;</font></div><div><font style="font-size: 12pt;">  box-sizing: border-box;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">body {</font></div><div><font style="font-size: 12pt;">  font-family: &quot;Helvetica Neue&quot;,Helvetica,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;微软雅黑&quot;,Arial,sans-serif;</font></div><div><font style="font-size: 12pt;">  user-select: none; /* 禁止用户鼠标在页面上选中文字/图片等 */</font></div><div><font style="font-size: 12pt;">  -webkit-tap-highlight-color: transparent; /* webkit是苹果浏览器引擎，tap点击，highlight背景高亮，color颜色，颜色用数值调节 */</font></div><div><font style="font-size: 12pt;">  background: var(--color-background);</font></div><div><font style="font-size: 12pt;">  color: var(--color-text);</font></div><div><font style="font-size: 12pt;">  width: 100vw;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">a {</font></div><div><font style="font-size: 12pt;">  color: var(--color-text);</font></div><div><font style="font-size: 12pt;">  text-decoration: none;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.clear-fix::after {</font></div><div><font style="font-size: 12pt;">  clear: both;</font></div><div><font style="font-size: 12pt;">  content: '';</font></div><div><font style="font-size: 12pt;">  display: block;</font></div><div><font style="font-size: 12pt;">  width: 0;</font></div><div><font style="font-size: 12pt;">  height: 0;</font></div><div><font style="font-size: 12pt;">  visibility: hidden;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.clear-fix {</font></div><div><font style="font-size: 12pt;">  zoom: 1;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.arrow-right {</font></div><div><font style="font-size: 12pt;">  border-top: 1px solid #999;</font></div><div><font style="font-size: 12pt;">  border-left: 1px solid #999;</font></div><div><font style="font-size: 12pt;">  width: 9px;</font></div><div><font style="font-size: 12pt;">  height: 9px;</font></div><div><font style="font-size: 12pt;">  background-color: transparent;</font></div><div><font style="font-size: 12pt;">  transform: rotate(135deg);</font></div><div><font style="font-size: 12pt;">  display: inline-block;</font></div><div><font style="font-size: 12pt;">  margin-left: .1rem;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.left {</font></div><div><font style="font-size: 12pt;">  float: left;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.right {</font></div><div><font style="font-size: 12pt;">  float: right;</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">引入 base.css</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [17].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">vue.config.js </span></span> <span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">和 .editorconfig</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">对路径起别名和统一代码风格</span></div><div><font color="#FF0000" style="font-size: 12pt;"><br/></font></div><div><font color="#FF0000" style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">注意： vue.config.js 文件必须放到项目（这里是mall）目录下，而不是 src 目录下！</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [18].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">内部已经默认配置一个别名 @ 代表 src，所以</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">module.export = {</font></div><div><font style="font-size: 12pt;">  configureWebpack: {</font></div><div><font style="font-size: 12pt;">    resolve: {</font></div><div><font style="font-size: 12pt;">      alias: {</font></div><div><font style="font-size: 12pt;">        &quot;assets&quot;: &quot;@/assets&quot;,</font></div><div><font style="font-size: 12pt;">        &quot;components&quot;: &quot;@/components&quot;,</font></div><div><font style="font-size: 12pt;">        &quot;common&quot;: &quot;@/components/common&quot;,</font></div><div><font style="font-size: 12pt;">        &quot;content&quot;: &quot;@/components/content&quot;,</font></div><div><font style="font-size: 12pt;">        &quot;network&quot;: &quot;@/network&quot;,</font></div><div><font style="font-size: 12pt;">        &quot;view&quot;: &quot;@/view&quot;</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">router 一般不配，因为一般只在 main.js 中引用一次（store 同理）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">而且可以通过 this.$router 和 this.$store 获取它们</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">遇到的坑：</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">配置被忽略，以为是 </span><span style="font-size: 12pt; font-weight: bold;">vue-cli 4.3.1 的 bug 导致不生效，其实是自己把 vue.config.js 放到 src 目录下，而不是项目目录下，而且 VSCode 没有安装 ES6 代码提示导致拼写错误</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">vue.config.js</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">const path = require(&quot;path&quot;)</span></div><div><br/></div><div><span style="font-size: 12pt;">function resolve(dir) {</span></div><div><span style="font-size: 12pt;">  return path.join(__dirname, dir)</span></div><div><span style="font-size: 12pt;">}</span></div><div><br/></div><div><span style="font-size: 12pt;">module.exports = {</span></div><div><span style="font-size: 12pt;">  chainWebpack: config =&gt; {</span></div><div><span style="font-size: 12pt;">    config.resolve.alias</span></div><div><span style="font-size: 12pt;">      .set(&quot;assets&quot;, resolve(&quot;src/assets&quot;))</span></div><div><span style="font-size: 12pt;">      .set(&quot;components&quot;, resolve(&quot;src/components&quot;))</span></div><div><span style="font-size: 12pt;">      .set(&quot;common&quot;, resolve(&quot;src/components/common&quot;))</span></div><div><span style="font-size: 12pt;">      .set(&quot;content&quot;, resolve(&quot;src/components/content&quot;))</span></div><div><span style="font-size: 12pt;">      .set(&quot;network&quot;, resolve(&quot;src/network&quot;))</span></div><div><span style="font-size: 12pt;">      .set(&quot;views&quot;, resolve(&quot;src/views&quot;));</span></div><div><span style="font-size: 12pt;">  }   </span></div><div><span style="font-size: 12pt;">}</span></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">vue-cli 3 没有 vue-cli 2 的 .editorconfig，所以需要自己配置，配置一次后下一个项目直接拷贝就好，这样就可以统一团队代码风格</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [19].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">.editorconfig</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">root = true</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">[*]</font></div><div><font style="font-size: 12pt;">charset = utf-8</font></div><div><font style="font-size: 12pt;">indent_style = space</font></div><div><font style="font-size: 12pt;">indent_size = 2</font></div><div><font style="font-size: 12pt;">end_of_line = lf</font></div><div><font style="font-size: 12pt;">insert_final_newline = true</font></div><div><font style="font-size: 12pt;">trim_trailing_whitespace = true</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">引入 tabBar 组件</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">注意：在 Vue 的 HTML </span></span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">中</span> <span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">DOM 使用别名，前面要加~</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">tabbar 是完全独立的公共组件，所以放到 common 下</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">下一个项目不一定是首页、分类等，甚至图标和文字都可能不一样，所以将 MainTabBar（与业务有关） 放到 content 下</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [20].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">img 下也要进行目录划分</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [21].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">MainTabBar 里为 &lt;img&gt; src 路径添加别名</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [22].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">为 APP.vue 注册 MainTabBar 组件</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [23].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">为 MainTabBar组件 注册 TabBar组件 和 TabBarItem组件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [24].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">实现路由效果</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">APP.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;app&quot;&gt;</font></div><div><font style="font-size: 12pt;"><b>    &lt;router-view&gt;&lt;/router-view&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;main-tab-bar&gt;&lt;/main-tab-bar&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"><b>  import MainTabBar from 'content/mainTabbar/MainTabBar'</b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'app',</font></div><div><font style="font-size: 12pt;"><b>    components: {</b></font></div><div><font style="font-size: 12pt;"><b>      MainTabBar</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;"><b>  @import &quot;assets/css/base.css&quot;;</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">router 的 index.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;"><b>// 1、引入 router</b></font></div><div><font style="font-size: 12pt;"><b>import VueRouter from 'vue-router'</b></font></div><div><font style="font-size: 12pt;"><b>// 2、安装插件</b></font></div><div><font style="font-size: 12pt;"><b>Vue.use(VueRouter)</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;"><b>// 5、实现组件懒加载</b></font></div><div><font style="font-size: 12pt;"><b>const Home = () =&gt; import('views/home/Home')</b></font></div><div><font style="font-size: 12pt;"><b>const Category = () =&gt; import('views/category/Category')</b></font></div><div><font style="font-size: 12pt;"><b>const Cart = () =&gt; import('views/cart/Cart')</b></font></div><div><font style="font-size: 12pt;"><b>const Profile = () =&gt; import('views/profile/Profile')</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;"><b><font>// 4、</font>routes 配置数组中的对象记录路由，配置映射关系</b></font></div><div><font style="font-size: 12pt;"><b>const routes = [</b></font></div><div><font style="font-size: 12pt;"><b>  {</b></font></div><div><font style="font-size: 12pt;"><b>    path: '',</b></font></div><div><font style="font-size: 12pt;"><b>    redirect: '/home'</b></font></div><div><font style="font-size: 12pt;"><b>  },</b></font></div><div><font style="font-size: 12pt;"><b>  {</b></font></div><div><font style="font-size: 12pt;"><b>    path: '/home',</b></font></div><div><font style="font-size: 12pt;"><b>    component: Home</b></font></div><div><font style="font-size: 12pt;"><b>  },</b></font></div><div><font style="font-size: 12pt;"><b>  {</b></font></div><div><font style="font-size: 12pt;"><b>    path: '/category',</b></font></div><div><font style="font-size: 12pt;"><b>    component: Category</b></font></div><div><font style="font-size: 12pt;"><b>  },</b></font></div><div><font style="font-size: 12pt;"><b>  {</b></font></div><div><font style="font-size: 12pt;"><b>    path: '/cart',</b></font></div><div><font style="font-size: 12pt;"><b>    component: cart</b></font></div><div><font style="font-size: 12pt;"><b>  },</b></font></div><div><font style="font-size: 12pt;"><b>  {</b></font></div><div><font style="font-size: 12pt;"><b>    path: '/profile',</b></font></div><div><font style="font-size: 12pt;"><b>    component: Profile</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>]</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;"><b>// 3、创建 router 实例，</b></font><font style="font-size: 12pt;"><b>传入 routes 路由</b></font></div><div><font style="font-size: 12pt;"><b>const router = new VueRouter({</b></font></div><div><font style="font-size: 12pt;"><b>  mode: 'history',</b></font></div><div><font style="font-size: 12pt;"><b>  base: process.env.BASE_URL,</b></font></div><div><font style="font-size: 12pt;"><b>  routes</b></font></div><div><font style="font-size: 12pt;"><b>})</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;"><b>// 6、导出 router</b></font></div><div><font style="font-size: 12pt;"><b>export default router</b></font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">MainTabBar.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  <b>&lt;tab-bar&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;tab-bar-item <b>path=&quot;/home&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img slot=&quot;item-icon&quot; src=&quot;~assets/img/tabbar/home.svg&quot; alt=&quot;首页&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img slot=&quot;item-icon-active&quot; src=&quot;~assets/img/tabbar/home_active.svg&quot; alt=&quot;&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;item-text&quot;&gt;首页&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/tab-bar-item&gt;</font></div><div><font style="font-size: 12pt;">    &lt;tab-bar-item <b>path=&quot;/category&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img slot=&quot;item-icon&quot; src=&quot;~assets/img/tabbar/category.svg&quot; alt=&quot;分类&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img slot=&quot;item-icon-active&quot; src=&quot;~assets/img/tabbar/category_active.svg&quot; alt=&quot;&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;item-text&quot;&gt;分类&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/tab-bar-item&gt;</font></div><div><font style="font-size: 12pt;">    &lt;tab-bar-item <b>path=&quot;/cart&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img slot=&quot;item-icon&quot; src=&quot;~assets/img/tabbar/cart.svg&quot; alt=&quot;购物车&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img slot=&quot;item-icon-active&quot; src=&quot;~assets/img/tabbar/cart_active.svg&quot; alt=&quot;&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;item-text&quot;&gt;购物车&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/tab-bar-item&gt;</font></div><div><font style="font-size: 12pt;">    &lt;tab-bar-item <b>path=&quot;/profile&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img slot=&quot;item-icon&quot; src=&quot;~assets/img/tabbar/profile.svg&quot; alt=&quot;我的&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img slot=&quot;item-icon-active&quot; src=&quot;~assets/img/tabbar/profile_active.svg&quot; alt=&quot;&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;item-text&quot;&gt;我的&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/tab-bar-item&gt;</font></div><div><font style="font-size: 12pt;">  <b>&lt;/tab-bar&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"><b>import TabBar from 'common/tabBar/TabBar'</b></font></div><div><font style="font-size: 12pt;"><b>import TabBarItem from 'common/tabBar/TabBarItem'</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'MainTabBar',</font></div><div><font style="font-size: 12pt;"> <b> components: {</b></font></div><div><font style="font-size: 12pt;"><b>    TabBar,</b></font></div><div><font style="font-size: 12pt;"><b>    TabBarItem</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [25].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">标签页小图标的修改</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">public 文件夹下 修改 index.html （图片文件改为 logo.png）</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [26].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">&lt;%= Base_URL %&gt; 是 JSP 的语法，表示当前文件（index.html）所在的路径</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">public文件夹 相当于 vue-cli2 的 static 文件夹，打包（run build）时会将里面的文件原封不动地复制（并进行</span><span style="font-size: 12pt;">压缩后</span><span style="font-size: 12pt;">）到 dist 目录下</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">navbar 组件的封装</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [27].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">不是所有导航中间都是标题，例如下图 中间是 TabBar（TabControl）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [28].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">后续导航还需要加图标</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [29].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">所以需要封装一个独立的导航栏组件</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">将 NavBar 组件放进 components/common 公共组件里，</span><span style="font-size: 12pt; font-weight: bold;">文件夹小写、组件大写（代码风格）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><img src="10- 购物街_files/3 [30].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">不可以对 &lt;slot&gt; 直接使用 class 添加样式，所以需要在外面</span></span><span style="font-size: 12pt; font-weight: bold;">包裹一层</span> <span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">&lt;div&gt;用来添加 class</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">不对 &lt;div&gt; 使用 id 命名为</span></span> <span style="font-size: 12pt; font-weight: bold;">nav-bar</span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">，而是使用 class 命名为 nav-bar，因为一个项目里多个地方都会有导航栏会导致 id 重复，而 tabBar 只有一个</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">NavBar.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  <b>&lt;div class=&quot;nav-bar&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;div class=&quot;left&quot;&gt;&lt;slot name=&quot;left&quot;&gt;&lt;/slot&gt;&lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;div class=&quot;center&quot;&gt;&lt;slot name=&quot;center&quot;&gt;&lt;/slot&gt;&lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;div class=&quot;right&quot;&gt;&lt;slot name=&quot;right&quot;&gt;&lt;/slot&gt;&lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>  &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'NavBar'</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  <b>.nav-bar {</b></font></div><div><font style="font-size: 12pt;"><b>    display: flex;</b></font></div><div><font style="font-size: 12pt;"><b>    height: 44px;</b></font></div><div><font style="font-size: 12pt;"><b>    line-height: 44px;</b></font></div><div><font style="font-size: 12pt;"><b>    text-align: center;</b></font></div><div><font style="font-size: 12pt;"><b>    box-shadow: 0 1px 1px rgba(100, 100, 100, .1);</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>  .left {</b></font></div><div><font style="font-size: 12pt;"><b>    width: 60px;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>  .center {</b></font></div><div><font style="font-size: 12pt;"><b>    flex: 1;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>  .right {</b></font></div><div><font style="font-size: 12pt;"><b>    width: 60px;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">在首页使用导航栏组件</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [31].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;nav-bar class=&quot;nav&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/nav-bar&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"><b>import NavBar from 'common/navBar/NavBar'</b></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'Home',</font></div><div><font style="font-size: 12pt;"> <b> components: {</b></font></div><div><font style="font-size: 12pt;"><b>    NavBar</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">  <b>.nav {</b></font></div><div><font style="font-size: 12pt;"><b>    background-color: var(--color-tint);</b></font></div><div><font style="font-size: 12pt;"><b>    color: #fff;</b></font></div><div><font style="font-size: 12pt;"><b>    z-index: 9;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font color="#FF0000" style="font-size: 12pt;"><br/></font></div><div><font color="#FF0000" style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">注意：不要在公共组件中使用 z-index</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">因为每个导航栏的背景颜色和文字颜色都不一样，所以不在 NavBar 组件添加</span><span style="font-size: 12pt;">背景颜色和文字颜色</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [32].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">请求首页的多个数据</span></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">一般来说，不要在组件里发送网络请求，而是再做一层封装，在 network 文件夹里进行统一管理</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [33].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm install axios --save</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">request.js</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import axios from 'axios'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export function request(config) {</font></div><div><font style="font-size: 12pt;">  // 1、创建 axios 实例</font></div><div><font style="font-size: 12pt;">  const instance = axios.create({</font></div><div><font style="font-size: 12pt;"><font>    baseURL: &quot;</font>http://123.207.32.32:8000/api/m3&quot;,</font></div><div><font style="font-size: 12pt;">    timeout: 5000</font></div><div><font style="font-size: 12pt;">  });</font></div><div><font style="font-size: 12pt;">  // axios 拦截器</font></div><div><font style="font-size: 12pt;">  // 2、请求拦截</font></div><div><font style="font-size: 12pt;">  instance.interceptors.request.use(config =&gt; {</font></div><div><font style="font-size: 12pt;">    return config</font></div><div><font style="font-size: 12pt;">  }, err =&gt; {</font></div><div><font style="font-size: 12pt;">    console.log(&quot;error&quot;);</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">  // 3、响应拦截</font></div><div><font style="font-size: 12pt;">  instance.interceptors.response.use(res =&gt; {</font></div><div><font style="font-size: 12pt;">    return res.data</font></div><div><font style="font-size: 12pt;">  }, err =&gt; {</font></div><div><font style="font-size: 12pt;">    console.log('error')</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">  // 4、 发送真正的网络请求（ Get 请求），返回 Promise，可以 .then</font></div><div><font style="font-size: 12pt;">  return instance(config)</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">home.js</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">假如首页有多个请求时，方便管理所有首页相关的请求<span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">（</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">这个设计方案对大项目非常好，多去看优秀的代码才能学到</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">）</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Home.vue 面向 home.js 模块进行开发</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="10- 购物街_files/3 [34].jpg" type="image/jpeg" data-filename="3.jpg"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;"><b>import {request} from './request'</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;"><b>export function getHomeMultidata() {</b></font></div><div><font style="font-size: 12pt;"><b>   return request({</b></font></div><div><font style="font-size: 12pt;"><b>     url: '/home/multidata'</b></font></div><div><font style="font-size: 12pt;"><b>   })</b></font></div><div><font style="font-size: 12pt;"><b>}</b></font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import NavBar from 'common/navBar/NavBar'</font></div><div><font style="font-size: 12pt;"><b>import {getHomeMultidata} from 'network/home'</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'Home',</font></div><div><font style="font-size: 12pt;"> <b> data() {</b></font></div><div><font style="font-size: 12pt;"><b>    return {</b></font></div><div><font style="font-size: 12pt;"><b>      banner: [], // 这里的变量永远被 Home 组件引用</b></font></div><div><font style="font-size: 12pt;"><b>      recommend: []</b></font></div><div><font style="font-size: 12pt;"><b>    }   </b></font></div><div><font style="font-size: 12pt;"><b>  }</b>,</font></div><div><font style="font-size: 12pt;">  components: {</font></div><div><font style="font-size: 12pt;">    NavBar</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;"> <b> created () {</b></font></div><div><font style="font-size: 12pt;"><b>    getHomeMultidata().then(res =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>      // this.result = res</b></font></div><div><font style="font-size: 12pt;"><b>      this.banner = res.data.banner.list; // 回调函数执行完成后会弹出执行栈，内存会回收释放所有函数局部变量，所以需要保存起来，这里保存在 data 中</b></font></div><div><font style="font-size: 12pt;"><b>      this.recommend = res.data.recommend.list; // 箭头函数的 this 就是 created 的 this ，也就是 Home 组件</b></font></div><div><font style="font-size: 12pt;"><b><font>      // </font>垃圾回收只会等到没有引用指向才会回收，这里只回收 res</b></font></div><div><font style="font-size: 12pt;"><b>    })</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">网络请求里回调函数执行完会释放所有局部变量，数据无法保存，所以需要在 data 定义一个变量接收响应的数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">result 和 res 的内存地址同时指向 data，函数执行完 res 被回收，res 的箭头引用也就不存在了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为 result 在组件中存在，data 被 result 箭头引用，所以不会被垃圾回收回收掉</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [35].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">注意：不可以像下图那样验证数据，因为 getHomeMultidata().then() 是异步操作，所以会打印 undefined</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [36].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以这里需要工具进行验证</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [37].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [38].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">解决问题： vue-tools 无法打开</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [39].jpg" type="image/jpeg" data-filename="3.jpg" width="692"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">在 main.js 添加</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">Vue.config.devtools = true;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><a href="https://segmentfault.com/q/1010000008735643" style="font-size: 12pt;">https://segmentfault.com/q/1010000008735643</a></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">轮播图的展示</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [40].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Swiper.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div id=&quot;hy-swiper&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;swiper&quot; @touchstart=&quot;touchStart&quot; @touchmove=&quot;touchMove&quot; @touchend=&quot;touchEnd&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;slot&gt;&lt;/slot&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;slot name=&quot;indicator&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/slot&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;indicator&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;slot name=&quot;indicator&quot; v-if=&quot;showIndicator &amp;&amp; slideCount&gt;1&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div v-for=&quot;(item, index) in slideCount&quot; class=&quot;indi-item&quot; :class=&quot;{active: index === currentIndex-1}&quot; :key=&quot;index&quot;&gt;&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/slot&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: &quot;Swiper&quot;,</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      interval: {</font></div><div><font style="font-size: 12pt;">        type: Number,</font></div><div><font style="font-size: 12pt;">        default: 3000</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      animDuration: {</font></div><div><font style="font-size: 12pt;">        type: Number,</font></div><div><font style="font-size: 12pt;">        default: 300</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      moveRatio: {</font></div><div><font style="font-size: 12pt;">        type: Number,</font></div><div><font style="font-size: 12pt;">        default: 0.25</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      showIndicator: {</font></div><div><font style="font-size: 12pt;">        type: Boolean,</font></div><div><font style="font-size: 12pt;">        default: true</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data: function () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        slideCount: 0, // 元素个数</font></div><div><font style="font-size: 12pt;">        totalWidth: 0, // swiper的宽度</font></div><div><font style="font-size: 12pt;">        swiperStyle: {}, // swiper样式</font></div><div><font style="font-size: 12pt;">        currentIndex: 1, // 当前的index</font></div><div><font style="font-size: 12pt;">        scrolling: false, // 是否正在滚动</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted: function () {</font></div><div><font style="font-size: 12pt;">      // 1.操作DOM, 在前后添加Slide</font></div><div><font style="font-size: 12pt;">      setTimeout(() =&gt; {</font></div><div><font style="font-size: 12pt;">        this.handleDom();</font></div><div><font style="font-size: 12pt;">        // 2.开启定时器</font></div><div><font style="font-size: 12pt;">        this.startTimer();</font></div><div><font style="font-size: 12pt;">      }, 3000)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      /**</font></div><div><font style="font-size: 12pt;">       * 定时器操作</font></div><div><font style="font-size: 12pt;">       */</font></div><div><font style="font-size: 12pt;">      startTimer: function () {</font></div><div><font style="font-size: 12pt;">        this.playTimer = window.setInterval(() =&gt; {</font></div><div><font style="font-size: 12pt;">          this.currentIndex++;</font></div><div><font style="font-size: 12pt;">          this.scrollContent(-this.currentIndex * this.totalWidth);</font></div><div><font style="font-size: 12pt;">        }, this.interval)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      stopTimer: function () {</font></div><div><font style="font-size: 12pt;">        window.clearInterval(this.playTimer);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      /**</font></div><div><font style="font-size: 12pt;">       * 滚动到正确的位置</font></div><div><font style="font-size: 12pt;">       */</font></div><div><font style="font-size: 12pt;">      scrollContent: function (currentPosition) {</font></div><div><font style="font-size: 12pt;">        // 0.设置正在滚动</font></div><div><font style="font-size: 12pt;">        this.scrolling = true;</font></div><div><font style="font-size: 12pt;">        // 1.开始滚动动画</font></div><div><font style="font-size: 12pt;">        this.swiperStyle.transition ='transform '+ this.animDuration + 'ms';</font></div><div><font style="font-size: 12pt;">        this.setTransform(currentPosition);</font></div><div><font style="font-size: 12pt;">        // 2.判断滚动到的位置</font></div><div><font style="font-size: 12pt;">        this.checkPosition();</font></div><div><font style="font-size: 12pt;">        // 4.滚动完成</font></div><div><font style="font-size: 12pt;">        this.scrolling = false</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      /**</font></div><div><font style="font-size: 12pt;">       * 校验正确的位置</font></div><div><font style="font-size: 12pt;">       */</font></div><div><font style="font-size: 12pt;">      checkPosition: function () {</font></div><div><font style="font-size: 12pt;">        window.setTimeout(() =&gt; {</font></div><div><font style="font-size: 12pt;">          // 1.校验正确的位置</font></div><div><font style="font-size: 12pt;">          this.swiperStyle.transition = '0ms';</font></div><div><font style="font-size: 12pt;">          if (this.currentIndex &gt;= this.slideCount + 1) {</font></div><div><font style="font-size: 12pt;">            this.currentIndex = 1;</font></div><div><font style="font-size: 12pt;">            this.setTransform(-this.currentIndex * this.totalWidth);</font></div><div><font style="font-size: 12pt;">          } else if (this.currentIndex &lt;= 0) {</font></div><div><font style="font-size: 12pt;">            this.currentIndex = this.slideCount;</font></div><div><font style="font-size: 12pt;">            this.setTransform(-this.currentIndex * this.totalWidth);</font></div><div><font style="font-size: 12pt;">          }</font></div><div><font style="font-size: 12pt;">          // 2.结束移动后的回调</font></div><div><font style="font-size: 12pt;">          this.$emit('transitionEnd', this.currentIndex-1);</font></div><div><font style="font-size: 12pt;">        }, this.animDuration)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      /**</font></div><div><font style="font-size: 12pt;">       * 设置滚动的位置</font></div><div><font style="font-size: 12pt;">       */</font></div><div><font style="font-size: 12pt;">      setTransform: function (position) {</font></div><div><font style="font-size: 12pt;">        this.swiperStyle.transform = `translate3d(${position}px, 0, 0)`;</font></div><div><font style="font-size: 12pt;">        this.swiperStyle['-webkit-transform'] = `translate3d(${position}px), 0, 0`;</font></div><div><font style="font-size: 12pt;">        this.swiperStyle['-ms-transform'] = `translate3d(${position}px), 0, 0`;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      /**</font></div><div><font style="font-size: 12pt;">       * 操作DOM, 在DOM前后添加Slide</font></div><div><font style="font-size: 12pt;">       */</font></div><div><font style="font-size: 12pt;">      handleDom: function () {</font></div><div><font style="font-size: 12pt;">        // 1.获取要操作的元素</font></div><div><font style="font-size: 12pt;">        let swiperEl = document.querySelector('.swiper');</font></div><div><font style="font-size: 12pt;">        let slidesEls = swiperEl.getElementsByClassName('slide');</font></div><div><font style="font-size: 12pt;">        // 2.保存个数</font></div><div><font style="font-size: 12pt;">        this.slideCount = slidesEls.length;</font></div><div><font style="font-size: 12pt;">        // 3.如果大于1个, 那么在前后分别添加一个slide</font></div><div><font style="font-size: 12pt;">        if (this.slideCount &gt; 1) {</font></div><div><font style="font-size: 12pt;">          let cloneFirst = slidesEls[0].cloneNode(true);</font></div><div><font style="font-size: 12pt;">          let cloneLast = slidesEls[this.slideCount - 1].cloneNode(true);</font></div><div><font style="font-size: 12pt;">          swiperEl.insertBefore(cloneLast, slidesEls[0]);</font></div><div><font style="font-size: 12pt;">          swiperEl.appendChild(cloneFirst);</font></div><div><font style="font-size: 12pt;">          this.totalWidth = swiperEl.offsetWidth;</font></div><div><font style="font-size: 12pt;">          this.swiperStyle = swiperEl.style;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        // 4.让swiper元素, 显示第一个(目前是显示前面添加的最后一个元素)</font></div><div><font style="font-size: 12pt;">        this.setTransform(-this.totalWidth);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      /**</font></div><div><font style="font-size: 12pt;">       * 拖动事件的处理</font></div><div><font style="font-size: 12pt;">       */</font></div><div><font style="font-size: 12pt;">      touchStart: function (e) {</font></div><div><font style="font-size: 12pt;">        // 1.如果正在滚动, 不可以拖动</font></div><div><font style="font-size: 12pt;">        if (this.scrolling) return;</font></div><div><font style="font-size: 12pt;">        // 2.停止定时器</font></div><div><font style="font-size: 12pt;">        this.stopTimer();</font></div><div><font style="font-size: 12pt;">        // 3.保存开始滚动的位置</font></div><div><font style="font-size: 12pt;">        this.startX = e.touches[0].pageX;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      touchMove: function (e) {</font></div><div><font style="font-size: 12pt;">        // 1.计算出用户拖动的距离</font></div><div><font style="font-size: 12pt;">        this.currentX = e.touches[0].pageX;</font></div><div><font style="font-size: 12pt;">        this.distance = this.currentX - this.startX;</font></div><div><font style="font-size: 12pt;">        let currentPosition = -this.currentIndex * this.totalWidth;</font></div><div><font style="font-size: 12pt;">        let moveDistance = this.distance + currentPosition;</font></div><div><font style="font-size: 12pt;">        // 2.设置当前的位置</font></div><div><font style="font-size: 12pt;">        this.setTransform(moveDistance);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      touchEnd: function (e) {</font></div><div><font style="font-size: 12pt;">        // 1.获取移动的距离</font></div><div><font style="font-size: 12pt;">        let currentMove = Math.abs(this.distance);</font></div><div><font style="font-size: 12pt;">        // 2.判断最终的距离</font></div><div><font style="font-size: 12pt;">        if (this.distance === 0) {</font></div><div><font style="font-size: 12pt;">          return</font></div><div><font style="font-size: 12pt;">        } else if (this.distance &gt; 0 &amp;&amp; currentMove &gt; this.totalWidth * this.moveRatio) { // 右边移动超过0.5</font></div><div><font style="font-size: 12pt;">          this.currentIndex--</font></div><div><font style="font-size: 12pt;">        } else if (this.distance &lt; 0 &amp;&amp; currentMove &gt; this.totalWidth * this.moveRatio) { // 向左移动超过0.5</font></div><div><font style="font-size: 12pt;">          this.currentIndex++</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        // 3.移动到正确的位置</font></div><div><font style="font-size: 12pt;">        this.scrollContent(-this.currentIndex * this.totalWidth);</font></div><div><font style="font-size: 12pt;">        // 4.移动完成后重新开启定时器</font></div><div><font style="font-size: 12pt;">        this.startTimer();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      /**</font></div><div><font style="font-size: 12pt;">       * 控制上一个, 下一个</font></div><div><font style="font-size: 12pt;">       */</font></div><div><font style="font-size: 12pt;">      previous: function () {</font></div><div><font style="font-size: 12pt;">        this.changeItem(-1);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      next: function () {</font></div><div><font style="font-size: 12pt;">        this.changeItem(1);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      changeItem: function (num) {</font></div><div><font style="font-size: 12pt;">        // 1.移除定时器</font></div><div><font style="font-size: 12pt;">        this.stopTimer();</font></div><div><font style="font-size: 12pt;">        // 2.修改index和位置</font></div><div><font style="font-size: 12pt;">        this.currentIndex += num;</font></div><div><font style="font-size: 12pt;">        this.scrollContent(-this.currentIndex * this.totalWidth);</font></div><div><font style="font-size: 12pt;">        // 3.添加定时器</font></div><div><font style="font-size: 12pt;">        this.startTimer();</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #hy-swiper {</font></div><div><font style="font-size: 12pt;">    overflow: hidden;</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .swiper {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .indicator {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    justify-content: center;</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    width: 100%;</font></div><div><font style="font-size: 12pt;">    bottom: 8px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .indi-item {</font></div><div><font style="font-size: 12pt;">    box-sizing: border-box;</font></div><div><font style="font-size: 12pt;">    width: 8px;</font></div><div><font style="font-size: 12pt;">    height: 8px;</font></div><div><font style="font-size: 12pt;">    border-radius: 4px;</font></div><div><font style="font-size: 12pt;">    background-color: #fff;</font></div><div><font style="font-size: 12pt;">    line-height: 8px;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">    font-size: 12px;</font></div><div><font style="font-size: 12pt;">    margin: 0 5px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .indi-item.active {</font></div><div><font style="font-size: 12pt;">    background-color: rgba(212,62,46,1.0);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">SwiperItem.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;slide&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;slot&gt;&lt;/slot&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: &quot;Slide&quot;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .slide {</font></div><div><font style="font-size: 12pt;">    width: 100%;</font></div><div><font style="font-size: 12pt;">    flex-shrink: 0;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .slide img {</font></div><div><font style="font-size: 12pt;">    width: 100%;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">index.js</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Swiper from './Swiper'</font></div><div><font style="font-size: 12pt;">import SwiperItem from './SwiperItem'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export {</font></div><div><font style="font-size: 12pt;">  Swiper, SwiperItem</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">UI 库直接用是简单的（知道怎么用就行），</span><span style="font-size: 12pt;">如果要学习研究它必须</span><span style="font-size: 12pt;">自己从零封装一个，才能熟悉，大胆在项目中用</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">如果 swiper 组件放到 Home.vue 中，会出现以下情况，代码越来越多造成 Home.vue 的臃肿，层级越来越多：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [41].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue 只负责管理最主要的逻辑，至于组件里面怎么写、怎么封装的 Home.vue 不需要关心，</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">因为 swiper 属于 Home，是Home 里面的代码，所以要抽取到 Home文件夹下（而不是其他文件夹）</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [42].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所有关于 Home 的子组件都放到 childComps（个人认为命名叫作 childCpns 比较好） 里</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="10- 购物街_files/3 [43].jpg" type="image/jpeg" data-filename="3.jpg"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="10- 购物街_files/3 [44].jpg" type="image/jpeg" data-filename="3.jpg"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HomeSwiper.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;"> <b> &lt;swiper&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;swiper-item v-for=&quot;(item, index) in banner&quot; :key=&quot;index&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;a :href=&quot;item.link&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>        &lt;img :src=&quot;item.image&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;/a&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/swiper-item&gt;</b></font></div><div><font style="font-size: 12pt;"><b>  &lt;/swiper&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  <b>import {Swiper, SwiperItem} from 'common/swiper/index.js'</b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    <b>name: 'HomeSwiper',</b></font></div><div><font style="font-size: 12pt;"><b>    props: {</b></font></div><div><font style="font-size: 12pt;"><b>      banner: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Array,</b></font></div><div><font style="font-size: 12pt;"><b>        default() {</b></font></div><div><font style="font-size: 12pt;"><b>          return []</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    components: {</b></font></div><div><font style="font-size: 12pt;"><b>      Swiper,</b></font></div><div><font style="font-size: 12pt;"><b>      SwiperItem</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">组件按顺序导入</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  <b>&lt;div id=&quot;home&quot;&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</b></font></div><div><font style="font-size: 12pt;">  <b>&lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  <b>import HomeSwiper from './childComps/HomeSwiper'</b></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata } from 'network/home'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      <b>HomeSwiper</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null</font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">        this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">遇到的坑：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">没有属性绑定和没有设置根元素 &lt;div&gt;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3.gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">推荐信息的展示</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [45].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">推荐信息是一个独立的组件（属于 Home 的 子组件）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [46].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HomeRecommend.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  <b>&lt;div class=&quot;recommend&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;div class=&quot;recommend-item&quot; v-for=&quot;item of recommend&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;a :href=&quot;item.link&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>        &lt;img :src=&quot;item.image&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>        &lt;div&gt;{{item.title}}&lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;/a&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>  &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'HomeRecommend',</font></div><div><font style="font-size: 12pt;">    <b>props: {</b></font></div><div><font style="font-size: 12pt;"><b>      recommend: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Array,</b></font></div><div><font style="font-size: 12pt;"><b>        default() {</b></font></div><div><font style="font-size: 12pt;"><b>          return []</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .recommend {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">    font-size: 12px;</font></div><div><font style="font-size: 12pt;">    padding: 10px 0 20px;</font></div><div><font style="font-size: 12pt;">    border-bottom: 5px solid #ccc;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .recommend-item {</font></div><div><font style="font-size: 12pt;">    flex: 1;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .recommend-item img {</font></div><div><font style="font-size: 12pt;">    width: 70px;</font></div><div><font style="font-size: 12pt;">    height: 70px;</font></div><div><font style="font-size: 12pt;">    margin-bottom: 10px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  <b>import HomeRecommend from './childCpns/HomeRecommend'</b></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata } from 'network/home'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null</font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">        this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [47].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">FeatureView 的封装</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">目前来说，我们只在首页 Home.vue 添加了三个组件：tab-bar、home-swiper、home-recommend，具体的东西可以在具体的小组件查看</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这种封装的思想就是组件化开发的思想</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">    &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [48].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">虽然这块只是一张图片，但是也不推荐在 Home.vue 中直接添加 &lt;img&gt;，因为它也属于一个独立的功能模块，所以也要把它封装成一个独立的组件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">它也属于首页的子组件，所以要放到 childCpns 里</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [49].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为它是购物特点相关的，所以命名为 FeatureView</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">FeatureView.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  <b>&lt;div class=&quot;feature&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;a href=&quot;http://act.mogujie.com/zzlx67&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;img src=&quot;~assets/img/home/recommend_bg.jpg&quot; alt=&quot;&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/a&gt;</b></font></div><div><font style="font-size: 12pt;"><b>  &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'FeatureView',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  <b>.feature img{</b></font></div><div><font style="font-size: 12pt;"><b>    width: 100%;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">导航栏在滚动时必须固定，而且需要使用 padding-top 让整个页面增加一个导航栏的高度</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">ul&gt;li{列表$}*100 暂时撑开下拉列表的高度，使得滚动时看到下拉列表的内容，后面再删</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 11pt;">&lt;template&gt;</font></div><div><font style="font-size: 11pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 11pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 11pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 11pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 11pt;">    &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 11pt;">    &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 11pt;">   <b> &lt;feature-view&gt;&lt;/feature-view&gt;</b></font></div><div><font style="font-size: 11pt;">    <b>&lt;ul&gt;</b></font></div><div><font style="font-size: 11pt;"><b>      &lt;li&gt;列表1&lt;/li&gt;</b></font></div><div><font style="font-size: 11pt;"><b>      &lt;li&gt;列表2&lt;/li&gt;</b></font></div><div><font style="font-size: 11pt;"><b>      &lt;li&gt;列表3&lt;/li&gt;</b></font></div><div><font style="font-size: 11pt;"><b>      ...  </b></font></div><div><font style="font-size: 11pt;"><b>    &lt;/ul&gt;</b></font></div><div><font style="font-size: 11pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 11pt;">&lt;/template&gt;</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">&lt;script&gt;</font></div><div><font style="font-size: 11pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 11pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 11pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 11pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 11pt;">  import { getHomeMultidata } from 'network/home'</font></div><div><font style="font-size: 11pt;">  export default {</font></div><div><font style="font-size: 11pt;">    name: 'Home',</font></div><div><font style="font-size: 11pt;">    components: {</font></div><div><font style="font-size: 11pt;">      NavBar,</font></div><div><font style="font-size: 11pt;">      HomeSwiper,</font></div><div><font style="font-size: 11pt;">      HomeRecommend,</font></div><div><font style="font-size: 11pt;">      FeatureView</font></div><div><font style="font-size: 11pt;">    },</font></div><div><font style="font-size: 11pt;">    data() {</font></div><div><font style="font-size: 11pt;">      return {</font></div><div><font style="font-size: 11pt;">        banner: null,</font></div><div><font style="font-size: 11pt;">        recommend: null</font></div><div><font style="font-size: 11pt;">      }    </font></div><div><font style="font-size: 11pt;">    },</font></div><div><font style="font-size: 11pt;">    created () {</font></div><div><font style="font-size: 11pt;">      getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 11pt;">        this.banner = res.data.banner.list;</font></div><div><font style="font-size: 11pt;">        this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 11pt;">      })</font></div><div><font style="font-size: 11pt;">    }</font></div><div><font style="font-size: 11pt;">  }</font></div><div><font style="font-size: 11pt;">&lt;/script&gt;</font></div><div><font style="font-size: 11pt;"><br/></font></div><div><font style="font-size: 11pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 11pt;"> <b> #home {</b></font></div><div><font style="font-size: 11pt;"><b>    padding-top: 44px;</b></font></div><div><font style="font-size: 11pt;"><b>  }</b></font></div><div><font style="font-size: 11pt;">  .nav {</font></div><div><font style="font-size: 11pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 11pt;">    color: #fff;</font></div><div><font style="font-size: 11pt;">    <b>position: fixed;</b></font></div><div><font style="font-size: 12pt;"><b>    top: 0;</b></font></div><div><font style="font-size: 12pt;"><b><font>    </font>right: 0;</b></font></div><div><font style="font-size: 11pt;"><b>    left: 0;</b></font></div><div><font style="font-size: 11pt;">  }</font></div><div><font style="font-size: 11pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">为了不在移动端浏览器滚动时非常卡顿，所以我们不使用原生，将会使用 better-scroll 库（一个仿 iscroll 核心的库）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [1].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">TabControl 的封装</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">选项卡控制栏也是一个独立的组件，它也会在其它地方用</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">首页里面用（有停留吸顶效果）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [50].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">分类页面里面用（没有停留</span><span style="font-size: 12pt;">吸顶</span><span style="font-size: 12pt;">效果）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [51].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">既然这个组件可以在多个页面中使用，所以不能放在 home/ChildCpns 里（分类页面不应该使用 Home的子组件），</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">而是放在 components/content 里，因为它属于业务相关的公共组件，在下一个项目当中可能不一样</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [52].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为在不同页面填充的文字无法确定，而且选项卡的个数也不是确定的</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">只是文字不一样而已，并不像导航栏（不一样的东西太多），所以没有必要搞 &lt;slot&gt;插槽，根据不同情况采取不同思想</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">只需要让开发者传入包含所有标题文字的数组，根据有几个</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">标题</span><span style="font-size: 12pt;">文字和</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">标题</span><span style="font-size: 12pt;">文字叫什么来决定显示几个选项卡和显示什么样的</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">标题</span><span style="font-size: 12pt;">文字</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">每个选项卡是一个 &lt;div&gt;</span><span style="font-size: 12pt;">，&lt;div&gt;里有一个 &lt;span&gt;，</span><span style="font-size: 12pt;">&lt;span&gt; 有一个 border-bottom</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [53].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">&lt;div&gt; 选项卡</span><span style="font-size: 12pt;">个数根据传进来的标题文字数组决定</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">子组件和 common 的公共组件导入时使用空格区分，按顺序导入，另外：components: {} 与 import 顺序要保持一致</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">&lt;template&gt;</span></div><div><span style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</span></div><div><span style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</span></div><div><span style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</span></div><div><span style="font-size: 12pt;">    &lt;/nav-bar&gt;</span></div><div><span style="font-size: 12pt;">    &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</span></div><div><span style="font-size: 12pt;">    &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</span></div><div><span style="font-size: 12pt;">    &lt;feature-view&gt;&lt;/feature-view&gt;</span></div><div><span style="font-size: 12pt;">    <b>&lt;tab-control :title=&quot;['流行', '新款', '精选']&quot;&gt;&lt;/tab-control&gt;</b></span></div><div><span style="font-size: 12pt;">    &lt;ul&gt;</span></div><div><span style="font-size: 12pt;">      &lt;li&gt;列表1&lt;/li&gt;</span></div><div><span style="font-size: 12pt;">      &lt;li&gt;列表2&lt;/li&gt;</span></div><div><span style="font-size: 12pt;">      &lt;li&gt;列表3&lt;/li&gt;</span></div><div><span style="font-size: 12pt;">      ...</span></div><div><span style="font-size: 12pt;">    &lt;/ul&gt;</span></div><div><span style="font-size: 12pt;">  &lt;/div&gt;</span></div><div><span style="font-size: 12pt;">&lt;/template&gt;</span></div><div><br/></div><div><span style="font-size: 12pt;">&lt;script&gt;</span></div><div><span style="font-size: 12pt;"><b>  import HomeSwiper from './childCpns/HomeSwiper'</b></span></div><div><span style="font-size: 12pt;"><b>  import HomeRecommend from './childCpns/HomeRecommend'</b></span></div><div><span style="font-size: 12pt;"><b>  import FeatureView from './childCpns/FeatureView'</b></span></div><div><b><br/></b></div><div><span style="font-size: 12pt;"><b>  import NavBar from 'common/navbar/NavBar'</b></span></div><div><span style="font-size: 12pt;"><b>  import TabControl from 'content/tabControl/TabControl'</b></span></div><div><b><br/></b></div><div><span style="font-size: 12pt;"><b>  import { getHomeMultidata } from 'network/home'</b></span></div><div><br/></div><div><span style="font-size: 12pt;">  export default {</span></div><div><span style="font-size: 12pt;">    name: 'Home',</span></div><div><span style="font-size: 12pt;">    components: {    </span></div><div><span style="font-size: 12pt;">      HomeSwiper,</span></div><div><span style="font-size: 12pt;">      HomeRecommend,</span></div><div><span style="font-size: 12pt;">      FeatureView,</span></div><div><span style="font-size: 12pt;">      NavBar,</span></div><div><span style="font-size: 12pt;">      <b>TabControl</b></span></div><div><span style="font-size: 12pt;">    },</span></div><div><span style="font-size: 12pt;">    data() {</span></div><div><span style="font-size: 12pt;">      return {</span></div><div><span style="font-size: 12pt;">        banner: null,</span></div><div><span style="font-size: 12pt;">        recommend: null</span></div><div><span style="font-size: 12pt;">      }    </span></div><div><span style="font-size: 12pt;">    },</span></div><div><span style="font-size: 12pt;">    created () {</span></div><div><span style="font-size: 12pt;">      getHomeMultidata().then(res =&gt; {</span></div><div><span style="font-size: 12pt;">        this.banner = res.data.banner.list;</span></div><div><span style="font-size: 12pt;">        this.recommend = res.data.recommend.list;</span></div><div><span style="font-size: 12pt;">      })</span></div><div><span style="font-size: 12pt;">    }</span></div><div><span style="font-size: 12pt;">  }</span></div><div><span style="font-size: 12pt;">&lt;/script&gt;</span></div></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">TabControl.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;tab-control&quot;&gt;</font></div><div><font style="font-size: 12pt;">   <b> &lt;div v-for=&quot;(item, index) of title&quot; :key=&quot;index&quot;</b></font></div><div><font style="font-size: 12pt;"><b>    @click=&quot;tabClick(index)&quot; :class=&quot;{active: currentIndex === index}&quot;</b></font></div><div><font style="font-size: 12pt;"><b>    class=&quot;tab-control-item&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;span&gt;{{item}}&lt;/span&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;  </font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'TabControl',</font></div><div><font style="font-size: 12pt;">   <b> props: {</b></font></div><div><font style="font-size: 12pt;"><b>      title: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Array,</b></font></div><div><font style="font-size: 12pt;"><b>        default() {</b></font></div><div><font style="font-size: 12pt;"><b>          return []</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    data () {</b></font></div><div><font style="font-size: 12pt;"><b>      return {</b></font></div><div><font style="font-size: 12pt;"><b>        currentIndex: 0</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    methods: {</b></font></div><div><font style="font-size: 12pt;"><b>      tabClick(index) {</b></font></div><div><font style="font-size: 12pt;"><b>        this.currentIndex = index</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .tab-control {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">    height: 40px;</font></div><div><font style="font-size: 12pt;">    line-height: 40px;</font></div><div><font style="font-size: 12pt;">    font-size: 15px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;"><font>  .</font>tab-control-item {</font></div><div><font style="font-size: 12pt;">    flex: 1;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .active {</font></div><div><font style="font-size: 12pt;">    color: var(--color-tint);   </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  <b>.active span {</b></font></div><div><font style="font-size: 12pt;"><b>    border-bottom: 2px solid var(--color-tint);</b></font></div><div><font style="font-size: 12pt;"><b>    padding: 5px;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">注意： </span><span style="font-size: 12pt; font-weight: bold;">border-bottom 必须添加到 span 上，否则太长，而且需要使用 padding 撑开一点距离</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [54].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [55].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">保存商品的数据结构设计</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">接下来要做商品列表页，第一件事是要请求数据，但是数据分为三类： 流行、新款、精选，而且有点多</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Vue 会默认对组件进行复用，复用的话会造成切换 TabControl 时商品列表页的图片不会更新（就像两个 input 一样）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以在后面需要绑定一个 :key 属性</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [56].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">使用计算属性来决定显示哪个 img</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [57].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">根据不同的点击展示不同的数据，但是保存数据的时候既要有流行的数据，也要有新款和精选的数据，如果没有就只能再次发送请求，这样的话用户延迟时间就比较长了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以要一次性把所有 流行/新款/精选 数据 请求下来，放到一个地方存储</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [58].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">但是一个 流行 的数据有很多页，因为要做上拉加载更多，既有第一页也有其他页，数据量还是很大的</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">假如在 goods 变量（一个对象）保存所有的 </span><span style="font-size: 12pt;">流行/新款/精选 数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">流行/新款/精选 其中的</span><span style="font-size: 12pt;">每个数据又是一个对象（里面有页数 page 和表示列表数据的 list），有可能保存着30条，</span><span style="font-size: 12pt;">有可能保存着60条，</span><span style="font-size: 12pt;">有可能保存着90条</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">另外，流行/新款/精选 每一页显示的页数是可以不一样的</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [59].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当用户上拉加载更多时，新款就要增加 30 条数据，</span><span style="font-size: 12pt;">page变成第 3 页 list</span><span style="font-size: 12pt;">变成展示 90 条数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">做其他开发时也可以设计成 map 数据结构</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [60].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这个数据模型属于首页，所以可以在首页 Home.vue 中添加 goods</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">goods 可以默认写成第 1 页，也可以是第 0 页，表示什么都还没请求</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [61].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">首页数据的请求和保存</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">默认先把每个类型的第一页数据请求下来，方便展示和操作，当用户上拉加载更多时再显示其他页</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以要先从 network 里入手，封装一个请求商品列表数据的函数，添加类型和页码请求不同类型的数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [62].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">引入 </span><span style="font-size: 12pt;">请求商品列表数据 的函数</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [63].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">created 里</span><span style="font-size: 12pt;">保存数据时，created 里的代码会有点多，容易乱</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [64].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以要把 请求的代码抽离到 methods 里（代码组织方式，只有用经验慢慢体会和积累），而且可以动态地请求数据了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为一旦首页创建完之后请求的不是一个数据，</span><span style="font-size: 12pt;">所以请求类型 type  和请求页码 page 可以不写死，要让请求函数可以复用，请求不同类型的数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">由于默认先请求第一页数据，而且 请求函数复用 时未必是第一页，所以</span><span style="font-size: 12pt;">请求页码 page 是之前的页码 + 1，不写死数据让 请求函数复用 更方便</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">下面例子 请求的 res结果 默认就是 pop类型的第一页30条数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [65].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">不能直接 .push(数组)</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">let totalNums = []</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">totalNums.push([10, 20, 30]); // 结果为[[10, 20, 30]]</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以 使用 .push(可变参数 ...数组) 依次取出数组的值然后依次push</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [66].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [67].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">home.js</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import {request} from './request'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export function getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">  return request({</font></div><div><font style="font-size: 12pt;">    url: 'home/multidata'</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><b>export function getHomeGoods(type, page) {</b></font></div><div><font style="font-size: 12pt;"><b>  return request({</b></font></div><div><font style="font-size: 12pt;"><b>    url: 'home/data',</b></font></div><div><font style="font-size: 12pt;"><b>    params: {</b></font></div><div><font style="font-size: 12pt;"><b>      type,</b></font></div><div><font style="font-size: 12pt;"><b>      page</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;"><b>  })</b></font></div><div><font style="font-size: 12pt;"><b>}</b></font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">    &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">    &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">    &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot;&gt;&lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">    &lt;ul&gt;</font></div><div><font style="font-size: 12pt;">      &lt;li&gt;列表1&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">      &lt;li&gt;列表2&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">      &lt;li&gt;列表3&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">      ...</font></div><div><font style="font-size: 12pt;">    &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><b>  import { getHomeMultidata, getHomeGoods } from 'network/home'</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        <b>goods: {</b></font></div><div><font style="font-size: 12pt;"><b>          'pop': {page: 0, list: []},</b></font></div><div><font style="font-size: 12pt;"><b>          'new': {page: 0, list: []},</b></font></div><div><font style="font-size: 12pt;"><b>          'sell': {page: 0, list: []}</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>created () {</b></font></div><div><font style="font-size: 12pt;"><b>      this.getHomeMultidata();</b></font></div><div><font style="font-size: 12pt;"><b>      this.getHomeGoods('pop');</b></font></div><div><font style="font-size: 12pt;"><b>      this.getHomeGoods('new');</b></font></div><div><font style="font-size: 12pt;"><b>      this.getHomeGoods('sell');</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;">   <b> methods: {</b></font></div><div><font style="font-size: 12pt;"><b>      getHomeMultidata() {</b></font></div><div><font style="font-size: 12pt;"><b>        getHomeMultidata().then(res =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>          this.banner = res.data.banner.list;</b></font></div><div><font style="font-size: 12pt;"><b>          this.recommend = res.data.recommend.list;</b></font></div><div><font style="font-size: 12pt;"><b>        })</b></font></div><div><font style="font-size: 12pt;"><b>      },</b></font></div><div><font style="font-size: 12pt;"><b>      getHomeGoods(type) {</b></font></div><div><font style="font-size: 12pt;"><b>        const page = this.goods[type].page + 1;</b></font></div><div><font style="font-size: 12pt;"><b>        getHomeGoods(type, page).then(res =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>           this.goods[type].list.push(...res.data.list);</b></font></div><div><font style="font-size: 12pt;"><b>           this.goods[type].page += 1;</b></font></div><div><font style="font-size: 12pt;"><b>        })</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">请求成功：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [68].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">首页商品数据的展示</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果要展示，要如何封装组件进行展示呢？</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">整个区域是一个大的组件，根据数据量的多少塞这些小组件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [69].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这个大组件要封装在哪呢？首先考虑组件会不会被复用，其实会被复用，所以将它放到业务有关的 common/content 公共组件里</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [70].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">每一个小的 GoodsItem 本身都是一个组件（GoodList的局部组件），根据数据的多少遍历出多少个</span><span style="font-size: 12pt;">小的 </span><span style="font-size: 12pt;">GoodsItem</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以要有两个组件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">然后引入 GoodsList 组件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [71].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">GoodList 要展示首页的 商品列表数据，所以需要 Home.vue 将数据传递给 GoodList.vue</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [72].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></div><div><br/></div><div><img src="10- 购物街_files/3 [73].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">GoodsList.vue</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [74].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">GoodsList 大组件循环数据渲染多个 GoodsListItem</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="10- 购物街_files/3 [75].jpg" type="image/jpeg" data-filename="3.jpg"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">GoodsItem.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="10- 购物街_files/3 [76].jpg" type="image/jpeg" data-filename="3.jpg"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [77].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [78].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">接下来添加样式即可</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">GoodsList.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;goods&quot;&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;goods-item v-for=&quot;(item, index) in goods&quot; :key=&quot;index&quot; :goodsItem=&quot;item&quot;&gt;&lt;/goods-item&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import GoodsItem from './GoodsItem'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Goods',</font></div><div><font style="font-size: 12pt;">    <b>props: {</b></font></div><div><font style="font-size: 12pt;"><b>      goods: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Array,</b></font></div><div><font style="font-size: 12pt;"><b>        default() {</b></font></div><div><font style="font-size: 12pt;"><b>          return []</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      GoodsItem</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .goods {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    flex-wrap: wrap;</font></div><div><font style="font-size: 12pt;">    justify-content: space-around;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">GoodsItem.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  <b>&lt;div class=&quot;goods-item&quot;&gt;</b></font></div><div><font style="font-size: 12pt;">   <b> &lt;img :src=&quot;goodsItem.show.img&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;div class=&quot;goods-info&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;p&gt;{{goodsItem.title}}&lt;/p&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;span class=&quot;price&quot;&gt;{{goodsItem.price}}&lt;/span&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;span class=&quot;collect&quot;&gt;{{goodsItem.cfav}}&lt;/span&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>  &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'GoodsItem',</font></div><div><font style="font-size: 12pt;">   <b> props: {</b></font></div><div><font style="font-size: 12pt;"><b>      goodsItem: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Object,</b></font></div><div><font style="font-size: 12pt;"><b>        default() {</b></font></div><div><font style="font-size: 12pt;"><b>          return {}</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .goods-item {</font></div><div><font style="font-size: 12pt;">    padding-bottom: 40px;</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    width: 150px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .goods-item img {</font></div><div><font style="font-size: 12pt;">    width: 100%;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .goods-info {</font></div><div><font style="font-size: 12pt;">    font-size: 12px;</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    bottom: 5px;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;</font></div><div><font style="font-size: 12pt;">    overflow: hidden;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .goods-info p {</font></div><div><font style="font-size: 12pt;">    overflow: hidden;</font></div><div><font style="font-size: 12pt;">    text-overflow: ellipsis;</font></div><div><font style="font-size: 12pt;">    white-space: nowrap;</font></div><div><font style="font-size: 12pt;">    margin-bottom: 3px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .goods-info .price {</font></div><div><font style="font-size: 12pt;">    color: var(--color-high-text);</font></div><div><font style="font-size: 12pt;">    margin-right: 20px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .goods-info .collect {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .goods-info .collect::before {</font></div><div><font style="font-size: 12pt;">    content: '';</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    left: -15px;</font></div><div><font style="font-size: 12pt;">    top: 0;</font></div><div><font style="font-size: 12pt;">    width: 14px;</font></div><div><font style="font-size: 12pt;">    height: 14px;</font></div><div><font style="font-size: 12pt;">    background: url(&quot;~assets/img/common/collect.svg&quot;) 0 0/14px 14px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">    &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">    &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">    &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot;&gt;&lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">   <b> &lt;goods-list :goods=&quot;goods['pop'].list&quot;&gt;&lt;/goods-list&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;"> <b> import { getHomeMultidata, getHomeGoods } from 'network/home'</b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      <b>GoodsList</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        <b>goods: {</b></font></div><div><font style="font-size: 12pt;"><b>          'pop': {page: 0, list: []},</b></font></div><div><font style="font-size: 12pt;"><b>          'new': {page: 0, list: []},</b></font></div><div><font style="font-size: 12pt;"><b>          'sell': {page: 0, list: []}</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> created () {</b></font></div><div><font style="font-size: 12pt;"><b>      this.getHomeMultidata();</b></font></div><div><font style="font-size: 12pt;"><b>      this.getHomeGoods('pop');</b></font></div><div><font style="font-size: 12pt;"><b>      this.getHomeGoods('new');</b></font></div><div><font style="font-size: 12pt;"><b>      this.getHomeGoods('sell');</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    methods: {</b></font></div><div><font style="font-size: 12pt;"><b>      getHomeMultidata() {</b></font></div><div><font style="font-size: 12pt;"><b>        getHomeMultidata().then(res =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>          this.banner = res.data.banner.list;</b></font></div><div><font style="font-size: 12pt;"><b>          this.recommend = res.data.recommend.list;</b></font></div><div><font style="font-size: 12pt;"><b>        })</b></font></div><div><font style="font-size: 12pt;"><b>      },</b></font></div><div><font style="font-size: 12pt;"><b>      getHomeGoods(type) {</b></font></div><div><font style="font-size: 12pt;"><b>        const page = this.goods[type].page + 1;</b></font></div><div><font style="font-size: 12pt;"><b>        getHomeGoods(type, page).then(res =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>          this.goods[type].list.push(...res.data.list);</b></font></div><div><font style="font-size: 12pt;"><b>          this.goods[type].page += 1;</b></font></div><div><font style="font-size: 12pt;"><b>        })</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [79].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">TabControl 点击切换商品</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [80].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">要实现</span><span style="font-size: 12pt;">点击切换商品，首先要在 </span><span style="font-size: 12pt;">TabControl 内部监听点击（已监听），但是没有把</span> <span style="font-size: 12pt;">TabControl 的</span><span style="font-size: 12pt;">点击事件传播到外面（Home.vue）去</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为 Home.vue 组件需要知道你点击了哪个 Tab（子组件向父组件传值）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [81].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">注意：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">改完代码要在浏览器刷新，不要依赖热更新（</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">热更新可能不是完全更新</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">真正写代码时多注释，不然自己都看不懂</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">要改变 </span><span style="font-size: 12pt;">:goods=&quot;goods['pop'].list&quot; 就不能把写死 ['pop']，所以在 data 中添加一个属性 </span><span style="font-size: 12pt;">currentType </span><span style="font-size: 12pt;">记录当前类型，默认为  'pop'</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当选中 tab 的 index 不同时，根据 index 的不同给 currentType 赋值</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">TabControl.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;tab-control&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div <b>v-for=&quot;(item, index) of title&quot; :key=&quot;index&quot;</b></font></div><div><font style="font-size: 12pt;">    <b>@click=&quot;tabClick(index)&quot;</b> :class=&quot;{active: currentIndex === index}&quot;</font></div><div><font style="font-size: 12pt;">    class=&quot;tab-control-item&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span&gt;{{item}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;  </font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'TabControl',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      title: {</font></div><div><font style="font-size: 12pt;">        type: Array,</font></div><div><font style="font-size: 12pt;">        default() {</font></div><div><font style="font-size: 12pt;">          return []</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        currentIndex: 0</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> methods: {</b></font></div><div><font style="font-size: 12pt;"><b>      tabClick(index) {</b></font></div><div><font style="font-size: 12pt;"><b>        this.currentIndex = index</b></font></div><div><font style="font-size: 12pt;"><b>        this.$emit('tabClick', index);</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .tab-control {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">    height: 40px;</font></div><div><font style="font-size: 12pt;">    line-height: 40px;</font></div><div><font style="font-size: 12pt;">    font-size: 15px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .tab-control-item {</font></div><div><font style="font-size: 12pt;">    flex: 1;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .active {</font></div><div><font style="font-size: 12pt;">    color: var(--color-tint);   </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .active span {   </font></div><div><font style="font-size: 12pt;">    border-bottom: 2px solid var(--color-tint);</font></div><div><font style="font-size: 12pt;">    padding: 5px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">    &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">    &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;&gt;&lt;/tab-control&gt;</b></font></div><div><font style="font-size: 12pt;">   <b> &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop'</font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>computed: {</b></font></div><div><font style="font-size: 12pt;"><b>      showGoods() {</b></font></div><div><font style="font-size: 12pt;"><b>        return this.goods[this.currentType].list</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">     <b> // 事件监听</b></font></div><div><font style="font-size: 12pt;"><b>      tabClick(index) {</b></font></div><div><font style="font-size: 12pt;"><b>        switch(index) {</b></font></div><div><font style="font-size: 12pt;"><b>          case 0:</b></font></div><div><font style="font-size: 12pt;"><b>            this.currentType = 'pop'</b></font></div><div><font style="font-size: 12pt;"><b>            break</b></font></div><div><font style="font-size: 12pt;"><b>          case 1:</b></font></div><div><font style="font-size: 12pt;"><b>            this.currentType = 'new'</b></font></div><div><font style="font-size: 12pt;"><b>            break</b></font></div><div><font style="font-size: 12pt;"><b>          case 2:</b></font></div><div><font style="font-size: 12pt;"><b>            this.currentType = 'sell'</b></font></div><div><font style="font-size: 12pt;"><b>            break    </b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b>,</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">属性绑定的值太长了，所以需要一个计算属性</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [82].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [83].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [2].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">BetterScroll 的安装和使用</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">滚动只要超出视觉视口高度就可以滚动，为了解决移动端滚动卡顿（滚一下，卡一下）的问题，这个原生滚动的问题在项目部署到服务器之后移动端调试时尤为明显</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">以前用 iScroll （几年不维护了），现在用 Better-Scroll </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><a href="https://better-scroll.github.io/docs/zh-CN/" style="font-size: 12pt;">BetterScroll 2.x 中文文档</a></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [84].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">找源码，找到最新的 Tag，然后找到 dist 文件夹，下载未压缩版</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [85].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [86].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">esm（ESModule） 表示要使用模块化方式导入</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">原生局部滚动方式（移动端非常卡顿）</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [87].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [88].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [89].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">在项目中使用时，还是不直接引入第三方库（为了可维护），所以先要进行封装</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">BetterScroll 的使用</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm install better-scroll --save</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">绿色部分为 wrapper，也就是父容器，它会有固定的高度。黄色部分为 content，</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">它是父容器的第一个子元素</span><span style="font-size: 12pt;">，它的高度会随着内容的大小而撑高。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">强制结构：content 由一个标签组成，也就是说wrapper</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">里面必须只有一个包裹多个元素的元素，即一个 wrapper 包裹 一个有多个元素的 content</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">实现局部滚动：wrapper 必须设置一个高度，content 通常会设置 overflow: hidden</span></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/schematic.png" type="image/png" data-filename="schematic.png" width="433"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">created() 生命周期函数：组件创建完之后调用，不会挂载 tamplate 模板，所以不能在 created() 生命周期函数中使用 new Bscroll()</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">所以需要在 mounted() 生命周期函数</span></span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">使用 new Bscroll()，才能获取需要滚动的 wrapper 元素</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import BScroll from 'better-scroll</font>'</div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [90].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [91].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">BetterScroll 的基本使用解析</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">node_modules 中找到 BetterScroll 的源码</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [92].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在项目中应用 </span><span style="font-size: 12pt;">BetterScroll，实时监听滚动到的位置来实现 TabControl 吸顶效果，显示 /隐藏回到顶部按钮（一旦超过某个区域就显示，一旦小于某个区域就隐藏）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [93].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、默认情况下， BScroll 不可以实时监听滚动位置，如果想监听必须传一个参数 </span><span style="font-size: 12pt;">probeType</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">probeType参数 表示要不要实时侦测滚动的位置</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">probeType: 0 （不侦测）和 1</span><span style="font-size: 12pt;">（屏幕滑动超过一定时间后才侦测</span><span style="font-size: 12pt;">） 都表示不实时侦测</span><span style="font-size: 12pt;">滚动的位置</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">probeType: 2 表示在屏幕滑动的过程</span><span style="font-size: 12pt;">实时侦测</span><span style="font-size: 12pt;">滚动的位置</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">probeType: 3 表示</span><span style="font-size: 12pt;">不仅在屏幕滑动的过程中，而且在手指离开的惯性滚动回弹动画（弹簧效果）运行过程中实时</span><span style="font-size: 12pt;">侦测</span><span style="font-size: 12pt;">滚动的位置</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [94].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [95].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">监听scroll事件 </span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">.on('scroll', function() {})</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">2、BScroll 管理的元素里面有 button 按钮元素时是监听不到的，因为 </span><span style="font-size: 12pt;">BetterScroll 默认会阻止浏览器的原生 click 事件。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以要设置 click: true。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">3、还有一个：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当列表内容滚动到最底部的时候需要实现上拉加载更多，需要在滚动到底部时马上回调一个事件请求下一页数据，然后把数据追加到 list 数组里，最后将所有数据一起展示</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以还需要使用 </span><span style="font-size: 12pt;">BetterScroll 的 上拉加载更多的功能</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">如何监听已经滚动到底部呢？</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">pullUpLoad </span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">当设置为 true 或者是一个 Object 的时候，可以开启上拉加载</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当配置项为一个 Object 时，有如下属性：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">threshold 决定开始加载的时机，类型为 Number，默认为 0</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [96].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">pullingUp 事件 </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">pullUpLoad </span><span style="font-size: 12pt; font-weight: bold;">上拉加载更多后触发，</span><span style="font-size: 12pt; font-weight: bold;">当距离滚动到底部小于 threshold 值时，触发一次 pullingUp 事件</span><span style="font-size: 12pt; font-weight: bold;">，一般用于向后端请求数据</span><span style="font-size: 12pt; font-weight: bold;">。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [97].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">pullingUp 事件执行完成后， 必须调用</span><span style="font-size: 12pt;">bscroll.finishpullUp() </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">bscroll 才知道这次的上拉加载更多做完了，使用定时器控制每次上拉加载更多请求的间隔</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [98].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Better-Scroll 在Vue项目中使用基本过程</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [99].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">首先把 better-scroll 封装到 components/common 里</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、设置滚动的高度是由开发者自己决定的</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">2、使用 document.querySelelctor('.wrapper') 时，获取的是一个 class=&quot;wrapper&quot; 的元素，当很多组件都有 </span><span style="font-size: 12pt;">class=&quot;wrapper&quot; 时，很容易获取出错，导致 </span><span style="font-size: 12pt;">better-scroll 失效</span></div><div><span style="font-size: 12pt;"> </span></div><div><span style="font-size: 12pt;">     所以为组件添加 ref=&quot;别名&quot; 更为准确，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">     ref 特性 一般绑定到组件上，那么通过 this.$ref.别名 获取一个组件对象</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">      ref 特性 </span><span style="font-size: 12pt;">如果是绑定在普通的元素中，那么通过 this.$refs.别名 获取到的是一个元素对象</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">3、因为 &lt;style scoped&gt;，即使 Home.vue 的 &lt;scroll class=&quot;content&quot;&gt; 同名，样式也不会覆盖到其他组件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第一种方案 使用 calc 与 </span></span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">margin-top </span></span><span style="font-size: 12pt; font-weight: bold;">计算滚动区域高度（即 &lt;scroll&gt; 的整体高度）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">NavBar 高度 44px + TabBar高度 49px = 93px</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [100].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第二种方案 height: 100vh 结合 position:absolute</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Scroll.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;"> <b> &lt;div class=&quot;wrapper&quot; ref=&quot;wrapper&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;div class=&quot;content&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;slot&gt;&lt;/slot&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>  &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  <b>import Bscroll from 'better-scroll'</b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Scroll',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>mounted() {</b></font></div><div><font style="font-size: 12pt;"><b>      this.scroll = new Bscroll(this.$refs.wrapper)</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;scroll class=&quot;content&quot;&gt;</b></font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;&gt;&lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;/scroll&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;"> <b> import Scroll from 'common/scroll/Scroll'</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      <b>Scroll</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop'</font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop'</font></div><div><font style="font-size: 12pt;">            break</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new'</font></div><div><font style="font-size: 12pt;">            break</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell'</font></div><div><font style="font-size: 12pt;">            break    </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #home {</font></div><div><font style="font-size: 12pt;">   <b> height: 100vh;</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    position: fixed;</font></div><div><font style="font-size: 12pt;">    top: 0;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;"><b>  .content {</b></font></div><div><font style="font-size: 12pt;"><b>    position: absolute;</b></font></div><div><font style="font-size: 12pt;"><b>    top: 44px;</b></font></div><div><font style="font-size: 12pt;"><b>    bottom: 49px;</b></font></div><div><font style="font-size: 12pt;"><b>    left: 0;</b></font></div><div><font style="font-size: 12pt;"><b>    right: 0;   </b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [101].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">BackTop 组件的封装</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">实现滚动到一定位置  显示/隐藏 回到顶部按钮的功能</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [102].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为不是原生的滚动了， better-scroll 在帮忙做滚动，但是系统无法检测滚动的位置，所以吸顶的样式效果不起作用了，之后需要重新做了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [103].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">回到顶部按钮思路</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">首先，不管滚到哪个位置先把回到按钮显示出来再说</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">之后，再决定它的显示 /隐藏</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为不仅只有首页有这个组件，其他页面（比如下方详情页）也有这个组件，所以需要封装到 components/content 里</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [104].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这个按钮里面其实就是一张小图片</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">back-top 组件不需要跟着 scroll 一起滚动，所以写在 scroll 下面</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">另外，back-top 组件的位置都一样，设置相同的位置即可</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">添加点击事件监听，实现回到顶部，但是回到顶部意味着下图框选部分回到顶部，现在的滚动都依赖 Bscroll，所以点击时需要调用 </span><span style="font-size: 12pt;">Bscroll 的</span> <span style="font-size: 12pt;">scrollTo(x, y) </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [105].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">现在要在 back-top 组件中操作 scroll 组件，但是不使用 $emit （因为比较啰嗦，麻烦）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [106].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">要在组件上进行点击，组件上是不允许直接 @click 监听点击的，所以需要使用 @click.native 才可以监听原生点击事件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">监听组件原生事件（不仅仅是 click 事件）时必须添加 .native 修饰符，才能进行监听</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">通过 this.$refs 可以直接访问该组件的数据和方法</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">出现问题： </span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">调用</span> <span style="font-size: 12pt;">this.scroll.scrollTo(x, y, time) 时无效</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">原因：#home 多了padding-top: 44px，.wrapper 即 &lt;scroll&gt;组件的高度不够，而且 position: fixed 没有写在 &lt;back-top&gt; 组件上</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">BackUp.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;back-up&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;img src=&quot;~assets/img/common/top.png&quot; alt=&quot;回到顶部&quot;&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'BackUp',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  <b>.back-up img {</b></font></div><div><font style="font-size: 12pt;"><b>    width: 43px;</b></font></div><div><font style="font-size: 12pt;"><b>    height: 43px;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Scroll.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;wrapper&quot; ref=&quot;wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;content&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;slot&gt;&lt;/slot&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import Bscroll from 'better-scroll'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Scroll',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        scroll: {}</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> methods: {</b></font></div><div><font style="font-size: 12pt;"><b>      scrollTo(x, y, time=500) {</b></font></div><div><font style="font-size: 12pt;"><b>        this.scroll.scrollTo(x, y, time)</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    mounted() {</font></div><div><font style="font-size: 12pt;">      this.scroll = new Bscroll(this.$refs.wrapper);</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; <b>ref=&quot;scroll&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;&gt;&lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">   <b> &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot;&gt;&lt;/back-up&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll'</font></div><div><font style="font-size: 12pt;">  <b>import BackUp from 'content/backUp/BackUp'</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      <b>BackUp</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop'</font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop'</font></div><div><font style="font-size: 12pt;">            break</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new'</font></div><div><font style="font-size: 12pt;">            break</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell'</font></div><div><font style="font-size: 12pt;">            break    </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      <b>backClick() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$refs.scroll.scrollTo(0, 0, 300);</b></font></div><div><font style="font-size: 12pt;"><b>      }</b>,</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #home {</font></div><div><font style="font-size: 12pt;">    height: 100vh;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    position: fixed;</font></div><div><font style="font-size: 12pt;">    top: 0;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .content {</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    top: 44px;</font></div><div><font style="font-size: 12pt;">    bottom: 49px;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;   </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  <b>.back-up {</b></font></div><div><font style="font-size: 12pt;"><b>    position: fixed;</b></font></div><div><font style="font-size: 12pt;"><b>    right: 8px;</b></font></div><div><font style="font-size: 12pt;"><b>    bottom: 55px;  </b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">效果图</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [3].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">回到顶部按钮的 显示/隐藏</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在 Better-Scroll 管理的元素中需要注意：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [107].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为 TabControl 是 div，也是需要点击的，所以添加</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Scroll.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">mounted() {</font></div><div><font style="font-size: 12pt;">  this.scroll = new Bscroll(this.$refs.wrapper, <b>{</b></font></div><div><font style="font-size: 12pt;"><b>    click:true</b></font></div><div><font style="font-size: 12pt;"><b>  }</b>);</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在 Better-Scroll 管理的元素中，</span><span style="font-size: 12pt;">除了button 元素不需要，其他元素</span><span style="font-size: 12pt;">需要监听</span><span style="font-size: 12pt;">点击时添加 </span><span style="font-size: 12pt;">click:true</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">计算机中没有黑魔法，一般出现问题首先考虑的是代码有没有问题，使用框架大部分情况不会出现问题。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">做到这里，其实还有一个图片相关的Bug没解决：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [4].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">现在，想先完成回到顶部按钮</span><span style="font-size: 12pt;">的 显示/隐藏，必然要监听滚动位置滚动了多少，达到临界值时显示，未达到临界值时默认隐藏</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">但是，注意不能在 Scroll.vue 组件中写监听事件，因为它是与项目无关的独立的公共组件，所以不能默认监听滚动，而是由开发者自己决定</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Scroll.vue</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [108].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">而设置 probeType: 3 时会实时回调下面的 scroll事件，影响性能，所以 </span><span style="font-size: 12pt;">probeType 不能写死，像下图这样的话就不会很影响性能了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [109].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">prop 是驼峰命名时， : 属性绑定的特性需要使用 - </span><span style="font-size: 12pt;">短横线分隔命名，当传入 probe-type 时，才会实时监听</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [110].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当其他组件需要时，就要把 position 位置信息给它，所以要通过 $emit 把传 position（x值 和 y值） 出去</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Scroll.vue</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [111].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [112].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">问题：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、probeType 应该写在 props 里而不是 data 里。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">2、$emit 发送事件时使用了 </span><span style="font-size: 12pt;">this.scroll.$emit('scroll', position) 而不是 </span><span style="font-size: 12pt;">this.$emit('scroll', position)，</span><span style="font-size: 12pt;">this 必须</span><span style="font-size: 12pt;">指向</span><span style="font-size: 12pt;">组件，让组件调用</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">也就是说必须是组件使用 this.</span><span style="font-size: 12pt;">$emit('scroll', position)</span><span style="font-size: 12pt;">，在对应组件中接收 @</span><span style="font-size: 12pt;">scroll=&quot;contentScroll&quot;</span><span style="font-size: 12pt;">，然后调用父组件的 </span><span style="font-size: 12pt;">contentScroll </span><span style="font-size: 12pt;">方法即可取得 position的值</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Scroll.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;wrapper&quot; ref=&quot;wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;content&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;slot&gt;&lt;/slot&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import Bscroll from 'better-scroll'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Scroll',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      probeType: {</font></div><div><font style="font-size: 12pt;">        type: Number,</font></div><div><font style="font-size: 12pt;">        default: 0</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        scroll: {}        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      scrollTo(x, y, time=500) {</font></div><div><font style="font-size: 12pt;">        this.scroll.scrollTo(x, y, time)</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted() {</font></div><div><font style="font-size: 12pt;">      this.scroll = new Bscroll(this.$refs.wrapper, <b>{</b></font></div><div><font style="font-size: 12pt;"><b>        click:true,</b></font></div><div><font style="font-size: 12pt;"><b>        probeType: this.probeType</b></font></div><div><font style="font-size: 12pt;"><b>      }</b>);</font></div><div><font style="font-size: 12pt;"><b>      this.scroll.on('scroll', position =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$emit('scroll', position)</b></font></div><div><font style="font-size: 12pt;"><b>      })</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot; <b>:probe-type=&quot;3&quot; @scroll=&quot;contentScroll&quot;&gt;</b></font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;&gt;&lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; <b>v-show=&quot;isShowBackUp&quot;</b>&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll'</font></div><div><font style="font-size: 12pt;">  import BackUp from 'content/backUp/BackUp'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      BackUp</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop',</font></div><div><font style="font-size: 12pt;">        <b>isShowBackUp: false</b></font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop'</font></div><div><font style="font-size: 12pt;">            break</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new'</font></div><div><font style="font-size: 12pt;">            break</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell'</font></div><div><font style="font-size: 12pt;">            break    </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      backClick() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, 0, 300);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      <b>contentScroll(position) {</b></font></div><div><font style="font-size: 12pt;"><b>        this.isShowBackUp = (-position.y) &gt; 1000</b></font></div><div><font style="font-size: 12pt;"><b>      }</b>,</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #home {</font></div><div><font style="font-size: 12pt;">    height: 100vh;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    position: fixed;</font></div><div><font style="font-size: 12pt;">    top: 0;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .content {</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    top: 44px;</font></div><div><font style="font-size: 12pt;">    bottom: 49px;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;   </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .back-up {</font></div><div><font style="font-size: 12pt;">    position: fixed;</font></div><div><font style="font-size: 12pt;">    right: 8px;</font></div><div><font style="font-size: 12pt;">    bottom: 55px;  </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [5].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">完成上拉加载更多</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、要做上拉加载更多，首先要监听上拉加载更多事件，但</span><span style="font-size: 12pt;">上拉加载更多</span><span style="font-size: 12pt;">不一定每个 scroll 组件都需要，比如 我的 页面就不需要</span><span style="font-size: 12pt;">上拉加载更多，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以不能把 pullUpLoad 的值 写死，最好把 </span><span style="font-size: 12pt;">pullUpLoad 作为 props 的一个属性，需要监听 pullingUp </span><span style="font-size: 12pt;">上拉事件时只需要在 scroll 组件上传值即可</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">:pull-up-load=&quot;true&quot;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><img src="10- 购物街_files/3 [113].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><span style="font-size: 12pt;">2、为了继续加载更多，必须使用 better-scroll 的 finishPullUp()，否则的话只能加载一页数据，结果只能有两页的数据。</span></div><div><br/></div><div><span style="font-size: 12pt;">      如果上拉加载更多时，一次性加载了很多数据（能不能滚都会这样），可能是 better-scroll 滚动的问题（就是上述的 Bug，什么时候会滚动，什么时候不滚动的问题）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">3、better-scroll 的 bug：不会计算图片的高度，因为程序中图片都是异步加载的，而 better-scroll 认为 wrapper 下方的箭头才是</span><span style="font-size: 12pt;">可滚动区域</span><span style="font-size: 12pt;">高度（未加载更多图片时），</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当上拉加载更多时，图片撑开</span><span style="font-size: 12pt;">可滚动区域</span><span style="font-size: 12pt;">高度，可滚动区域高度变高了，但是 </span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">better-scroll 不会重新计算</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">当后来图片加载出来的时候，</span><span style="font-size: 12pt;">better-scroll 提前认为 可滚动区域高度应该是 2000（2000 是假想的值），所以就不会再让用户滚动了，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以等图片异步加载完之后要进行一次刷新（不能把</span><span style="font-size: 12pt;">可滚动区域高度写死，因为不知道要滚动多少才够</span><span style="font-size: 12pt;">）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">正常的</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">可滚动区域</span><span style="font-size: 12pt; font-weight: bold;">高度</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [114].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">出 Bug 时的</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">可滚动区域</span><span style="font-size: 12pt; font-weight: bold;">高度</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [115].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">为什么首页有时有Bug，有时没有Bug呢？</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这由图片加载的速度决定，如果图片加载速度很快，在 better-scroll 计算之前，图片已经有了，这时 </span><span style="font-size: 12pt;">better-scroll 计算出来的高度就是正确的，否则就会出现 Bug</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">但是这无法保证图片什么时候会加载出来，所以当图片加载出来以后必须自己手动调用一下 </span><span style="font-size: 12pt;">better-scroll  的 </span><span style="font-size: 12pt;">refresh()，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">先让图片加载完，再让 </span><span style="font-size: 12pt;">better-scroll </span><span style="font-size: 12pt;">刷新一下，重新计算一下</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">可滚动区域</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">高度</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [116].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [6].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [117].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Scroll.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;wrapper&quot; ref=&quot;wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;content&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;slot&gt;&lt;/slot&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import Bscroll from 'better-scroll'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Scroll',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      probeType: {</font></div><div><font style="font-size: 12pt;">        type: Number,</font></div><div><font style="font-size: 12pt;">        default: 0</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      <b>pullUpLoad: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Boolean,</b></font></div><div><font style="font-size: 12pt;"><b>        default: false</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        scroll: {}        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      scrollTo(x, y, time=500) {</font></div><div><font style="font-size: 12pt;">        this.scroll.scrollTo(x, y, time)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      <b>finishPullUp() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.scroll.finishPullUp()</b></font></div><div><font style="font-size: 12pt;"><b>      },</b></font></div><div><font style="font-size: 12pt;"><b>      refresh() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.scroll.refresh()</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted() {</font></div><div><font style="font-size: 12pt;">      this.scroll = new Bscroll(this.$refs.wrapper, {</font></div><div><font style="font-size: 12pt;">        click:true,</font></div><div><font style="font-size: 12pt;">        probeType: this.probeType,</font></div><div><font style="font-size: 12pt;">        <b>pullUpLoad: this.pullUpLoad</b></font></div><div><font style="font-size: 12pt;">      });</font></div><div><font style="font-size: 12pt;">      this.scroll.on('scroll', position =&gt; {</font></div><div><font style="font-size: 12pt;">        this.$emit('scroll', position)</font></div><div><font style="font-size: 12pt;">      });</font></div><div><font style="font-size: 12pt;">      <b>this.scroll.on('pullingUp', () =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$emit('pullingUp')</b></font></div><div><font style="font-size: 12pt;"><b>      })</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; <b>ref=&quot;scroll&quot;</b></font></div><div><font style="font-size: 12pt;">    :probe-type=&quot;3&quot;</font></div><div><font style="font-size: 12pt;"><font>    </font><b>:pull-up-load=&quot;true&quot;</b></font></div><div><font style="font-size: 12pt;">    @scroll=&quot;contentScroll&quot;</font></div><div><font style="font-size: 12pt;">   <b> @pullingUp=&quot;loadMore&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;&gt;&lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll'</font></div><div><font style="font-size: 12pt;">  import BackUp from 'content/backUp/BackUp'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      BackUp</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop',</font></div><div><font style="font-size: 12pt;">        isShowBackUp: false</font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell';</font></div><div><font style="font-size: 12pt;">            break;   </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      backClick() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, 0, 300);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        this.isShowBackUp = (-position.y) &gt; 1000;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      <b>loadMore() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.getHomeGoods(this.currentType);</b></font></div><div><font style="font-size: 12pt;"><b>        this.$refs.scroll.refresh();</b></font></div><div><font style="font-size: 12pt;"><b>      }</b>,</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">           <b>this.$refs.scroll.finishPullUp();</b></font></div><div><font style="font-size: 12pt;">        });        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">滚动区域的 Bug 分析与解决</span></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Bug：有时候</span><span style="font-size: 12pt;">可以</span><span style="font-size: 12pt;">滚到底部，有时滚不到底部</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [118].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [119].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [120].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第一种方案（太麻烦）：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">GoodListItem $emit =&gt; GoodsList $emit =&gt; Home</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第二种方案：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">利用 Vuex 作为中间的通信</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">图片一加载完，</span><span style="font-size: 12pt;">GoodListItem.vue </span><span style="font-size: 12pt;">就使用 this.$store 改变 Vuex 的属性，Home.vue 引用 </span><span style="font-size: 12pt;">Vuex 的属性并且实时监听 </span><span style="font-size: 12pt;">Vuex 的属性的改变，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">一旦</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">Vuex 的属性发生变化，就执行 this.$refs.scroll.scroll.refresh()</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [121].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">第三种方案：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">事件总线 EventBus，它是管理事件的，不像 Vuex，Vuex是管理状态的</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [122].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [123].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">等组件创建完就开始监听了，因为图片的 onload 是异步加载的，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">但是注意：不能在 created 生命周期函数中获取 </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">this.$refs.scroll 这个 dom 元素</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">简单理解（详情见 Vue 入门）</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">created 生命周期函数： data 和 methods 初始化好了，template还没有初始化好。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">mounted </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">生命周期函数：</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">data 、methods 和 </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">template 都</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">初始化好了。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">main.js</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">import App from './App.vue'</font></div><div><font style="font-size: 12pt;">import router from './router'</font></div><div><font style="font-size: 12pt;">import store from './store'</font></div><div><font style="font-size: 12pt;">Vue.config.devtools = true;</font></div><div><font style="font-size: 12pt;">Vue.config.productionTip = false</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><b>Vue.prototype.$bus = new Vue()</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">new Vue({</font></div><div><font style="font-size: 12pt;">  router,</font></div><div><font style="font-size: 12pt;">  store,</font></div><div><font style="font-size: 12pt;">  render: h =&gt; h(App)</font></div><div><font style="font-size: 12pt;">}).$mount('#app')</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">GoodsItem.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;goods-item&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;img :src=&quot;goodsItem.show.img&quot; <b>@load=&quot;imgLoad&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;goods-info&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;p&gt;{{goodsItem.title}}&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;price&quot;&gt;{{goodsItem.price}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;collect&quot;&gt;{{goodsItem.cfav}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'GoodsItem',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      goodsItem: {</font></div><div><font style="font-size: 12pt;">        type: Object,</font></div><div><font style="font-size: 12pt;">        default() {</font></div><div><font style="font-size: 12pt;">          return {}</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">     <b> imgLoad() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$bus.$emit('itemImgLoad')</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot;</font></div><div><font style="font-size: 12pt;">    :probe-type=&quot;3&quot;</font></div><div><font style="font-size: 12pt;">    :pull-up-load=&quot;true&quot;</font></div><div><font style="font-size: 12pt;">    @scroll=&quot;contentScroll&quot;</font></div><div><font style="font-size: 12pt;">    @pullingUp=&quot;loadMore&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;&gt;&lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll'</font></div><div><font style="font-size: 12pt;">  import BackUp from 'content/backUp/BackUp'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      BackUp</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop',</font></div><div><font style="font-size: 12pt;">        isShowBackUp: false</font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> </b>created() {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>mounted() {</b></font></div><div><font style="font-size: 12pt;"><b><font>      </font>this.$bus.$on('itemImgLoad', () =&gt; this.$refs.scroll.refresh())</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell';</font></div><div><font style="font-size: 12pt;">            break;   </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      backClick() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, 0, 300);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        this.isShowBackUp = (-position.y) &gt; 1000;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      loadMore() {</font></div><div><font style="font-size: 12pt;">        this.getHomeGoods(this.currentType);</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">           this.$refs.scroll.finishPullUp();</font></div><div><font style="font-size: 12pt;">        });        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [7].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">refresh 函数找不到的 bug 处理</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为图片加载得太快，scroll.vue 的 mounted 生命周期函数的 new Bscroll() 还没有初始化，this.scroll 为 undefined，调用 undefined.refresh() 造成错误</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [124].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">逻辑与 前面为 false 后面的都不执行，用于判断是否有值</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当 </span><span style="font-size: 12pt;">this.scroll 初始化有值之后再执行后面的方法</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [125].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第二：不要在 created 生命周期函数中 获取 </span><span style="font-size: 12pt;">this.$refs.scroll</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">刷新频繁的防抖函数处理</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">this.$bus.$on('itemImgLoad', () =&gt; this.$refs.scroll.refresh())</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">refresh() 会调用得非常频繁，但是比如说我们希望一秒内多次调用的话就只调用一次就可以了，如果下一秒还有调用就要等一下才可以继续调用</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">常见的防抖应用：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在搜索框中输入一个字母就在下拉框中显示结果，持续向服务器发送请求，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这种情况下用户输入速度非常快的话，对服务器压力很大，服务器</span><span style="font-size: 12pt;">处理数据太多次，而用户只是想要一个单词的结果而已</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以</span><span style="font-size: 12pt;">当用户输入 yifu 时就发送四次请求是没有必要的，要进行防抖操作</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [126].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">防抖：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当用户输入 y 时，先不发送请求而是等待 500ms，看用户会不会继续输入，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果继续输入就把上次的请求取消掉，如果输入完了，等待 500ms后没有继续输入，再把 yifu 整体发送给服务器，让服务器返回相关结果，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">只在最后发送一次请求，</span><span style="font-size: 12pt;">这就防止了单位时间内连续向服务器发送请求</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">如何进行防抖操作：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">封装一个函数，让执行</span> <span style="font-size: 12pt;">this.$refs.scroll.refresh() </span><span style="font-size: 12pt;">函数前搞一个定时器，先在定时器里等一会，不要进行下一步操作，等单位时间内没有进行这个操作时才执行</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">必须使用 timer 记录有没有定时器</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">debounce(func, delay) {</font></div><div><font style="font-size: 12pt;">  let timer = null;</font></div><div><font style="font-size: 12pt;">  return function(...args) {</font></div><div><font style="font-size: 12pt;">    if(timer) clearTimeout(timer);</font></div><div><font style="font-size: 12pt;">    timer = setTimeout(() =&gt; {</font></div><div><font style="font-size: 12pt;">      func.apply(this, args);</font></div><div><font style="font-size: 12pt;">    }, delay)</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">const refresh = this.debounce(this.$refs.scroll.refresh, 50);</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [127].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、第一次 </span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">this.$bus.$on('itemImgLoad', refresh)</font></div></div><div><br/></div><div><span style="font-size: 12pt;">执行 refresh 的时候 timer 为 null，所以不执行下面这行</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">if (timer) clearTimeout(timer)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">2、然后先不执行</span> <span style="font-size: 12pt;">refresh ，而是</span><span style="font-size: 12pt;">延迟 delay ms ，但是在延迟 delay ms 的过程中，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">this.$bus.$on('itemImgLoad', refresh)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">又会调用一次 refresh，所以第二次执行 refresh</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">timer 不为 null，执行</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">clearTimeout(timer)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">清空了上一次的定时器</span><span style="font-size: 12pt;">也就是清空了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">timer = setTimeOut(() =&gt; func.apply(this, args), delay)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">然后又来这里等待</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">timer = setTimeOut(() =&gt; func.apply(this, args), delay)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">3、以此类推，等到最后一次（如第30次）时，会取消掉第 29 次的 refresh，然后等到延迟时间之后才会执行一次 refresh</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在 refresh() 中打印即可测试效果</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [128].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot;</font></div><div><font style="font-size: 12pt;">    :probe-type=&quot;3&quot;</font></div><div><font style="font-size: 12pt;">    :pull-up-load=&quot;true&quot;</font></div><div><font style="font-size: 12pt;">    @scroll=&quot;contentScroll&quot;</font></div><div><font style="font-size: 12pt;">    @pullingUp=&quot;loadMore&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;&gt;&lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll'</font></div><div><font style="font-size: 12pt;">  import BackUp from 'content/backUp/BackUp'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      BackUp</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop',</font></div><div><font style="font-size: 12pt;">        isShowBackUp: false</font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created() {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;"><b>    mounted() {</b></font></div><div><font style="font-size: 12pt;"><b>      const refresh = this.debounce(this.$refs.scroll.refresh, 50);</b></font></div><div><font style="font-size: 12pt;"><b>      this.$bus.$on('itemImgLoad', () =&gt; refresh());</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell';</font></div><div><font style="font-size: 12pt;">            break;   </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      backClick() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, 0, 300);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        this.isShowBackUp = (-position.y) &gt; 1000;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      loadMore() {</font></div><div><font style="font-size: 12pt;">        this.getHomeGoods(this.currentType);</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      <b>debounce(func, delay) {</b></font></div><div><font style="font-size: 12pt;"><b>        let timer = null;</b></font></div><div><font style="font-size: 12pt;"><b>        return function(...args) {</b></font></div><div><font style="font-size: 12pt;"><b>          if(timer) clearTimeout(timer);</b></font></div><div><font style="font-size: 12pt;"><b>          timer = setTimeout(() =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>            func.apply(this, args);</b></font></div><div><font style="font-size: 12pt;"><b>          }, delay)</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b>,</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">           this.$refs.scroll.finishPullUp();</font></div><div><font style="font-size: 12pt;">        });        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [129].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">...args 意味着传入所有的参数，args是使用所有的参数</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">this.$bus.$on('itemImgLoad', refresh)  refresh 执行很快的话， delay 都没写也会立马 </span><span style="font-size: 12pt;">clearTimeout(timer)，有一点防抖的效果，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">相当于</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">setTimeOut(() =&gt; {}, 0)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">setTimeOut 是同步任务执行完立即执行的异步</span><span style="font-size: 12pt;">宏任务</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">封装 debounce 到 util.js</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [130].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">为了代码更加严谨，可添加</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [131].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">出现问题：</span><span style="font-size: 12pt; font-weight: bold;">props 为驼峰命名时必须使用短横线命名且是在大写字母前加（之前为 </span><span style="font-size: 12pt; font-weight: bold;">:pull-upload=&quot;true&quot;</span><span style="font-size: 12pt; font-weight: bold;">）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">props: {</font></div><div><font style="font-size: 12pt;">  probeType: {</font></div><div><font style="font-size: 12pt;">    type: Number,</font></div><div><font style="font-size: 12pt;">    default: 0</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  pullUpLoad: {</font></div><div><font style="font-size: 12pt;">    type: Boolean,</font></div><div><font style="font-size: 12pt;">    default: false</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">:pull-up-load=&quot;true&quot;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">tabControl 的 offsetTop 获取分析</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">首页做完之后，还剩一个功能： tabControl 的吸顶效果</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以必须知道滚动到多少距离时，开始有吸顶效果，那么就要获取 </span><span style="font-size: 12pt;">tabControl 的 offsetTop</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">问题：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">不能在组件上直接获取 offsetTop，因为 this.$refs.tabConrol 获取的是组件对象，所以打印出 undefined</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [132].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">解决： </span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">通过 this.$refs</span><span style="font-size: 12pt;">.tabConrol.$el 获取元素，但是打印过后就会发现 offsetTop 是错的，因为 </span><span style="font-size: 12pt;">mounted() 时图片还没加载完， offsetTop </span><span style="font-size: 12pt;">不包含图片的高度，它的值非常小</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以必须监听图片加载完再获取 </span><span style="font-size: 12pt;">offsetTop，图片加载过程中经测试发现轮播图加载是最慢的，监听轮播图加载完再获取 </span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">offsetTop 即可，</span></div><div><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12pt;"><br/></span></div><div><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">但是轮播图会加载 4 次，所以要限制 $emit('swiperImageLoad') 的次数（这里没有必要使用防抖，因为这里相当于 y ifu，输入 y 时就不再发送事件，而防抖则是等待输入完整）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [133].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">注意问题：1、哪个组件 $emit，就在哪个组件上接收 2、data() 必须 return {}</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">监听滚动，动态地改变 tabControl</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">之前已经设置了监听首页滚动事件 contentScroll，所以要在  </span><span style="font-size: 12pt;">contentScroll 里决定</span> <span style="font-size: 12pt;">tabControl </span><span style="font-size: 12pt;">是否吸顶（position: fixed）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [134].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [135].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [136].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第一个问题：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">由下图可以看出图片会往上跑一下，因为原来布局的 t</span><span style="font-size: 12pt;">abControl 是顶着图片的，现在 tabControl 脱标了，下面的图片自然会在滚动距离超过 545时，突然往上跑一下</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [8].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">第二个问题：tabControl 不见了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [137].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">原因：better-scroll 使用了 transform: translate(0px, -500px) 来滚动的，而 tabControl 使用 fixed 定位时受其影响，位置发生了改变，已经在页面最上方，所以看不见</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [9].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以 fixed吸顶方案不可行</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">另一个方案</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">拷贝多一个 tab-control 组件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [138].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">tabControl 会被 nav-bar 挡住</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [139].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第一种方法：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">better-scroll 对 .content 区域使用了局部滚动，那么 nav-bar 即使不设置 fixed 定位也不会随页面滚动而滚动，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为 .content 与 nav-bar 相当于是分隔的，</span><span style="font-size: 12pt;">nav-bar </span><span style="font-size: 12pt;">不受影响（</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">这里说错了，事实并非如此，还是得设置 z-index</span><span style="font-size: 12pt;">）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">.nav {</font></div><div><font style="font-size: 12pt;">  background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">  color: #fff;</font></div><div><font style="font-size: 12pt;">  <b>position: relative;</b></font></div><div><font style="font-size: 12pt;"><b>  z-index: 1;</b></font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [140].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">取消 fixed 定位后，</span><span style="font-size: 12pt;">第一个 tabControl 组件（代码在上面的） </span><span style="font-size: 12pt;">自然会在 nav-bar 组件下面</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [141].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第二种方法：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">对第一个 tabControl 组件（代码在上面的）设置 margin-top 形成吸顶效果</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">然后：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><img src="10- 购物街_files/3 [142].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><span style="font-size: 12pt;">只要实现滚到</span><span style="font-size: 12pt;">第二个 tabControl 组件时</span><span style="font-size: 12pt;">第一个 tabControl 组件覆盖它，滚上去时隐藏</span><span style="font-size: 12pt;">第一个 tabControl 组件即可</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以很多动画都是假象，都是给用户看的，动画做完会移除掉的</span></div><div><br/></div><div><img src="10- 购物街_files/3 [10].gif" type="image/gif" data-filename="3.gif"/></div><div><br/></div><div><img src="10- 购物街_files/3 [143].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">还有一个问题：首页 </span><span style="font-size: 12pt;">tabControl 不一致</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">首页滚动时 Tab 会切换，因为第一个 tabControl 组件仍然显示的是流行 ，两个 tabControl 组件没有保持一致</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [11].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [144].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [145].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">问题： </span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、.fixed 吸顶样式设置 z-index，却只有文字覆盖图片，原因是没有背景颜色</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">2、之前 scroll.vue 中加了 </span><span style="font-size: 12pt;">if (this.pullUpLoad) 导致上拉加载更多时出错，所以去除 </span><span style="font-size: 12pt;">if (this.pullUpLoad) ，变成</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">this.scroll.on('pullingUp', () =&gt; {</font></div><div><font style="font-size: 12pt;">  this.$emit('pullingUp')</font></div><div><font style="font-size: 12pt;">});</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">HomeSwiper.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;swiper&gt;</font></div><div><font style="font-size: 12pt;">    &lt;swiper-item v-for=&quot;(item, index) in banner&quot; :key=&quot;index&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;a :href=&quot;item.link&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;img :src=&quot;item.image&quot; <b>@load=&quot;swiperImageLoad&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/a&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/swiper-item&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/swiper&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import {Swiper, SwiperItem} from 'common/swiper/index.js'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'HomeSwiper',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      banner: {</font></div><div><font style="font-size: 12pt;">        type: Array,</font></div><div><font style="font-size: 12pt;">        default() {</font></div><div><font style="font-size: 12pt;">          return []</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> data() {</b></font></div><div><font style="font-size: 12pt;"><b>      return {</b></font></div><div><font style="font-size: 12pt;"><b>        isImageLoad: false,</b></font></div><div><font style="font-size: 12pt;"><b>      }     </b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      <b>swiperImageLoad() {</b></font></div><div><font style="font-size: 12pt;"><b>        if (!this.isImageLoad) {</b></font></div><div><font style="font-size: 12pt;"><b>          this.$emit('swiperImageLoad')</b></font></div><div><font style="font-size: 12pt;"><b>          this.isImageLoad = true;</b></font></div><div><font style="font-size: 12pt;"><b>        }      </b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      Swiper,</font></div><div><font style="font-size: 12pt;">      SwiperItem</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;nav-bar class=&quot;nav&quot;&gt;</b></font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;</b></font></div><div><font style="font-size: 12pt;"><b>                 class=&quot;fixed&quot; v-show=&quot;isTabFixed&quot;  ref=&quot;tabControl1&quot;&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot;</font></div><div><font style="font-size: 12pt;">            ref=&quot;scroll&quot;</font></div><div><font style="font-size: 12pt;">            :probe-type=&quot;3&quot;</font></div><div><font style="font-size: 12pt;">            :pull-up-load=&quot;true&quot;</font></div><div><font style="font-size: 12pt;">            @scroll=&quot;contentScroll&quot;</font></div><div><font style="font-size: 12pt;">            @pullingUp=&quot;loadMore&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot; <b>@swiperImageLoad=&quot;swiperImageLoad&quot;</b>&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot;  </font></div><div><font style="font-size: 12pt;">                   @tabClick=&quot;tabClick&quot;</font></div><div><font style="font-size: 12pt;">                   <b>ref=&quot;tabControl2&quot;</b> &gt;</font></div><div><font style="font-size: 12pt;">      &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll'</font></div><div><font style="font-size: 12pt;">  import BackUp from 'content/backUp/BackUp'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home'</font></div><div><font style="font-size: 12pt;">  import {debounce} from 'commonjs/utils.js'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      BackUp</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop',</font></div><div><font style="font-size: 12pt;">        isShowBackUp: false,</font></div><div><font style="font-size: 12pt;">       <b> tabOffsetTop: 0,</b></font></div><div><font style="font-size: 12pt;"><b>        isTabFixed: false</b></font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created() {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted() {</font></div><div><font style="font-size: 12pt;">      const refresh = debounce(this.$refs.scroll.refresh, 50);</font></div><div><font style="font-size: 12pt;">      this.$bus.$on('itemImgLoad', () =&gt; refresh());</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell';</font></div><div><font style="font-size: 12pt;">            break;   </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        <b>this.$refs.tabControl1.currentIndex = index;</b></font></div><div><font style="font-size: 12pt;"><b>        this.$refs.tabControl2.currentIndex = index;</b></font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      backClick() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, 0, 300);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">     <b> contentScroll(position) {</b></font></div><div><font style="font-size: 12pt;">        this.isShowBackUp = (-position.y) &gt; 1000;</font></div><div><font style="font-size: 12pt;">        <b>this.isTabFixed = (-position.y) &gt; this.tabOffsetTop;</b></font></div><div><font style="font-size: 12pt;">      <b>},</b></font></div><div><font style="font-size: 12pt;">      loadMore() {</font></div><div><font style="font-size: 12pt;">        this.getHomeGoods(this.currentType);</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">    <b>  swiperImageLoad() {       </b></font></div><div><font style="font-size: 12pt;"><b>        this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;      </b></font></div><div><font style="font-size: 12pt;"><b>      }</b>,</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">           this.$refs.scroll.finishPullUp();</font></div><div><font style="font-size: 12pt;">        });        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #home {</font></div><div><font style="font-size: 12pt;">    height: 100vh;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  <b>.nav {</b></font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">   <b> position: relative;</b></font></div><div><font style="font-size: 12pt;"><b>    z-index: 1;</b></font></div><div><font style="font-size: 12pt;">  <b>}</b></font></div><div><font style="font-size: 12pt;">  .content {</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    top: 44px;</font></div><div><font style="font-size: 12pt;">    bottom: 49px;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;   </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .back-up {</font></div><div><font style="font-size: 12pt;">    position: fixed;</font></div><div><font style="font-size: 12pt;">    right: 8px;</font></div><div><font style="font-size: 12pt;">    bottom: 55px;  </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  <b>.fixed {</b></font></div><div><font style="font-size: 12pt;"><b>    position: fixed;</b></font></div><div><font style="font-size: 12pt;"><b>    top: 44px;</b></font></div><div><font style="font-size: 12pt;"><b>    left: 0;</b></font></div><div><font style="font-size: 12pt;"><b>    right: 0;   </b></font></div><div><font style="font-size: 12pt;"><b>    z-index: 1;</b></font></div><div><font style="font-size: 12pt;"><b>    background-color: #fff;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [12].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果想首页</span><span style="font-size: 12pt;">默认</span><span style="font-size: 12pt;">选中的是流行，可以这么做：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [146].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [147].jpg" type="image/jpeg" data-filename="3.jpg" width="863"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [148].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home 离开时记录状态和位置</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当从首页跳到分类页时，回到首页时应该停留在原来的位置，但是首页会 destroy 销毁，也就是说每次进入首页都会重新创建首页，不会</span><span style="font-size: 12pt;">停留在原来的位置</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [149].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [150].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">使用 &lt;keep-alive&gt; 阻止页面销毁，但是 beeter-scroll 使得首页无法保留原来的位置</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [151].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">问题：应该先 refresh() 再 scrollTo()</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [152].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">每次进入首页滚动到指定位置时都需要 refresh()，否则会出 Bug（</span><span style="font-size: 12pt;">突然回到顶部</span><span style="font-size: 12pt;">）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当 this.scroll 有值时才去取 this.scroll.y，没有值就取默认的 0。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [153].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">跳转到详情页并携带 id</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [154].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">一个商品就是一个 GoodListItem，要跳转到详情页必须先监听 </span><span style="font-size: 12pt;">GoodListItem 的点击</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">新建组件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [155].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">配置路由</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [156].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [157].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">路由使用 push 到时候可以使用 back 直接返回</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [158].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">点击时切换到 Detail 并传递参数 iid</span></div><div><br/></div><div><img src="10- 购物街_files/3 [159].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">给路由传递参数</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [160].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为要在详情页拿到 id 发送网络请求，所以需要存储 id</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [161].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">详情页导航栏的封装</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [162].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;</font></div><div><font style="font-size: 12pt;">                 class=&quot;fixed&quot; v-show=&quot;isTabFixed&quot;  ref=&quot;tabControl1&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot;</font></div><div><font style="font-size: 12pt;">            ref=&quot;scroll&quot;</font></div><div><font style="font-size: 12pt;">            :probe-type=&quot;3&quot;</font></div><div><font style="font-size: 12pt;">            :pull-up-load=&quot;true&quot;</font></div><div><font style="font-size: 12pt;">            @scroll=&quot;contentScroll&quot;</font></div><div><font style="font-size: 12pt;">            @pullingUp=&quot;loadMore&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot; @swiperImageLoad=&quot;swiperImageLoad&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot;  </font></div><div><font style="font-size: 12pt;">                   @tabClick=&quot;tabClick&quot;</font></div><div><font style="font-size: 12pt;">                   ref=&quot;tabControl2&quot; &gt;</font></div><div><font style="font-size: 12pt;">      &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper'</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend'</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl'</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList'</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll'</font></div><div><font style="font-size: 12pt;">  import BackUp from 'content/backUp/BackUp'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home'</font></div><div><font style="font-size: 12pt;">  import {debounce} from 'commonjs/utils.js'</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      BackUp</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop',</font></div><div><font style="font-size: 12pt;">        isShowBackUp: false,</font></div><div><font style="font-size: 12pt;">        tabOffsetTop: 0,</font></div><div><font style="font-size: 12pt;">        isTabFixed: false,</font></div><div><font style="font-size: 12pt;">        scrollY: 0</font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created() {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted() {</font></div><div><font style="font-size: 12pt;">      const refresh = debounce(this.$refs.scroll.refresh, 50);</font></div><div><font style="font-size: 12pt;">      this.$bus.$on('itemImgLoad', () =&gt; refresh());</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>activated () {</b></font></div><div><font style="font-size: 12pt;"><b>      this.$refs.scroll.refresh();</b></font></div><div><font style="font-size: 12pt;"><b>      this.$refs.scroll.scrollTo(0, this.scrollY, 0);     </b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    deactivated () {</b></font></div><div><font style="font-size: 12pt;"><b>      this.scrollY = this.$refs.scroll.getScrollY();</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell';</font></div><div><font style="font-size: 12pt;">            break;   </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        this.$refs.tabControl1.currentIndex = index;</font></div><div><font style="font-size: 12pt;">        this.$refs.tabControl2.currentIndex = index;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      backClick() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, 0, 300);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        this.isShowBackUp = (-position.y) &gt; 1000;</font></div><div><font style="font-size: 12pt;">        this.isTabFixed = (-position.y) &gt; this.tabOffsetTop;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      loadMore() {</font></div><div><font style="font-size: 12pt;">        this.getHomeGoods(this.currentType);</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      swiperImageLoad() {       </font></div><div><font style="font-size: 12pt;">        this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;      </font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">           this.$refs.scroll.finishPullUp();</font></div><div><font style="font-size: 12pt;">        });        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">GoodsItem.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;goods-item&quot; <b>@click=&quot;itemClick&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">    &lt;img :src=&quot;goodsItem.show.img&quot; @load=&quot;imgLoad&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;goods-info&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;p&gt;{{goodsItem.title}}&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;price&quot;&gt;{{goodsItem.price}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;collect&quot;&gt;{{goodsItem.cfav}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'GoodsItem',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      goodsItem: {</font></div><div><font style="font-size: 12pt;">        type: Object,</font></div><div><font style="font-size: 12pt;">        default() {</font></div><div><font style="font-size: 12pt;">          return {}</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      imgLoad() {</font></div><div><font style="font-size: 12pt;">        this.$bus.$emit('itemImgLoad')</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      <b>itemClick() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$router.push('/detail/' + this.goodsItem.iid)</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;nav-bar&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;div slot=&quot;left&quot; class=&quot;back&quot; @click=&quot;backClick&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>        &lt;img src=&quot;~assets/img/common/back.svg&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;div slot=&quot;center&quot; class=&quot;title&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>        &lt;div class=&quot;item&quot; :class=&quot;{active: index === currentIndex}&quot;</b></font></div><div><font style="font-size: 12pt;"><b>             @click=&quot;tabClick(index)&quot; v-for=&quot;(item, index) of title&quot; :key=&quot;index&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>          {{item}}</b></font></div><div><font style="font-size: 12pt;"><b>        &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/nav-bar&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  <b>import NavBar from 'common/navbar/NavBar'</b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        <b>iid: null,</b></font></div><div><font style="font-size: 12pt;"><b>        title: ['商品', '详情', '评论', '推荐'],</b></font></div><div><font style="font-size: 12pt;"><b>        currentIndex: 0</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      <b>tabClick(index) {</b></font></div><div><font style="font-size: 12pt;"><b>        this.currentIndex = index</b></font></div><div><font style="font-size: 12pt;"><b>      },</b></font></div><div><font style="font-size: 12pt;"><b>      backClick() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$router.back();</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>created () {</b></font></div><div><font style="font-size: 12pt;"><b>      this.iid = this.$route.params.iid</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    components: {</b></font></div><div><font style="font-size: 12pt;"><b>      NavBar</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;"><b>  .back img {</b></font></div><div><font style="font-size: 12pt;"><b>    margin-top: 12px;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>  .title {</b></font></div><div><font style="font-size: 12pt;"><b>    display: flex;   </b></font></div><div><font style="font-size: 12pt;"><b>    font-size: 12px;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>  .item {</b></font></div><div><font style="font-size: 12pt;"><b>    flex: 1;</b></font></div><div><font style="font-size: 12pt;"><b>    text-align: center;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>  .active {</b></font></div><div><font style="font-size: 12pt;"><b>    color: var(--color-tint)</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在 &lt;div&gt;上监听点击，而不是在 &lt;img&gt; 上监听点击，因为 &lt;div&gt; 监听的范围会更大</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">发现Bug：第一次刷新时，无法滚动到底部，tabControl1 也不见了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">数据请求与轮播图展示</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [163].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">有些公司会有详细的接口文档，有些公司则没有（不一定会</span><span style="font-size: 12pt;">具体</span><span style="font-size: 12pt;">解释内部数据，需要自己找）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [164].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [165].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [166].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [167].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为封装的组件使用了 querySelector('.swiper')，所以不能取名为 swiper</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [168].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [169].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">问题：每次进入详情页，轮播图数据不变</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">exclude=&quot;Detail&quot; 之后还要</span><span style="font-size: 12pt;">给Detail组件的路由取name=&quot;Detail'&quot;</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [170].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">index.js</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from &quot;vue&quot;</font></div><div><font style="font-size: 12pt;">import VueRouter from &quot;vue-router&quot;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.use(VueRouter)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const Home = () =&gt; import(&quot;views/home/Home&quot;)</font></div><div><font style="font-size: 12pt;">const Category = () =&gt; import(&quot;views/category/Category&quot;)</font></div><div><font style="font-size: 12pt;">const Cart = () =&gt; import(&quot;views/cart/Cart&quot;)</font></div><div><font style="font-size: 12pt;">const Profile = () =&gt; import(&quot;views/profile/Profile&quot;)</font></div><div><font style="font-size: 12pt;"><b>const Detail = () =&gt; import(&quot;views/detail/Detail&quot;)</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const routes = [</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: &quot;&quot;,</font></div><div><font style="font-size: 12pt;">    redirect: &quot;/home&quot;,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: &quot;/home&quot;,</font></div><div><font style="font-size: 12pt;">    component: Home,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: &quot;/category&quot;,</font></div><div><font style="font-size: 12pt;">    component: Category,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: &quot;/cart&quot;,</font></div><div><font style="font-size: 12pt;">    component: Cart,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: &quot;/profile&quot;,</font></div><div><font style="font-size: 12pt;">    component: Profile,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;"> <b> {</b></font></div><div><font style="font-size: 12pt;"><b>    path: &quot;/detail/:iid&quot;,</b></font></div><div><font style="font-size: 12pt;"><b>    component: Detail,</b></font></div><div><font style="font-size: 12pt;"><b>    name: 'Detail'</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">]</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const router = new VueRouter({</font></div><div><font style="font-size: 12pt;">  mode: &quot;history&quot;,</font></div><div><font style="font-size: 12pt;">  base: process.env.BASE_URL,</font></div><div><font style="font-size: 12pt;">  routes,</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default router</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DetailNavBar.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  <b>&lt;nav-bar&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;div slot=&quot;left&quot; class=&quot;back&quot; @click=&quot;backClick&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;img src=&quot;~assets/img/common/back.svg&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;div slot=&quot;center&quot; class=&quot;title&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;div class=&quot;item&quot; :class=&quot;{active: index === currentIndex}&quot;</b></font></div><div><font style="font-size: 12pt;"><b>            @click=&quot;tabClick(index)&quot; v-for=&quot;(item, index) of title&quot; :key=&quot;index&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>        {{item}}</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>  &lt;/nav-bar&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  <b>import NavBar from 'common/navbar/NavBar'</b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    <b>name: 'DetailNavBar'</b>,</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">       <b> title: ['商品', '详情', '评论', '推荐'],</b></font></div><div><font style="font-size: 12pt;"><b>        currentIndex: 0</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">     <b> tabClick(index) {</b></font></div><div><font style="font-size: 12pt;"><b>        this.currentIndex = index</b></font></div><div><font style="font-size: 12pt;"><b>      },</b></font></div><div><font style="font-size: 12pt;"><b>      backClick() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$router.back();</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      <b>NavBar</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  <b>.back img {</b></font></div><div><font style="font-size: 12pt;"><b>    margin-top: 12px;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>  .title {</b></font></div><div><font style="font-size: 12pt;"><b>    display: flex;   </b></font></div><div><font style="font-size: 12pt;"><b>    font-size: 12px;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>  .item {</b></font></div><div><font style="font-size: 12pt;"><b>    flex: 1;</b></font></div><div><font style="font-size: 12pt;"><b>    text-align: center;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>  .active {</b></font></div><div><font style="font-size: 12pt;"><b>    color: var(--color-tint)</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">对子元素使用 flex: 1;</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">detail.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;"><b>import {request} from './request';</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;"><b>export function getDetailData(iid) {</b></font></div><div><font style="font-size: 12pt;"><b>  return request({</b></font></div><div><font style="font-size: 12pt;"><b>    url: '/detail',</b></font></div><div><font style="font-size: 12pt;"><b>    params: {</b></font></div><div><font style="font-size: 12pt;"><b>      iid</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;"><b>  })</b></font></div><div><font style="font-size: 12pt;"><b>}</b></font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;detail-nav-bar&gt;&lt;/detail-nav-bar&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"> <b> import DetailNavBar from './childCpns/DetailNavBar';</b></font></div><div><font style="font-size: 12pt;"><b>  import DetailSwiper from './childCpns/DetailSwiper';</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;"><b>  import {getDetailData} from 'network/detail';</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">       <b> iid: null,</b></font></div><div><font style="font-size: 12pt;"><b>        topImages: []</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">     <b> this.iid = this.$route.params.iid;</b></font></div><div><font style="font-size: 12pt;"><b>      getDetailData(this.iid).then(res =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>        this.topImages = res.result.itemInfo.topImages</b></font></div><div><font style="font-size: 12pt;"><b>      })</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">    <b>  DetailNavBar,</b></font></div><div><font style="font-size: 12pt;"><b>      DetailSwiper</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DetailSwiper.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;"> <b> &lt;swiper class=&quot;detail-swiper&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;swiper-item v-for=&quot;(item, index) of topImages&quot; :key=&quot;index&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;img :src=&quot;item&quot; alt=&quot;detail images&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/swiper-item&gt;</b></font></div><div><font style="font-size: 12pt;"><b>  &lt;/swiper&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  <b>import {Swiper, SwiperItem} from 'common/swiper'</b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'DetailSwiper',</font></div><div><font style="font-size: 12pt;">   <b> props:{</b></font></div><div><font style="font-size: 12pt;"><b>      topImages: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Array,</b></font></div><div><font style="font-size: 12pt;"><b>        default() {</b></font></div><div><font style="font-size: 12pt;"><b>          return []</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    <b>components: {</b></font></div><div><font style="font-size: 12pt;"><b>      Swiper,</b></font></div><div><font style="font-size: 12pt;"><b>      SwiperItem</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  <b>.detail-swiper {</b></font></div><div><font style="font-size: 12pt;"><b>    height: 300px;</b></font></div><div><font style="font-size: 12pt;"><b>    overflow: hidden;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [13].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">商品基本信息的展示</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [171].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">要想展示数据首先要获取该部分数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [172].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">商品基本信息要封装成一个独立的组件，那么就要先把用到的数据抽离出去再交给 DetailBaseInfo 组件展示</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">给组件传数据的时候要尽量先整合好（数据杂乱无章也无所谓，真实数据一般都这一块那一块的，所以要做的只是整合）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">思想：把杂乱无章的数据封装到 class Goods 里最后整合成一个对象 goods （只有我们想要的数据，有规律的数据）再做展示</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">detail.js</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import {request} from './request';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export function getDetailData(iid) {</font></div><div><font style="font-size: 12pt;">  return request({</font></div><div><font style="font-size: 12pt;">    url: '/detail',</font></div><div><font style="font-size: 12pt;">    params: {</font></div><div><font style="font-size: 12pt;">      iid</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export class Goods {</font></div><div><font style="font-size: 12pt;">  constructor(itemInfo, columns, services) {</font></div><div><font style="font-size: 12pt;">    this.title = itemInfo.title;</font></div><div><font style="font-size: 12pt;">    this.desc = itemInfo.desc;</font></div><div><font style="font-size: 12pt;">    this.newPrice = itemInfo.price;</font></div><div><font style="font-size: 12pt;">    this.oldPrice = itemInfo.oldPrice;</font></div><div><font style="font-size: 12pt;">    this.discount = itemInfo.discountDesc;</font></div><div><font style="font-size: 12pt;">    this.columns = columns;</font></div><div><font style="font-size: 12pt;">    this.services = services;</font></div><div><font style="font-size: 12pt;"><font>    </font>this.lowNowPrice = itemInfo.lowNowPrice;</font></div><div><font style="font-size: 12pt;">    this.nowPrice = itemInfo.highNowPrice;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [173].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-nav-bar&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"> <b> </b>import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;"><b>  import DetailBaseInfo from './childCpns/DetailBaseInfo';</b></font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods} from 'network/detail';</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {}</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        const data =  res.result;</font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        <b>this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services)</b></font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">     <b> DetailBaseInfo</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [174].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DetailBaseInfo.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div <b>v-if=&quot;Object.keys(goods).length !== 0&quot;</b> class=&quot;base-info&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;info-title&quot;&gt;{{goods.title}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;info-price&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;n-price&quot;&gt;{{goods.newPrice}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;o-price&quot;&gt;{{goods.oldPrice}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;discount&quot;&gt;{{goods.discount}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;info-other&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span&gt;{{goods.columns[0]}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span&gt;{{goods.columns[1]}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span&gt;{{goods.services[goods.services.length-1].name}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;info-service&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;info-service-item&quot; <b>v-for=&quot;index in goods.services.length-1&quot;</b> :key=&quot;index&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;img :src=&quot;goods.services[index-1].icon&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;span&gt;{{goods.services[index-1].name}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: &quot;DetailBaseInfo&quot;,</font></div><div><font style="font-size: 12pt;">    <b>props: {</b></font></div><div><font style="font-size: 12pt;"><b>      goods: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Object</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .base-info {</font></div><div><font style="font-size: 12pt;">    margin-top: 15px;</font></div><div><font style="font-size: 12pt;">    padding: 0 8px;</font></div><div><font style="font-size: 12pt;">    color: #999;</font></div><div><font style="font-size: 12pt;">    border-bottom: 5px solid #f2f5f8;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-title {</font></div><div><font style="font-size: 12pt;">    color: #222</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-price {</font></div><div><font style="font-size: 12pt;">    margin-top: 10px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-price .n-price {</font></div><div><font style="font-size: 12pt;">    font-size: 24px;</font></div><div><font style="font-size: 12pt;">    color: var(--color-high-text);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-price .o-price {</font></div><div><font style="font-size: 12pt;">    font-size: 13px;</font></div><div><font style="font-size: 12pt;">    margin-left: 5px;</font></div><div><font style="font-size: 12pt;">    text-decoration: line-through;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-price .discount {</font></div><div><font style="font-size: 12pt;">    font-size: 12px;</font></div><div><font style="font-size: 12pt;">    padding: 2px 5px;</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-high-text);</font></div><div><font style="font-size: 12pt;">    border-radius: 8px;</font></div><div><font style="font-size: 12pt;">    margin-left: 5px;</font></div><div><font style="font-size: 12pt;">    /*让元素上浮一些: 使用相对定位即可*/</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    top: -8px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-other {</font></div><div><font style="font-size: 12pt;">    margin-top: 15px;</font></div><div><font style="font-size: 12pt;">    line-height: 30px;</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    font-size: 13px;</font></div><div><font style="font-size: 12pt;">    border-bottom: 1px solid rgba(100,100,100,.1);</font></div><div><font style="font-size: 12pt;">    justify-content: space-between;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-service {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    justify-content: space-between;</font></div><div><font style="font-size: 12pt;">    line-height: 60px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-service-item img {</font></div><div><font style="font-size: 12pt;">    width: 14px;</font></div><div><font style="font-size: 12pt;">    height: 14px;</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    top: 2px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-service-item span {</font></div><div><font style="font-size: 12pt;">    font-size: 13px;</font></div><div><font style="font-size: 12pt;">    color: #333;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">v-for 可以遍历数字 </span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;div v-for=&quot;item in 10&quot;&gt;&lt;/div&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">item 会从 1 遍历到 10</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">v-if 请求的 goods 数据不为空才显示</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">v-if=&quot;Object.keys(goods).length !== 0&quot;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Object.keys(obj).length 获取 obj 对象所有的 key，判断对象是否为空</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">问题</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为还没请求到数据时给 </span><span style="font-size: 12pt;">&lt;detail-base-info :goods=&quot;null&quot;&gt;&lt;/detail-base-info&gt; 传了个null</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">而 DetailBaseInfo.vue 要求是个对象</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">props: {</font></div><div><font style="font-size: 12pt;">  goods: {</font></div><div><font style="font-size: 12pt;">    type: Object</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以报错</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [175].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Detail.vue 的 goods: null 改为 goods: {} 即可</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">data () {</font></div><div><font style="font-size: 12pt;">  return {</font></div><div><font style="font-size: 12pt;">    iid: null,</font></div><div><font style="font-size: 12pt;">    topImages: [],</font></div><div><font style="font-size: 12pt;">    goods: {}</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">店铺信息的解析与展示</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DetailShopInfo.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;shop-info&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;shop-top&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img :src=&quot;shop.logo&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;title&quot;&gt;{{shop.name}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;shop-middle&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;shop-middle-item shop-middle-left&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;info-sells&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;sells-count&quot;&gt;</font></div><div><font style="font-size: 12pt;">            {{shop.sells | sellCountFilter}}</font></div><div><font style="font-size: 12pt;">          &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;sells-text&quot;&gt;总销量&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;info-goods&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;goods-count&quot;&gt;</font></div><div><font style="font-size: 12pt;">            {{shop.goodsCount}}</font></div><div><font style="font-size: 12pt;">          &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;goods-text&quot;&gt;全部宝贝&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;shop-middle-item shop-middle-right&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;table&gt;</font></div><div><font style="font-size: 12pt;">          &lt;tr <b>v-for=&quot;(item, index) in shop.score&quot;</b> :key=&quot;index&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;td&gt;{{item.name}}&lt;/td&gt;</font></div><div><font style="font-size: 12pt;">            &lt;td class=&quot;score&quot; <b>:class=&quot;{'score-better': item.isBetter}&quot;</b>&gt;{{item.score}}&lt;/td&gt;</font></div><div><font style="font-size: 12pt;">            &lt;td class=&quot;better&quot; :<b>class=&quot;{'better-more': item.isBetter}&quot;</b>&gt;&lt;span&gt;{{item.isBetter ? '高':'低'}}&lt;/span&gt;&lt;/td&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/tr&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/table&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;shop-bottom&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;enter-shop&quot;&gt;进店逛逛&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: &quot;DetailShopInfo&quot;,</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      shop: {</font></div><div><font style="font-size: 12pt;">        type: Object</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    filters: {</font></div><div><font style="font-size: 12pt;">      sellCountFilter: function (value) {</font></div><div><font style="font-size: 12pt;">        if (value &lt; 10000) return value;</font></div><div><font style="font-size: 12pt;">        return (value/10000).toFixed(1) + '万'</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .shop-info {</font></div><div><font style="font-size: 12pt;">    padding: 25px 8px;</font></div><div><font style="font-size: 12pt;">    border-bottom: 5px solid #f2f5f8;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .shop-top {</font></div><div><font style="font-size: 12pt;">    line-height: 45px;</font></div><div><font style="font-size: 12pt;">    /* 让元素垂直中心对齐 */</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    align-items: center;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .shop-top img {</font></div><div><font style="font-size: 12pt;">    width: 45px;</font></div><div><font style="font-size: 12pt;">    height: 45px;</font></div><div><font style="font-size: 12pt;">    border-radius: 50%;</font></div><div><font style="font-size: 12pt;">    border: 1px solid rgba(0,0,0,.1);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .shop-top .title {</font></div><div><font style="font-size: 12pt;">    margin-left: 10px;</font></div><div><font style="font-size: 12pt;">    vertical-align: center;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .shop-middle {</font></div><div><font style="font-size: 12pt;">    margin-top: 15px;</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    align-items: center;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .shop-middle-item {</font></div><div><font style="font-size: 12pt;">    flex: 1;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .shop-middle-left {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    justify-content: space-evenly;</font></div><div><font style="font-size: 12pt;">    color: #333;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">    border-right: 1px solid rgba(0,0,0,.1);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .sells-count, .goods-count {</font></div><div><font style="font-size: 12pt;">    font-size: 18px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .sells-text, .goods-text {</font></div><div><font style="font-size: 12pt;">    margin-top: 10px;</font></div><div><font style="font-size: 12pt;">    font-size: 12px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .shop-middle-right {</font></div><div><font style="font-size: 12pt;">    font-size: 13px;</font></div><div><font style="font-size: 12pt;">    color: #333;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .shop-middle-right table {</font></div><div><font style="font-size: 12pt;">    width: 120px;</font></div><div><font style="font-size: 12pt;">    margin-left: 30px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .shop-middle-right table td {</font></div><div><font style="font-size: 12pt;">    padding: 5px 0;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  <b>.shop-middle-right .score {</b></font></div><div><font style="font-size: 12pt;"><b>    color: #5ea732;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"> <b> .shop-middle-right .score-better {</b></font></div><div><font style="font-size: 12pt;"><b>    color: #f13e3a;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">  .shop-middle-right .better span {</font></div><div><font style="font-size: 12pt;">    background-color: #5ea732;</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .<b>shop-middle-right .better-more span {</b></font></div><div><font style="font-size: 12pt;"><b>    background-color: #f13e3a;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">  .shop-bottom {</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">    margin-top: 10px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .enter-shop {</font></div><div><font style="font-size: 12pt;">    display: inline-block;</font></div><div><font style="font-size: 12pt;">    font-size: 14px;</font></div><div><font style="font-size: 12pt;">    background-color: #f2f5f8;</font></div><div><font style="font-size: 12pt;">    width: 150px;</font></div><div><font style="font-size: 12pt;">    height: 30px;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">    line-height: 30px;</font></div><div><font style="font-size: 12pt;">    border-radius: 10px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果传过来的 isBetter 为 true，item.isBetter 为 true ，.score-better 的样式就会生效，评分变成红色 ，否则为绿色</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [176].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">但是还有个问题：滚动时导航栏也跟着滚动了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">加入滚动的效果 Scroll</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">tabBar 脱离标准流，盖住了详情页，</span><span style="font-size: 12pt;">所以详情页要设置层级 z-index</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [177].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><br/></div><div><span style="font-size: 12pt;">注意问题：父元素如果没有固定高度，父元素根据内容撑高，那么子元素100%就是父元素内容的高度（不变）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-nav-bar class=&quot;detail-nav&quot;&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</font></div><div><font style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods, Shop} from 'network/detail';</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {},</font></div><div><font style="font-size: 12pt;">        shop: {}</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        const data =  res.result;</font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services)</font></div><div><font style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo)</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">      DetailBaseInfo,</font></div><div><font style="font-size: 12pt;">      DetailShopInfo,</font></div><div><font style="font-size: 12pt;">      Scroll</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #detail {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    z-index: 1;</font></div><div><font style="font-size: 12pt;">   <b> height: 100vh;</b></font></div><div><font style="font-size: 12pt;">    background-color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .detail-nav {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    z-index: 1;</font></div><div><font style="font-size: 12pt;">    background-color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .content {</font></div><div><font style="font-size: 12pt;">    <b>height: calc(100% - 44px);</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">商品详情数据展示</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">接下来要展示详情的图片数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">但是有个问题：图片展示后无法滚动到底部</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [178].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [179].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">之前轮播图只要有一个图片加载完，整个可滚动区域高度就确定了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">现在这里要把所有图片加载完，因为每一张详情页下面的图片都会影响高度</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">if (++this.counter === this.imagesLength)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">也就是当计数器等于图片个数时才发送 imageLoad 事件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [180].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [181].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">每次获取图片个数时都需要写 this.detailInfo.detailImage[0].list.length，这样性能比较不好，</span></div><div><br/></div><div><span style="font-size: 12pt;">而且，不能直接 imagesLength: this.detailInfo.detailImage[0].list.length，因为 detailInfo 默认是 {}，异步请求还没获得数据使，它传的就是 {}，所以 </span></div><div><br/></div><div><span style="font-size: 12pt;">imagesLength: undefined，imagesLength 是获取不到图片个数的</span></div><div><br/></div><div><span style="font-size: 12pt;">因此给 </span><span style="font-size: 12pt;">imagesLength 默认值先为 0，再使用 watch 监听 props 的 detailInfo 变化，一旦 </span><span style="font-size: 12pt;">detailInfo 发生变化就可以获得最新的数据，获取到长度然后赋值给 imagesLength</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [182].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DetailGoodsInfo.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div v-if=&quot;Object.keys(detailInfo).length !== 0&quot; class=&quot;goods-info&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;info-desc clear-fix&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;start&quot;&gt;&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;desc&quot;&gt;{{detailInfo.desc}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;end&quot;&gt;&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;info-key&quot;&gt;{{detailInfo.detailImage[0].key}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;info-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img v-for=&quot;(item, index) in detailInfo.detailImage[0].list&quot;</font></div><div><font style="font-size: 12pt;">      :key=&quot;index&quot; :src=&quot;item&quot; alt=&quot;&quot; <b>@load=&quot;imgLoad&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: &quot;DetailGoodsInfo&quot;,</font></div><div><font style="font-size: 12pt;">    <b>props: {</b></font></div><div><font style="font-size: 12pt;"><b>      detailInfo: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Object</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;">   <b> data() {</b></font></div><div><font style="font-size: 12pt;"><b>      return {</b></font></div><div><font style="font-size: 12pt;"><b>        counter: 0,</b></font></div><div><font style="font-size: 12pt;"><b>        imgLength: 0</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    methods: {</b></font></div><div><font style="font-size: 12pt;"><b>      imgLoad() {</b></font></div><div><font style="font-size: 12pt;"><b>        if (++this.counter === this.imgLength) {</b></font></div><div><font style="font-size: 12pt;"><b>          this.$emit('imgLoad')</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    watch: {</b></font></div><div><font style="font-size: 12pt;"><b>      detailInfo() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.imgLength = this.detailInfo.detailImage[0].list.length;</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .goods-info {</font></div><div><font style="font-size: 12pt;">    padding: 20px 0;</font></div><div><font style="font-size: 12pt;">    border-bottom: 5px solid #f2f5f8;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-desc {</font></div><div><font style="font-size: 12pt;">    padding: 0 15px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-desc .start, .info-desc .end {</font></div><div><font style="font-size: 12pt;">    width: 90px;</font></div><div><font style="font-size: 12pt;">    height: 1px;</font></div><div><font style="font-size: 12pt;">    background-color: #a3a3a5;</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-desc .start {</font></div><div><font style="font-size: 12pt;">    float: left;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-desc .end {</font></div><div><font style="font-size: 12pt;">    float: right;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-desc .start::before, .info-desc .end::after {</font></div><div><font style="font-size: 12pt;">    content: '';</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    width: 5px;</font></div><div><font style="font-size: 12pt;">    height: 5px;</font></div><div><font style="font-size: 12pt;">    background-color: #333;</font></div><div><font style="font-size: 12pt;">    bottom: 0;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-desc .end::after {</font></div><div><font style="font-size: 12pt;">    right: 0;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-desc .desc {</font></div><div><font style="font-size: 12pt;">    padding: 15px 0;</font></div><div><font style="font-size: 12pt;">    font-size: 14px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-key {</font></div><div><font style="font-size: 12pt;">    margin: 10px 0 10px 15px;</font></div><div><font style="font-size: 12pt;">    color: #333;</font></div><div><font style="font-size: 12pt;">    font-size: 15px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-list img {</font></div><div><font style="font-size: 12pt;">    width: 100%;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-</font><font style="font-size: 12pt;">nav-bar class=&quot;detail-nav&quot;&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</font></div><div><font style="font-size: 12pt;">     <b> &lt;detail-goods-info :detailInfo=&quot;detailInfo&quot; @imgLoad=&quot;imgLoad&quot;&gt;&lt;/detail-goods-info&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</font></div><div><font style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import DetailGoodsInfo from './childCpns/DetailGoodsInfo';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods, Shop} from 'network/detail';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {},</font></div><div><font style="font-size: 12pt;">        shop: {},</font></div><div><font style="font-size: 12pt;">        <b>detailInfo: {}</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>methods: {</b></font></div><div><font style="font-size: 12pt;"><b>      imgLoad() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$refs.scroll.refresh();</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">     <b> getDetailData(this.iid).then(res =&gt; {</b></font></div><div><font style="font-size: 12pt;">        <b>const data =  res.result;</b></font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</font></div><div><font style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo);</font></div><div><font style="font-size: 12pt;">        <b>this.detailInfo = data.detailInfo</b></font></div><div><font style="font-size: 12pt;">      <b>})</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">      DetailBaseInfo,</font></div><div><font style="font-size: 12pt;">      DetailShopInfo,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      <b>DetailGoodsInfo</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [14].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">商品参数数据的展示</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DetailParamsInfo.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;param-info&quot; v-if=&quot;Object.keys(paramInfo).length !== 0&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;table v-for=&quot;(table, index) in paramInfo.sizes&quot;</font></div><div><font style="font-size: 12pt;">           class=&quot;info-size&quot; :key=&quot;index&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tr v-for=&quot;(tr, indey) in table&quot; :key=&quot;indey&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;td v-for=&quot;(td, indez) in tr&quot; :key=&quot;indez&quot;&gt;{{td}}&lt;/td&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/tr&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/table&gt;</font></div><div><font style="font-size: 12pt;">    &lt;table class=&quot;info-param&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tr v-for=&quot;(info, index) in paramInfo.infos&quot; :key=&quot;index&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;td class=&quot;info-param-key&quot;&gt;{{info.key}}&lt;/td&gt;</font></div><div><font style="font-size: 12pt;">        &lt;td class=&quot;param-value&quot;&gt;{{info.value}}&lt;/td&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/tr&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/table&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;info-img&quot; v-if=&quot;paramInfo.image.length !== 0&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img :src=&quot;paramInfo.image&quot; alt=&quot;&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: &quot;DetailParamInfo&quot;,</font></div><div><font style="font-size: 12pt;">   <b> props: {</b></font></div><div><font style="font-size: 12pt;"><b>      paramInfo: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Object</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .param-info {</font></div><div><font style="font-size: 12pt;">    padding: 20px 15px;</font></div><div><font style="font-size: 12pt;">    font-size: 14px;</font></div><div><font style="font-size: 12pt;">    border-bottom: 5px solid #f2f5f8;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .param-info table {</font></div><div><font style="font-size: 12pt;">    width: 100%;</font></div><div><font style="font-size: 12pt;">    border-collapse: collapse;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .param-info table tr {</font></div><div><font style="font-size: 12pt;">    height: 42px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .param-info table tr td {</font></div><div><font style="font-size: 12pt;">    border-bottom: 1px solid rgba(100,100,100,.1);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-param-key {</font></div><div><font style="font-size: 12pt;">    /*当value的数据量比较大的时候, 会挤到key,所以给一个固定的宽度*/</font></div><div><font style="font-size: 12pt;">    width: 95px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-param {</font></div><div><font style="font-size: 12pt;">    border-top: 1px solid rgba(0,0,0,.1);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .param-value {</font></div><div><font style="font-size: 12pt;">    color: #eb4868</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-img img {</font></div><div><font style="font-size: 12pt;">    width: 100%;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">&lt;template&gt;</span></div><div><span style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</span></div><div><span style="font-size: 12pt;">    &lt;detail-nav-bar class=&quot;detail-nav&quot;&gt;&lt;/detail-nav-bar&gt;</span></div><div><span style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot;&gt;</span></div><div><span style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</span></div><div><span style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</span></div><div><span style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</span></div><div><span style="font-size: 12pt;">      &lt;detail-goods-info :detailInfo=&quot;detailInfo&quot; @imgLoad=&quot;imgLoad&quot;&gt;&lt;/detail-goods-info&gt;</span></div><div><span style="font-size: 12pt;">      <b>&lt;detail-params-info :paramInfo=&quot;paramInfo&quot;&gt;&lt;/detail-params-info&gt;</b></span></div><div><span style="font-size: 12pt;">    &lt;/scroll&gt;</span></div><div><span style="font-size: 12pt;">  &lt;/div&gt;</span></div><div><span style="font-size: 12pt;">&lt;/template&gt;</span></div><div><br/></div><div><span style="font-size: 12pt;">&lt;script&gt;</span></div><div><span style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</span></div><div><span style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</span></div><div><span style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</span></div><div><span style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</span></div><div><span style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</span></div><div><span style="font-size: 12pt;">  import DetailGoodsInfo from './childCpns/DetailGoodsInfo';</span></div><div><span style="font-size: 12pt;">  <b>import DetailParamsInfo from './childCpns/DetailParamInfo';</b></span></div><div><span style="font-size: 12pt;"><b><br/></b></span></div><div><span style="font-size: 12pt;">  import {getDetailData, Goods, Shop, GoodsParam} from 'network/detail';</span></div><div><span style="font-size: 12pt;">  export default {</span></div><div><span style="font-size: 12pt;">    name: 'Detail',</span></div><div><span style="font-size: 12pt;">    data () {</span></div><div><span style="font-size: 12pt;">      return {</span></div><div><span style="font-size: 12pt;">        iid: null,</span></div><div><span style="font-size: 12pt;">        topImages: [],</span></div><div><span style="font-size: 12pt;">        goods: {},</span></div><div><span style="font-size: 12pt;">        shop: {},</span></div><div><span style="font-size: 12pt;">        detailInfo: {},</span></div><div><span style="font-size: 12pt;">        <b>paramInfo: {}</b></span></div><div><span style="font-size: 12pt;">      }</span></div><div><span style="font-size: 12pt;">    },</span></div><div><span style="font-size: 12pt;">    methods: {</span></div><div><span style="font-size: 12pt;">      imgLoad() {</span></div><div><span style="font-size: 12pt;">        this.$refs.scroll.refresh();</span></div><div><span style="font-size: 12pt;">      }</span></div><div><span style="font-size: 12pt;">    },</span></div><div><span style="font-size: 12pt;">    created () {</span></div><div><span style="font-size: 12pt;">      this.iid = this.$route.params.iid;</span></div><div><span style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</span></div><div><span style="font-size: 12pt;">        const data =  res.result;</span></div><div><span style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</span></div><div><span style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</span></div><div><span style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo);</span></div><div><span style="font-size: 12pt;">        this.detailInfo = data.detailInfo;</span></div><div><span style="font-size: 12pt;">        <b>this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);</b></span></div><div><span style="font-size: 12pt;">      })</span></div><div><span style="font-size: 12pt;">    },</span></div><div><span style="font-size: 12pt;">    components: {</span></div><div><span style="font-size: 12pt;">      DetailNavBar,</span></div><div><span style="font-size: 12pt;">      DetailSwiper,</span></div><div><span style="font-size: 12pt;">      DetailBaseInfo,</span></div><div><span style="font-size: 12pt;">      DetailShopInfo,</span></div><div><span style="font-size: 12pt;">      Scroll,</span></div><div><span style="font-size: 12pt;">      DetailGoodsInfo,</span></div><div><span style="font-size: 12pt;">      DetailParamsInfo</span></div><div><span style="font-size: 12pt;">    }</span></div><div><span style="font-size: 12pt;">  }</span></div><div><span style="font-size: 12pt;">&lt;/script&gt;</span></div></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [15].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">商品评论信息的展示</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">对评论信息数据进行获取然后进行展示（接口只有一条评论信息，其他的评论信息没有抓取）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [183].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><img src="10- 购物街_files/3 [184].jpg" type="image/jpeg" data-filename="3.jpg" style="font-size: 12pt;"/></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [185].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">目的是为了让用户点击更多，跳转到另一个页面里展示更多的评论信息</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为有些商家是没有评论的，所以在获取商家评论数据时要做个判断</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">  const data =  res.result;</font></div><div><font style="font-size: 12pt;">  this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">  this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</font></div><div><font style="font-size: 12pt;">  this.shop = new Shop(data.shopInfo);</font></div><div><font style="font-size: 12pt;">  this.detailInfo = data.detailInfo;</font></div><div><font style="font-size: 12pt;">  this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);</font></div><div><font style="font-size: 12pt;"> <b> if (data.rate.list) {</b></font></div><div><font style="font-size: 12pt;"><b>    this.commentInfo = data.rate.list[0];</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">})</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">返回评论信息时，服务器数据返回的日期是数字格式，并没有返回时间格式，这样更灵活</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为</span><span style="font-size: 12pt;">有些地方</span><span style="font-size: 12pt;">日期格式是不需要时分秒的，有些地方则需要，所以服务器返回的是时间戳，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">即格林威治时间1970年01月01日00时00分00秒(北京时间1970年01月01日08时00分00秒)起至现在的总秒数。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [186].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">时间格式化字符串</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [187].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [188].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DetailCommentInfo.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">{{commentInfo.created | showDate}} 使用过滤器，格式化时间</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div v-if=&quot;Object.keys(commentInfo).length !== 0&quot; class=&quot;comment-info&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;info-header&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;header-title&quot;&gt;用户评价&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;header-more&quot;&gt;</font></div><div><font style="font-size: 12pt;">          更多</font></div><div><font style="font-size: 12pt;">          &lt;i class=&quot;arrow-right&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;info-user&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;img :src=&quot;commentInfo.user.avatar&quot; alt=&quot;&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;span&gt;{{commentInfo.user.uname}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;info-detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;p&gt;{{commentInfo.content}}&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;info-other&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;span class=&quot;date&quot;&gt;<b>{{commentInfo.created | showDate}}</b>&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">          &lt;span&gt;{{commentInfo.style}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;info-imgs&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;img :src=&quot;item&quot; v-for=&quot;(item, index) in commentInfo.images&quot; :key=&quot;index&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import {formatDate} from &quot;commonjs/utils.js&quot;;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: &quot;DetailCommentInfo&quot;,</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      commentInfo: {</font></div><div><font style="font-size: 12pt;">        type: Object,</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>filters: {</b></font></div><div><font style="font-size: 12pt;"><b>      showDate: function (value) {</b></font></div><div><font style="font-size: 12pt;"><b>        let date = new Date(value * 1000);</b></font></div><div><font style="font-size: 12pt;"><b>        return formatDate(date, 'yyyy-MM-dd')</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .comment-info {</font></div><div><font style="font-size: 12pt;">    padding: 5px 12px;</font></div><div><font style="font-size: 12pt;">    color: #333;</font></div><div><font style="font-size: 12pt;">    border-bottom: 5px solid #f2f5f8;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-header {</font></div><div><font style="font-size: 12pt;">    height: 50px;</font></div><div><font style="font-size: 12pt;">    line-height: 50px;</font></div><div><font style="font-size: 12pt;">    border-bottom: 1px solid rgba(0,0,0,.1);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .header-title {</font></div><div><font style="font-size: 12pt;">    float: left;</font></div><div><font style="font-size: 12pt;">    font-size: 15px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .header-more {</font></div><div><font style="font-size: 12pt;">    float: right;</font></div><div><font style="font-size: 12pt;">    margin-right: 10px;</font></div><div><font style="font-size: 12pt;">    font-size: 13px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-user {</font></div><div><font style="font-size: 12pt;">    padding: 10px 0 5px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-user img {</font></div><div><font style="font-size: 12pt;">    width: 42px;</font></div><div><font style="font-size: 12pt;">    height: 42px;</font></div><div><font style="font-size: 12pt;">    border-radius: 50%;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-user span {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    font-size: 15px;</font></div><div><font style="font-size: 12pt;">    top: -15px;</font></div><div><font style="font-size: 12pt;">    margin-left: 10px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-detail {</font></div><div><font style="font-size: 12pt;">    padding: 0 5px 15px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-detail p {</font></div><div><font style="font-size: 12pt;">    font-size: 14px;</font></div><div><font style="font-size: 12pt;">    color: #777;</font></div><div><font style="font-size: 12pt;">    line-height: 1.5;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-detail .info-other {</font></div><div><font style="font-size: 12pt;">    font-size: 12px;</font></div><div><font style="font-size: 12pt;">    color: #999;</font></div><div><font style="font-size: 12pt;">    margin-top: 10px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-other .date {</font></div><div><font style="font-size: 12pt;">    margin-right: 8px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-imgs {</font></div><div><font style="font-size: 12pt;">    margin-top: 10px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-imgs img {</font></div><div><font style="font-size: 12pt;">    width: 70px;</font></div><div><font style="font-size: 12pt;">    height: 70px;</font></div><div><font style="font-size: 12pt;">    margin-right: 5px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">utils.js</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Java 有格式化日期的方法，JS 没有，但是这个太常用了，肯定有人写过，就不必那么麻烦了，cv 大法</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">时间格式化很常用，很重要</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">export function formatDate(date, fmt) {</font></div><div><font style="font-size: 12pt;">  if (/(y+)/.test(fmt)) {</font></div><div><font style="font-size: 12pt;"><font>    fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length));</font></font></div><div><font><font><span style="font-size: 12pt;"> </span> <font style="font-size: 12pt;">  /</font><font style="font-size: 12pt;">/ 如果传的是'yyyy'，就是四位的</font></font></font> <font style="font-size: 12pt;"><font>2019 + '' <font>，传的是'yy'，</font>则是两位的 19 </font>+ ''</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  let o = {</font></div><div><font style="font-size: 12pt;">    'M+': date.getMonth() + 1,</font></div><div><font style="font-size: 12pt;">    'd+': date.getDate(),</font></div><div><font style="font-size: 12pt;">    'h+': date.getHours(),</font></div><div><font style="font-size: 12pt;">    'm+': date.getMinutes(),</font></div><div><font style="font-size: 12pt;">    's+': date.getSeconds()</font></div><div><font style="font-size: 12pt;">  };</font></div><div><font style="font-size: 12pt;">  for (let k in o) {</font></div><div><font style="font-size: 12pt;">    if (new RegExp(`(${k})`).test(fmt)) {</font></div><div><font style="font-size: 12pt;">      let str = o[k] + '';</font></div><div><font style="font-size: 12pt;">      fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? str : padLeftZero(str));</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  return fmt;</font></div><div><font style="font-size: 12pt;">};</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><font>// 旁边补一个0，即 01:01:01 ，而不是 </font>1:1:1</font></div><div><font style="font-size: 12pt;">function padLeftZero (str) {</font></div><div><font style="font-size: 12pt;">  return ('00' + str).substr(str.length);</font></div><div><font style="font-size: 12pt;">};</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">商品推荐数据的展示</span></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [189].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [190].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">推荐数据属于不同接口，在这里有个 list，有 24 条数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [191].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">要展示推荐数据，仍然第一件事是请求获取数据</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">detail.js</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">import {request} from './request';</span></div><div><br/></div><div><span style="font-size: 12pt;">export function getDetailData(iid) {</span></div><div><span style="font-size: 12pt;">  return request({</span></div><div><span style="font-size: 12pt;">    url: '/detail',</span></div><div><span style="font-size: 12pt;">    params: {</span></div><div><span style="font-size: 12pt;">      iid</span></div><div><span style="font-size: 12pt;">    }</span></div><div><span style="font-size: 12pt;">  })</span></div><div><span style="font-size: 12pt;">}</span></div><div><br/></div><div><span style="font-size: 12pt;">export class Goods {</span></div><div><span style="font-size: 12pt;">  constructor(itemInfo, columns, services) {</span></div><div><span style="font-size: 12pt;">    this.title = itemInfo.title;</span></div><div><span style="font-size: 12pt;">    this.desc = itemInfo.desc;</span></div><div><span style="font-size: 12pt;">    this.newPrice = itemInfo.price;</span></div><div><span style="font-size: 12pt;">    this.oldPrice = itemInfo.oldPrice;</span></div><div><span style="font-size: 12pt;">    this.discount = itemInfo.discountDesc;</span></div><div><span style="font-size: 12pt;">    this.columns = columns;</span></div><div><font style="font-size: 12pt;">    this.services = services;</font></div><div><font style="font-size: 12pt;">    this.lowNowPrice = itemInfo.lowNowPrice;</font></div><div><span style="font-size: 12pt;">    this.nowPrice = itemInfo.highNowPrice;</span></div><div><span style="font-size: 12pt;">  }</span></div><div><span style="font-size: 12pt;">}</span></div><div><br/></div><div><span style="font-size: 12pt;">export class Shop {</span></div><div><span style="font-size: 12pt;">  constructor(shopInfo) {</span></div><div><span style="font-size: 12pt;">    this.logo = shopInfo.shopLogo;</span></div><div><span style="font-size: 12pt;">    this.name = shopInfo.name;</span></div><div><span style="font-size: 12pt;">    this.fans = shopInfo.cFans;</span></div><div><span style="font-size: 12pt;">    this.sells = shopInfo.cSells;</span></div><div><span style="font-size: 12pt;">    this.score = shopInfo.score;</span></div><div><span style="font-size: 12pt;">    this.goodsCount = shopInfo.cGoods</span></div><div><span style="font-size: 12pt;">  }</span></div><div><span style="font-size: 12pt;">}</span></div><div><br/></div><div><span style="font-size: 12pt;">export class GoodsParam {</span></div><div><span style="font-size: 12pt;">  constructor(info, rule) {</span></div><div><span style="font-size: 12pt;">    // 注: images可能没有值(某些商品有值, 某些没有值)</span></div><div><span style="font-size: 12pt;">    this.image = info.images ? info.images[0] : &quot;&quot;;</span></div><div><span style="font-size: 12pt;">    this.infos = info.set;</span></div><div><span style="font-size: 12pt;">    this.sizes = rule.tables;</span></div><div><span style="font-size: 12pt;">  }</span></div><div><span style="font-size: 12pt;">}</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">export function getRecommend() {</span></div><div><span style="font-size: 12pt; font-weight: bold;">  return request({</span></div><div><span style="font-size: 12pt; font-weight: bold;">    url: '/recommend'</span></div><div><span style="font-size: 12pt; font-weight: bold;">  })</span></div><div><span style="font-size: 12pt; font-weight: bold;">}</span></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">而要展示数据的话不用再搞个子组件了，因为这就是一个 GoodsList 组件，GoodsList 需要传的也正是一个数组，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以可以 </span><span style="font-size: 12pt;">:goods=&quot;recommends&quot;，将 recommends 数据传给 goods</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">&lt;goods-list&gt; 也需要滚动，所以把它放进 &lt;scroll&gt; 里</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [192].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-nav-bar class=&quot;detail-nav&quot;&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-goods-info :detailInfo=&quot;detailInfo&quot; @imgLoad=&quot;imgLoad&quot;&gt;&lt;/detail-goods-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-params-info :paramInfo=&quot;paramInfo&quot;&gt;&lt;/detail-params-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-comment-info :comment-info=&quot;commentInfo&quot;&gt;&lt;/detail-comment-info&gt;</font></div><div><font style="font-size: 12pt;">      <b>&lt;goods-list :goods=&quot;recommends&quot;&gt;&lt;/goods-list&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</font></div><div><font style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import DetailGoodsInfo from './childCpns/DetailGoodsInfo';</font></div><div><font style="font-size: 12pt;">  import DetailParamsInfo from './childCpns/DetailParamInfo';</font></div><div><font style="font-size: 12pt;">  import DetailCommentInfo from './childCpns/DetailCommentInfo';</font></div><div><font style="font-size: 12pt;"> <b> import GoodsList from 'content/goods/GoodsList';</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods, Shop, GoodsParam, <b>getRecommend</b>} from 'network/detail';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {},</font></div><div><font style="font-size: 12pt;">        shop: {},</font></div><div><font style="font-size: 12pt;">        detailInfo: {},</font></div><div><font style="font-size: 12pt;">        paramInfo: {},</font></div><div><font style="font-size: 12pt;">        commentInfo: {},</font></div><div><font style="font-size: 12pt;">        <b>recommends: []</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      imgLoad() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        const data =  res.result;</font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</font></div><div><font style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo);</font></div><div><font style="font-size: 12pt;">        this.detailInfo = data.detailInfo;</font></div><div><font style="font-size: 12pt;">        this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);</font></div><div><font style="font-size: 12pt;">        if (data.rate.list) {</font></div><div><font style="font-size: 12pt;">          this.commentInfo = data.rate.list[0];</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      <b>getRecommend().then(res =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>        this.recommends = res.data.list</b></font></div><div><font style="font-size: 12pt;"><b>      })</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">      DetailBaseInfo,</font></div><div><font style="font-size: 12pt;">      DetailShopInfo,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      DetailGoodsInfo,</font></div><div><font style="font-size: 12pt;">      DetailParamsInfo,</font></div><div><font style="font-size: 12pt;">      <b>DetailCommentInfo,</b></font></div><div><font style="font-size: 12pt;"><b>      GoodsList</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #detail {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    z-index: 1;</font></div><div><font style="font-size: 12pt;">    height: 100vh;</font></div><div><font style="font-size: 12pt;">    background-color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .detail-nav {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    z-index: 1;</font></div><div><font style="font-size: 12pt;">    background-color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .content {</font></div><div><font style="font-size: 12pt;">    height: calc(100% - 44px);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">GoodsList.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;goods&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;goods-item v-for=&quot;(item, index) in goods&quot; :key=&quot;index&quot; :goodsItem=&quot;item&quot;&gt;&lt;/goods-item&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import GoodsItem from './GoodsItem'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'GoodsList',</font></div><div><font style="font-size: 12pt;">   <b> props: {</b></font></div><div><font style="font-size: 12pt;"><b>      goods: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Array,</b></font></div><div><font style="font-size: 12pt;"><b>        default() {</b></font></div><div><font style="font-size: 12pt;"><b>          return []</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      GoodsItem</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .goods {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    flex-wrap: wrap;</font></div><div><font style="font-size: 12pt;">    justify-content: space-around;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [193].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">哪里读取 img 呢？很明显是 GooodsList Item 的 &lt;img&gt; src 特性读不到</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">因为 recommends 里没有 show 属性，只有 image 属性，所以不能读取</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [194].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">不能再这样读取了，所以有时要这样读有时不需要这样读</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [195].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">使用计算属性搞一个判断，逻辑或前面为空直接执行后面的</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">GoodsListItem.vue</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;goods-item&quot; @click=&quot;itemClick&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;img :src=&quot;<b>showImg</b>&quot; @load=&quot;imgLoad&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;goods-info&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;p&gt;{{goodsItem.title}}&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;price&quot;&gt;{{goodsItem.price}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span class=&quot;collect&quot;&gt;{{goodsItem.cfav}}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'GoodsItem',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">      goodsItem: {</font></div><div><font style="font-size: 12pt;">        type: Object,</font></div><div><font style="font-size: 12pt;">        default() {</font></div><div><font style="font-size: 12pt;">          return {}</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>computed: {</b></font></div><div><font style="font-size: 12pt;"><b>      showImg() {</b></font></div><div><font style="font-size: 12pt;"><b>        return this.goodsItem.image || this.goodsItem.show.img</b></font></div><div><font style="font-size: 12pt;"><b>      }    </b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      imgLoad() {</font></div><div><font style="font-size: 12pt;">        this.$bus.$emit('itemImgLoad')</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      itemClick() {</font></div><div><font style="font-size: 12pt;">        this.$router.push('/detail/' + this.goodsItem.iid)</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [16].gif" type="image/gif" data-filename="3.gif"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">首页和详情页监听全局事件和 mixin 使用</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">详情页滚动问题：滚动很久又可以了</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">原因：其他图片加载完，大图没加载完造成无法滚动，所以等大图加载完再刷新一次计算可滚动区域高度</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [17].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">详情页的 GoodListItem 通过 img 的 load 事件发送事件给了 Home，通知 Home 刷新，这是不合理的</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">怎么区分呢？可以通过路由判断，路由发现路径是 /home 时才发送事件，</span><span style="font-size: 12pt;">通知 Home 刷新，</span><span style="font-size: 12pt;">详情页也会出现滚动问题，也需要刷新</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [196].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">可以使用第二种方法</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [197].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [198].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [199].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Detail.vue 中 mounted() 的代码与  Home.vue </span><span style="font-size: 12pt;">中 mounted() 的代码是相同的，所以要进行抽取，要使用新技术——混入 mixin</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">首先强调一点：这里不能使用继承，继承也可以减少重复的代码，但是是减少类里面的重复代码的，而这里是两个对象，所以这里不能用继承</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">用 Vue 中的 混入 mixin 减少组件之间重复的代码，</span><span style="font-size: 12pt;">混入 mixin 也是一个 JS 文件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [200].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [201].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [202].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">Home.vue 同理</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">混入 mixin 可以放更多的东西</span></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [203].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 12pt;">具体参考：</span> <span style="font-size: 12pt;"><a href="https://cn.vuejs.org/v2/guide/mixins.html" style="font-size: 12pt;">https://cn.vuejs.org/v2/guide/mixins.html</a></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">mixin.js</span></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;"><b>import { debounce } from &quot;commonjs/utils.js&quot;;</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;"><b>export const itemListenerMixin = {</b></font></div><div><font style="font-size: 12pt;"><b>  data() {</b></font></div><div><font style="font-size: 12pt;"><b>    return {</b></font></div><div><font style="font-size: 12pt;"><b>      itemImgListener: null</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;"><b>  },</b></font></div><div><font style="font-size: 12pt;"><b>  mounted() {</b></font></div><div><font style="font-size: 12pt;"><b>    const refresh = debounce(this.$refs.scroll.refresh, 50);</b></font></div><div><font style="font-size: 12pt;"><b>    this.itemImgListener = () =&gt; refresh();</b></font></div><div><font style="font-size: 12pt;"><b>    this.$bus.$on(&quot;itemImgLoad&quot;, this.itemImgListener);</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>}</b></font></div></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">Home.vue</span></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;</font></div><div><font style="font-size: 12pt;">                 class=&quot;fixed&quot; v-show=&quot;isTabFixed&quot;  ref=&quot;tabControl1&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot;</font></div><div><font style="font-size: 12pt;">            ref=&quot;scroll&quot;</font></div><div><font style="font-size: 12pt;">            :probe-type=&quot;3&quot;</font></div><div><font style="font-size: 12pt;">            :pull-up-load=&quot;true&quot;</font></div><div><font style="font-size: 12pt;">            @scroll=&quot;contentScroll&quot;</font></div><div><font style="font-size: 12pt;">            @pullingUp=&quot;loadMore&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot; @swiperImageLoad=&quot;swiperImageLoad&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot;  </font></div><div><font style="font-size: 12pt;">                   @tabClick=&quot;tabClick&quot;</font></div><div><font style="font-size: 12pt;">                   ref=&quot;tabControl2&quot; &gt;</font></div><div><font style="font-size: 12pt;">      &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper';</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend';</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView';</font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar';</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl';</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import BackUp from 'content/backUp/BackUp';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"> <b> import {itemListenerMixin} from 'commonjs/mixin';</b></font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      BackUp</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> mixins: [itemListenerMixin],</b></font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop',</font></div><div><font style="font-size: 12pt;">        isShowBackUp: false,</font></div><div><font style="font-size: 12pt;">        tabOffsetTop: 0,</font></div><div><font style="font-size: 12pt;">        isTabFixed: false,</font></div><div><font style="font-size: 12pt;">        scrollY: 0     </font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created() {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    activated () {</font></div><div><font style="font-size: 12pt;">      this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      this.$refs.scroll.scrollTo(0, this.scrollY, 0);     </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    deactivated () {</font></div><div><font style="font-size: 12pt;">      this.scrollY = this.$refs.scroll.getScrollY();</font></div><div><font style="font-size: 12pt;">      this.$bus.$off('itemImgLoad', this.itemImgListener);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell';</font></div><div><font style="font-size: 12pt;">            break;   </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        this.$refs.tabControl1.currentIndex = index;</font></div><div><font style="font-size: 12pt;">        this.$refs.tabControl2.currentIndex = index;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      backClick() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, 0, 300);</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        this.isShowBackUp = (-position.y) &gt; 1000;</font></div><div><font style="font-size: 12pt;">        this.isTabFixed = (-position.y) &gt; this.tabOffsetTop;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      loadMore() {</font></div><div><font style="font-size: 12pt;">        this.getHomeGoods(this.currentType);</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      swiperImageLoad() {       </font></div><div><font style="font-size: 12pt;">        this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;      </font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">           this.$refs.scroll.finishPullUp();</font></div><div><font style="font-size: 12pt;">        });        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">Detail.vue</span></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-nav-bar class=&quot;detail-nav&quot;&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-goods-info :detailInfo=&quot;detailInfo&quot; @imgLoad=&quot;imgLoad&quot;&gt;&lt;/detail-goods-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-params-info :paramInfo=&quot;paramInfo&quot;&gt;&lt;/detail-params-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-comment-info :comment-info=&quot;commentInfo&quot;&gt;&lt;/detail-comment-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;recommends&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</font></div><div><font style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import DetailGoodsInfo from './childCpns/DetailGoodsInfo';</font></div><div><font style="font-size: 12pt;">  import DetailParamsInfo from './childCpns/DetailParamInfo';</font></div><div><font style="font-size: 12pt;">  import DetailCommentInfo from './childCpns/DetailCommentInfo';</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods, Shop, GoodsParam, getRecommend} from 'network/detail';</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;"> <b> import {itemListenerMixin} from 'commonjs/mixin';</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    <b>mixins: [itemListenerMixin],</b></font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {},</font></div><div><font style="font-size: 12pt;">        shop: {},</font></div><div><font style="font-size: 12pt;">        detailInfo: {},</font></div><div><font style="font-size: 12pt;">        paramInfo: {},</font></div><div><font style="font-size: 12pt;">        commentInfo: {},</font></div><div><font style="font-size: 12pt;">        recommends: []</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      imgLoad() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        const data =  res.result;</font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</font></div><div><font style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo);</font></div><div><font style="font-size: 12pt;">        this.detailInfo = data.detailInfo;</font></div><div><font style="font-size: 12pt;">        this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);</font></div><div><font style="font-size: 12pt;">        if (data.rate.list) {</font></div><div><font style="font-size: 12pt;">          this.commentInfo = data.rate.list[0];</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      getRecommend().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        this.recommends = res.data.list</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    destroyed() {</font></div><div><font style="font-size: 12pt;">      this.$bus.$off('itemImgLoad', this.itemImgListener);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">      DetailBaseInfo,</font></div><div><font style="font-size: 12pt;">      DetailShopInfo,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      DetailGoodsInfo,</font></div><div><font style="font-size: 12pt;">      DetailParamsInfo,</font></div><div><font style="font-size: 12pt;">      DetailCommentInfo,</font></div><div><font style="font-size: 12pt;">      GoodsList</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [204].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [205].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [206].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">做项目最重要的是理清好思路，而不是立即动手</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">标题和内容的联动效果</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">底部工具栏，点击加入购物车</span></div><div><br/></div><div><span style="font-size: 12pt;">回到顶部</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">点击标题滚动到对应内容</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">注意事项：属性和事件可以使用驼峰命名，但是特性必须使用短横线命名</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [207].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">要滚动到参数，必须获取参数组件的 offsetTop，评论就是获取评论组件的 offsetTop，推荐就是获取推荐组件的 offsetTop</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [208].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在 Detail.vue 的 mounted() 中获取offsetTop 不对，因为图片没有加载完，甚至异步请求的数据都还没有过来，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">而且因为一些组件（如 DetailParams 参数组件）只有等数据请求下来了才显示，所以这时获取到的 offsetTop 是 undefined</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><img src="10- 购物街_files/3 [209].jpg" type="image/jpeg" data-filename="3.jpg" style="font-size: 12pt;"/></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">异步请求了数据还有一个渲染的过程，有了数据后会执行 updated() 生命周期函数，对界面进行更新</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">但是 updated() 有个问题：就是更新频繁，因为只要有数据变化就会执行 updated()，会执行很多次</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以要每次执行时都要把  重置为空数组  []</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">下图为第一次 updated() 还没有请求下来数据，第二次</span><span style="font-size: 12pt;">updated() 时有数据，所以有值了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [210].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当然也可以不在 updated() 里执行，但是在 created() 请求数据之后再执行就会获取不到元素（值不对的原因：元素没有渲染出来），</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以等数据赋值到组件过后要稍微等一会，等它完成渲染更新 DOM 后才能获取到 offsetTop 的值</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">渲染线程 和 JS执行线程 不是在同一个线程里，所以需要等待渲染完成</span></div><div><span style="font-size: 12pt;">this.$nextTick() 下一帧，表示等待渲染完成后，执行里面的回调函数</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [211].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [212].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">但是，这样还有一个问题：进入新的商品详情时，滚动的位置就不对了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [213].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">因为 this.$nextTick() 根据最新的数据，对应的 DOM 是已经被渲染出来，</span><span style="font-size: 12pt;">但是图片依然是没有加载完（目前的 offsetTop 是不包含图片的，值不对的原因：没有把图片计算在内）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">之前可以是因为图片已经缓存下来了，再次刷新时就可以发现它重新把图片计算在内，滚动位置正确了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">一旦重新从首页进入其他商品详情时，滚动位置仍然是错误的</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">总结： offsetTop 值不对是一般都是因为图片的问题</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以我们选择在图片 load 时，获取 offsetTop</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">下图可以发现只有第一次获取的值是不对的，但是后面的值都是对的，出现了重复调用过于频繁的问题</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [214].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [215].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [216].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/2020-06-28_154332.jpg" type="image/jpeg" data-filename="2020-06-28_154332.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [217].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="10- 购物街_files/3 [218].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DeatailNavBar.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div slot=&quot;left&quot; class=&quot;back&quot; @click=&quot;backClick&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img src=&quot;~assets/img/common/back.svg&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div slot=&quot;center&quot; class=&quot;title&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;item&quot; :class=&quot;{active: index === currentIndex}&quot;</font></div><div><font style="font-size: 12pt;">            @click=&quot;tabClick(index)&quot; v-for=&quot;(item, index) of title&quot; :key=&quot;index&quot;&gt;</font></div><div><font style="font-size: 12pt;">        {{item}}</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'DetailNavBar',</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        title: ['商品', '详情', '评论', '推荐'],</font></div><div><font style="font-size: 12pt;">        currentIndex: 0</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        this.currentIndex = index;</font></div><div><font style="font-size: 12pt;">        <b>this.$emit('titleClick', index);</b></font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      backClick() {</font></div><div><font style="font-size: 12pt;">        this.$router.back();</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      NavBar</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;<font style="font-size: 12pt;">template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-nav-bar class=&quot;detail-nav&quot; <b>@titleClick=&quot;titleClick&quot;</b>&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-goods-info :detailInfo=&quot;detailInfo&quot; <b>@imgLoad=&quot;imgLoad&quot;</b>&gt;&lt;/detail-goods-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-params-info :paramInfo=&quot;paramInfo&quot; <b>ref=&quot;params&quot;</b>&gt;&lt;/detail-params-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-comment-info :comment-info=&quot;commentInfo&quot; <b>ref=&quot;comment&quot;</b>&gt;&lt;/detail-comment-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;recommends&quot; <b>ref=&quot;recommend&quot;</b>&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</font></div><div><font style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import DetailGoodsInfo from './childCpns/DetailGoodsInfo';</font></div><div><font style="font-size: 12pt;">  import DetailParamsInfo from './childCpns/DetailParamInfo';</font></div><div><font style="font-size: 12pt;">  import DetailCommentInfo from './childCpns/DetailCommentInfo';</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods, Shop, GoodsParam, getRecommend} from 'network/detail';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  <b>import { debounce } from &quot;commonjs/utils.js&quot;;</b></font></div><div><font style="font-size: 12pt;">  import {itemListenerMixin} from 'commonjs/mixin';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    mixins: [itemListenerMixin],</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {},</font></div><div><font style="font-size: 12pt;">        shop: {},</font></div><div><font style="font-size: 12pt;">        detailInfo: {},</font></div><div><font style="font-size: 12pt;">        paramInfo: {},</font></div><div><font style="font-size: 12pt;">        commentInfo: {},</font></div><div><font style="font-size: 12pt;">        recommends: [],</font></div><div><font style="font-size: 12pt;">        <b>titleTopY: [],</b></font></div><div><font style="font-size: 12pt;"><b>        getTitleTopY: null</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        const data =  res.result;</font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</font></div><div><font style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo);</font></div><div><font style="font-size: 12pt;">        this.detailInfo = data.detailInfo;</font></div><div><font style="font-size: 12pt;">        this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);</font></div><div><font style="font-size: 12pt;">        if (data.rate.list) {</font></div><div><font style="font-size: 12pt;">          this.commentInfo = data.rate.list[0];</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      getRecommend().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        this.recommends = res.data.list</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">     <b> this.getTitleTopY = debounce(() =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>        this.titleTopY = [];</b></font></div><div><font style="font-size: 12pt;"><b>        this.titleTopY.push(0);</b></font></div><div><font style="font-size: 12pt;"><b>        this.titleTopY.push(this.$refs.params.$el.offsetTop);</b></font></div><div><font style="font-size: 12pt;"><b>        this.titleTopY.push(this.$refs.comment.$el.offsetTop);</b></font></div><div><font style="font-size: 12pt;"><b>        this.titleTopY.push(this.$refs.recommend.$el.offsetTop);</b></font></div><div><font style="font-size: 12pt;"><b>      }, 100)</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    destroyed() {</font></div><div><font style="font-size: 12pt;">      this.$bus.$off('itemImgLoad', this.itemImgListener);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      <b>imgLoad() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$refs.scroll.refresh();</b></font></div><div><font style="font-size: 12pt;"><b>        this.getTitleTopY();</b></font></div><div><font style="font-size: 12pt;"><b>      }</b>,</font></div><div><font style="font-size: 12pt;">      <b>titleClick(index) {</b></font></div><div><font style="font-size: 12pt;"><b>        this.$refs.scroll.scrollTo(0, -this.titleTopY[index] + 44, 100)</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">      DetailBaseInfo,</font></div><div><font style="font-size: 12pt;">      DetailShopInfo,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      DetailGoodsInfo,</font></div><div><font style="font-size: 12pt;">      DetailParamsInfo,</font></div><div><font style="font-size: 12pt;">      DetailCommentInfo,</font></div><div><font style="font-size: 12pt;">      GoodsList</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="10- 购物街_files/3 [219].jpg" type="image/jpeg" data-filename="3.jpg"/></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">首</span><span style="font-size: 12pt;">页</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">详情页收藏</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">购物车</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">搜索</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">分类商品展示</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">登录注册</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">个人中心（查看订单、更换头像）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">订单</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">聊天</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div></div><div><br/></div></span>
</div></body></html> 