<html>
<head>
  <title>12 - 购物街</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/606060 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3162"/>
<h1>12 - 购物街</h1>

<div>
<span><div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">点击标题滚动到对应内容 效果图</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3.gif" type="image/gif" data-filename="3.gif"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">滚动内容显示对应标题</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3.jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [1].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [2].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">i &lt; length - 1 表示 0 、1、2 前三种情况时</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">i === length - 1 表示 最后一种情况，即大于等于 9120 值时</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">由于打印</span> <span style="font-size: 12pt;">this.currentIndex 时</span><span style="font-size: 12pt;">太频繁，使用 this.currentIndex !== i 表示 currentIndex 与 i 不一致时才把 i  赋值给 currentIndex  </span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [3].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当 i 为 0 0 0 时，由于 this.currentIndex 为 0 所以不打印，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当 i 为 1 1 1 时，由于第一个 1时执行了 this.currentIndex = i ，所以 this.currentIndex = 1，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">等到第二个 1 时，由于 this.currentIndex === i，所以不会执行后面的条件，也就不会执行 </span><span style="font-size: 12pt;">this.currentIndex = i，打印 </span><span style="font-size: 12pt;">this.currentIndex</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">依此类推，所以 1、2 、3 只打印一次</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [4].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">对复杂判断条件进行分析和优化</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [5].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">JS 能传的最大值是 Number.MAX__VALUE，但是存那么大的值会有内存</span><span style="font-size: 12pt;">问题，虽然 number 会占空间，但是它占的空间不会特别多</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [6].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [7].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">当判断条件特别多时也会影响性能的，比如上图注释的判断条件</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">操作系统里有句话叫：用空间换时间，多一些变量多占一点空间，但是目的是为了提高运算性能</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [8].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-nav-bar class=&quot;detail-nav&quot; @titleClick=&quot;titleClick&quot; <b>ref=&quot;nav&quot;</b>&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot; <b>:probe-type=&quot;3&quot; @scroll=&quot;contentScroll&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-goods-info :detailInfo=&quot;detailInfo&quot; @imgLoad=&quot;imgLoad&quot;&gt;&lt;/detail-goods-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-params-info :paramInfo=&quot;paramInfo&quot; ref=&quot;params&quot;&gt;&lt;/detail-params-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-comment-info :comment-info=&quot;commentInfo&quot; ref=&quot;comment&quot;&gt;&lt;/detail-comment-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;recommends&quot; ref=&quot;recommend&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</font></div><div><font style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import DetailGoodsInfo from './childCpns/DetailGoodsInfo';</font></div><div><font style="font-size: 12pt;">  import DetailParamsInfo from './childCpns/DetailParamInfo';</font></div><div><font style="font-size: 12pt;">  import DetailCommentInfo from './childCpns/DetailCommentInfo';</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods, Shop, GoodsParam, getRecommend} from 'network/detail';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { debounce } from &quot;commonjs/utils.js&quot;;</font></div><div><font style="font-size: 12pt;">  import {itemListenerMixin} from 'commonjs/mixin';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    mixins: [itemListenerMixin],</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {},</font></div><div><font style="font-size: 12pt;">        shop: {},</font></div><div><font style="font-size: 12pt;">        detailInfo: {},</font></div><div><font style="font-size: 12pt;">        paramInfo: {},</font></div><div><font style="font-size: 12pt;">        commentInfo: {},</font></div><div><font style="font-size: 12pt;">        recommends: [],</font></div><div><font style="font-size: 12pt;">        titleTopY: [],</font></div><div><font style="font-size: 12pt;">        getTitleTopY: null,</font></div><div><font style="font-size: 12pt;">        <b>currentIndex: 0,</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        const data =  res.result;</font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</font></div><div><font style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo);</font></div><div><font style="font-size: 12pt;">        this.detailInfo = data.detailInfo;</font></div><div><font style="font-size: 12pt;">        this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);</font></div><div><font style="font-size: 12pt;">        if (data.rate.list) {</font></div><div><font style="font-size: 12pt;">          this.commentInfo = data.rate.list[0];</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      getRecommend().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        this.recommends = res.data.list</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      this.getTitleTopY = debounce(() =&gt; {</font></div><div><font style="font-size: 12pt;">        this.titleTopY = [];</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(0);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.params.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.comment.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.recommend.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(Number.MAX_VALUE);</font></div><div><font style="font-size: 12pt;">      }, 100)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    destroyed() {</font></div><div><font style="font-size: 12pt;">      this.$bus.$off('itemImgLoad', this.itemImgListener);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      imgLoad() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">        this.getTitleTopY();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      titleClick(index) {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, -this.titleTopY[index] + 44, 100)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      <b>contentScroll(position) {</b></font></div><div><font style="font-size: 12pt;"><b>        let positionY = -position.y;</b></font></div><div><font style="font-size: 12pt;"><b>        let length = this.titleTopY.length;</b></font></div><div><font style="font-size: 12pt;"><b>        for (let i = 0; i &lt; length - 1; i++) {</b></font></div><div><font style="font-size: 12pt;"><b>          if (this.currentIndex !== i &amp;&amp;</b></font></div><div><font style="font-size: 12pt;"><b>          (positionY &gt;= this.titleTopY[i] - 44 &amp;&amp; positionY &lt; this.titleTopY[i + 1])) {</b></font></div><div><font style="font-size: 12pt;"><b>            this.currentIndex = i;</b></font></div><div><font style="font-size: 12pt;"><b>            this.$refs.nav.currentIndex = this.currentIndex;</b></font></div><div><font style="font-size: 12pt;"><b>          }</b></font></div><div><font style="font-size: 12pt;"><b>        }  </b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">      DetailBaseInfo,</font></div><div><font style="font-size: 12pt;">      DetailShopInfo,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      DetailGoodsInfo,</font></div><div><font style="font-size: 12pt;">      DetailParamsInfo,</font></div><div><font style="font-size: 12pt;">      DetailCommentInfo,</font></div><div><font style="font-size: 12pt;">      GoodsList</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [1].gif" type="image/gif" data-filename="3.gif"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">底部工具栏的封装</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [9].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">BackTop 的混入封装</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">为了不重复复制代码到 Detail.vue，所以要把两个组件公共的代码抽离出去</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [10].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">mixin 不能对 methods 的方法进行抽取，然后合二为一，所以 mixin 的方法名不能与 methods 方法名相同（同名时 mixin 会覆盖 methods 的方法），</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">其他如 components、data()、生命周期函数名字等可以相同</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">可以这样抽：</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [11].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">正式的抽法：</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [12].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [13].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [14].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [15].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [16].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">mixin.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import { debounce } from &quot;commonjs/utils.js&quot;;</font></div><div><font style="font-size: 12pt;"><b>import BackUp from &quot;content/backUp/BackUp&quot;;</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export const itemListenerMixin = {</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      itemImgListener: null</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  mounted() {</font></div><div><font style="font-size: 12pt;">    const refresh = debounce(this.$refs.scroll.refresh, 50);</font></div><div><font style="font-size: 12pt;">    this.itemImgListener = () =&gt; refresh();</font></div><div><font style="font-size: 12pt;">    this.$bus.$on(&quot;itemImgLoad&quot;, this.itemImgListener);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><b>export const backUpMixin = {</b></font></div><div><font style="font-size: 12pt;"><b>  components: {</b></font></div><div><font style="font-size: 12pt;"><b>    BackUp</b></font></div><div><font style="font-size: 12pt;"><b>  },</b></font></div><div><font style="font-size: 12pt;"><b>  data() {</b></font></div><div><font style="font-size: 12pt;"><b>    return {</b></font></div><div><font style="font-size: 12pt;"><b>      isShowBackUp: false</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;"><b>  },</b></font></div><div><font style="font-size: 12pt;"><b>  methods: {</b></font></div><div><font style="font-size: 12pt;"><b>    backClick() {</b></font></div><div><font style="font-size: 12pt;"><b>      this.$refs.scroll.scrollTo(0, 0, 300);</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    listenShowBackUp(position) {</b></font></div><div><font style="font-size: 12pt;"><b>      this.isShowBackUp = -position.y &gt; 1000;</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;"><b>}</b></font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-nav-bar class=&quot;detail-nav&quot; @titleClick=&quot;titleClick&quot; ref=&quot;nav&quot;&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot; :probe-type=&quot;3&quot; @scroll=&quot;contentScroll&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-goods-info :detailInfo=&quot;detailInfo&quot; @imgLoad=&quot;imgLoad&quot;&gt;&lt;/detail-goods-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-params-info :paramInfo=&quot;paramInfo&quot; ref=&quot;params&quot;&gt;&lt;/detail-params-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-comment-info :comment-info=&quot;commentInfo&quot; ref=&quot;comment&quot;&gt;&lt;/detail-comment-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;recommends&quot; ref=&quot;recommend&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</b></font></div><div><font style="font-size: 12pt;">    <b>&lt;detail-bottom-bar&gt;&lt;/detail-bottom-bar&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</font></div><div><font style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import DetailGoodsInfo from './childCpns/DetailGoodsInfo';</font></div><div><font style="font-size: 12pt;">  import DetailParamsInfo from './childCpns/DetailParamInfo';</font></div><div><font style="font-size: 12pt;">  import DetailCommentInfo from './childCpns/DetailCommentInfo';</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList';</font></div><div><font style="font-size: 12pt;"> <b> import DetailBottomBar from './childCpns/DetailBottomBar';</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods, Shop, GoodsParam, getRecommend} from 'network/detail';</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import { debounce } from &quot;commonjs/utils.js&quot;;</font></div><div><font style="font-size: 12pt;">  <b>import {itemListenerMixin, backUpMixin } from 'commonjs/mixin';</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    <b>mixins: [itemListenerMixin, backUpMixin],</b></font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {},</font></div><div><font style="font-size: 12pt;">        shop: {},</font></div><div><font style="font-size: 12pt;">        detailInfo: {},</font></div><div><font style="font-size: 12pt;">        paramInfo: {},</font></div><div><font style="font-size: 12pt;">        commentInfo: {},</font></div><div><font style="font-size: 12pt;">        recommends: [],</font></div><div><font style="font-size: 12pt;">        titleTopY: [],</font></div><div><font style="font-size: 12pt;">        getTitleTopY: null,</font></div><div><font style="font-size: 12pt;">        currentIndex: 0,</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        const data =  res.result;</font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</font></div><div><font style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo);</font></div><div><font style="font-size: 12pt;">        this.detailInfo = data.detailInfo;</font></div><div><font style="font-size: 12pt;">        this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);</font></div><div><font style="font-size: 12pt;">        if (data.rate.list) {</font></div><div><font style="font-size: 12pt;">          this.commentInfo = data.rate.list[0];</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      getRecommend().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        this.recommends = res.data.list</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      this.getTitleTopY = debounce(() =&gt; {</font></div><div><font style="font-size: 12pt;">        this.titleTopY = [];</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(0);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.params.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.comment.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.recommend.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(Number.MAX_VALUE);</font></div><div><font style="font-size: 12pt;">      }, 100)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    destroyed() {</font></div><div><font style="font-size: 12pt;">      this.$bus.$off('itemImgLoad', this.itemImgListener);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      imgLoad() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">        this.getTitleTopY();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      titleClick(index) {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, -this.titleTopY[index] + 44, 100)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        let positionY = -position.y;</font></div><div><font style="font-size: 12pt;">        let length = this.titleTopY.length;</font></div><div><font style="font-size: 12pt;">        for (let i = 0; i &lt; length - 1; i++) {</font></div><div><font style="font-size: 12pt;">          if (this.currentIndex !== i &amp;&amp;</font></div><div><font style="font-size: 12pt;">          (positionY &gt;= this.titleTopY[i] &amp;&amp; positionY &lt; this.titleTopY[i + 1])) {</font></div><div><font style="font-size: 12pt;">            this.currentIndex = i;</font></div><div><font style="font-size: 12pt;">            this.$refs.nav.currentIndex = this.currentIndex;</font></div><div><font style="font-size: 12pt;">          }</font></div><div><font style="font-size: 12pt;">        }  </font></div><div><font style="font-size: 12pt;">        <b>this.listenShowBackUp(position)</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">      DetailBaseInfo,</font></div><div><font style="font-size: 12pt;">      DetailShopInfo,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      DetailGoodsInfo,</font></div><div><font style="font-size: 12pt;">      DetailParamsInfo,</font></div><div><font style="font-size: 12pt;">      DetailCommentInfo,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      <b>DetailBottomBar,</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #detail {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    z-index: 1;</font></div><div><font style="font-size: 12pt;">    height: 100vh;</font></div><div><font style="font-size: 12pt;">    background-color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .detail-nav {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    z-index: 1;</font></div><div><font style="font-size: 12pt;">    background-color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .content {</font></div><div><font style="font-size: 12pt;">    height: calc(100% - 102px);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;"><b>  .back-up {</b></font></div><div><font style="font-size: 12pt;"><b>    position: fixed;</b></font></div><div><font style="font-size: 12pt;"><b>    right: 8px;</b></font></div><div><font style="font-size: 12pt;"><b>    bottom: 55px;  </b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">DetailBottomBar.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;bottom-bar&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;bar-item bar-left&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;i class=&quot;icon service&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">        &lt;span class=&quot;text&quot;&gt;客服&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;i class=&quot;icon shop&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">        &lt;span class=&quot;text&quot;&gt;店铺&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;i class=&quot;icon select&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">        &lt;span class=&quot;text&quot;&gt;收藏&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;bar-item bar-right&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;cart&quot; @click=&quot;addToCart&quot;&gt;加入购物车&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;buy&quot;&gt;购买&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: &quot;DetailBottomBar&quot;,</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      addToCart() {</font></div><div><font style="font-size: 12pt;">        this.$emit('addToCart')</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .bottom-bar {</font></div><div><font style="font-size: 12pt;">    height: 58px;</font></div><div><font style="font-size: 12pt;">    <b>position: relative;</b></font></div><div><font style="font-size: 12pt;">    background-color: #fff;</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bar-item {</font></div><div><font style="font-size: 12pt;">    flex: 1;</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bar-item&gt;div {</font></div><div><font style="font-size: 12pt;">    flex: 1;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bar-left .text {</font></div><div><font style="font-size: 12pt;">    font-size: 13px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bar-left .icon {</font></div><div><font style="font-size: 12pt;">    display: block;</font></div><div><font style="font-size: 12pt;">    width: 22px;</font></div><div><font style="font-size: 12pt;">    height: 22px;</font></div><div><font style="font-size: 12pt;">    margin: 10px auto 3px;</font></div><div><font style="font-size: 12pt;">    background: url(&quot;~assets/img/detail/detail_bottom.png&quot;) 0 0/100%;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bar-left .service {</font></div><div><font style="font-size: 12pt;">    background-position: 0 -54px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bar-left .shop {</font></div><div><font style="font-size: 12pt;">    background-position: 0 -98px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bar-right {</font></div><div><font style="font-size: 12pt;">    font-size: 15px;</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    line-height: 58px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bar-right .cart {</font></div><div><font style="font-size: 12pt;">    background-color: #ffe817;</font></div><div><font style="font-size: 12pt;">    color: #333;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bar-right .buy {</font></div><div><font style="font-size: 12pt;">    background-color: #f69;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;</font></div><div><font style="font-size: 12pt;">                 class=&quot;fixed&quot; v-show=&quot;isTabFixed&quot;  ref=&quot;tabControl1&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot;</font></div><div><font style="font-size: 12pt;">            ref=&quot;scroll&quot;</font></div><div><font style="font-size: 12pt;">            :probe-type=&quot;3&quot;</font></div><div><font style="font-size: 12pt;">            :pull-up-load=&quot;true&quot;</font></div><div><font style="font-size: 12pt;">            @scroll=&quot;contentScroll&quot;</font></div><div><font style="font-size: 12pt;">            @pullingUp=&quot;loadMore&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot; @swiperImageLoad=&quot;swiperImageLoad&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot;  </font></div><div><font style="font-size: 12pt;">                   @tabClick=&quot;tabClick&quot;</font></div><div><font style="font-size: 12pt;">                   ref=&quot;tabControl2&quot; &gt;</font></div><div><font style="font-size: 12pt;">      &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper';</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend';</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView';</font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar';</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl';</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"> <b> import {itemListenerMixin, backUpMixin} from 'commonjs/mixin';</b></font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> mixins: [itemListenerMixin, backUpMixin],</b></font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop',</font></div><div><font style="font-size: 12pt;">        tabOffsetTop: 0,</font></div><div><font style="font-size: 12pt;">        isTabFixed: false,</font></div><div><font style="font-size: 12pt;">        scrollY: 0     </font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created() {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    activated () {</font></div><div><font style="font-size: 12pt;">      this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      this.$refs.scroll.scrollTo(0, this.scrollY, 0);     </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    deactivated () {</font></div><div><font style="font-size: 12pt;">      this.scrollY = this.$refs.scroll.getScrollY();</font></div><div><font style="font-size: 12pt;">      this.$bus.$off('itemImgLoad', this.itemImgListener);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell';</font></div><div><font style="font-size: 12pt;">            break;   </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        this.$refs.tabControl1.currentIndex = index;</font></div><div><font style="font-size: 12pt;">        this.$refs.tabControl2.currentIndex = index;</font></div><div><font style="font-size: 12pt;">      }</font><span style="font-size: 12pt;">,</span></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        <b>this.listenShowBackUp(position);</b></font></div><div><font style="font-size: 12pt;">        this.isTabFixed = (-position.y) &gt; this.tabOffsetTop;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      loadMore() {</font></div><div><font style="font-size: 12pt;">        this.getHomeGoods(this.currentType);</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      swiperImageLoad() {       </font></div><div><font style="font-size: 12pt;">        this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;      </font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">           this.$refs.scroll.finishPullUp();</font></div><div><font style="font-size: 12pt;">        });        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #home {</font></div><div><font style="font-size: 12pt;">    height: 100vh;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    z-index: 1;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .content {</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    top: 44px;</font></div><div><font style="font-size: 12pt;">    bottom: 49px;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;   </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .back-up {</font></div><div><font style="font-size: 12pt;">    position: fixed;</font></div><div><font style="font-size: 12pt;">    right: 8px;</font></div><div><font style="font-size: 12pt;">    bottom: 55px;  </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .fixed {</font></div><div><font style="font-size: 12pt;">    position: fixed;</font></div><div><font style="font-size: 12pt;">    top: 44px;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;   </font></div><div><font style="font-size: 12pt;">    z-index: 1;</font></div><div><font style="font-size: 12pt;">    background-color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [2].gif" type="image/gif" data-filename="3.gif"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">coderwhy 老师喜欢使用 relative 进行微调</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Bug：首页其实应该监听三张图片全部加载完毕再刷新</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">将商品添加到购物车中</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [17].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">要知道获取哪些商品信息才能知道怎么做购物车（</span><span style="font-size: 12pt;">图片、标题、描述、价格、数量</span><span style="font-size: 12pt;">）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">在这个购物车里，有个不足就是：无法任意选择数量，必须返回再点击一次加入购物车才能增加数量</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">注意：加入购物车时必须带有 id ，给服务器使用</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">使用事件总线的话，</span><span style="font-size: 12pt;">如果</span><span style="font-size: 12pt;">购物车组件压根没有创建出来，也就没法监听到 product 的值了</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [18].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">假如使用 Vuex ，如果有其他页面也有加入购物车功能，那么 Vuex 就可以一并处理了</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [19].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [20].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [21].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex 代码的重构</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">mutations 做的事要尽量单一，而不是像下面这样要么加 1，要么添加新的商品，这样方便在调试工具中对状态进行跟踪</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [22].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">所以建议把多余的逻辑放到 actions 里</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [23].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [24].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [25].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">再次优化</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [26].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [27].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [28].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [29].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex 知识点</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">实现购物车页面</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [30].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">购物车() 括号里的数字应该通过 Vuex 的 cartList 传给它</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [31].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">第一种办法是计算属性</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [32].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">第二种办法是使用 Vuex 的 getters，使用 cartList 的地方多时适合使用 getters，mapGetters 将 getters 里的函数直接映射为 computed 里的局部计算属性</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [33].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [34].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Deatail.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-nav-bar class=&quot;detail-nav&quot; @titleClick=&quot;titleClick&quot; ref=&quot;nav&quot;&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot; :probe-type=&quot;3&quot; @scroll=&quot;contentScroll&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-goods-info :detailInfo=&quot;detailInfo&quot; @imgLoad=&quot;imgLoad&quot;&gt;&lt;/detail-goods-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-params-info :paramInfo=&quot;paramInfo&quot; ref=&quot;params&quot;&gt;&lt;/detail-params-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-comment-info :comment-info=&quot;commentInfo&quot; ref=&quot;comment&quot;&gt;&lt;/detail-comment-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;recommends&quot; ref=&quot;recommend&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;detail-bottom-bar @addToCart=&quot;addToCart&quot;&gt;&lt;/detail-bottom-bar&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</font></div><div><font style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import DetailGoodsInfo from './childCpns/DetailGoodsInfo';</font></div><div><font style="font-size: 12pt;">  import DetailParamsInfo from './childCpns/DetailParamInfo';</font></div><div><font style="font-size: 12pt;">  import DetailCommentInfo from './childCpns/DetailCommentInfo';</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList';</font></div><div><font style="font-size: 12pt;">  import DetailBottomBar from './childCpns/DetailBottomBar';</font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods, Shop, GoodsParam, getRecommend} from 'network/detail';</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import { debounce } from &quot;commonjs/utils.js&quot;;</font></div><div><font style="font-size: 12pt;">  import {itemListenerMixin, backUpMixin } from 'commonjs/mixin';</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    mixins: [itemListenerMixin, backUpMixin],</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {},</font></div><div><font style="font-size: 12pt;">        shop: {},</font></div><div><font style="font-size: 12pt;">        detailInfo: {},</font></div><div><font style="font-size: 12pt;">        paramInfo: {},</font></div><div><font style="font-size: 12pt;">        commentInfo: {},</font></div><div><font style="font-size: 12pt;">        recommends: [],</font></div><div><font style="font-size: 12pt;">        titleTopY: [],</font></div><div><font style="font-size: 12pt;">        getTitleTopY: null,</font></div><div><font style="font-size: 12pt;">        currentIndex: 0,</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        const data =  res.result;</font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</font></div><div><font style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo);</font></div><div><font style="font-size: 12pt;">        this.detailInfo = data.detailInfo;</font></div><div><font style="font-size: 12pt;">        this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);</font></div><div><font style="font-size: 12pt;">        if (data.rate.list) {</font></div><div><font style="font-size: 12pt;">          this.commentInfo = data.rate.list[0];</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      getRecommend().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        this.recommends = res.data.list</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      this.getTitleTopY = debounce(() =&gt; {</font></div><div><font style="font-size: 12pt;">        this.titleTopY = [];</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(0);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.params.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.comment.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.recommend.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(Number.MAX_VALUE);</font></div><div><font style="font-size: 12pt;">      }, 100)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    destroyed() {</font></div><div><font style="font-size: 12pt;">      this.$bus.$off('itemImgLoad', this.itemImgListener);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      imgLoad() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">        this.getTitleTopY();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      titleClick(index) {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, -this.titleTopY[index] + 44, 100)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        let positionY = -position.y;</font></div><div><font style="font-size: 12pt;">        let length = this.titleTopY.length;</font></div><div><font style="font-size: 12pt;">        for (let i = 0; i &lt; length - 1; i++) {</font></div><div><font style="font-size: 12pt;">          if (this.currentIndex !== i &amp;&amp;</font></div><div><font style="font-size: 12pt;">          (positionY &gt;= this.titleTopY[i] &amp;&amp; positionY &lt; this.titleTopY[i + 1])) {</font></div><div><font style="font-size: 12pt;">            this.currentIndex = i;</font></div><div><font style="font-size: 12pt;">            this.$refs.nav.currentIndex = this.currentIndex;</font></div><div><font style="font-size: 12pt;">          }</font></div><div><font style="font-size: 12pt;">        }  </font></div><div><font style="font-size: 12pt;">        this.listenShowBackUp(position)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">     <b> addToCart() {</b></font></div><div><font style="font-size: 12pt;"><b>        // 获取购物车要展示的商品信息</b></font></div><div><font style="font-size: 12pt;"><b>        const product = {};</b></font></div><div><font style="font-size: 12pt;"><b>        product.image = this.topImages[0];</b></font></div><div><font style="font-size: 12pt;"><b>        product.title = this.goods.title;</b></font></div><div><font style="font-size: 12pt;"><b>        product.desc = this.goods.desc;</b></font></div><div><font style="font-size: 12pt;"><b>        <font color="#FF0000">product.price = this.goods.lowNowPrice;</font></b></font></div><div><font style="font-size: 12pt;"><b>        product.iid = this.iid;</b></font></div><div><font style="font-size: 12pt;"><b>        // 将商品添加到购物车</b></font></div><div><font style="font-size: 12pt;"><b>        this.$store.dispatch('addCart', product);</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">      DetailBaseInfo,</font></div><div><font style="font-size: 12pt;">      DetailShopInfo,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      DetailGoodsInfo,</font></div><div><font style="font-size: 12pt;">      DetailParamsInfo,</font></div><div><font style="font-size: 12pt;">      DetailCommentInfo,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      DetailBottomBar,</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">index.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">import Vuex from 'vuex'</font></div><div><font style="font-size: 12pt;">import mutations from './mutations';</font></div><div><font style="font-size: 12pt;">import actions from './actions';</font></div><div><font style="font-size: 12pt;">import getters from './getters';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.use(Vuex)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const state = {</font></div><div><font style="font-size: 12pt;">  cartList: []</font></div><div><font style="font-size: 12pt;">};</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const store = new Vuex.Store({</font></div><div><font style="font-size: 12pt;">  state,</font></div><div><font style="font-size: 12pt;">  mutations,</font></div><div><font style="font-size: 12pt;">  actions,</font></div><div><font style="font-size: 12pt;">  getters,</font></div><div><font style="font-size: 12pt;">  modules: {}</font></div><div><font style="font-size: 12pt;">});</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default store</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">mutations-type.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">export const ADD_COUNTER = 'addCounter';</font></div><div><font style="font-size: 12pt;">export const ADD_TO_CART = 'addToCart';</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">actions.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import { ADD_COUNTER, ADD_TO_CART } from &quot;./mutations-type&quot;;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  <b>addCart({ commit, state }, payload) {</b></font></div><div><font style="font-size: 12pt;"><b>    // 查找之前是否有该商品，cartList 中有该商品，就赋值给 oldProduct</b></font></div><div><font style="font-size: 12pt;"><b>    // let oldProduct = null;</b></font></div><div><font style="font-size: 12pt;"><b>    // for (let item of state.carList) {</b></font></div><div><font style="font-size: 12pt;"><b>    //   if (item.iid === payload.iid) {</b></font></div><div><font style="font-size: 12pt;"><b>    //     oldProduct = item</b></font></div><div><font style="font-size: 12pt;"><b>    //   }</b></font></div><div><font style="font-size: 12pt;"><b>    // }</b></font></div><div><font style="font-size: 12pt;"><b>    // 之前有该商品就将该商品的数量加 1</b></font></div><div><font style="font-size: 12pt;"><b>    let oldProduct = state.cartList.find(item =&gt; item.iid === payload.iid);</b></font></div><div><font style="font-size: 12pt;"><b>    if (oldProduct) {</b></font></div><div><font style="font-size: 12pt;"><b>      // oldProduct.count += 1;</b></font></div><div><font style="font-size: 12pt;"><b>      commit(ADD_COUNTER, oldProduct);</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;"><b>    // 之前没有该商品就该商品的数量设置为 1 并添加到购物车</b></font></div><div><font style="font-size: 12pt;"><b>    else {</b></font></div><div><font style="font-size: 12pt;"><b>      payload.count = 1;</b></font></div><div><font style="font-size: 12pt;"><b>      // state.cartList.push(payload);</b></font></div><div><font style="font-size: 12pt;"><b>      commit(ADD_TO_CART, payload);</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">mutations.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import {ADD_COUNTER, ADD_TO_CART} from './mutations-type'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;"><b>  [ADD_COUNTER](state, payload) {</b></font></div><div><font style="font-size: 12pt;"><b>    payload.count++;</b></font></div><div><font style="font-size: 12pt;"><b>  },</b></font></div><div><font style="font-size: 12pt;"><b>  [ADD_TO_CART](state, payload) {</b></font></div><div><font style="font-size: 12pt;"><b>    state.cartList.push(payload);</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">};</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">getters.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;"> <b> cartLength(state) {</b></font></div><div><font style="font-size: 12pt;"><b>    return state.cartList.length</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Cart.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;cart&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-Bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物车(<b>{{length}}</b>)&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-Bar&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import navBar from 'common/navbar/NavBar';</font></div><div><font style="font-size: 12pt;">  import {mapGetters} from 'vuex';</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Cart',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      navBar</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> computed: {</b></font></div><div><font style="font-size: 12pt;"><b>      ...mapGetters({</b></font></div><div><font style="font-size: 12pt;"><b>        length: 'cartLength'</b></font></div><div><font style="font-size: 12pt;"><b>      })</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [3].gif" type="image/gif" data-filename="3.gif"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">购物车商品列表展示</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [35].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [36].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">最外层为 .cart ，第二层为 .cart-list ，第三层为 content，要给 content 一个确定高度</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [37].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [38].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [39].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Emmet 语法</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">li{内容$}*100</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [40].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [41].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">购物车页面无法滚动问题：</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">因为一开始进入购物车页面时，可滚动区域高度 </span><span style="font-size: 12pt;">scrollHeight = 0，</span><span style="font-size: 12pt;">添加数据后，scrollHeight = 0（better-scroll 并不知道添加了数据，所以还是和初始高度一样）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">所以如果再次进入购物车页面时，最好要 refresh 刷新 一次，</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">因为有自动缓存，所以要在 activated() 生命周期函数中刷新</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [42].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">将 checkButton 全选按钮组件封装在 content 里</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [43].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [44].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">item 选中和不选中的切换</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">是在对象模型里切换的，即 Vuex 的 商品数据中切换</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [45].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [46].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [47].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [48].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">底部工具栏的封装</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [49].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [50].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [51].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [52].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [53].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [54].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Cart.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;cart&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-Bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物车({{length}})&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-Bar&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;cart-list&gt;&lt;/cart-list&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import navBar from 'common/navbar/NavBar';</font></div><div><font style="font-size: 12pt;">  import {mapGetters} from 'vuex';</font></div><div><font style="font-size: 12pt;">  <b>import CartList from './childCpns/CartList';</b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Cart',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      navBar,</font></div><div><font style="font-size: 12pt;">      <b>CartList</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> </b>computed: {</font></div><div><font style="font-size: 12pt;">      ...mapGetters({</font></div><div><font style="font-size: 12pt;">        length: 'cartLength'</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;"> <b> .cart {</b></font></div><div><font style="font-size: 12pt;"><b>    height: 100vh;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">CartList.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;cart-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;cart-list-item</b></font></div><div><font style="font-size: 12pt;"><b>        v-for=&quot;item of cartList&quot;</b></font></div><div><font style="font-size: 12pt;"><b>        :key=&quot;item.iid&quot;</b></font></div><div><font style="font-size: 12pt;"><b>        :item-info=&quot;item&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;/cart-list-item&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/scroll&gt;</b></font></div><div><font style="font-size: 12pt;">    <b>&lt;cart-bottom-bar&gt;&lt;/cart-bottom-bar&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"> <b> import Scroll from 'common/scroll/Scroll';</b></font></div><div><font style="font-size: 12pt;"><b>  import CartListItem from './CartListItem';</b></font></div><div><font style="font-size: 12pt;">  <b>import CartBottomBar from './CartBottomBar';</b></font></div><div><font style="font-size: 12pt;">  <b>import {mapGetters} from 'vuex';</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'CartList',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      CartListItem,</font></div><div><font style="font-size: 12pt;">      CartBottomBar</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  <b>  computed: {</b></font></div><div><font style="font-size: 12pt;"><b>      ...mapGetters({</b></font></div><div><font style="font-size: 12pt;"><b>        cartList: 'cartList'</b></font></div><div><font style="font-size: 12pt;"><b>      })</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;">   <b> activated () {</b></font></div><div><font style="font-size: 12pt;"><b>      this.$refs.scroll.refresh();</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  <b>.cart-list {</b></font></div><div><font style="font-size: 12pt;"><b>    height: calc(100% - 137px);</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">  <b>.content {</b></font></div><div><font style="font-size: 12pt;"><b>    height: 100%;</b></font></div><div><font style="font-size: 12pt;"><b>    overflow: hidden;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">CheckButton.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;icon-selector&quot; <b>:class=&quot;{check: isChecked}&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img src=&quot;~/assets/img/cart/tick.svg&quot; alt=&quot;&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: &quot;CheckButton&quot;,</font></div><div><font style="font-size: 12pt;">   <b> props: {</b></font></div><div><font style="font-size: 12pt;"><b>      isChecked: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Boolean,</b></font></div><div><font style="font-size: 12pt;"><b>        default: false</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .icon-selector {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    margin: 0;</font></div><div><font style="font-size: 12pt;">    width: 18px;</font></div><div><font style="font-size: 12pt;">    height: 18px;</font></div><div><font style="font-size: 12pt;">    border-radius: 50%;</font></div><div><font style="font-size: 12pt;">    border: 2px solid #ccc;</font></div><div><font style="font-size: 12pt;">    cursor: pointer;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .check {</font></div><div><font style="font-size: 12pt;">    background-color: #ff8198;</font></div><div><font style="font-size: 12pt;">    border-color: #ff8198;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">CartListItem.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;shop-item&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;item-selector&quot;&gt;</font></div><div><font style="font-size: 12pt;">      <b>&lt;check-button :is-checked=&quot;itemInfo.checked&quot; @click.native=&quot;checkClick&quot;&gt;&lt;/check-button&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;item-img&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;img :src=&quot;itemInfo.image&quot; alt=&quot;商品图片&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;item-info&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;item-title&quot;&gt;{{itemInfo.title}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;item-desc&quot;&gt;商品描述: {{itemInfo.desc}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;info-bottom&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;item-price left&quot;&gt;{{itemInfo.price}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;item-count right&quot;&gt;x{{itemInfo.count}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"> <b> import CheckButton from 'content/checkButton/CheckButton'</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'CartListItem',</font></div><div><font style="font-size: 12pt;">    <b>props: {</b></font></div><div><font style="font-size: 12pt;"><b>      itemInfo: {</b></font></div><div><font style="font-size: 12pt;"><b>        type: Object,</b></font></div><div><font style="font-size: 12pt;"><b>        default() {</b></font></div><div><font style="font-size: 12pt;"><b>          return {}</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">   <b> components: {</b></font></div><div><font style="font-size: 12pt;"><b>      CheckButton</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;">    <b>methods: {</b></font></div><div><font style="font-size: 12pt;"><b>      checkClick() {</b></font></div><div><font style="font-size: 12pt;"><b>        this.itemInfo.checked = !this.itemInfo.checked</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #shop-item {</font></div><div><font style="font-size: 12pt;">    width: 100%;</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    font-size: 0;</font></div><div><font style="font-size: 12pt;">    padding: 5px;</font></div><div><font style="font-size: 12pt;">    border-bottom: 1px solid #ccc;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .item-selector {</font></div><div><font style="font-size: 12pt;">    width: 14%;</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    justify-content: center;</font></div><div><font style="font-size: 12pt;">    align-items: center;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .item-title, .item-desc {</font></div><div><font style="font-size: 12pt;">    overflow: hidden;</font></div><div><font style="font-size: 12pt;">    white-space: nowrap;</font></div><div><font style="font-size: 12pt;">    text-overflow: ellipsis;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .item-img {</font></div><div><font style="font-size: 12pt;">    padding: 5px;</font></div><div><font style="font-size: 12pt;">    /*border: 1px solid #ccc;*/</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .item-img img {</font></div><div><font style="font-size: 12pt;">    width: 80px;</font></div><div><font style="font-size: 12pt;">    height: 100px;</font></div><div><font style="font-size: 12pt;">    display: block;</font></div><div><font style="font-size: 12pt;">    border-radius: 5px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .item-info {</font></div><div><font style="font-size: 12pt;">    font-size: 17px;</font></div><div><font style="font-size: 12pt;">    color: #333;</font></div><div><font style="font-size: 12pt;">    padding: 5px 10px;</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    overflow: hidden;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .item-info .item-desc {</font></div><div><font style="font-size: 12pt;">    font-size: 14px;</font></div><div><font style="font-size: 12pt;">    color: #666;</font></div><div><font style="font-size: 12pt;">    margin-top: 15px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-bottom {</font></div><div><font style="font-size: 12pt;">    margin-top: 10px;</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    bottom: 10px;</font></div><div><font style="font-size: 12pt;">    left: 10px;</font></div><div><font style="font-size: 12pt;">    right: 10px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .info-bottom .item-price {</font></div><div><font style="font-size: 12pt;">    color: orangered;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">CartBottomBar.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;bottom-bar&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;check-content&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;check-button class=&quot;check-button&quot;&gt;&lt;/check-button&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span&gt;全选&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;total&quot;&gt;</font></div><div><font style="font-size: 12pt;">      合计：<b>{{totalPrice}}</b></font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;calculate&quot;&gt;去计算(<b>{{checkLength}}</b>)&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import CheckButton from 'content/checkButton/CheckButton';</font></div><div><font style="font-size: 12pt;">  <b>import { mapGetters } from 'vuex';</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'CartBottomBar',</font></div><div><font style="font-size: 12pt;">   <b> components: {</b></font></div><div><font style="font-size: 12pt;"><b>      CheckButton</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;">   <b> computed: {</b></font></div><div><font style="font-size: 12pt;"><b>      ...mapGetters(['cartList']),</b></font></div><div><font style="font-size: 12pt;"><b>      totalPrice() {</b></font></div><div><font style="font-size: 12pt;"><b>        return this.cartList.filter(item =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>          return item.checked</b></font></div><div><font style="font-size: 12pt;"><b>        }).reduce((preValue, item) =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>          return preValue + item.price * item.count</b></font></div><div><font style="font-size: 12pt;"><b>        }, 0).toFixed(2)</b></font></div><div><font style="font-size: 12pt;"><b>      },</b></font></div><div><font style="font-size: 12pt;"><b>      checkLength() {</b></font></div><div><font style="font-size: 12pt;"><b>        return this.cartList.filter(item =&gt; item.checked).length</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .bottom-bar {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    height: 44px;</font></div><div><font style="font-size: 12pt;">    line-height: 44px;</font></div><div><font style="font-size: 12pt;">    background-color: #eee;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .check-content {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    align-items: center;</font></div><div><font style="font-size: 12pt;">    margin-left: 40px;</font></div><div><font style="font-size: 12pt;">    width: 60px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .check-button {</font></div><div><font style="font-size: 12pt;">    width: 20px;</font></div><div><font style="font-size: 12pt;">    height: 20px;</font></div><div><font style="font-size: 12pt;">    line-height: 20px;</font></div><div><font style="font-size: 12pt;">    margin-right: 5px;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .total {</font></div><div><font style="font-size: 12pt;">    margin-left: 20px;</font></div><div><font style="font-size: 12pt;">    flex: 1;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .calculate {</font></div><div><font style="font-size: 12pt;">    width: 90px;</font></div><div><font style="font-size: 12pt;">    background-color: orangered;</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [4].gif" type="image/gif" data-filename="3.gif"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [55].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [56].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [57].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [58].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">全选按钮的状态显示</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [59].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [60].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [61].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">三种方案</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [62].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">全选按钮的点击效果</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [63].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [64].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">不可以写成下面的简化代码，否则 checked 与 selectAll 相互影响，效果混乱</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [65].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">CartBottomBar.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;bottom-bar&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;check-content&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;check-button</font></div><div><font style="font-size: 12pt;">        class=&quot;check-button&quot;</font></div><div><font style="font-size: 12pt;">        <b>:is-checked=&quot;isSelectAll&quot;</b></font></div><div><font style="font-size: 12pt;"><b>        @click.native=&quot;checkClick&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/check-button&gt;</font></div><div><font style="font-size: 12pt;">      &lt;span&gt;全选&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;total&quot;&gt;</font></div><div><font style="font-size: 12pt;">      合计：{{totalPrice}}</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;calculate&quot;&gt;去计算({{checkLength}})&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import CheckButton from 'content/checkButton/CheckButton';</font></div><div><font style="font-size: 12pt;">  import { mapGetters } from 'vuex';</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'CartBottomBar',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      CheckButton</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      ...mapGetters(['cartList']),</font></div><div><font style="font-size: 12pt;">      totalPrice() {</font></div><div><font style="font-size: 12pt;">        return this.cartList.filter(item =&gt; {</font></div><div><font style="font-size: 12pt;">          return item.checked</font></div><div><font style="font-size: 12pt;">        }).reduce((preValue, item) =&gt; {</font></div><div><font style="font-size: 12pt;">          return preValue + item.price * item.count</font></div><div><font style="font-size: 12pt;">        }, 0).toFixed(2)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      checkLength() {</font></div><div><font style="font-size: 12pt;">        return this.cartList.filter(item =&gt; item.checked).length</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">     <b> isSelectAll() {</b></font></div><div><font style="font-size: 12pt;"><b>        if (this.cartList.length === 0) {</b></font></div><div><font style="font-size: 12pt;"><b>          return false</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>        // 找到其中的一个商品 checked 为 false，即一个商品不选中则返回该商品，最后返回 false</b></font></div><div><font style="font-size: 12pt;"><b>        // 没有找到其中的一个商品 checked 为 false，即每个商品都选中则返回 undefined，最后返回 true</b></font></div><div><font style="font-size: 12pt;"><b>        return !this.cartList.find(item =&gt; !item.checked)</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods:{</font></div><div><font style="font-size: 12pt;">      <b>checkClick() {</b></font></div><div><font style="font-size: 12pt;"><b>        // 如果全部商品被选中</b></font></div><div><font style="font-size: 12pt;"><b>        if (this.isSelectAll) {</b></font></div><div><font style="font-size: 12pt;"><b>          this.cartList.forEach(item =&gt; item.checked = false)</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>        // 如果全部商品或部分商品不被选中</b></font></div><div><font style="font-size: 12pt;"><b>        else {</b></font></div><div><font style="font-size: 12pt;"><b>          this.cartList.forEach(item =&gt; item.checked = true)</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;"><img src="12 - 购物街_files/3 [5].gif" type="image/gif" data-filename="3.gif"/></span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex - actions 返回 Promise - mapActions</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">弹出模态框提示 —— Toast（太常用，任何一个页面随时可能要显示，所以把这个组件通过一种特别的封装方法，只用一行代码即可显示）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">加入购物车时提示 添加到购物车成功</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [66].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">没有选中商品，点击去计算时提示 请选择要购买的商品</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [67].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">1、dispatch 会返回一个 Promise</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">应该根据  dipatch 的 addCart 返回的结果来提示，而不是在下面直接写显示添加购物车</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [68].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [69].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">2、要想像下图标记处像调用自己的方法一样调用，而不是像下面调用 actions 的方法的话，需要使用 </span><span style="font-size: 12pt;">mapActions 把 Actions 的方法 映射到 Detali.vue 的 methods 里</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [70].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [71].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [72].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Toast 封装 —— 普通方式封装</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [73].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [74].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [75].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [76].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [77].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">然而普通封装很麻烦，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果要在 CartBottomBar 中点击去计算时使用 Toast 的话，就要把 Toast 添加到 Cart 中，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这时点击 去计算 时就要把事件发出去，还要导入注册添加元素，message、show重写等等</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">所以需要另一种封装方式，像 jQuery 一样，一行代码即可</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [78].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Toast 封装 —— 插件方式封装</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">这个组件必须按某一种方式用起来，引入并添加</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">这么做：把组件封装到某一个插件里面，安装这个插件就把组件创建出来并且把组件在最开始的时候就把它添加到</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [79].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: medium; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"><img src="12 - 购物街_files/3 [80].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="box-sizing: border-box; -webkit-tap-highlight-color: transparent;"/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 8px; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 14pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">export default obj;</span></div></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [81].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [82].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [83].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [84].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [85].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [86].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">main.js</span></font></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">import App from './App.vue'</font></div><div><font style="font-size: 12pt;">import router from './router'</font></div><div><font style="font-size: 12pt;">import store from './store'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><b>import toast from 'common/toast';</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.config.devtools = true;</font></div><div><font style="font-size: 12pt;">Vue.config.productionTip = false</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.prototype.$bus = new Vue()</font></div><div><font style="font-size: 12pt;"><b>Vue.use(toast)</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">new Vue({</font></div><div><font style="font-size: 12pt;">  router,</font></div><div><font style="font-size: 12pt;">  store,</font></div><div><font style="font-size: 12pt;">  render: h =&gt; h(App)</font></div><div><font style="font-size: 12pt;">}).$mount('#app')</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">index.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Toast from './Toast';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const obj = {};</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">obj.install = function(Vue) {</font></div><div><font style="font-size: 12pt;">  const toastConstructor = Vue.extend(Toast);</font></div><div><font style="font-size: 12pt;">  const toast = new toastConstructor();</font></div><div><font style="font-size: 12pt;">  toast.$mount(document.createElement('body'));</font></div><div><font style="font-size: 12pt;">  document.body.appendChild(toast.$el);</font></div><div><font style="font-size: 12pt;">  Vue.prototype.$toast = toast;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default obj;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Toast.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;toast&quot; v-show=&quot;isShow&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div&gt;{{message}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: '',</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        isShow: false,</font></div><div><font style="font-size: 12pt;">        message: ''</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      show(message='默认文字', duration=1000) {</font></div><div><font style="font-size: 12pt;">        this.isShow = true;</font></div><div><font style="font-size: 12pt;">        this.message = message;</font></div><div><font style="font-size: 12pt;">        setTimeout(() =&gt; {</font></div><div><font style="font-size: 12pt;">          this.isShow = false;</font></div><div><font style="font-size: 12pt;">          this.message = '';</font></div><div><font style="font-size: 12pt;">        }, duration)</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  .toast {</font></div><div><font style="font-size: 12pt;">    position: fixed;</font></div><div><font style="font-size: 12pt;">    top: 50%;</font></div><div><font style="font-size: 12pt;">    left: 50%;</font></div><div><font style="font-size: 12pt;">    transform: translate(-50%, -50%);</font></div><div><font style="font-size: 12pt;">    z-index: 2;</font></div><div><font style="font-size: 12pt;">    padding: 8px 10px;</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    background-color: rgba(0, 0, 0, .75);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">actions.js</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import { ADD_COUNTER, ADD_TO_CART } from &quot;./mutations-type&quot;;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  addCart({ commit, state }, payload) {</font></div><div><font style="font-size: 12pt;">    // 查找之前是否有该商品，cartList 中有该商品，就赋值给 oldProduct</font></div><div><font style="font-size: 12pt;">    // let oldProduct = null;</font></div><div><font style="font-size: 12pt;">    // for (let item of state.carList) {</font></div><div><font style="font-size: 12pt;">    //   if (item.iid === payload.iid) {</font></div><div><font style="font-size: 12pt;">    //     oldProduct = item</font></div><div><font style="font-size: 12pt;">    //   }</font></div><div><font style="font-size: 12pt;">    // }</font></div><div><font style="font-size: 12pt;">    // 之前有该商品就将该商品的数量加 1</font></div><div><font style="font-size: 12pt;">    <b>return new Promise((resolve, reject) =&gt; {</b></font></div><div><font style="font-size: 12pt;">      let oldProduct = state.cartList.find(item =&gt; item.iid === payload.iid);</font></div><div><font style="font-size: 12pt;">      if (oldProduct) {</font></div><div><font style="font-size: 12pt;">        // oldProduct.count += 1;</font></div><div><font style="font-size: 12pt;">        commit(ADD_COUNTER, oldProduct);</font></div><div><font style="font-size: 12pt;">        <b>resolve('当前商品数量+1')</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      // 之前没有该商品就该商品的数量设置为 1 并添加到购物车</font></div><div><font style="font-size: 12pt;">      else {</font></div><div><font style="font-size: 12pt;">        payload.count = 1;</font></div><div><font style="font-size: 12pt;">        // state.cartList.push(payload);</font></div><div><font style="font-size: 12pt;">        commit(ADD_TO_CART, payload);</font></div><div><font style="font-size: 12pt;">        <b>resolve('添加了新的商品')</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    <b>})</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;detail&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-nav-bar class=&quot;detail-nav&quot; @titleClick=&quot;titleClick&quot; ref=&quot;nav&quot;&gt;&lt;/detail-nav-bar&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot; ref=&quot;scroll&quot; :probe-type=&quot;3&quot; @scroll=&quot;contentScroll&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-swiper :topImages=&quot;topImages&quot;&gt;&lt;/detail-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-base-info :goods=&quot;goods&quot;&gt;&lt;/detail-base-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-shop-info :shop=&quot;shop&quot;&gt;&lt;/detail-shop-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-goods-info :detailInfo=&quot;detailInfo&quot; @imgLoad=&quot;imgLoad&quot;&gt;&lt;/detail-goods-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-params-info :paramInfo=&quot;paramInfo&quot; ref=&quot;params&quot;&gt;&lt;/detail-params-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;detail-comment-info :comment-info=&quot;commentInfo&quot; ref=&quot;comment&quot;&gt;&lt;/detail-comment-info&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;recommends&quot; ref=&quot;recommend&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">    &lt;detail-bottom-bar @addToCart=&quot;addToCart&quot;&gt;&lt;/detail-bottom-bar&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import DetailNavBar from './childCpns/DetailNavBar';</font></div><div><font style="font-size: 12pt;">  import DetailSwiper from './childCpns/DetailSwiper';</font></div><div><font style="font-size: 12pt;">  import DetailBaseInfo from './childCpns/DetailBaseInfo';</font></div><div><font style="font-size: 12pt;">  import DetailShopInfo from './childCpns/DetailShopInfo';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import DetailGoodsInfo from './childCpns/DetailGoodsInfo';</font></div><div><font style="font-size: 12pt;">  import DetailParamsInfo from './childCpns/DetailParamInfo';</font></div><div><font style="font-size: 12pt;">  import DetailCommentInfo from './childCpns/DetailCommentInfo';</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList';</font></div><div><font style="font-size: 12pt;">  import DetailBottomBar from './childCpns/DetailBottomBar';</font></div><div><font style="font-size: 12pt;">  import {getDetailData, Goods, Shop, GoodsParam, getRecommend} from 'network/detail';</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import {debounce} from &quot;commonjs/utils.js&quot;;</font></div><div><font style="font-size: 12pt;">  import {itemListenerMixin, backUpMixin } from 'commonjs/mixin';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"> <b> import{mapActions} from 'vuex';</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Detail',</font></div><div><font style="font-size: 12pt;">    mixins: [itemListenerMixin, backUpMixin],</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        iid: null,</font></div><div><font style="font-size: 12pt;">        topImages: [],</font></div><div><font style="font-size: 12pt;">        goods: {},</font></div><div><font style="font-size: 12pt;">        shop: {},</font></div><div><font style="font-size: 12pt;">        detailInfo: {},</font></div><div><font style="font-size: 12pt;">        paramInfo: {},</font></div><div><font style="font-size: 12pt;">        commentInfo: {},</font></div><div><font style="font-size: 12pt;">        recommends: [],</font></div><div><font style="font-size: 12pt;">        titleTopY: [],</font></div><div><font style="font-size: 12pt;">        getTitleTopY: null,</font></div><div><font style="font-size: 12pt;">        currentIndex: 0,</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created () {</font></div><div><font style="font-size: 12pt;">      this.iid = this.$route.params.iid;</font></div><div><font style="font-size: 12pt;">      getDetailData(this.iid).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        const data =  res.result;</font></div><div><font style="font-size: 12pt;">        this.topImages = data.itemInfo.topImages;</font></div><div><font style="font-size: 12pt;">        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);</font></div><div><font style="font-size: 12pt;">        this.shop = new Shop(data.shopInfo);</font></div><div><font style="font-size: 12pt;">        this.detailInfo = data.detailInfo;</font></div><div><font style="font-size: 12pt;">        this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);</font></div><div><font style="font-size: 12pt;">        if (data.rate.list) {</font></div><div><font style="font-size: 12pt;">          this.commentInfo = data.rate.list[0];</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      getRecommend().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">        this.recommends = res.data.list</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      this.getTitleTopY = debounce(() =&gt; {</font></div><div><font style="font-size: 12pt;">        this.titleTopY = [];</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(0);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.params.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.comment.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(this.$refs.recommend.$el.offsetTop);</font></div><div><font style="font-size: 12pt;">        this.titleTopY.push(Number.MAX_VALUE);</font></div><div><font style="font-size: 12pt;">      }, 100)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    destroyed() {</font></div><div><font style="font-size: 12pt;">      this.$bus.$off('itemImgLoad', this.itemImgListener);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      <b>...mapActions(['addCart']),</b></font></div><div><font style="font-size: 12pt;">      imgLoad() {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">        this.getTitleTopY();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      titleClick(index) {</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.scrollTo(0, -this.titleTopY[index] + 44, 100)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        let positionY = -position.y;</font></div><div><font style="font-size: 12pt;">        let length = this.titleTopY.length;</font></div><div><font style="font-size: 12pt;">        for (let i = 0; i &lt; length - 1; i++) {</font></div><div><font style="font-size: 12pt;">          if (this.currentIndex !== i &amp;&amp;</font></div><div><font style="font-size: 12pt;">          (positionY &gt;= this.titleTopY[i] &amp;&amp; positionY &lt; this.titleTopY[i + 1])) {</font></div><div><font style="font-size: 12pt;">            this.currentIndex = i;</font></div><div><font style="font-size: 12pt;">            this.$refs.nav.currentIndex = this.currentIndex;</font></div><div><font style="font-size: 12pt;">          }</font></div><div><font style="font-size: 12pt;">        }  </font></div><div><font style="font-size: 12pt;">        this.listenShowBackUp(position)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      addToCart() {</font></div><div><font style="font-size: 12pt;">        // 获取购物车要展示的商品信息</font></div><div><font style="font-size: 12pt;">        const product = {};</font></div><div><font style="font-size: 12pt;">        product.image = this.topImages[0];</font></div><div><font style="font-size: 12pt;">        product.title = this.goods.title;</font></div><div><font style="font-size: 12pt;">        product.desc = this.goods.desc;</font></div><div><font style="font-size: 12pt;">        product.price = this.goods.lowNowPrice;</font></div><div><font style="font-size: 12pt;">        product.iid = this.iid;</font></div><div><font style="font-size: 12pt;">        // 将商品添加到购物车</font></div><div><font style="font-size: 12pt;">        // this.$store.dispatch('addCart', product);</font></div><div><font style="font-size: 12pt;">       <b> this.addCart(product).then(res =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>          this.$toast.show(res)</b></font></div><div><font style="font-size: 12pt;"><b>        })</b></font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      DetailNavBar,</font></div><div><font style="font-size: 12pt;">      DetailSwiper,</font></div><div><font style="font-size: 12pt;">      DetailBaseInfo,</font></div><div><font style="font-size: 12pt;">      DetailShopInfo,</font></div><div><font style="font-size: 12pt;">      Scroll,</font></div><div><font style="font-size: 12pt;">      DetailGoodsInfo,</font></div><div><font style="font-size: 12pt;">      DetailParamsInfo,</font></div><div><font style="font-size: 12pt;">      DetailCommentInfo,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      DetailBottomBar,</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">效果图</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [6].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">fastclick 解决移动端 300ms 问题</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm install fastclick --save</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">import fastClick from 'fastclick';</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">fastClick.attach(document.body);</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [87].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">图片懒加载 - vue-lazyload 库</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">有些公司会做，有些公司不做</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm install vue-lazyload --save</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [88].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [89].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">px2vw - css转化插件（有bug？不知道是不是电脑问题，先去掉）</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img></img></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [90].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [91].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">postcss.config.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">module.exports = {</font></div><div><font style="font-size: 12pt;">  plugins: {</font></div><div><font style="font-size: 12pt;">    autoprefixer: {},</font></div><div><font style="font-size: 12pt;">    &quot;postcss-px-to-viewport&quot;: {</font></div><div><font style="font-size: 12pt;">      viewportWidth: 375, // 视窗的宽度，对应的是我们设计稿的宽度</font></div><div><font style="font-size: 12pt;">      viewportHeight: 667, // 视窗的高度，对应的是我们设计稿的高度（也可以不设置）</font></div><div><font style="font-size: 12pt;">      unitPrecision: 5, // 指定 'px' 转换为视窗单位值的小数位数</font></div><div><font style="font-size: 12pt;">      viewportUnit: &quot;vw&quot;, // 指定需要转换成的视窗单位，建议使用vm</font></div><div><font style="font-size: 12pt;">      selectorBlackList: [&quot;scroll&quot;, &quot;wrapper&quot;], // 指定不需要转换的类</font></div><div><font style="font-size: 12pt;">      minPixelValue: 1, // 小于或等于 1px 不转换为视窗高度</font></div><div><font style="font-size: 12pt;">      mediaQuery: false, // 允许在媒体查询中 转换为 px</font></div><div><font style="font-size: 12pt;">      exclude: [/TabBar/, /NavBar/]</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">};</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">最后修改tabControl 的样式，否则一开始进入首页没有吸顶效果</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Detail.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;<font style="font-size: 12pt;">template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;nav-bar class=&quot;nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div slot=&quot;center&quot;&gt;购物街&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/nav-bar&gt;</font></div><div><font style="font-size: 12pt;">   <b> &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot; @tabClick=&quot;tabClick&quot;</b></font></div><div><font style="font-size: 12pt;"><b>                 class=&quot;fixed&quot; v-show=&quot;isTabFixed&quot;  ref=&quot;tabControl1&quot;&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">    &lt;scroll class=&quot;content&quot;</font></div><div><font style="font-size: 12pt;">            ref=&quot;scroll&quot;</font></div><div><font style="font-size: 12pt;">            :probe-type=&quot;3&quot;</font></div><div><font style="font-size: 12pt;">            :pull-up-load=&quot;true&quot;</font></div><div><font style="font-size: 12pt;">            @scroll=&quot;contentScroll&quot;</font></div><div><font style="font-size: 12pt;">            @pullingUp=&quot;loadMore&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-swiper :banner=&quot;banner&quot; @swiperImageLoad=&quot;swiperImageLoad&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">      &lt;home-recommend :recommend=&quot;recommend&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">      &lt;feature-view&gt;&lt;/feature-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;tab-control :title=&quot;['流行', '新款', '精选']&quot;  </font></div><div><font style="font-size: 12pt;">                   @tabClick=&quot;tabClick&quot;</font></div><div><font style="font-size: 12pt;">                   ref=&quot;tabControl2&quot; &gt;</font></div><div><font style="font-size: 12pt;">      &lt;/tab-control&gt;</font></div><div><font style="font-size: 12pt;">      &lt;goods-list :goods=&quot;showGoods&quot;&gt;&lt;/goods-list&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/scroll&gt;</font></div><div><font style="font-size: 12pt;">    &lt;back-up @click.native=&quot;backClick&quot; class=&quot;back-up&quot; v-show=&quot;isShowBackUp&quot;&gt;&lt;/back-up&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  import HomeSwiper from './childCpns/HomeSwiper';</font></div><div><font style="font-size: 12pt;">  import HomeRecommend from './childCpns/HomeRecommend';</font></div><div><font style="font-size: 12pt;">  import FeatureView from './childCpns/FeatureView';</font></div><div><font style="font-size: 12pt;">  import NavBar from 'common/navbar/NavBar';</font></div><div><font style="font-size: 12pt;">  import TabControl from 'content/tabControl/TabControl';</font></div><div><font style="font-size: 12pt;">  import GoodsList from 'content/goods/GoodsList';</font></div><div><font style="font-size: 12pt;">  import Scroll from 'common/scroll/Scroll';</font></div><div><font style="font-size: 12pt;">  import { getHomeMultidata, getHomeGoods } from 'network/home';</font></div><div><font style="font-size: 12pt;">  import {itemListenerMixin, backUpMixin} from 'commonjs/mixin';</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'Home',</font></div><div><font style="font-size: 12pt;">    components: {    </font></div><div><font style="font-size: 12pt;">      HomeSwiper,</font></div><div><font style="font-size: 12pt;">      HomeRecommend,</font></div><div><font style="font-size: 12pt;">      FeatureView,</font></div><div><font style="font-size: 12pt;">      NavBar,</font></div><div><font style="font-size: 12pt;">      TabControl,</font></div><div><font style="font-size: 12pt;">      GoodsList,</font></div><div><font style="font-size: 12pt;">      Scroll</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mixins: [itemListenerMixin, backUpMixin],</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        banner: null,</font></div><div><font style="font-size: 12pt;">        recommend: null,</font></div><div><font style="font-size: 12pt;">        goods: {</font></div><div><font style="font-size: 12pt;">          'pop': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'new': {page: 0, list: []},</font></div><div><font style="font-size: 12pt;">          'sell': {page: 0, list: []}</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        currentType: 'pop',</font></div><div><font style="font-size: 12pt;">        tabOffsetTop: 0,</font></div><div><font style="font-size: 12pt;">        isTabFixed: false,</font></div><div><font style="font-size: 12pt;">        scrollY: 0     </font></div><div><font style="font-size: 12pt;">      }    </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      showGoods() {</font></div><div><font style="font-size: 12pt;">        return this.goods[this.currentType].list</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    created() {</font></div><div><font style="font-size: 12pt;">      this.getHomeMultidata();</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('pop');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('new');</font></div><div><font style="font-size: 12pt;">      this.getHomeGoods('sell');</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    activated () {</font></div><div><font style="font-size: 12pt;">      this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      this.$refs.scroll.scrollTo(0, this.scrollY, 0);     </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    deactivated () {</font></div><div><font style="font-size: 12pt;">      this.scrollY = this.$refs.scroll.getScrollY();</font></div><div><font style="font-size: 12pt;">      this.$bus.$off('itemImgLoad', this.itemImgListener);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      // 事件监听</font></div><div><font style="font-size: 12pt;">      tabClick(index) {</font></div><div><font style="font-size: 12pt;">        switch(index) {</font></div><div><font style="font-size: 12pt;">          case 0:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'pop';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 1:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'new';</font></div><div><font style="font-size: 12pt;">            break;</font></div><div><font style="font-size: 12pt;">          case 2:</font></div><div><font style="font-size: 12pt;">            this.currentType = 'sell';</font></div><div><font style="font-size: 12pt;">            break;   </font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        this.$refs.tabControl1.currentIndex = index;</font></div><div><font style="font-size: 12pt;">        this.$refs.tabControl2.currentIndex = index;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      contentScroll(position) {</font></div><div><font style="font-size: 12pt;">        this.listenShowBackUp(position);</font></div><div><font style="font-size: 12pt;">        this.isTabFixed = (-position.y) &gt; this.tabOffsetTop;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      loadMore() {</font></div><div><font style="font-size: 12pt;">        this.getHomeGoods(this.currentType);</font></div><div><font style="font-size: 12pt;">        this.$refs.scroll.refresh();</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      swiperImageLoad() {       </font></div><div><font style="font-size: 12pt;">        this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;      </font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // 网络请求</font></div><div><font style="font-size: 12pt;">      getHomeMultidata() {</font></div><div><font style="font-size: 12pt;">        getHomeMultidata().then(res =&gt; {</font></div><div><font style="font-size: 12pt;">          this.banner = res.data.banner.list;</font></div><div><font style="font-size: 12pt;">          this.recommend = res.data.recommend.list;</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      getHomeGoods(type) {</font></div><div><font style="font-size: 12pt;">        const page = this.goods[type].page + 1;</font></div><div><font style="font-size: 12pt;">        getHomeGoods(type, page).then(res =&gt; {</font></div><div><font style="font-size: 12pt;">           this.goods[type].list.push(...res.data.list);</font></div><div><font style="font-size: 12pt;">           this.goods[type].page += 1;</font></div><div><font style="font-size: 12pt;">           this.$refs.scroll.finishPullUp();</font></div><div><font style="font-size: 12pt;">        });        </font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">  #home {</font></div><div><font style="font-size: 12pt;">    height: 100vh;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .nav {</font></div><div><font style="font-size: 12pt;">    background-color: var(--color-tint);</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    z-index: 1;</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .content {</font></div><div><font style="font-size: 12pt;">    position: absolute;</font></div><div><font style="font-size: 12pt;">    top: 44px;</font></div><div><font style="font-size: 12pt;">    bottom: 49px;</font></div><div><font style="font-size: 12pt;">    left: 0;</font></div><div><font style="font-size: 12pt;">    right: 0;   </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .back-up {</font></div><div><font style="font-size: 12pt;">    position: fixed;</font></div><div><font style="font-size: 12pt;">    right: 8px;</font></div><div><font style="font-size: 12pt;">    bottom: 55px;  </font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;"><b>  .fixed {</b></font></div><div><font style="font-size: 12pt;"><b>    position: relative;</b></font></div><div><font style="font-size: 12pt;"><b>    z-index: 2;</b></font></div><div><font style="font-size: 12pt;"><b>    background-color: white;</b></font></div><div><font style="font-size: 12pt;"><b>  }</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">ngnix 部署</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">在公司的话，一般不会把服务器账号密码给前端，很多情况下是对项目进行打包然后传给服务器人员</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果公司有使用自动化部署流程的话，就是项目一旦发布成功的话，把项目提交到 github，打一个 tag 就可以自动化发布的</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">而且可能首先打包发布到测试人员的测试服务器上</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm run build</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><img src="12 - 购物街_files/3 [92].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><span style="font-size: 12pt;">coderwhy 老师使用 python 的 flask 框架开发了很多接口，为前端服务，数据来自于 app_run.py 文件</span></div><div><span style="font-size: 12pt;"> </span></div><div><span style="font-size: 12pt;">还写了个爬虫爬取推荐商品数据，爬虫在服务器上执行，爬到数据后会放到远程服务器的 MongoDB 数据库</span></div><div><br/></div><div><span style="font-size: 12pt;">再通过</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">app_run.py 读取 </span><span style="font-size: 12pt;">MongoDB 数据库，最后返回前端</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">项目在远程 Linux 下部署</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">先登录后安装 nginx</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [93].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">但是 windows系统 没有 ssh 命令，而 Mac 系统自带 ssh 命令（Mac系统比 windows 系统多很多开发相关的东西）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">所以需要使用 SecureCRT 登录到服务器并</span><span style="font-size: 12pt;">使用 winSCP </span><span style="font-size: 12pt;">拷贝文件到服务器</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">SecureCRT</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [94].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [95].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [96].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">输入服务器主机公网 ip 地址（不是 192 开头的私网 ip）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [97].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">点击完成后，选择连接一次，输入服务器密码</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [98].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">安装 nginix</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [99].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">winSCP</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">拷贝打包文件</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [100].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">修改 nginx 配置，右键打开 ngnix.conf</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [101].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/3 [102].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">改了配置之后需要进行重启</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><a href="https://zhidao.baidu.com/question/537772935.html" style="font-size: 12pt;">https://zhidao.baidu.com/question/537772935.html</a></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">第一个答案第一种方法</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">使用 IP 访问即可成功</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="12 - 购物街_files/overview.png" type="image/png" data-filename="overview.png"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div></div><div><br/></div></span>
</div></body></html> 