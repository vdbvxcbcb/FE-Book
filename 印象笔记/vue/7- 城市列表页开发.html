<html>
<head>
  <title>7- 城市列表页开发</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/606060 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3338"/>
<h1>7- 城市列表页开发</h1>

<div>
<span><div><div><div><span style="font-size: 12pt; color: unset; font-family: unset; font-weight: bold;">城市列表页</span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">VueRouter简介</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3.jpg" type="image/jpeg" data-filename="3.jpg" width="568"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">在&lt;template&gt;模板里 以 &lt;router-link&gt; 方式 跳转到页面</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;"><b>&lt;router-link to=&quot;/demo9&quot;&gt;demo9&lt;/router-link&gt;</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><font><font>&lt;!-- 下</font></font>面一行代码表示 <font><font>跳转到 name 为 demo9 （也可以改为path: '/demo9'）的组件，</font>并且<font>传参数 --&gt;</font></font></font></div><div><font><font style="font-size: 12pt;"><br/></font></font></div><div><font style="font-size: 12pt;">&lt;router-link :to=&quot;{ name: 'demo9', params: { userId: 456 }}&quot;&gt;params&lt;/router-link&gt; </font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;!-- 上面一行代码跳转结果为 http://localhost:8080/#/demo9/456--&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><font>&lt;!--</font> 下面一行代码表示 <font>跳转到 name 为 demo9 （也可以改为path: '/demo9'）的组件，并且传参数 和 查询参数 --&gt;</font></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><b>&lt;router-link :to=&quot;{ name: 'demo9', params: { userId: 456 }, query: { plan: 'private' }}&quot;&gt;query&lt;/router-link&gt;</b></font></div><div><font style="font-size: 12pt;"><b><br/></b></font></div><div><font style="font-size: 12pt;"><font>&lt;!--</font> 上面一行代码<font>跳转结果为 http://localhost:8080/#/demo9/456?plan=private --&gt;</font></font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import demo9 from '@/pages/demo9/index'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.use(Router)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default new Router({</font></div><div><font style="font-size: 12pt;">  routes: [{</font></div><div><font style="font-size: 12pt;">      <b>path: '/demo9/:userid', // :表示通配符，userid可以是任何值</b></font></div><div><font style="font-size: 12pt;"><b>      name: 'demo9',</b></font></div><div><font style="font-size: 12pt;"><b>      component: demo9</b></font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">})</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">JS方式跳转到页面</span></font></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;button <b>@click=&quot;toURL&quot;</b>&gt;跳转页面&lt;/button&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default{</font></div><div><font style="font-size: 12pt;">    <b>methods:{</b></font></div><div><font style="font-size: 12pt;"><b>        toURL(){</b></font></div><div><font style="font-size: 12pt;"><b>            // this.$router.push({ path: '/demo8' })</b></font></div><div><font style="font-size: 12pt;"><b>            // this.$router.push({ name: 'demo9', params: { userId: 123 }})</b></font></div><div><font style="font-size: 12pt;"><b>            this.$router.push({ name: 'demo9', params: { userId: 123 }, query: { plan: 'private' } })</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">新建分支为 ci</span><span style="font-size: 12pt; font-weight: bold;">ty-router</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git pull</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout city-router </font></div><div><font style="font-size: 12pt;"> </font></div><div><font style="font-size: 12pt;">npm run dev</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">打开 src 文件夹下 router 文件夹的 index.js 文件</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">在 routes 路由项创建一个新的路由，分别配置 路径，路由名，对应的组件</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">import Router from 'vue-router'</font></div><div><font style="font-size: 12pt;">import Home from '@/pages/home/Home.vue'</font></div><div><font style="font-size: 12pt;"><b>import City from '@/pages/city/City.vue'</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.use(Router)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default new Router({</font></div><div><font style="font-size: 12pt;">  routes: [{</font></div><div><font style="font-size: 12pt;">      path: '/',</font></div><div><font style="font-size: 12pt;">      name: 'Home',</font></div><div><font style="font-size: 12pt;">      component: Home</font></div><div><font style="font-size: 12pt;">  }, <b>{</b></font></div><div><font style="font-size: 12pt;"><b>      path: '/city',</b></font></div><div><font style="font-size: 12pt;"><b>      name: 'City',</b></font></div><div><font style="font-size: 12pt;"><b>      component: City</b></font></div><div><font style="font-size: 12pt;"><b>  }</b>]</font></div><div><font style="font-size: 12pt;">})</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">pages目录下新建city文件夹，city文件夹下创建City.vue文件</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [1].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">City.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;city-page&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-header&gt;&lt;/city-header&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;   </font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">    export default {</font></div><div><font style="font-size: 12pt;">        name: 'City'</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">如何实现点击城市跳转到/city呢？</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">首页在 Header.vue 使用&lt;router-link&gt;</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;"><b>&lt;router-link to=&quot;/city&quot;&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;header-right&quot;&gt;</font></div><div><font style="font-size: 12pt;">        城市</font></div><div><font style="font-size: 12pt;">        &lt;span class=&quot;iconfont arrow-icon&quot;&gt;&amp;#xe64a;&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;"><b>&lt;/router-link&gt;</b></font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [2].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">在 city 文件夹下 新建 components 文件夹，并创建 Header.vue文件</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">在</span><span style="font-size: 12pt; font-weight: bold;">Header.vue的</span><span style="font-size: 12pt; font-weight: bold;">&lt;script&gt;中导出 </span><span style="font-size: 12pt; font-weight: bold;">Header.vue 为 </span><span style="font-size: 12pt; font-weight: bold;">CityHeader </span><span style="font-size: 12pt; font-weight: bold;">组件</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;header&quot;&gt;城市选择&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    <b>name: 'CityHeader'</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">@import '~styles/variables.styl'</font></div><div><font style="font-size: 12pt;">    .header</font></div><div><font style="font-size: 12pt;">        height: .86rem</font></div><div><font style="font-size: 12pt;">        line-height: .86rem</font></div><div><font style="font-size: 12pt;">        text-align: center</font></div><div><font style="font-size: 12pt;">        background: $bgColor  </font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">然后在 City.vue </span><span style="font-size: 12pt; font-weight: bold;">的</span><span style="font-size: 12pt; font-weight: bold;">&lt;script&gt;</span><span style="font-size: 12pt; font-weight: bold;">中引入 </span><span style="font-size: 12pt; font-weight: bold;">Header.vue</span> <span style="font-size: 12pt; font-weight: bold;">为  </span><span style="font-size: 12pt; font-weight: bold;">CityHeader 局部组件</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">   <b> &lt;city-header&gt;&lt;/city-header&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"><b>import CityHeader from './components/Header.vue'</b></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'City',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">        <b>CityHeader: CityHeader</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Header.vue</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;header&quot;&gt;</font></div><div><font style="font-size: 12pt;">        <b>&lt;router-link to=&quot;/&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>            &lt;div class=&quot;iconfont header-back&quot;&gt;&amp;#xe624;&lt;/div&gt;  </b></font></div><div><font style="font-size: 12pt;"><b>        &lt;/router-link&gt;</b></font></div><div><font style="font-size: 12pt;">        &lt;h1 class=&quot;header-title&quot;&gt;城市选择&lt;/h1&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityHeader'</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;"><b>@import '~styles/variables.styl'</b></font></div><div><font style="font-size: 12pt;">    <b>.header</b></font></div><div><font style="font-size: 12pt;"><b>        position:relative</b></font></div><div><font style="font-size: 12pt;"><b>        height: .88rem</b></font></div><div><font style="font-size: 12pt;">        <b>background: $bgColor</b></font></div><div><font style="font-size: 12pt;">        color: #fff</font></div><div><font style="font-size: 12pt;">        <b>.header-back</b></font></div><div><font style="font-size: 12pt;">           <b> position: absolute</b></font></div><div><font style="font-size: 12pt;"><b>            left: 0</b></font></div><div><font style="font-size: 12pt;"><b>            top: 0</b></font></div><div><font style="font-size: 12pt;">           <b> width: .8rem</b></font></div><div><font style="font-size: 12pt;"><b>            text-align: center</b></font></div><div><font style="font-size: 12pt;"><b><font>            </font>font-size: .36rem</b></font></div><div><font style="font-size: 12pt;"><b>            line-height: .88rem</b></font></div><div><font style="font-size: 12pt;">            color: #fff            </font></div><div><font style="font-size: 12pt;">        .header-title</font></div><div><font style="font-size: 12pt;">            margin: 0 1rem</font></div><div><font style="font-size: 12pt;">            font-size: .32rem</font></div><div><font style="font-size: 12pt;"><font>            </font>text-align: center  </font></div><div><font style="font-size: 12pt;">            line-height: .88rem</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3.gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">ctrl + c 退出项目</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">提交代码到仓库</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git add .</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git commit -m 'city-router'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout master</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git merge city-router</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">搜索框布局</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">新建分支 </span><span style="font-size: 12pt; font-weight: bold;">city-search</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git pull</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout city-search</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">npm run dev</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">components 文件夹 </span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">新建组件 Serach.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [3].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Serach.vue</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;search&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;input class=&quot;search-input&quot; type=&quot;text&quot; placeholder=&quot;输入城市名或拼音&quot;/&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    <b>name: 'CitySearch'</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;"><b>@import '~styles/variables.styl'</b></font></div><div><font style="font-size: 12pt;">     <b>.search</b></font></div><div><font style="font-size: 12pt;">         height: .72rem</font></div><div><font style="font-size: 12pt;">         <b>padding: 0 .1rem</b></font></div><div><font style="font-size: 12pt;">         <b>background: $bgColor</b></font></div><div><font style="font-size: 12pt;">         <b>.search-input</b></font></div><div><font style="font-size: 12pt;">             box-sizing: border-box</font></div><div><font style="font-size: 12pt;">             <b>width: 100%</b></font></div><div><font style="font-size: 12pt;">             height: .62rem</font></div><div><font style="font-size: 12pt;">             padding: 0 .1rem</font></div><div><font style="font-size: 12pt;">            <b> text-align: center</b></font></div><div><font style="font-size: 12pt;">             <b>border-radius: .06rem</b></font></div><div><font style="font-size: 12pt;">             color: #666</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">City.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-header&gt;&lt;/city-header&gt;</font></div><div><font style="font-size: 12pt;">        <b>&lt;city-search&gt;&lt;/city-search&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;   </font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import CityHeader from './components/Header.vue'</font></div><div><font style="font-size: 12pt;"><b>import CitySearch from './components/Search.vue'</b></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'City',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">        CityHeader: CityHeader,</font></div><div><font style="font-size: 12pt;">        <b>CitySearch: CitySearch</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [4].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">ctrl + c 退出项目</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">提交代码到仓库</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">git add .</span></div><div><br/></div><div><span style="font-size: 12pt;">git commit -m 'add search'</span></div><div><br/></div><div><span style="font-size: 12pt;">git push</span></div><div><br/></div><div><span style="font-size: 12pt;">git checkout master</span></div><div><br/></div><div><span style="font-size: 12pt;">git merge city-search</span></div><div><br/></div><div><span style="font-size: 12pt;">git push</span></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">列表布局</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">新建分支 </span><span style="font-size: 12pt; font-weight: bold;">city-list</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git pull</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout city-list</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">npm run dev</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">背景颜色为#f5f5f5</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">components 文件夹 </span><span style="font-size: 12pt; font-weight: bold;">新建组件 </span><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">List.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">Better-scroll的使用和字母表布局</span></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">原来去哪儿网的城市列表是利用浏览器自带的滚轮实现的，我们引入更高级的关于区块滚动的内容</span></span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">npm install better-scroll --save</span></div><div><br/></div><div><span style="font-size: 12pt;">npm run start</span></div></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Better-scroll的使用：里面必须有一个包裹多个元素的元素</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">List.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">   <b> &lt;div class=&quot;list&quot; ref=&quot;wrapper&quot;&gt;</b></font></div><div><font style="font-size: 12pt;">        &lt;div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title <b>border-topbottom</b>&quot;&gt;<b>当前城市</b>&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;<b>button-list</b>&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div class=&quot;<b>button-wrappe</b>r&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;<b>button</b>&quot;&gt;广州&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title <b>border-topbottom</b>&quot;&gt;<b>热门城市</b>&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;<b>button-list</b>&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div class=&quot;<b>button-wrapper</b>&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;<b>button</b>&quot;&gt;广州&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div class=&quot;button-wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;button&quot;&gt;广州&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div class=&quot;button-wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;button&quot;&gt;广州&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title <b>border-topbottom</b>&quot;&gt;<b>A</b>&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;ul class=&quot;item-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;A&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;ul class=&quot;item-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;安阳&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;    </font></div><div><font style="font-size: 12pt;">   <b> &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><b><font style="font-size: 12pt;">import Bscroll from 'better-scroll'</font></b></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityList',</font></div><div><font style="font-size: 12pt;">   <b> mounted () {</b></font></div><div><b><font style="font-size: 12pt;">        this.scroll = new Bscroll(this.$refs.wrapper)</font></b></div><div><b><font style="font-size: 12pt;">    }</font></b></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">@import '~styles/variables.styl'</font></div><div><font style="font-size: 12pt;">    <b>.border-topbottom</b></font></div><div><font style="font-size: 12pt;"><b>        &amp;:before</b></font></div><div><font style="font-size: 12pt;"><b>            border-color: #ccc</b></font></div><div><font style="font-size: 12pt;"><b>        &amp;:after</b></font></div><div><font style="font-size: 12pt;"><b>            border-color: #ccc</b></font></div><div><font style="font-size: 12pt;"><b>    .border-bottom</b></font></div><div><font style="font-size: 12pt;"><b>        &amp;:before</b></font></div><div><font style="font-size: 12pt;"><b>            border-color: #ccc  </b></font></div><div><font style="font-size: 12pt;">    <b>.list</b></font></div><div><font style="font-size: 12pt;">        <b>overflow: hidden</b></font></div><div><b><font style="font-size: 12pt;">        position: absolute</font></b></div><div><b><font style="font-size: 12pt;">        top: 1.58rem</font></b></div><div><b><font style="font-size: 12pt;">        left: 0</font></b></div><div><b><font style="font-size: 12pt;">        right:0</font></b></div><div><font style="font-size: 12pt;"><b>        bottom: 0</b>              </font></div><div><font style="font-size: 12pt;">    .title</font></div><div><font style="font-size: 12pt;">        font-size: .24rem</font></div><div><font style="font-size: 12pt;">        padding: .24rem .3rem</font></div><div><font style="font-size: 12pt;">        background: #f5f5f5   </font></div><div><font style="font-size: 12pt;">        color: #666  </font></div><div><font style="font-size: 12pt;">     .button-list</font></div><div><font style="font-size: 12pt;">         overflow: hidden</font></div><div><font style="font-size: 12pt;">         padding: .1rem .6rem .1rem .1rem</font></div><div><font style="font-size: 12pt;">         <b>.button-wrapper</b></font></div><div><font style="font-size: 12pt;"><b>             float: left</b></font></div><div><font style="font-size: 12pt;"><b>             width: 33.33%</b></font></div><div><font style="font-size: 12pt;"><b>             .button</b></font></div><div><font style="font-size: 12pt;"><b>                 margin: .1rem</b></font></div><div><font style="font-size: 12pt;"><b>                 padding: .1rem 0</b></font></div><div><font style="font-size: 12pt;"><b>                 border: .02rem solid #cccccc</b></font></div><div><font style="font-size: 12pt;"><b>                 border-radius: .06rem  </b></font></div><div><font style="font-size: 12pt;"><b><font>                 </font>text-align: center</b></font></div><div><font style="font-size: 12pt;">     .<b>item-list</b></font></div><div><font style="font-size: 12pt;"><b>         line-height: .76rem</b></font></div><div><font style="font-size: 12pt;"><b>         padding-left: .2rem</b></font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">components 文件夹 </span><span style="font-size: 12pt; font-weight: bold;">新建组件 </span><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Alphabet.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;ul class=&quot;list&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li class=&quot;item&quot;&gt;A&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li class=&quot;item&quot;&gt;A&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li class=&quot;item&quot;&gt;A&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li class=&quot;item&quot;&gt;A&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li class=&quot;item&quot;&gt;A&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li class=&quot;item&quot;&gt;A&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityAlphabet'</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">    @import '~styles/variables.styl'  </font></div><div><font style="font-size: 12pt;">   <b> .list</b></font></div><div><font style="font-size: 12pt;"><b>        display: flex</b></font></div><div><font style="font-size: 12pt;"><b>        flex-direction: column</b></font></div><div><font style="font-size: 12pt;"><b>        justify-content: center</b></font></div><div><font style="font-size: 12pt;"><b>        position: absolute</b></font></div><div><font style="font-size: 12pt;"><b>        top: 1.58rem</b></font></div><div><font style="font-size: 12pt;"><b>        right: 0</b></font></div><div><font style="font-size: 12pt;"><b>        bottom: 0</b></font></div><div><font style="font-size: 12pt;"><b>        width: .4rem</b></font></div><div><font style="font-size: 12pt;">        <b>.item</b></font></div><div><font style="font-size: 12pt;"><b>            line-height: .4rem</b></font></div><div><font style="font-size: 12pt;"><b>            text-align: center</b></font></div><div><font style="font-size: 12pt;"><b>            color: $bgColor</b>                    </font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [1].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">ctrl + c 退出项目</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">再次提交代码到远程仓库</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git add .</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git commit -m 'finish city css'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout master</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git merge city-list</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">页面的动态数据渲染</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">新建分支 city-ajax，并启动项目</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git pull</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout city-ajax</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">npm run start</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">复制一份 city.json 文件到 static 文件夹下的 mock 文件夹</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">ajax请求一般放在最外层的组件上，即当前页面，这样一次ajax就可以获得页面所有的请求，所以要在父组件City.vue中实现ajax请求</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">City.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-header&gt;&lt;/city-header&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-search&gt;&lt;/city-search&gt;</font></div><div><font style="font-size: 12pt;">       <b> &lt;city-list :cities=&quot;cities&quot; :hot=&quot;hotCities&quot;&gt;&lt;/city-list&gt;</b></font></div><div><font style="font-size: 12pt;"><b>        &lt;city-alphabet :cities=&quot;cities&quot;&gt;&lt;/city-alphabet&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;   </font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"><b>import axios from 'axios'</b></font></div><div><font style="font-size: 12pt;">import CityHeader from './components/Header.vue'</font></div><div><font style="font-size: 12pt;">import CitySearch from './components/Search.vue'</font></div><div><font style="font-size: 12pt;">import CityList from './components/List.vue'</font></div><div><font style="font-size: 12pt;">import CityAlphabet from './components/Alphabet.vue'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'City',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">        CityHeader: CityHeader,</font></div><div><font style="font-size: 12pt;">        CitySearch: CitySearch,</font></div><div><font style="font-size: 12pt;">        CityList: CityList,</font></div><div><font style="font-size: 12pt;">        CityAlphabet: CityAlphabet</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> data () {</b></font></div><div><font style="font-size: 12pt;"><b>        return {</b></font></div><div><font style="font-size: 12pt;"><b>            cities: {},</b></font></div><div><font style="font-size: 12pt;"><b>            hotCities: []    </b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    methods: {</b></font></div><div><font style="font-size: 12pt;"><b>        getCityInfo () {</b></font></div><div><font style="font-size: 12pt;"><b>            axios.get('/api/city.json')</b></font></div><div><font style="font-size: 12pt;"><b>                .then(this.handelGetCityInfoSucc)</b></font></div><div><font style="font-size: 12pt;"><b>        },</b></font></div><div><font style="font-size: 12pt;"><b>        handelGetCityInfoSucc (res) {</b></font></div><div><font style="font-size: 12pt;"><b>            res = res.data;</b></font></div><div><font style="font-size: 12pt;"><b>            if (res.ret &amp;&amp; res.data) {</b></font></div><div><font style="font-size: 12pt;"><b>                const data = res.data</b></font></div><div><font style="font-size: 12pt;"><b>                this.cities = data.cities</b></font></div><div><font style="font-size: 12pt;"><b>                this.hotCities = data.hotCities</b></font></div><div><font style="font-size: 12pt;"><b>            }</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;"><b>    mounted () {</b></font></div><div><font style="font-size: 12pt;"><b>        this.getCityInfo()</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">List.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">v-for 只需放在要循环显示的元素上，它的子元素自然就会循环显示</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">双重循环，先循环对象取A B...，再循环数组取item.name  </span><span style="font-size: 12pt; font-weight: bold;">阿坝</span> <span style="font-size: 12pt; font-weight: bold;">阿克苏</span><span style="font-size: 12pt; font-weight: bold;">....</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">city.json</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&quot;cities&quot;: {</font></div><div><font style="font-size: 12pt;">            &quot;A&quot;: [{</font></div><div><font style="font-size: 12pt;">                &quot;id&quot;: 56,</font></div><div><font style="font-size: 12pt;">                &quot;spell&quot;: &quot;aba&quot;,</font></div><div><font style="font-size: 12pt;">                &quot;name&quot;: &quot;阿坝&quot;</font></div><div><font style="font-size: 12pt;">            }, {</font></div><div><font style="font-size: 12pt;">                &quot;id&quot;: 57,</font></div><div><font style="font-size: 12pt;">                &quot;spell&quot;: &quot;akesu&quot;,</font></div><div><font style="font-size: 12pt;">                &quot;name&quot;: &quot;阿克苏&quot;</font></div><div><font style="font-size: 12pt;">            }],</font></div><div><font style="font-size: 12pt;">            &quot;B&quot;: [{</font></div><div><font style="font-size: 12pt;">                &quot;id&quot;: 1,</font></div><div><font style="font-size: 12pt;">                &quot;spell&quot;: &quot;beijing&quot;,</font></div><div><font style="font-size: 12pt;">                &quot;name&quot;: &quot;北京&quot;</font></div><div><font style="font-size: 12pt;">            }, {</font></div><div><font style="font-size: 12pt;">                &quot;id&quot;: 66,</font></div><div><font style="font-size: 12pt;">                &quot;spell&quot;: &quot;baicheng&quot;,</font></div><div><font style="font-size: 12pt;">                &quot;name&quot;: &quot;白城&quot;</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">父</span><span style="font-size: 12pt; font-weight: bold;">级循环</span><span style="font-size: 12pt; font-weight: bold;">的 </span><span style="font-size: 12pt; font-weight: bold;">:key 和 子级循环的</span><span style="font-size: 12pt; font-weight: bold;">:key 可以相同，</span><span style="font-size: 12pt; font-weight: bold;">只要父级同层级中的 :key 没有相同的就行</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">List.vue</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;list&quot; ref=&quot;wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;当前城市&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;button-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div class=&quot;button-wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;button&quot;&gt;广州&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;热门城市&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;button-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    <b>&lt;div class=&quot;button-wrapper&quot; v-for=&quot;item of hot&quot; :key=&quot;item.id&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>                        &lt;div class=&quot;button&quot;&gt;{{item.name}}&lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;"><b>                    &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            <b>&lt;div class=&quot;area&quot; v-for=&quot;(item, key) of cities&quot; :key=&quot;key&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>                &lt;h2 class=&quot;title border-topbottom&quot;&gt;{{key}}&lt;/h2&gt;</b></font></div><div><font style="font-size: 12pt;"><b>                &lt;ul class=&quot;item-list&quot; v-for=&quot;inneritem of item&quot; :key=&quot;inneritem.id&quot;&gt;</b></font></div><div><font style="font-size: 12pt;"><b>                    &lt;li class=&quot;item border-bottom&quot;&gt;{{inneritem.name}}&lt;/li&gt;</b></font></div><div><font style="font-size: 12pt;"><b>                &lt;/ul&gt;</b></font></div><div><font style="font-size: 12pt;"><b>            &lt;/div&gt;</b></font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;    </font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import Bscroll from 'better-scroll'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityList',</font></div><div><font style="font-size: 12pt;">    <b>props: {</b></font></div><div><font style="font-size: 12pt;"><b>        cities: Object,</b></font></div><div><font style="font-size: 12pt;"><b>        hot: Array</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    mounted () {</font></div><div><font style="font-size: 12pt;">        this.scroll = new Bscroll(this.$refs.wrapper)</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">@import '~styles/variables.styl'</font></div><div><font style="font-size: 12pt;">    .border-topbottom</font></div><div><font style="font-size: 12pt;">        &amp;:before</font></div><div><font style="font-size: 12pt;">            border-color: #ccc</font></div><div><font style="font-size: 12pt;">        &amp;:after</font></div><div><font style="font-size: 12pt;">            border-color: #ccc</font></div><div><font style="font-size: 12pt;">    .border-bottom</font></div><div><font style="font-size: 12pt;">        &amp;:before</font></div><div><font style="font-size: 12pt;">            border-color: #ccc  </font></div><div><font style="font-size: 12pt;">    .list</font></div><div><font style="font-size: 12pt;">        overflow: hidden</font></div><div><font style="font-size: 12pt;">        position: absolute</font></div><div><font style="font-size: 12pt;">        top: 1.58rem</font></div><div><font style="font-size: 12pt;">        left: 0</font></div><div><font style="font-size: 12pt;">        right:0</font></div><div><font style="font-size: 12pt;">        bottom: 0              </font></div><div><font style="font-size: 12pt;">    .title</font></div><div><font style="font-size: 12pt;">        font-size: .24rem</font></div><div><font style="font-size: 12pt;">        padding: .24rem .3rem</font></div><div><font style="font-size: 12pt;">        background: #f5f5f5   </font></div><div><font style="font-size: 12pt;">     .button-list</font></div><div><font style="font-size: 12pt;">         overflow: hidden</font></div><div><font style="font-size: 12pt;">         padding: .1rem .6rem .1rem .1rem</font></div><div><font style="font-size: 12pt;">         .button-wrapper</font></div><div><font style="font-size: 12pt;">             float: left</font></div><div><font style="font-size: 12pt;">             width: 33.33%</font></div><div><font style="font-size: 12pt;">             .button</font></div><div><font style="font-size: 12pt;">                 margin: .1rem</font></div><div><font style="font-size: 12pt;">                 padding: .1rem 0</font></div><div><font style="font-size: 12pt;">                 text-align: center</font></div><div><font style="font-size: 12pt;">                 border: .02rem solid #cccccc</font></div><div><font style="font-size: 12pt;">                 border-radius: .06rem  </font></div><div><font style="font-size: 12pt;">     .item-list</font></div><div><font style="font-size: 12pt;">         line-height: .76rem</font></div><div><font style="font-size: 12pt;">         padding-left: .2rem</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Alphabet.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;ul class=&quot;list&quot;&gt;</font></div><div><font style="font-size: 12pt;">       <b> &lt;li class=&quot;item&quot; v-for=&quot;(item, key) of cities&quot; :key=&quot;key&quot;&gt;{{key}}&lt;/li&gt;</b></font></div><div><font style="font-size: 12pt;">    &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityAlphabet',</font></div><div><font style="font-size: 12pt;">   <b> props: {</b></font></div><div><font style="font-size: 12pt;"><b>        cities: Object</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">    @import '~styles/variables.styl'  </font></div><div><font style="font-size: 12pt;">    .list</font></div><div><font style="font-size: 12pt;">        display: flex</font></div><div><font style="font-size: 12pt;">        flex-direction: column</font></div><div><font style="font-size: 12pt;">        justify-content: center</font></div><div><font style="font-size: 12pt;">        position: absolute</font></div><div><font style="font-size: 12pt;">        top: 1.58rem</font></div><div><font style="font-size: 12pt;">        right: 0</font></div><div><font style="font-size: 12pt;">        bottom: 0</font></div><div><font style="font-size: 12pt;">        width: .4rem</font></div><div><font style="font-size: 12pt;">        .item</font></div><div><font style="font-size: 12pt;">            line-height: .4rem</font></div><div><font style="font-size: 12pt;">            text-align: center</font></div><div><font style="font-size: 12pt;">            color: $bgColor                    </font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">ctrl + c 退出项目</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">再次提交代码到远程仓库</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git add .</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git commit -m 'ajax city'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout master</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git merge city-ajax</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">兄弟组件间联动</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">实现点击字母表跳转到该字母开头的城市列表</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">把 Alphabet.vue 组件的值 传给 List.vue 组件 ，即兄弟组件之间的传值</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">因为这个非父子组件传递的兄弟组件只有两个，很简单，所以可以先让 </span><span style="font-size: 12pt; font-weight: bold;">Alphabet.vue 传值给 City.vue，</span><span style="font-size: 12pt; font-weight: bold;">City.vue 再转发给 </span><span style="font-size: 12pt; font-weight: bold;">List.vue</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Alphabet.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;ul class=&quot;list&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li</font></div><div><font style="font-size: 12pt;">          class=&quot;item&quot;</font></div><div><font style="font-size: 12pt;">          v-for=&quot;(item, key) of cities&quot;</font></div><div><font style="font-size: 12pt;">          :key=&quot;key&quot;</font></div><div><font style="font-size: 12pt;">          <b>@click=&quot;handleLetterClick&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">            {{key}}</font></div><div><font style="font-size: 12pt;">        &lt;/li&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityAlphabet',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">        cities: Object</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>methods: {</b></font></div><div><font style="font-size: 12pt;"><b><font>        handle</font>Letter<font>Click (e) {</font></b></font></div><div><font style="font-size: 12pt;"><b>             this.$emit('change', e.target.innerText)</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">    @import '~styles/variables.styl'  </font></div><div><font style="font-size: 12pt;">    .list</font></div><div><font style="font-size: 12pt;">        display: flex</font></div><div><font style="font-size: 12pt;">        flex-direction: column</font></div><div><font style="font-size: 12pt;">        justify-content: center</font></div><div><font style="font-size: 12pt;">        position: absolute</font></div><div><font style="font-size: 12pt;">        top: 1.58rem</font></div><div><font style="font-size: 12pt;">        right: 0</font></div><div><font style="font-size: 12pt;">        bottom: 0</font></div><div><font style="font-size: 12pt;">        width: .4rem</font></div><div><font style="font-size: 12pt;">        .item</font></div><div><font style="font-size: 12pt;">            line-height: .4rem</font></div><div><font style="font-size: 12pt;">            text-align: center</font></div><div><font style="font-size: 12pt;">            color: $bgColor                    </font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">City.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;city-page&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-header&gt;&lt;/city-header&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-search&gt;&lt;/city-search&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-list</font></div><div><font style="font-size: 12pt;">          :cities=&quot;cities&quot;</font></div><div><font style="font-size: 12pt;">          :hot=&quot;hotCities&quot;</font></div><div><font style="font-size: 12pt;">          <b>:letter=&quot;letter&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/city-list&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-alphabet</font></div><div><font style="font-size: 12pt;">          :cities=&quot;cities&quot;</font></div><div><font style="font-size: 12pt;">          <b>@change=&quot;handleLetterChange&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/city-alphabet&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;   </font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import axios from 'axios'</font></div><div><font style="font-size: 12pt;">import CityHeader from './components/Header.vue'</font></div><div><font style="font-size: 12pt;">import CitySearch from './components/Search.vue'</font></div><div><font style="font-size: 12pt;">import CityList from './components/List.vue'</font></div><div><font style="font-size: 12pt;">import CityAlphabet from './components/Alphabet.vue'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'City',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">        CityHeader: CityHeader,</font></div><div><font style="font-size: 12pt;">        CitySearch: CitySearch,</font></div><div><font style="font-size: 12pt;">        CityList: CityList,</font></div><div><font style="font-size: 12pt;">        CityAlphabet: CityAlphabet</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">        return {</font></div><div><font style="font-size: 12pt;">            cities: {},</font></div><div><font style="font-size: 12pt;">            hotCities: [],  </font></div><div><font style="font-size: 12pt;">            <b>letter: ''</b></font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">        getCityInfo () {</font></div><div><font style="font-size: 12pt;">            axios.get('/api/city.json')</font></div><div><font style="font-size: 12pt;">                .then(this.handelGetCityInfoSucc)</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        handelGetCityInfoSucc (res) {</font></div><div><font style="font-size: 12pt;">            res = res.data;</font></div><div><font style="font-size: 12pt;">            if (res.ret &amp;&amp; res.data) {</font></div><div><font style="font-size: 12pt;">                const data = res.data</font></div><div><font style="font-size: 12pt;">                this.cities = data.cities</font></div><div><font style="font-size: 12pt;">                this.hotCities = data.hotCities</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        <b>handleLetterChange (letter) {</b></font></div><div><font style="font-size: 12pt;"><b>            this.letter = letter</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted () {</font></div><div><font style="font-size: 12pt;">        this.getCityInfo()</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot;&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">实现字母表拖拽</span></span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Betterscroll 提供了一个接口 scrollToElement() 让滚动区域自动滚动到某个元素上（</span><span style="font-size: 12pt; font-weight: bold;">当letter数据不为空时滚动到该元素</span><span style="font-size: 12pt; font-weight: bold;">）</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">scrollToElement(element)</span></div></div><div><br/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">使用 ref 绑定 key，key 为A B C D...</span></font></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;div</font></div><div><font style="font-size: 12pt;">    class=&quot;area&quot;</font></div><div><font style="font-size: 12pt;">    v-for=&quot;(item, key) of cities&quot;</font></div><div><font style="font-size: 12pt;">    :key=&quot;key&quot;</font></div><div><font style="font-size: 12pt;">    <b>:ref=&quot;key&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">    &lt;h2 class=&quot;title border-topbottom&quot;&gt;{{key}}&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">    &lt;ul class=&quot;item-list&quot; v-for=&quot;inneritem of item&quot; :key=&quot;inneritem.id&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li class=&quot;item border-bottom&quot;&gt;{{inneritem.name}}&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">&lt;/div&gt;</font></div></div><div><br/></div><div><br/></div><div><img src="7- 城市列表页开发_files/3 [5].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">循环输出的 ref 获得的内容是一个数组 [div.area] ，而 </span><span style="font-size: 12pt; font-weight: bold;">scrollToElement() 的参数必须要是一个DOM元素，所以</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">const element = this.$refs[this.letter][0]</span></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">List.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;list&quot; ref=&quot;wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;当前城市&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;button-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div class=&quot;button-wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;button&quot;&gt;广州&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;热门城市&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;button-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div class=&quot;button-wrapper&quot; v-for=&quot;item of hot&quot; :key=&quot;item.id&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;button&quot;&gt;{{item.name}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div</font></div><div><font style="font-size: 12pt;">              class=&quot;area&quot;</font></div><div><font style="font-size: 12pt;">              v-for=&quot;(item, key) of cities&quot;</font></div><div><font style="font-size: 12pt;">              :key=&quot;key&quot;</font></div><div><font style="font-size: 12pt;">              <b>:ref=&quot;key&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;{{key}}&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;ul class=&quot;item-list&quot; v-for=&quot;inneritem of item&quot; :key=&quot;inneritem.id&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;{{inneritem.name}}&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;    </font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import Bscroll from 'better-scroll'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityList',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">        cities: Object,</font></div><div><font style="font-size: 12pt;">        hot: Array,</font></div><div><font style="font-size: 12pt;">        <b>letter: String</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted () {</font></div><div><font style="font-size: 12pt;">        this.scroll = new Bscroll(this.$refs.wrapper)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> watch: {</b></font></div><div><font style="font-size: 12pt;"><b>        letter () {</b></font></div><div><font style="font-size: 12pt;"><b>            if (this.letter) {</b></font></div><div><font style="font-size: 12pt;"><b>                const element = this.$refs[this.letter][0]</b></font></div><div><font style="font-size: 12pt;"><b>                this.scroll.scrollToElement(element)</b></font></div><div><font style="font-size: 12pt;"><b>            }</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">@import '~styles/variables.styl'</font></div><div><font style="font-size: 12pt;">    .border-topbottom</font></div><div><font style="font-size: 12pt;">        &amp;:before</font></div><div><font style="font-size: 12pt;">            border-color: #ccc</font></div><div><font style="font-size: 12pt;">        &amp;:after</font></div><div><font style="font-size: 12pt;">            border-color: #ccc</font></div><div><font style="font-size: 12pt;">    .border-bottom</font></div><div><font style="font-size: 12pt;">        &amp;:before</font></div><div><font style="font-size: 12pt;">            border-color: #ccc  </font></div><div><font style="font-size: 12pt;">    .list</font></div><div><font style="font-size: 12pt;">        overflow: hidden</font></div><div><font style="font-size: 12pt;">        position: absolute</font></div><div><font style="font-size: 12pt;">        top: 1.58rem</font></div><div><font style="font-size: 12pt;">        left: 0</font></div><div><font style="font-size: 12pt;">        right:0</font></div><div><font style="font-size: 12pt;">        bottom: 0              </font></div><div><font style="font-size: 12pt;">    .title</font></div><div><font style="font-size: 12pt;">        font-size: .24rem</font></div><div><font style="font-size: 12pt;">        padding: .24rem .3rem</font></div><div><font style="font-size: 12pt;">        background: #f5f5f5   </font></div><div><font style="font-size: 12pt;">     .button-list</font></div><div><font style="font-size: 12pt;">         overflow: hidden</font></div><div><font style="font-size: 12pt;">         padding: .1rem .6rem .1rem .1rem</font></div><div><font style="font-size: 12pt;">         .button-wrapper</font></div><div><font style="font-size: 12pt;">             float: left</font></div><div><font style="font-size: 12pt;">             width: 33.33%</font></div><div><font style="font-size: 12pt;">             .button</font></div><div><font style="font-size: 12pt;">                 margin: .1rem</font></div><div><font style="font-size: 12pt;">                 padding: .1rem 0</font></div><div><font style="font-size: 12pt;">                 text-align: center</font></div><div><font style="font-size: 12pt;">                 border: .02rem solid #cccccc</font></div><div><font style="font-size: 12pt;">                 border-radius: .06rem  </font></div><div><font style="font-size: 12pt;">     .item-list</font></div><div><font style="font-size: 12pt;">         line-height: .76rem</font></div><div><font style="font-size: 12pt;">         padding-left: .2rem</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [2].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">实现字母表拖拽，列表跟着滚动</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">首先使用计算属性将 cities 的 key（即A、B、C、D...）取出，放到新数组 </span><span style="font-size: 12pt;">letters</span><span style="font-size: 12pt;">，即 </span><span style="font-size: 12pt;">cities 的 key</span><span style="font-size: 12pt;">（即A、B、C、D...）</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">转接给 letters，</span><span style="font-size: 12pt;">v-for 时循环 letters 即可</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">要监听字母表的滚动事件，需要绑定三个新的事件：</span><span style="font-size: 12pt;">touchstart、</span><span style="font-size: 12pt;">touchmove、</span><span style="font-size: 12pt;">touchend</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">我们希望只有在 </span><span style="font-size: 12pt;">touchstart 之后才能触发 </span><span style="font-size: 12pt;">touchmove，所以要在 data 里定义一个标识位</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">data () {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">        touchStatus: false</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">handleTouchStart () {</font></div><div><font style="font-size: 12pt;">    this.touchStatus = true</font></div><div><font style="font-size: 12pt;">},</font></div><div><font style="font-size: 12pt;">handleTouchMove (e) {</font></div><div><font style="font-size: 12pt;">    if (this.touchStatus) {}</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">handleTouchMove要做什么呢？</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">首先，</span><span style="font-size: 12pt;">上下滑动时</span><span style="font-size: 12pt;">需要知道当前触碰的是第几个字母</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">思路：(</span><span style="font-size: 12pt;">滑动时当前手指触碰</span><span style="font-size: 12pt;">的字母</span><span style="font-size: 12pt;">距离</span><span style="font-size: 12pt;">页面顶部的</span><span style="font-size: 12pt;">高度 - </span><span style="font-size: 12pt;">Header头部高度 - </span><span style="font-size: 12pt;">第一个字母A</span><span style="font-size: 12pt;">顶部</span><span style="font-size: 12pt;">到</span><span style="font-size: 12pt;">列表顶部的高度  </span><span style="font-size: 12pt;">) / 每个字母的高度</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">e.touches[0].clientY 代表 当前手指触摸的字母</span><span style="font-size: 12pt;">距离</span><span style="font-size: 12pt;">页面顶部的</span><span style="font-size: 12pt;">高度</span><span style="font-size: 12pt;"> 假设当前第一个</span><span style="font-size: 12pt;">字母A</span><span style="font-size: 12pt;">为 181，即字母 B 顶部距离页面顶部的高度</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Header头部高度为 80</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">this.$refs['A'][0].offsetTop </span><span style="font-size: 12pt;">代表</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">第一个</span><span style="font-size: 12pt;">字母A顶部距离列表顶部的高度，这里是 74</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">一个</span><span style="font-size: 12pt;">字母的高度为 20</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">所以可以得出公式 Math.floor( (e.touches[0].clientY - 80 - </span><span style="font-size: 12pt;">this.$refs['A'][0].offsetTop) / 20 ) </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Math.floor( (181 - 80 - </span><span style="font-size: 12pt;">74) / 20 ) = 1</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">0 表示 A    </span><span style="font-size: 12pt;">Math.floor( (154 - 80 - </span><span style="font-size: 12pt;">74) / 20 ) = 0</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1 表示 B    </span><span style="font-size: 12pt;">Math.floor( (181 - 80 - </span><span style="font-size: 12pt;">74) / 20 ) = 1</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">依此类推</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [6].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Alphabet.vue</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;ul class=&quot;list&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li</font></div><div><font style="font-size: 12pt;">          class=&quot;item&quot;</font></div><div><font style="font-size: 12pt;">          v-for=&quot;item of letters&quot;</font></div><div><font style="font-size: 12pt;">          :key=&quot;item&quot;</font></div><div><font style="font-size: 12pt;">          <b>:ref=&quot;item&quot;</b></font></div><div><font style="font-size: 12pt;"><b>          @touchstart=&quot;handleTouchStart&quot;</b></font></div><div><font style="font-size: 12pt;"><b>          @touchmove=&quot;handleTouchMove&quot;</b></font></div><div><font style="font-size: 12pt;"><b>          @touchend=&quot;handleTouchEnd&quot;</b></font></div><div><font style="font-size: 12pt;"><b>          @click=&quot;handleClick&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">            {{item}}</font></div><div><font style="font-size: 12pt;">        &lt;/li&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityAlphabet',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">        cities: Object</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">        return {</font></div><div><font style="font-size: 12pt;">            <b>touchStatus: false,</b></font></div><div><font style="font-size: 12pt;"><b>            startY: 0</b></font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>computed: {</b></font></div><div><font style="font-size: 12pt;"><b>        letters () {</b></font></div><div><font style="font-size: 12pt;"><b>            const letters = []</b></font></div><div><font style="font-size: 12pt;"><b>            for (let i in this.cities) {</b></font></div><div><font style="font-size: 12pt;"><b>                letters.push(i)</b></font></div><div><font style="font-size: 12pt;"><b>            }</b></font></div><div><font style="font-size: 12pt;"><b>            return letters</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">        <b>handleClick (e) {</b></font></div><div><font style="font-size: 12pt;"><b>            this.$emit('change', e.target.innerText)</b></font></div><div><font style="font-size: 12pt;"><b>        },</b></font></div><div><font style="font-size: 12pt;"><b>        handleTouchStart () {</b></font></div><div><font style="font-size: 12pt;"><b>            this.touchStatus = true</b></font></div><div><font style="font-size: 12pt;"><b>        },</b></font></div><div><font style="font-size: 12pt;"><b>        handleTouchMove (e) {</b></font></div><div><font style="font-size: 12pt;"><b>            if (this.touchStatus) {</b></font></div><div><font style="font-size: 12pt;"><b>                this.startY = this.$refs['A'][0].offsetTop</b></font></div><div><font style="font-size: 12pt;"><b>                const touchY = e.touches[0].clientY - 80</b></font></div><div><font style="font-size: 12pt;"><b>                const index = Math.floor((touchY - this.startY) / 20)</b></font></div><div><font style="font-size: 12pt;"><b>                if (index &gt;= 0 &amp;&amp; index &lt; this.letters.length) {</b></font></div><div><font style="font-size: 12pt;"><b>                    this.$emit('change', this.letters[index])</b></font></div><div><font style="font-size: 12pt;"><b>                }</b></font></div><div><font style="font-size: 12pt;"><b>        },</b></font></div><div><font style="font-size: 12pt;"><b>        handleTouchEnd () {</b></font></div><div><font style="font-size: 12pt;"><b>            this.touchStatus = false</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">列表切换性能优化</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">this.$refs['A'][0].offsetTop A字母的</span><span style="font-size: 12pt; font-weight: bold;">offsetTop是固定的</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">handleTouchMove </span><span style="font-size: 12pt; font-weight: bold;">性能比较低，因为每执行一次 </span><span style="font-size: 12pt; font-weight: bold;">handleTouchMove </span><span style="font-size: 12pt; font-weight: bold;">就要运算一次offsetTop</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">去掉</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">const startY = this.$refs['A'][0].offsetTop</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">在 data 里再定义一个初始值 </span><span style="font-size: 12pt; font-weight: bold;">startY</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">data () {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">        startY: 0</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">},</font></div><div><font style="font-size: 12pt;">updated () {</font></div><div><font style="font-size: 12pt;">    this.startY = this.$refs['A'][0].offsetTop</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当初次渲染 Alphabet</span><span style="font-size: 12pt;">.vue 时是用 City.vue 的 cities 的数据渲染的，初始化</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">cities 的值是空对象，也就是说页面刚加载时 </span><span style="font-size: 12pt;">Alphabet</span><span style="font-size: 12pt;">.vue里什么东西都不会显示</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">当 </span><span style="font-size: 12pt;">City.vue 的 ajax 获取到数据之后， </span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">cities 的值才发生变化，</span><span style="font-size: 12pt;">Alphabet</span><span style="font-size: 12pt;">.vue 才被渲染出来</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">往 Alphabet</span><span style="font-size: 12pt;">.vue 传的数据发生变化时，</span><span style="font-size: 12pt;">Alphabet</span><span style="font-size: 12pt;">.vue </span><span style="font-size: 12pt;">就会重新渲染</span></div><div><span style="font-size: 12pt;"> </span></div><div><span style="font-size: 12pt;">Alphabet</span><span style="font-size: 12pt;">.vue </span><span style="font-size: 12pt;">重新渲染之后，</span><span style="font-size: 12pt;">updated 这个生命周期函数就会被执行，这时页面已经展示了城市字母列表才去获取 </span><span style="font-size: 12pt;">offsetTop，实现</span><span style="font-size: 12pt;">渲染之后</span><span style="font-size: 12pt;">只需要获取一次 </span><span style="font-size: 12pt;">offsetTop</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">函数防抖</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">当鼠标来回移动时 touchmove 的函数 </span><span style="font-size: 12pt;">handleTouchMove 执行频率非常高，所以要限制执行函数的频率，setTimeout设置延迟多少毫秒执行一次</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><br/></div><hr/><div><font style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Alphabet.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;ul class=&quot;list&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;li</font></div><div><font style="font-size: 12pt;">          class=&quot;item&quot;</font></div><div><font style="font-size: 12pt;">          v-for=&quot;item of letters&quot;</font></div><div><font style="font-size: 12pt;">          :key=&quot;item&quot;</font></div><div><font style="font-size: 12pt;">          <b>:ref=&quot;item&quot;</b></font></div><div><font style="font-size: 12pt;"><b>          @touchstart=&quot;handleTouchStart&quot;</b></font></div><div><font style="font-size: 12pt;"><b>          @touchmove=&quot;handleTouchMove&quot;</b></font></div><div><font style="font-size: 12pt;"><b>          @touchend=&quot;handleTouchEnd&quot;</b></font></div><div><font style="font-size: 12pt;"><b>          @click=&quot;handleClick&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">            {{item}}</font></div><div><font style="font-size: 12pt;">        &lt;/li&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityAlphabet',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">        cities: Object</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">        return {</font></div><div><font style="font-size: 12pt;">            touchStatus: false,</font></div><div><font style="font-size: 12pt;">            <b>startY: 0,</b></font></div><div><font style="font-size: 12pt;"><b>            timer: null</b></font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>updated () {</b></font></div><div><font style="font-size: 12pt;"><b>        this.startY = this.$refs['A'][0].offsetTop</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">        letters () {</font></div><div><font style="font-size: 12pt;">            const letters = []</font></div><div><font style="font-size: 12pt;">            for (let i in this.cities) {</font></div><div><font style="font-size: 12pt;">                letters.push(i)</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">            return letters</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">        handleClick (e) {</font></div><div><font style="font-size: 12pt;">            this.$emit('change', e.target.innerText)</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">       <b> handleTouchStart () {</b></font></div><div><font style="font-size: 12pt;"><b>            this.touchStatus = true</b></font></div><div><font style="font-size: 12pt;"><b>        },</b></font></div><div><font style="font-size: 12pt;"><b>        handleTouchMove (e) {</b></font></div><div><font style="font-size: 12pt;"><b>            if (this.touchStatus) {</b></font></div><div><font style="font-size: 12pt;"><b>                if (this.timer) {</b></font></div><div><font style="font-size: 12pt;"><b>                    clearTimeout(this.timer)</b></font></div><div><font style="font-size: 12pt;"><b>                }</b></font></div><div><font style="font-size: 12pt;"><b>                this.timer = setTimeout(() =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>                    const touchY = e.touches[0].clientY - 80</b></font></div><div><font style="font-size: 12pt;"><b>                    const index = Math.floor((touchY - this.startY) / 20)</b></font></div><div><font style="font-size: 12pt;"><b>                    if (index &gt;= 0 &amp;&amp; index &lt; this.letters.length) {</b></font></div><div><font style="font-size: 12pt;"><b>                        this.$emit('change', this.letters[index])</b></font></div><div><font style="font-size: 12pt;"><b>                    }</b></font></div><div><font style="font-size: 12pt;"><b>                }, 16)</b></font></div><div><font style="font-size: 12pt;"><b>            }</b></font></div><div><font style="font-size: 12pt;"><b>        },</b></font></div><div><font style="font-size: 12pt;"><b>        handleTouchEnd () {</b></font></div><div><font style="font-size: 12pt;"><b>            this.touchStatus = false</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">    @import '~styles/variables.styl'  </font></div><div><font style="font-size: 12pt;">    .list</font></div><div><font style="font-size: 12pt;">        display: flex</font></div><div><font style="font-size: 12pt;">        flex-direction: column</font></div><div><font style="font-size: 12pt;">        justify-content: center</font></div><div><font style="font-size: 12pt;">        position: absolute</font></div><div><font style="font-size: 12pt;">        top: 1.58rem</font></div><div><font style="font-size: 12pt;">        right: 0</font></div><div><font style="font-size: 12pt;">        bottom: 0</font></div><div><font style="font-size: 12pt;">        width: .4rem</font></div><div><font style="font-size: 12pt;">        .item</font></div><div><font style="font-size: 12pt;">            line-height: .4rem</font></div><div><font style="font-size: 12pt;">            text-align: center</font></div><div><font style="font-size: 12pt;">            color: $bgColor                    </font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [3].gif" type="image/gif" data-filename="3.gif"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">ctrl + c 退出项目</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">再次提交代码到远程仓库</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git add .</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git commit -m 'perfomance'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout master</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git merge city-components</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">搜索功能</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">新建分支为 city-search-logic</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">搜索框初始样式</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [7].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">问题：搜索的列表特别多时无法滚动</span></div><div><br/></div><div><span style="font-size: 12pt;">使用Better-scroll来实现局部滚动</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">mounted () {</font></div><div><font style="font-size: 12pt;">    this.scroll = new Bscroll(this.$refs.search)</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">city.json</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">&quot;cities&quot;: {</span></div><div><span style="font-size: 12pt;">            &quot;A&quot;: [{</span></div><div><span style="font-size: 12pt;">                &quot;id&quot;: 56,</span></div><div><span style="font-size: 12pt;">                &quot;spell&quot;: &quot;aba&quot;,</span></div><div><span style="font-size: 12pt;">                &quot;name&quot;: &quot;阿坝&quot;</span></div><div><span style="font-size: 12pt;">            }, {</span></div><div><span style="font-size: 12pt;">                &quot;id&quot;: 57,</span></div><div><span style="font-size: 12pt;">                &quot;spell&quot;: &quot;akesu&quot;,</span></div><div><span style="font-size: 12pt;">                &quot;name&quot;: &quot;阿克苏&quot;</span></div><div><span style="font-size: 12pt;">            }],</span></div><div><span style="font-size: 12pt;">            &quot;B&quot;: [{</span></div><div><span style="font-size: 12pt;">                &quot;id&quot;: 1,</span></div><div><span style="font-size: 12pt;">                &quot;spell&quot;: &quot;beijing&quot;,</span></div><div><span style="font-size: 12pt;">                &quot;name&quot;: &quot;北京&quot;</span></div><div><span style="font-size: 12pt;">            }, {</span></div><div><span style="font-size: 12pt;">                &quot;id&quot;: 66,</span></div><div><span style="font-size: 12pt;">                &quot;spell&quot;: &quot;baicheng&quot;,</span></div><div><span style="font-size: 12pt;">                &quot;name&quot;: &quot;白城&quot;</span></div><div><span style="font-size: 12pt;">            }</span></div><div><span style="font-size: 12pt;">}</span></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Search.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">&lt;div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;search&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;input</font></div><div><font style="font-size: 12pt;">          <b>v-model=&quot;keyword&quot;</b></font></div><div><font style="font-size: 12pt;">          class=&quot;search-input&quot;</font></div><div><font style="font-size: 12pt;">          type=&quot;text&quot;</font></div><div><font style="font-size: 12pt;">          placeholder=&quot;输入城市名或拼音&quot;/&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;"><font>    &lt;div class=&quot;search-content&quot; <b>ref=&quot;search&quot; v-show=&quot;keyword&quot;</b>&gt; //</font> v-show 输入关键词显示，没有就不显示</font></div><div><font style="font-size: 12pt;">        &lt;ul&gt;</font></div><div><font style="font-size: 12pt;">            &lt;li</font></div><div><font style="font-size: 12pt;">              class=&quot;search-item border-bottom&quot;</font></div><div><font style="font-size: 12pt;">              v-for=&quot;item of list&quot;</font></div><div><font style="font-size: 12pt;">              :key=&quot;item.id&quot;&gt;</font></div><div><font style="font-size: 12pt;">              {{item.name}}</font></div><div><font style="font-size: 12pt;">            &lt;/li&gt;</font></div><div><font style="font-size: 12pt;"><font>            &lt;li class=&quot;search-item border-bottom&quot; <b>v-show=&quot;hasNoData&quot;</b>&gt; // </font>v-show <font>搜索结果没有时显示</font></font></div><div><font style="font-size: 12pt;">                没有找到匹配的数据</font></div><div><font style="font-size: 12pt;">            &lt;/li&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;"><b>import Bscroll from 'better-scroll'</b></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CitySearch',</font></div><div><font style="font-size: 12pt;">    <b>props: {</b></font></div><div><font style="font-size: 12pt;"><b>        cities: Object</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">        return {</font></div><div><font style="font-size: 12pt;">            <b>keyword: '',</b></font></div><div><font style="font-size: 12pt;">            <b>list: []</b>,</font></div><div><font style="font-size: 12pt;">            timer: null</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> computed: {</b></font></div><div><font style="font-size: 12pt;"><b>        hasNoData () {</b></font></div><div><font style="font-size: 12pt;"><b>            return !this.list.length</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>    },</b></font></div><div><font style="font-size: 12pt;">    watch: {</font></div><div><font style="font-size: 12pt;">        keyword () {</font></div><div><font style="font-size: 12pt;">           <b> if (this.timer) {</b></font></div><div><font style="font-size: 12pt;"><b>                clearTimeout(this.timer)</b></font></div><div><font style="font-size: 12pt;"><b>            }</b></font></div><div><font style="font-size: 12pt;">            <b>if (!this.keyword) {</b></font></div><div><font style="font-size: 12pt;"><b>                this.list = []</b></font></div><div><font style="font-size: 12pt;"><b>                return</b></font></div><div><font style="font-size: 12pt;"><b>            }</b></font></div><div><font style="font-size: 12pt;">            <b>this.timer = setTimeout(() =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>                const result = []</b></font></div><div><font style="font-size: 12pt;"><b>                // 搜索核心代码</b></font></div><div><font style="font-size: 12pt;"><b>                for (let i in this.cities) {</b></font></div><div><font style="font-size: 12pt;"><b>                    this.cities[i].forEach((value) =&gt; {</b></font></div><div><font style="font-size: 12pt;"><b>                        if (value.spell.indexOf(this.keyword) &gt; -1 ||</b></font></div><div><font style="font-size: 12pt;"><b>                        value.name.indexOf(this.keyword) &gt; -1) {</b></font></div><div><font style="font-size: 12pt;"><b>                            result.push(value)</b></font></div><div><font style="font-size: 12pt;"><b>                        }</b></font></div><div><font style="font-size: 12pt;"><b>                    })</b></font></div><div><font style="font-size: 12pt;"><b>                }</b></font></div><div><font style="font-size: 12pt;"><b>                this.list = result</b></font></div><div><font style="font-size: 12pt;"><b>            }, 100)</b></font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> mounted () {</b></font></div><div><font style="font-size: 12pt;"><b>        this.scroll = new Bscroll(this.$refs.search)</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;stylus&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">@import '~styles/variables.styl'</font></div><div><font style="font-size: 12pt;">     .border-bottom</font></div><div><font style="font-size: 12pt;">         border-bottom: 1px solid #e0e0e0</font></div><div><font style="font-size: 12pt;">     .search</font></div><div><font style="font-size: 12pt;">         height: .72rem</font></div><div><font style="font-size: 12pt;">         padding: 0 .1rem</font></div><div><font style="font-size: 12pt;">         background: $bgColor</font></div><div><font style="font-size: 12pt;">         .search-input</font></div><div><font style="font-size: 12pt;">             box-sizing: border-box</font></div><div><font style="font-size: 12pt;">             width: 100%</font></div><div><font style="font-size: 12pt;">             height: .62rem</font></div><div><font style="font-size: 12pt;">             padding: 0 .1rem</font></div><div><font style="font-size: 12pt;">             line-height: .62rem</font></div><div><font style="font-size: 12pt;">             text-align: center</font></div><div><font style="font-size: 12pt;">             border-radius: .06rem</font></div><div><font style="font-size: 12pt;">             color: #666</font></div><div><font style="font-size: 12pt;">   <b>  .search-content</b></font></div><div><font style="font-size: 12pt;"><b>         position: absolute</b></font></div><div><font style="font-size: 12pt;"><b>         top: 1.58rem</b></font></div><div><font style="font-size: 12pt;"><b>         left: 0</b></font></div><div><font style="font-size: 12pt;"><b>         right: 0</b></font></div><div><font style="font-size: 12pt;"><b>         bottom: 0</b></font></div><div><font style="font-size: 12pt;"><b>         background: #eee</b></font></div><div><font style="font-size: 12pt;"><b>         z-index: 1</b></font></div><div><font style="font-size: 12pt;">         <b>.search-item</b></font></div><div><font style="font-size: 12pt;"><b>             line-height: .62rem</b></font></div><div><font style="font-size: 12pt;"><b>             padding-left: .2rem</b></font></div><div><font style="font-size: 12pt;">             color: #666   </font></div><div><font style="font-size: 12pt;">             background: #fff     </font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">City.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;city-page&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-header&gt;&lt;/city-header&gt;</font></div><div><font style="font-size: 12pt;">        <b>&lt;city-search :cities=&quot;cities&quot;&gt;&lt;/city-search&gt;</b></font></div><div><font style="font-size: 12pt;">        &lt;city-list</font></div><div><font style="font-size: 12pt;">          :cities=&quot;cities&quot;</font></div><div><font style="font-size: 12pt;">          :hot=&quot;hotCities&quot;</font></div><div><font style="font-size: 12pt;">          :letter=&quot;letter&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/city-list&gt;</font></div><div><font style="font-size: 12pt;">        &lt;city-alphabet</font></div><div><font style="font-size: 12pt;">          :cities=&quot;cities&quot;</font></div><div><font style="font-size: 12pt;">          @change=&quot;handleLetterChange&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/city-alphabet&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;   </font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import axios from 'axios'</font></div><div><font style="font-size: 12pt;">import CityHeader from './components/Header.vue'</font></div><div><font style="font-size: 12pt;"><b>import CitySearch from './components/Search.vue'</b></font></div><div><font style="font-size: 12pt;">import CityList from './components/List.vue'</font></div><div><font style="font-size: 12pt;">import CityAlphabet from './components/Alphabet.vue'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'City',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">        CityHeader: CityHeader,</font></div><div><font style="font-size: 12pt;">        <b>CitySearch: CitySearch,</b></font></div><div><font style="font-size: 12pt;">        CityList: CityList,</font></div><div><font style="font-size: 12pt;">        CityAlphabet: CityAlphabet</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">        return {</font></div><div><font style="font-size: 12pt;">            <b>cities: {},</b></font></div><div><font style="font-size: 12pt;">            hotCities: [],  </font></div><div><font style="font-size: 12pt;">            letter: ''</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">        getCityInfo () {</font></div><div><font style="font-size: 12pt;">            axios.get('/api/city.json')</font></div><div><font style="font-size: 12pt;">                .then(this.handelGetCityInfoSucc)</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        handelGetCityInfoSucc (res) {</font></div><div><font style="font-size: 12pt;">            res = res.data;</font></div><div><font style="font-size: 12pt;">            if (res.ret &amp;&amp; res.data) {</font></div><div><font style="font-size: 12pt;">                <b>const data = res.data</b></font></div><div><font style="font-size: 12pt;">                <b>this.cities = data.cities</b></font></div><div><font style="font-size: 12pt;">                this.hotCities = data.hotCities</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        handleLetterChange (letter) {</font></div><div><font style="font-size: 12pt;">            this.letter = letter</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted () {</font></div><div><font style="font-size: 12pt;">        this.getCityInfo()</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [4].gif" type="image/gif" data-filename="3.gif"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">ctrl + c 退出项目</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">提交代码到仓库</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git add .</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git commit -m 'search finish'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout master</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git merge city-search-logic</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">使用Vuex实现 首页 和 城市选择页面 的数据共享</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">实现功能：点击城市选择页面列表的城市时，首页的城市会跟着变</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">但是，由于City.vue 和 Home.vue 没有共用的父级组件，</span><span style="font-size: 12pt;">城市选择页面的数据要传给</span><span style="font-size: 12pt;">首页就没办法通过父级组件来传了</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">虽然可以使用bus，但是依然麻烦</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vue官方提供了数据框架工具——Vuex</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Vuex的设计理念：</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">当我们各个页面或多个组件数据传值困难时，如果我们把公用数据放在一个公共存储区域存储，一旦某个组件改变公用数据，其他组件能感知到</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">下图虚线部分就是公用数据存储区域，这个区域可以理解成store仓库</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/vuex.png" type="image/png" data-filename="vuex.png" width="587"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">store仓库由三部分组成</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">State：存放所有公用的数据，使用数据调用 State 即可（</span></span> <span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">{{this.$store.state.city}}</span></span><b style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold; color: rgb(255, 0, 0);">）</span></b></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">Actions：</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">如果有异步操作或批量复杂的同步操作，可以放在 Actions 里（并不是必须的，可以略过）</span></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Mutations：放着一个一个同步的对 State 的修改</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">不能让一个组件直接改变公用的数据，必须走一个流程才能改变公用的数据</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">流程：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">组件先调用 Actions（组件使用 Dispatch 方法来操作 Actions）</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Actions 接着调用 Mutations（组件或 </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Actions </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">使用 Commit 方法来操作 </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Mutations</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Mutations 最后改变 State 里的公用数据</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">当数据发生变化，组件展示的内容相应地发生变化</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">使用 Vuex 时可以使用 Devtools 来调试代码</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">在main.js引入vuex不太好，因为vuex要做的文件比较复杂，所以要在src文件夹下单独创建一个store文件夹，在</span><span style="font-size: 12pt; font-weight: bold;">store文件夹新建一个文件，叫 index.js</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [8].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">Vuex是一个插件，Vue使用插件都是通过use()使用的</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">export default 导出的是 Vuex 创建的 store（仓库）</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">index.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">import Vuex from 'vuex'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.use(Vuex)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default <b>new Vuex.Store({</b></font></div><div><font style="font-size: 12pt;"><b>    state: {</b></font></div><div><font style="font-size: 12pt;"><b>        city: '广州'</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;"><b>})</b></font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">main.js 引入 store</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">import App from './App'</font></div><div><font style="font-size: 12pt;">import router from './router'</font></div><div><font style="font-size: 12pt;">import fastClick from 'fastclick'</font></div><div><font style="font-size: 12pt;">import VueAwesomeSwiper from 'vue-awesome-swiper'</font></div><div><font style="font-size: 12pt;"><b>import store from './store'</b></font></div><div><font style="font-size: 12pt;">import 'styles/reset.css'</font></div><div><font style="font-size: 12pt;">import 'styles/border.css'</font></div><div><font style="font-size: 12pt;">import 'styles/iconfont.css'</font></div><div><font style="font-size: 12pt;">import 'swiper/dist/css/swiper.css'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.config.productionTip = false</font></div><div><font style="font-size: 12pt;">fastClick.attach(document.body)</font></div><div><font style="font-size: 12pt;">Vue.use(VueAwesomeSwiper)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">/* eslint-disable no-new */</font></div><div><font style="font-size: 12pt;">new Vue({</font></div><div><font style="font-size: 12pt;">  el: '#app',</font></div><div><font style="font-size: 12pt;">  router,</font></div><div><font style="font-size: 12pt;">  <b>store,</b></font></div><div><font style="font-size: 12pt;">  render: h =&gt; h(App)</font></div><div><font style="font-size: 12pt;">})</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">怎么使用state里的数据呢？</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">以前首页 &lt;city-heade :city=&quot;city&quot;&gt; 是由外部传递的，现在不需要了</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">以前的</span> <span style="font-size: 12pt;">:city=&quot;city&quot; </span><span style="font-size: 12pt;">是通过 ajax 后端返回的，现在 Home.vue 的 data 和 axios、mock 的 city.json 的 city ；Home.vue 的 props 的 city 都不需要</span> <span style="font-size: 12pt;">通过 ajax 后端返回</span><span style="font-size: 12pt;">了</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">因为 main.js 创建根实例时把 store 传递进去了，所以 </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">store 会被派发到每个组件里，所以每个组件都可以使用 {{this.$store}} 获取到 store</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">首页 Header.vue 使用state的公用数据city</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;header&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;header-left&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;iconfont back-icon&quot;&gt;&amp;#xe624;&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;header-input&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;span class=&quot;iconfont&quot;&gt;&amp;#xe632;&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">            输入城市/景点/主题</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;router-link to=&quot;/city&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;header-right&quot;&gt;</font></div><div><font style="font-size: 12pt;">                <b>{{this.$store.state.city}}</b></font></div><div><font style="font-size: 12pt;">                &lt;span class=&quot;iconfont arrow-icon&quot;&gt;&amp;#xe64a;&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/router-link&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">城市列表页的List.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">     &lt;h2 class=&quot;title border-topbottom&quot;&gt;当前城市&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">     &lt;div class=&quot;button-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">     &lt;div class=&quot;button-wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">     &lt;div class=&quot;button&quot;&gt;<b>{{this.$store.state.city}}</b>&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/div&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">如果想改变state，需要怎么做呢？</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">城市列表页的List.vue</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">handleCityClick (city) {</font></div><div><font style="font-size: 12pt;">    <b>this.$store.dispatch('changeCity', city)  </b></font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">store文件夹的index.js</span></span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">城市列表页的 List.vue 的 </span><span style="font-size: 12pt; font-weight: bold;">handleCityClick 触发 dispatch</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">this.$store.dispatch('changeCity', city)  </font></div></div><div><br/></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">派发一个 </span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">changeCity 的 actions 并且把city传过去</span></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">actions 会接收到 city</span></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">actions 是一个对象，对象里都是方法，方法接受两个参数，第一个参数是上下文，第二个参数是传递过来的数据</span></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">actions 已经接收到传递过来的 city，需要调用 mutatuions 去改变公用数据</span></div><div><br/></div><div><span style="font-size: 12pt;">mutatuions</span><span style="font-size: 12pt;">是一个对象，对象里都是方法，</span><span style="font-size: 12pt;">方法名是任意的，</span><span style="font-size: 12pt;">方法接受两个参数，</span><span style="font-size: 12pt;">第一个参数是state指的是公用数据</span><span style="font-size: 12pt;">，第二个参数是传递过来的数据</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">import Vue from 'vue'</span></div><div><span style="font-size: 12pt;">import Vuex from 'vuex'</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Vue.use(Vuex)</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">export default new Vuex.Store({</span></div><div><span style="font-size: 12pt;">    state: {</span></div><div><span style="font-size: 12pt;">        city: '广州'</span></div><div><span style="font-size: 12pt;">    },</span></div><div><span style="font-size: 12pt;">    <b>actions: {</b></span></div><div><span style="font-size: 12pt;"><b>        changeCity (ctx, city) {</b></span></div><div><font style="font-size: 12pt;"><b>            ctx.commit('changeCity', city)</b></font></div><div><span style="font-size: 12pt;"><b>        }</b></span></div><div><span style="font-size: 12pt;"><b>    }</b>,</span></div><div><span style="font-size: 12pt;">   <b> mutations: {</b></span></div><div><span style="font-size: 12pt;"><b>        changeCity (state, city) {</b></span></div><div><span style="font-size: 12pt;"><b>            state.city = city</b></span></div><div><span style="font-size: 12pt;"><b>        }</b></span></div><div><span style="font-size: 12pt;"><b>    }</b></span></div><div><span style="font-size: 12pt;">})</span></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">列表页面无法点击切换城市，为什么?</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">betterScroll创建的区域，最近版本默认是不支持点击的，如果需要点击，创建betterScroll 的时候加一个参数即可：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">new Bscroll(this.$refs.wrapper, {click: true})</font></div></div><div><span style="font-size: 12pt;"><br/></span></div></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">城市列表页的List.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;list&quot; ref=&quot;wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;当前城市&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;button-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div class=&quot;button-wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;button&quot;&gt;<b>{{this.$store.state.city}}</b>&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;热门城市&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;button-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div</font></div><div><font style="font-size: 12pt;">                      class=&quot;button-wrapper&quot;</font></div><div><font style="font-size: 12pt;">                      v-for=&quot;item of hot&quot;</font></div><div><font style="font-size: 12pt;">                      :key=&quot;item.id&quot;</font></div><div><font style="font-size: 12pt;">                     <b> @click=&quot;handleCityClick(item.name)&quot;</b>&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;button&quot;&gt;{{item.name}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div</font></div><div><font style="font-size: 12pt;">              class=&quot;area&quot;</font></div><div><font style="font-size: 12pt;">              v-for=&quot;(item, key) of cities&quot;</font></div><div><font style="font-size: 12pt;">              :key=&quot;key&quot;</font></div><div><font style="font-size: 12pt;">              :ref=&quot;key&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;{{key}}&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;ul class=&quot;item-list&quot; v-for=&quot;inneritem of item&quot; :key=&quot;inneritem.id&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;{{inneritem.name}}&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;    </font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import Bscroll from 'better-scroll'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityList',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">        hot: Array,</font></div><div><font style="font-size: 12pt;">        cities: Object,</font></div><div><font style="font-size: 12pt;">        letter: String</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">       <b> handleCityClick (city) {</b></font></div><div><font style="font-size: 12pt;"><b>            this.$store.dispatch('changeCity', city)  </b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;">    },    </font></div><div><font style="font-size: 12pt;">    watch: {</font></div><div><font style="font-size: 12pt;">        letter () {</font></div><div><font style="font-size: 12pt;">            if (this.letter) {</font></div><div><font style="font-size: 12pt;">                const element = this.$refs[this.letter][0]</font></div><div><font style="font-size: 12pt;">                this.scroll.scrollToElement(element)</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted () {</font></div><div><font style="font-size: 12pt;">        <b>this.scroll = new Bscroll(this.$refs.wrapper, {click: true})</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">首页的Header.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;header&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;header-left&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;iconfont back-icon&quot;&gt;&amp;#xe624;&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;header-input&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;span class=&quot;iconfont&quot;&gt;&amp;#xe632;&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">            输入城市/景点/主题</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;router-link to=&quot;/city&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;header-right&quot;&gt;</font></div><div><font style="font-size: 12pt;">                <b>{{this.$store.state.city}}</b></font></div><div><font style="font-size: 12pt;">                &lt;span class=&quot;iconfont arrow-icon&quot;&gt;&amp;#xe64a;&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/router-link&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">    export default {</font></div><div><font style="font-size: 12pt;">        name: 'HomeHeader'</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 12pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">因为没有异步操作或批量复杂的同步操作，只是简单的操作，所以可以略过 actions，直接用 commit 调用 mutations</span></span></div><div><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">城市列表页的List.vue</span></div><div><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">handleCityClick (city) {</font></div><div><font style="font-size: 12pt;">    <b>this.$store.commit('changeCity', city)  </b></font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">store文件夹的index.js</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">export default new Vuex.Store({</font></div><div><font style="font-size: 12pt;">    state: {</font></div><div><font style="font-size: 12pt;">        city: '广州'</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">   <b> mutations: {</b></font></div><div><font style="font-size: 12pt;"><b>        changeCity (state, city) {</b></font></div><div><font style="font-size: 12pt;"><b>            state.city = city</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;"><b>    }</b></font></div><div><font style="font-size: 12pt;">})</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">功能完善：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">点击城市列表页的城市列表时改变当前城市</span><span style="font-size: 12pt; font-weight: bold;">的显示</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;ul</font></div><div><font style="font-size: 12pt;">     class=&quot;item-list&quot;</font></div><div><font style="font-size: 12pt;">     v-for=&quot;inneritem of item&quot;</font></div><div><font style="font-size: 12pt;">     :key=&quot;inneritem.id&quot;</font></div><div><font style="font-size: 12pt;">     <b>@click=&quot;handleCityClick(inneritem.name)</b>&quot;&gt;</font></div><div><font style="font-size: 12pt;">     &lt;li class=&quot;item border-bottom&quot;&gt;{{inneritem.name}}&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">&lt;/ul&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">搜索城市时点击城市也能</span><span style="font-size: 12pt; font-weight: bold;">改变当前城市的显示</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;li</font></div><div><font style="font-size: 12pt;">   class=&quot;search-item border-bottom&quot;</font></div><div><font style="font-size: 12pt;">   v-for=&quot;item of list&quot;</font></div><div><font style="font-size: 12pt;">   :key=&quot;item.id&quot;</font></div><div><font style="font-size: 12pt;">   <b>@click=&quot;handleCityClick(item.name)</b>&quot;&gt;</font></div><div><font style="font-size: 12pt;">{{item.name}}</font></div><div><font style="font-size: 12pt;">&lt;/li&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">点击</span><span style="font-size: 12pt; font-weight: bold;">城市列表页的城市列表</span><span style="font-size: 12pt; font-weight: bold;">或</span><span style="font-size: 12pt; font-weight: bold;">搜索城市点击城市后都可以跳转到首页</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">this.$router.push('/') 编程式导航</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">List.vue 和 Search.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">methods: {</font></div><div><font style="font-size: 12pt;">     handleCityClick (city) {</font></div><div><font style="font-size: 12pt;">         this.$store.commit('changeCity', city)</font></div><div><font style="font-size: 12pt;">         <b>this.$router.push('/')</b></font></div><div><font style="font-size: 12pt;">     }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><font style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex的高级使用 和 localStorage</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">刷新之后城市又变回原来的'广州'，再次访问应该是上次切换的城市</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">HTML5提供了localStorage，帮助我们实现类似cookie的功能，做到本地存储，API比</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">cookie简单</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">为了不让index.js页面变得复杂，所以</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">index.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">import Vuex from 'vuex'</font></div><div><font style="font-size: 12pt;"><b>import state from './state.js'</b></font></div><div><font style="font-size: 12pt;"><b>import mutations from './mutations.js'</b></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.use(Vuex)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default new Vuex.Store({</font></div><div><font style="font-size: 12pt;">    <b>state,</b></font></div><div><font style="font-size: 12pt;"><b>    mutations</b></font></div><div><font style="font-size: 12pt;">})</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">在state文件夹下新建</span><span style="font-size: 12pt; font-weight: bold;">mutations.js</span><span style="font-size: 12pt; font-weight: bold;">文件</span></div><div><br/></div><div><img src="7- 城市列表页开发_files/3 [9].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">mutations.js</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">export default {</span></div><div><span style="font-size: 12pt;">    <b>changeCity(state, city)</b> {</span></div><div><span style="font-size: 12pt;">        <b>state.city = city</b></span></div><div><span style="font-size: 12pt;">        try {</span></div><div><span style="font-size: 12pt;">           </span><span style="font-size: 12pt; font-weight: bold;"> localStorage.city = city</span></div><div><span style="font-size: 12pt;">        }</span></div><div><span style="font-size: 12pt;">        catch (e) { }</span></div><div><span style="font-size: 12pt;">    }</span></div><div><span style="font-size: 12pt;">}</span></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">为了避免用户关闭了本地存储，使用了隐身模式，</span><span style="font-size: 12pt;">localStorage 会抛出异常，代码</span><span style="font-size: 12pt;">运行不了，所以要使用 try-catch</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">在state文件夹下新建state.js文件</span></div><div><br/></div><div><img src="7- 城市列表页开发_files/3 [10].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">state.js</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">let defaultCity = '广州'</span></div><div><span style="font-size: 12pt;">try {</span></div><div><span style="font-size: 12pt;">    <b>if (localStorage.city) {</b></span></div><div><span style="font-size: 12pt;"><b>        defaultCity = localStorage.city</b></span></div><div><span style="font-size: 12pt;"><b>    }</b></span></div><div><span style="font-size: 12pt;">}</span></div><div><span style="font-size: 12pt;">catch (e) { }</span></div><div><br/></div><div><span style="font-size: 12pt;">export default {</span></div><div><span style="font-size: 12pt;">    <b>city: defaultCity</b></span></div><div><span style="font-size: 12pt;">}</span></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(255, 70, 53); font-weight: bold;">mapState 的意思是把 Vuex 的 state数据 映射到这个组件名字为 </span><span style="font-size: 12pt; color: rgb(255, 70, 53); font-weight: bold;">city的计算属性 中</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import { mapState } from 'vuex'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'HomeHeader',</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">        ...mapState(['city'])</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">{{this.$store.state.city}}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">就可以简化成：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">{{this.city}}</font></div></div><div><br/></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex还提供了mapMutations</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import { mapMutations } from 'vuex'</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">...mapMutations('changeCity')</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这段代码有一个mutation叫</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">changeCity，我们把这</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">个mutation映射到这个组件名叫</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">changeCity的方法里</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">this.$store.commit('changeCity', city)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">就可以简化成：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">this.changeCity(city)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">首页的Header.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;header&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;header-left&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;iconfont back-icon&quot;&gt;&amp;#xe624;&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;header-input&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;span class=&quot;iconfont&quot;&gt;&amp;#xe632;&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">            输入城市/景点/主题</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;router-link to=&quot;/city&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;header-right&quot;&gt;</font></div><div><font style="font-size: 12pt;">               <b> {{this.city}}</b></font></div><div><font style="font-size: 12pt;">                &lt;span class=&quot;iconfont arrow-icon&quot;&gt;&amp;#xe64a;&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/router-link&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">    <b>import { mapState } from 'vuex'</b></font></div><div><font style="font-size: 12pt;">    export default {</font></div><div><font style="font-size: 12pt;">        name: 'HomeHeader',</font></div><div><font style="font-size: 12pt;">       <b> computed: {</b></font></div><div><font style="font-size: 12pt;"><b>            ...mapState(['city'])</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">城市列表页的List.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;list&quot; ref=&quot;wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;当前城市&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;button-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div class=&quot;button-wrapper&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;button&quot;&gt;<b>{{this.city}}</b>&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;area&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;热门城市&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;div class=&quot;button-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;div</font></div><div><font style="font-size: 12pt;">                      class=&quot;button-wrapper&quot;</font></div><div><font style="font-size: 12pt;">                      v-for=&quot;item of hot&quot;</font></div><div><font style="font-size: 12pt;">                      :key=&quot;item.id&quot;</font></div><div><font style="font-size: 12pt;">                      @click=&quot;handleCityClick(item.name)&quot;&gt;</font></div><div><font style="font-size: 12pt;">                        &lt;div class=&quot;button&quot;&gt;{{item.name}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div</font></div><div><font style="font-size: 12pt;">              class=&quot;area&quot;</font></div><div><font style="font-size: 12pt;">              v-for=&quot;(item, key) of cities&quot;</font></div><div><font style="font-size: 12pt;">              :key=&quot;key&quot;</font></div><div><font style="font-size: 12pt;">              :ref=&quot;key&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h2 class=&quot;title border-topbottom&quot;&gt;{{key}}&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">                &lt;ul</font></div><div><font style="font-size: 12pt;">                  class=&quot;item-list&quot;</font></div><div><font style="font-size: 12pt;">                  v-for=&quot;inneritem of item&quot;</font></div><div><font style="font-size: 12pt;">                  :key=&quot;inneritem.id&quot;</font></div><div><font style="font-size: 12pt;">                 @click=&quot;handleCityClick(inneritem.name)&quot;&gt;</font></div><div><font style="font-size: 12pt;">                    &lt;li class=&quot;item border-bottom&quot;&gt;{{inneritem.name}}&lt;/li&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;    </font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import Bscroll from 'better-scroll'</font></div><div><font style="font-size: 12pt;"><b>import { mapState, mapMutations } from 'vuex'</b></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CityList',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">        hot: Array,</font></div><div><font style="font-size: 12pt;">        cities: Object,</font></div><div><font style="font-size: 12pt;">        letter: String</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    <b>computed: {</b></font></div><div><font style="font-size: 12pt;"><b>        ...mapState({</b></font></div><div><font style="font-size: 12pt;"><b>            city: 'city'</b></font></div><div><font style="font-size: 12pt;"><b>        })</b></font></div><div><font style="font-size: 12pt;"><b>    }</b>,</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">        handleCityClick (city) {</font></div><div><font style="font-size: 12pt;">           <b> this.changeCity(city)</b></font></div><div><font style="font-size: 12pt;">            this.$router.push('/')</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        <b>...mapMutations(['changeCity'])</b></font></div><div><font style="font-size: 12pt;">    },    </font></div><div><font style="font-size: 12pt;">    watch: {</font></div><div><font style="font-size: 12pt;">        letter () {</font></div><div><font style="font-size: 12pt;">            if (this.letter) {</font></div><div><font style="font-size: 12pt;">                const element = this.$refs[this.letter][0]</font></div><div><font style="font-size: 12pt;">                this.scroll.scrollToElement(element)</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted () {</font></div><div><font style="font-size: 12pt;">        this.scroll = new Bscroll(this.$refs.wrapper, {click: true})</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">城市列表页的</span><span style="font-size: 12pt; font-weight: bold;">Search.vue</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">&lt;div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;search&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;input</font></div><div><font style="font-size: 12pt;">          v-model=&quot;keyword&quot;</font></div><div><font style="font-size: 12pt;">          class=&quot;search-input&quot;</font></div><div><font style="font-size: 12pt;">          type=&quot;text&quot;</font></div><div><font style="font-size: 12pt;">          placeholder=&quot;输入城市名或拼音&quot;/&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div</font></div><div><font style="font-size: 12pt;">      class=&quot;search-content&quot;</font></div><div><font style="font-size: 12pt;">      ref=&quot;search&quot;</font></div><div><font style="font-size: 12pt;">      v-show=&quot;keyword&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;ul&gt;</font></div><div><font style="font-size: 12pt;">            &lt;li</font></div><div><font style="font-size: 12pt;">              class=&quot;search-item border-bottom&quot;</font></div><div><font style="font-size: 12pt;">              v-for=&quot;item of list&quot;</font></div><div><font style="font-size: 12pt;">              :key=&quot;item.id&quot;</font></div><div><font style="font-size: 12pt;">              @click=&quot;handleCityClick(item.name)&quot;&gt;</font></div><div><font style="font-size: 12pt;">              {{item.name}}</font></div><div><font style="font-size: 12pt;">            &lt;/li&gt;</font></div><div><font style="font-size: 12pt;">            &lt;li class=&quot;search-item border-bottom&quot; v-show=&quot;hasNoData&quot;&gt;</font></div><div><font style="font-size: 12pt;">                没有找到匹配的数据</font></div><div><font style="font-size: 12pt;">            &lt;/li&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/ul&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import Bscroll from 'better-scroll'</font></div><div><font style="font-size: 12pt;"><b>import { mapMutations } from 'vuex'</b></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    name: 'CitySearch',</font></div><div><font style="font-size: 12pt;">    props: {</font></div><div><font style="font-size: 12pt;">        cities: Object</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data () {</font></div><div><font style="font-size: 12pt;">        return {</font></div><div><font style="font-size: 12pt;">            keyword: '',</font></div><div><font style="font-size: 12pt;">            list: [],</font></div><div><font style="font-size: 12pt;">            timer: null</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">         handleCityClick (city) {</font></div><div><font style="font-size: 12pt;">            <b>this.changeCity(city)</b></font></div><div><font style="font-size: 12pt;">            this.$router.push('/')</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        <b>...mapMutations(['changeCity'])</b></font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">        hasNoData () {</font></div><div><font style="font-size: 12pt;">            return !this.list.length</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    watch: {</font></div><div><font style="font-size: 12pt;">        keyword () {</font></div><div><font style="font-size: 12pt;">            if (this.timer) {</font></div><div><font style="font-size: 12pt;">                clearTimeout(this.timer)</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">            if (!this.keyword) {</font></div><div><font style="font-size: 12pt;">                this.list = []</font></div><div><font style="font-size: 12pt;">                return</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">            this.timer = setTimeout(() =&gt; {</font></div><div><font style="font-size: 12pt;">                const result = []</font></div><div><font style="font-size: 12pt;">                for (let i in this.cities) {</font></div><div><font style="font-size: 12pt;">                    this.cities[i].forEach((value) =&gt; {</font></div><div><font style="font-size: 12pt;">                        if (value.spell.indexOf(this.keyword) &gt; -1 ||</font></div><div><font style="font-size: 12pt;">                        value.name.indexOf(this.keyword) &gt; -1) {</font></div><div><font style="font-size: 12pt;">                            result.push(value)</font></div><div><font style="font-size: 12pt;">                        }</font></div><div><font style="font-size: 12pt;">                    })</font></div><div><font style="font-size: 12pt;">                }</font></div><div><font style="font-size: 12pt;">                this.list = result</font></div><div><font style="font-size: 12pt;">            }, 100)</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted () {</font></div><div><font style="font-size: 12pt;">        this.scroll = new Bscroll(this.$refs.search, {click: true})</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [5].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git add .</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git commit -m 'use vuex'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout master</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git merge 'city-vuex'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">使用keep-alive优化网页性能</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">新建分支为city-keepalive</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">问题：每次路由切换到Home.vue 或 City.vue时都要在重新渲染时使用生命钩子mounted请求一个json文件</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [11].jpg" type="image/jpeg" data-filename="3.jpg" width="781"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">App.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;app&quot;&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;keep-alive&gt;</b></font></div><div><font style="font-size: 12pt;"><b>      &lt;router-view/&gt;   </b></font></div><div><font style="font-size: 12pt;"><b>    &lt;/keep-alive&gt; </b>  </font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'App'</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;"> &lt;router-view/&gt;  </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">加载过一次后， &lt;keep-alive&gt; </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">将 </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">&lt;router-view/&gt; </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">中的内容放到内存中，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">下一次再进入</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">&lt;router-view/&gt; </span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">不需要重新渲染重新执行mounted()生命钩子，</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">只需要在内存里拿以前的内容显示即可</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">还有个逻辑问题：当城市为桂林时，首页显示的是桂林的内容，当城市为北京时，首页显示的应该是北京的内容，所以城市改变时首页还要重新加载一次ajax请求</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">使用&lt;keepalive&gt;时切换城市不会改变请求参数，但是会多出一个activated()函数可以使用</span></span></div><div><font color="#FF0000" style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">activated()在首页首次加载时会和mounted()一起执行，重新加载首页时mounted()不会执行，而</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">activated()一定会执行</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">所以</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">activated()里</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">可以判断重新加载页面时的城市是否和上次加载页面的城市相同，如果不相同则再发一次</span><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">ajax请求</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">通过&lt;keepalive&gt;新增的</span><span style="font-size: 12pt; font-weight: bold;">activated()函数</span><span style="font-size: 12pt; font-weight: bold;">结合this.lastCity 临时缓存变量实现首页代码性能最优化</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Home.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;main-page&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;home-header&gt;&lt;/home-header&gt;</font></div><div><font style="font-size: 12pt;">        &lt;home-swiper :list=&quot;swiperList&quot;&gt;&lt;/home-swiper&gt;</font></div><div><font style="font-size: 12pt;">        &lt;home-icons :list=&quot;iconList&quot;&gt;&lt;/home-icons&gt;</font></div><div><font style="font-size: 12pt;">        &lt;home-recommend :list=&quot;recommendList&quot;&gt;&lt;/home-recommend&gt;</font></div><div><font style="font-size: 12pt;">        &lt;home-weekend :list=&quot;weekendList&quot;&gt;&lt;/home-weekend&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;    </font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">    import HomeHearder from './components/Header.vue'</font></div><div><font style="font-size: 12pt;">    import HomeSwiper from './components/Swiper.vue'</font></div><div><font style="font-size: 12pt;">    import HomeIcons from './components/Icons.vue'</font></div><div><font style="font-size: 12pt;">    import HomeRecommend from './components/Recommend.vue'</font></div><div><font style="font-size: 12pt;">    import HomeWeekend from './components/Weekend.vue'</font></div><div><font style="font-size: 12pt;">    import axios from 'axios'</font></div><div><font style="font-size: 12pt;">   <b> import { mapState } from 'vuex'</b></font></div><div><font style="font-size: 12pt;">    export default {</font></div><div><font style="font-size: 12pt;">        name: 'Home',</font></div><div><font style="font-size: 12pt;">        components: {</font></div><div><font style="font-size: 12pt;">            HomeHeader: HomeHearder,</font></div><div><font style="font-size: 12pt;">            HomeSwiper: HomeSwiper,</font></div><div><font style="font-size: 12pt;">            HomeIcons: HomeIcons,</font></div><div><font style="font-size: 12pt;">            HomeRecommend: HomeRecommend,</font></div><div><font style="font-size: 12pt;">            HomeWeekend: HomeWeekend</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        data () {</font></div><div><font style="font-size: 12pt;">            return {</font></div><div><font style="font-size: 12pt;">                lastCity: '',</font></div><div><font style="font-size: 12pt;">                swiperList: [],</font></div><div><font style="font-size: 12pt;">                iconList: [],</font></div><div><font style="font-size: 12pt;">                recommendList: [],</font></div><div><font style="font-size: 12pt;">                weekendList: []</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">       <b> computed: {</b></font></div><div><font style="font-size: 12pt;"><b>            ...mapState(['city'])</b></font></div><div><font style="font-size: 12pt;"><b>        }</b>,</font></div><div><font style="font-size: 12pt;">        methods: {</font></div><div><font style="font-size: 12pt;">            getHomeInfo () {</font></div><div><font style="font-size: 12pt;">                axios.get('/api/index.json<b>?city=' + this.city</b>)</font></div><div><font style="font-size: 12pt;">                    .then(this.getHomeInfoSucc)</font></div><div><font style="font-size: 12pt;">            },</font></div><div><font style="font-size: 12pt;">            getHomeInfoSucc (res) {</font></div><div><font style="font-size: 12pt;">                res = res.data</font></div><div><font style="font-size: 12pt;">                if (res.ret &amp;&amp; res.data) {</font></div><div><font style="font-size: 12pt;">                    const data = res.data</font></div><div><font style="font-size: 12pt;">                    this.swiperList = data.swiperList</font></div><div><font style="font-size: 12pt;">                    this.iconList = data.iconList</font></div><div><font style="font-size: 12pt;">                    this.recommendList = data.recommendList</font></div><div><font style="font-size: 12pt;">                    this.weekendList = data.weekendList</font></div><div><font style="font-size: 12pt;">                }</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        mounted () {</font></div><div><font style="font-size: 12pt;">            this.lastCity = this.city</font></div><div><font style="font-size: 12pt;">            this.getHomeInfo()</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">       <b> activated () {</b></font></div><div><font style="font-size: 12pt;"><b>            if (this.lastCity !== this.city) {</b></font></div><div><font style="font-size: 12pt;"><b>                this.lastCity = this.city</b></font></div><div><font style="font-size: 12pt;"><b>                this.getHomeInfo()</b></font></div><div><font style="font-size: 12pt;"><b>            }</b></font></div><div><font style="font-size: 12pt;"><b>        }</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="7- 城市列表页开发_files/3 [6].gif" type="image/gif" data-filename="3.gif"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">git add .</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git commit -m 'finish city page'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git checkout master</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git merge city-keepalive</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">git push</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 