<html>
<head>
  <title>3- Vuex</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/606060 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4355"/>
<h1>3- Vuex</h1>

<div>
<span><div><div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">状态是变量，也是数据。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">Vuex 是对象，也是状态的管家。</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3.jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [1].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font color="#FF0000" style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">以上代码虽然可以做到数据共享，但是无法实现响应式</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [2].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [3].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [4].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [5].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [6].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">安装 Vuex</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [7].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [8].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [9].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 319px;"></col><col style="width: 507px;"></col></colgroup><tbody><tr><td style="vertical-align: middle; width: 319px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">         State            状态</span></div></td><td style="vertical-align: middle; width: 507px; padding: 8px; border: 1px solid;"><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">     </span></div><div><span style="font-size: 16px;">     存储状态，</span><span style="font-size: 12pt;">供全局使用</span></div><div><span style="font-size: 16px;"><br/></span></div></td></tr><tr><td style="vertical-align: middle; width: 319px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">       </span> <span style="font-size: 12pt;"> Mutations    改变</span><span style="font-size: 12pt;">  </span></div></td><td style="vertical-align: middle; width: 507px; padding: 8px; border: 1px solid;"><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">     </span></div><div style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; font-size: medium; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">     </span><span style="font-size: 12pt;">负责跟踪哪个页面组件修改了 state</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><br/></div></td></tr><tr><td style="vertical-align: middle; width: 319px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">         </span><span style="font-size: 12pt;">Actions        操作</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">（可有可无）</span></div></td><td style="vertical-align: middle; width: 507px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">     </span></div><div><span style="font-size: 12pt;">     </span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">负责异步操作，</span><span style="box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-size: 12pt; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">向后端 API 发送请求</span></div><div><span style="font-size: 12pt;"><br/></span></div></td></tr><tr><td style="vertical-align: middle; width: 319px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">         Devtools </span></div></td><td style="vertical-align: middle; width: 507px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">     </span></div><div><span style="font-size: 12pt;">     Vue 开发的浏览器插件，跟踪多个页面的修改，防止修改错误</span></div><div><span style="font-size: 12pt;"><br/></span></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [10].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [11].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">store文件夹 index.js</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">import Vue from 'vue'</span></div><div><span style="font-size: 12pt;"><b>import Vuex from 'vuex'</b></span></div><div><br/></div><div><span style="font-size: 12pt;"><b>Vue.use(Vuex);</b></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><b>const store = new Vuex.Store(</b></span></div><div><span style="font-size: 12pt;">  {</span></div><div><span style="font-size: 12pt;">   </span><span style="font-size: 12pt; font-weight: bold;"> state: {</span></div><div><span style="font-size: 12pt; font-weight: bold;">      count: 0</span></div><div><span style="font-size: 12pt; font-weight: bold;">    }</span><span style="font-size: 12pt;">,</span></div><div><span style="font-size: 12pt;">    getters: {},</span></div><div><span style="font-size: 12pt;">    mutations: {</span></div><div><span style="font-size: 12pt;">      </span></div><div><span style="font-size: 12pt;">    },</span></div><div><span style="font-size: 12pt;">    actions: {</span></div><div><span style="font-size: 12pt;">      </span></div><div><span style="font-size: 12pt;">    }</span></div><div><span style="font-size: 12pt;">  }</span></div><div><font style="font-size: 12pt;"><b>)</b></font></div><div> </div><div><span style="font-size: 12pt;"><b>export default store</b></span></div></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">main.js</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">import Vue from 'vue'</span></div><div><span style="font-size: 12pt;">import App from './App'</span></div><div><span style="font-size: 12pt;">import router from './router'</span></div><div><span style="font-size: 12pt; font-weight: bold;">import store from &quot;./store&quot;</span></div><div><br/></div><div><span style="font-size: 12pt;">Vue.config.productionTip = false</span></div><div><br/></div><div><span style="font-size: 12pt;">new Vue({</span></div><div><span style="font-size: 12pt;">  el: '#app',</span></div><div><span style="font-size: 12pt;">  router,</span></div><div><span style="font-size: 12pt;"> </span><span style="font-size: 12pt; font-weight: bold;"> store,</span> <font style="font-size: 12pt;"><b>// 把 store 对象添加到 vue 实例上</b></font><span style="font-size: 12pt; font-weight: bold;"> </span></div><div><span style="font-size: 12pt;">  render: h =&gt; h(App)</span></div><div><span style="font-size: 12pt;">})</span></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">APP.vue</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(255, 0, 0); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, Ubuntu, Cantarell, &quot;Noto Sans&quot;, sans-serif, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, Arial; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">官方建议 this.$store.state.XXX 最好放在计算属性中</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;app&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;h2&gt;app组件的内容&lt;/h2&gt;</font></div><div><font style="font-size: 12pt;">    <b>&lt;p&gt;{{$store.state.count}}&lt;/p&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;button @click=&quot;increase&quot;&gt;+1&lt;/button&gt;</b></font></div><div><font style="font-size: 12pt;"><b>    &lt;button @click=&quot;decrease&quot;&gt;-1&lt;/button&gt;</b></font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'App',</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      <b>increase() {</b></font></div><div><font style="font-size: 12pt;"><b>        return this.$store.state.count++;</b></font></div><div><font style="font-size: 12pt;"><b>      },</b></font></div><div><font style="font-size: 12pt;"><b>      decrease() {</b></font></div><div><font style="font-size: 12pt;"><b>        return this.$store.state.count--;</b></font></div><div><font style="font-size: 12pt;"><b>      }</b></font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3.gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第二种方式</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [12].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [13].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [1].gif" type="image/gif" data-filename="3.gif"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex state 单一状态树的理解</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [14].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [15].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">只建一个 Store，不然不方便维护</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex getter 的使用详解</span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">Vuex 允许我们在 store 中定义“getter”（可以认为是 store 的计算属性）。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">就像计算属性一样，getter 的返回值会根据它的依赖被缓存起来，且只有当它的依赖值发生了改变才会被重新计算。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [16].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [17].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [18].jpg" type="image/jpeg" data-filename="3.jpg" width="924"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [19].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [20].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [21].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Vuex mutations 的携带参数</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">Vuex 中的 mutation 非常类似于事件：每个 mutation 都有一个字符串的 事件类型 (type) 和 一个 回调函数 (handler)。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">这个回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">const store = new Vuex.Store({</font></div><div><font style="font-size: 12pt;">  state: {</font></div><div><font style="font-size: 12pt;">    count: 1</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  mutations: {</font></div><div><font style="font-size: 12pt;">    increment (state) {</font></div><div><font style="font-size: 12pt;">      // 变更状态</font></div><div><font style="font-size: 12pt;">      state.count++</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font><span style="font-size: 12pt;">)</span></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">你不能直接调用一个 mutation 的 handler。这个参数更像是事件注册：“当一个类型为 increment 的 mutation 被唤醒时，调用此函数。”</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">要唤醒一个 mutation handler，你需要以相应的 type 调用 store.commit 方法：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">store.commit('increment')</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [22].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [23].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [24].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [25].jpg" type="image/jpeg" data-filename="3.jpg" width="717"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [26].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [27].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex 数据的响应规则</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [28].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [29].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [30].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [31].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">删除的响应式</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [32].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex mutation </span></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">使用常量替代 Mutation 事件类型</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// mutation-types.js</font></div><div><font style="font-size: 12pt;">export const SOME_MUTATION = 'SOME_MUTATION'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// store.js</font></div><div><font style="font-size: 12pt;">import Vuex from 'vuex'</font></div><div><font style="font-size: 12pt;">import { SOME_MUTATION } from './mutation-types'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const store = new Vuex.Store({</font></div><div><font style="font-size: 12pt;">  state: { ... },</font></div><div><font style="font-size: 12pt;">  mutations: {</font></div><div><font style="font-size: 12pt;">    // 我们可以使用 ES2015 风格的计算属性命名功能来使用一个常量作为函数名</font></div><div><font style="font-size: 12pt;">    [SOME_MUTATION] (state) {</font></div><div><font style="font-size: 12pt;">      // mutate state</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">})</font></div></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt;"><br/></span></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [33].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">例如下列代码定义了很多方法</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [34].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">在 commit 时写方法名往往容易出错</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [35].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果 mutations-type.js 里常量 INCREMENT 的值 'increment '是错的，也不会影响 mutations </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [36].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [37].jpg" type="image/jpeg" data-filename="3.jpg" width="763"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [38].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [39].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [40].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Mutation 同步函数</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [41].jpg" type="image/jpeg" data-filename="3.jpg" width="990"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [42].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [43].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [44].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">如果要进行异步操作，必须：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [45].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Vuex  action 的使用详解</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">actions 的 函数接受一个与 store 实例具有相同方法和属性的 context 对象，</span></span></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">因</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-family: unset; font-weight: bold;">此你可以调用 context.commit 提交一个 mutation，</span></div><div><br/></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">或者通过 context.state 和 context.getters 来获取 state 和 getters。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">context 对象其实不是 store 实例本身，</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">当介绍到 Modules 时，你就知道了 。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">实践中，我们会经常用到 ES2015 的 参数解构 来简化代码，（特别是我们需要调用 commit 很多次的时候，可以少写点代码）：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">因为 context 是对象，所以可以解构成 {commit}</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#000000" style="font-size: 12pt;">actions: {</font></div><div><font color="#000000" style="font-size: 12pt;">  increment ({ commit }) {</font></div><div><font color="#000000" style="font-size: 12pt;">    commit('increment')</font></div><div><font color="#000000" style="font-size: 12pt;">  }</font></div><div><font color="#000000" style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [46].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [47].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [48].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [49].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [50].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">异步操作完成时发送通知信息：</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第一种写法</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [51].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [52].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第二种写法</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [53].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [54].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [55].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">总结流程：（$store 表示 this.$store，此处省略）</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font color="#7600D8" style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">state 存储数据 =&gt; </span></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">getters 的方法(state) 变异数据 =&gt;</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">模板 {{</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">$store.</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">state.xxx}} 展示</span> <span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">getters 后的</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">数据 =&gt;</span></div><div><font color="#7600D8" style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">组件 methods 的 $store.diapatch('异步方法', payload) =&gt; actions 的异步方法(context, payload) =&gt; （这步可省略，需要异步处理时使用）</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">actions 的异步方法 </span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">context.commit</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">(</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">'同步方法'或常量类型</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">, 参数)</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">  </span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">（这步也可省略</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">，需要异步处理时使用</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">或 </span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">组件 methods</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">  的 $store.commit('同步方法'或常量类型, 参数) =&gt; </span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">mutations 的同步方法 [常量类型对象的方法名](state, 参数)  =&gt; 修改 state</span></span></div><div><font color="#7600D8" style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">getters 变异数据 =&gt;</span></span></div><div><br/></div><div><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">模板 {{$store.state.xxx}} 展示 </span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">getters 后</span><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">数据 =&gt; ...</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-weight: bold;">Vuex module 的使用详解</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">由于只能使用单一状态树的 store，不能定义多个 state、mutations、actions、getters，所以还提供了另一个方案 —— modules</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [56].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">第二种方式</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">模块的 state</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [57].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [58].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [59].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [60].jpg" type="image/jpeg" data-filename="3.jpg" width="1028"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">模块的 mutations</span></span></div><div><br/></div><div><span style="font-size: 12pt;">模块的 mutations 不能有与 new Vue.Store 的 mutaions 同名的情况，</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">this.store.commit('updateName', 'lisi') 时，会优先在 </span><span style="font-size: 12pt;">new Vuex.Store 的 mutaions 找有没有 </span><span style="font-size: 12pt;">updateName </span><span style="font-size: 12pt;">函数，没有的话，就会去</span><span style="font-size: 12pt;">模块的 mutations 中找</span></div><div><br/></div><div><img src="3- Vuex_files/3 [61].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><img src="3- Vuex_files/3 [62].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><img src="3- Vuex_files/3 [63].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><img src="3- Vuex_files/3 [64].jpg" type="image/jpeg" data-filename="3.jpg"/></div><div><br/></div><div><br/></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [65].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [66].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">模块的 getters</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [67].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [68].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [69].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [70].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">拼接 store 的 counter</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [71].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [72].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [73].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">模块 actions </span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">模块 actions </span><span style="font-size: 12pt;">的 context 表示该模块 （module），commit 针对的是该</span><span style="font-size: 12pt;">模块的 mutations</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [74].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [75].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [76].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [77].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [78].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [79].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [80].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">对象的解构</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [81].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vuex store 文件夹的目录组织</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [82].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">抽离 state</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [83].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">抽离 mutations（需要再创建一个文件）</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [84].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [85].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [86].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">抽离 actions 和 getters </span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [87].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [88].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [89].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">抽离 moduleA</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [90].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [91].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [92].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">全部抽离之后：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><img src="3- Vuex_files/3 [93].jpg" type="image/jpeg" data-filename="3.jpg"/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">每次都写 </span><span style="font-size: 12pt;">this.$store.state.XXX 和</span> <span style="font-size: 12pt;">this.$store.getters.XXX 很麻烦，官方建议我们可以使用 </span><span style="font-size: 12pt;">mapState 和</span> <span style="font-size: 12pt;">mapGetters 解构到计算属性中，就可以直接使用 this 调用</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import { mapState, mapGetters } from 'vuex';</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    mounted() {</font></div><div><font style="font-size: 12pt;">        console.log(this.name);</font></div><div><font style="font-size: 12pt;">        console.log(this.getMessage);</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">        ...mapState(['name']),</font></div><div><font style="font-size: 12pt;">        ...mapGetters(['getMessage']),</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">解构的时候可以赋别名</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">...mapState({ aliasName: 'name' }),  // 赋别名的话，这里接收对象，而不是数组</font></div><div><font style="font-size: 12pt;">...mapGetters({ aliasName: 'getMessage' }),  // 赋别名的话，这里接收对象，而不是数组</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">可以使用 mapActions 代替 </span><span style="font-size: 12pt;">this.$store.dispatch('XXX') 调用 action</span><span style="font-size: 12pt;">，把相关的 actions 解构到 methods 中，用 this 直接调用</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">&lt;script&gt;</span></div><div><span style="font-size: 12pt;">import { mapActions } from 'vuex';</span></div><div><span style="font-size: 12pt;">export default {</span></div><div><span style="font-size: 12pt;">    methods: {</span></div><div><span style="font-size: 12pt;">        ...mapActions(['setNum']),   // 就像这样，解构到methods中</span></div><div><span style="font-size: 12pt;">    },</span></div><div><span style="font-size: 12pt;">    async mounted() {</span></div><div><span style="font-size: 12pt;">        await this.setNum({ number: 123 });  // 直接这样调用即可</span></div><div><span style="font-size: 12pt;">    },</span></div><div><span style="font-size: 12pt;">}</span></div><div><span style="font-size: 12pt;">&lt;/script&gt;</span></div></div><div><br/></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">解构的时候可以赋别名</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">methods: {</span></div><div><span style="font-size: 12pt;">  ...mapActions({ setNumAlias: 'setNum' }),   // 赋别名的话，这里接收对象，而不是数组</span></div><div><span style="font-size: 12pt;">}</span></div></div><div><br/></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">像 mapState 和 mapGetters 一样，我们在组件中可以使用 mapMutations 代替 this.$store.commit('XXX')</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import { mapMutations } from 'vuex';</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">    mounted() {</font></div><div><font style="font-size: 12pt;">        this.setNumberIsWhat({ number: 999 });</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {   // 注意，mapMutations是解构到 methods 里面的，而不是计算属性</font></div><div><font style="font-size: 12pt;">        ...mapMutations(['setNumberIsWhat']),</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">解构的时候可以赋别名</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">methods: {</font></div><div><font style="font-size: 12pt;">    ...mapMutations({ setNumberIsAlias: 'setNumberIsWhat' }),   // 赋别名的话，这里接收对象，而不是数组</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div></div><hr/><div><br/></div></div><div><br/></div></span>
</div></body></html> 