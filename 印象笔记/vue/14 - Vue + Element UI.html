<html>
<head>
  <title>14 - Vue + Element UI</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/606060 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1109"/>
<h1>14 - Vue + Element UI</h1>

<div>
<span><div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Vue + Element UI</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">vue create element-test</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">基本用法</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、安装</span></div><div><a href="14 - Vue + Element UI.html" style="color: rgb(105, 170, 53);">14 - Vue + Element UI</a></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm i element-ui -S</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">2、main.js 使用这个 Vue 的插件并引用样式</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import ElementUI from 'element-ui'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">import 'element-ui/lib/theme-chalk/index.css'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.use(ElementUI)</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">按需加载</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">对项目进行打包：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm run build</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">发现 vendors 库高达 789KB</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">-rw-r--r--  1 sam  staff   789518 10 27 20:40 chunk-vendors.cd583f5b.js</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">这是由于我们未使用按需加载，所以对 element-ui 进行全量（整体加载）打包的结果，按需加载的用法如下：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">1. 安装 babel-plugin-component</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm install babel-plugin-component -D</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">2. 修改 babel.config.js：</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">{</font></div><div><font style="font-size: 12pt;">  &quot;presets&quot;: [[&quot;es2015&quot;, { &quot;modules&quot;: false }]],</font></div><div><font style="font-size: 12pt;">  &quot;plugins&quot;: [</font></div><div><font style="font-size: 12pt;">    [</font></div><div><font style="font-size: 12pt;">      &quot;component&quot;,</font></div><div><font style="font-size: 12pt;">      {</font></div><div><font style="font-size: 12pt;">        &quot;libraryName&quot;: &quot;element-ui&quot;,</font></div><div><font style="font-size: 12pt;">        &quot;styleLibraryName&quot;: &quot;theme-chalk&quot;</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    ]</font></div><div><font style="font-size: 12pt;">  ]</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">3. main.js 按需引入 Button 和 Message</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import { Button, Message } from 'element-ui'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.component(Button.name, Button)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.prototype.$message = Message</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">重新构建</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">npm run build</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">vendors 体积减小到 113KB</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">-rw-r--r--  1 sam  staff  113282 10 27 20:50 chunk-vendors.3d7d02b2.js</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">插件引用</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">可以通过 element 插件快速集成 element-ui</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">vue add element</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">全量加载还是按需加载？</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">Fully import</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">是否可以覆盖</span> <span style="font-size: 12pt;">element-ui SCSS</span><span style="font-size: 12pt;">样式的变量？</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">No</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">选择语言版本？</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">zh-CN</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">表单基本用法</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1. el-form 容器，通过 model 绑定整个表单数据源，inline 使表单在一行排列，否则换行排列</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">2. el-form-item 容器，通过 label 绑定标签</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">3. 表单组件通过 v-model 绑定 model 中的数据，与 el-form 数据源对应</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;el-form inline :model=&quot;data&quot;&gt;</font></div><div><font style="font-size: 12pt;">  &lt;el-form-item label=&quot;审批人&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;el-input v-model=&quot;data.user&quot; placeholder=&quot;审批人&quot;&gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">&lt;el-form&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;app&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;el-form inline :model=&quot;data&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-form-item label=&quot;审批人&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-input v-model=&quot;data.user&quot; placeholder=&quot;审批人&quot;&gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-form-item label=&quot;活动区域&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-select v-model=&quot;data.region&quot; placeholder=&quot;活动区域&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-option label=&quot;区域一&quot; value=&quot;shanghai&quot;&gt;&lt;/el-option&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-option label=&quot;区域二&quot; value=&quot;beijing&quot;&gt;&lt;/el-option&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-select&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-form-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-button type=&quot;primary&quot; @click=&quot;onSubmit&quot;&gt;查询&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/el-form&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'app',</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      data: {</font></div><div><font style="font-size: 12pt;">        user: 'sam',</font></div><div><font style="font-size: 12pt;">        region: '区域二'</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    onSubmit() {</font></div><div><font style="font-size: 12pt;">      console.log(this.data)</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">表单校验基本用法</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1. 定义校验规则，可以绑定到 el-form 或 el-form-item</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">data() {</font></div><div><font style="font-size: 12pt;">  const userValidator = (rule, value, callback) =&gt; {</font></div><div><font style="font-size: 12pt;">    if (value.length &gt; 3) {</font></div><div><font style="font-size: 12pt;">      callback()</font></div><div><font style="font-size: 12pt;">    } else {</font></div><div><font style="font-size: 12pt;">      callback(new Error('用户名长度必须大于3'))</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  return {</font></div><div><font style="font-size: 12pt;">    data: {</font></div><div><font style="font-size: 12pt;">      user: 'sam',</font></div><div><font style="font-size: 12pt;">      region: '区域二'</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    rules: {</font></div><div><font style="font-size: 12pt;">      user: [</font></div><div><font style="font-size: 12pt;">        { required: true, trigger: 'change', message: '用户名必须录入' },</font></div><div><font style="font-size: 12pt;">        { validator: userValidator, trigger: 'change' }</font></div><div><font style="font-size: 12pt;">      ]</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">2. 指定 el-form-item 的 prop 属性</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;el-form-item label=&quot;审批人&quot; prop=&quot;user&quot;&gt;</font></div><div><font style="font-size: 12pt;">  &lt;el-input v-model=&quot;data.user&quot; placeholder=&quot;审批人&quot; clearable&gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">&lt;/el-form-item&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">表单校验相关属性</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● hide-required-asterisk：隐藏必录标识</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> inline-message：验证消息是否在一行显示</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">表单校验高级用法</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">用法一：动态改变校验规则</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">1、rules 只包含一个校验规则</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">{</font></div><div><font style="font-size: 12pt;">  rules: {</font></div><div><font style="font-size: 12pt;">      user: [</font></div><div><font style="font-size: 12pt;">        { required: true, trigger: 'change', message: '用户名必须录入' },</font></div><div><font style="font-size: 12pt;">      ]</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">2、</span><span style="font-size: 12pt;">动态添加 rules</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">addRule() {</font></div><div><font style="font-size: 12pt;">    const userValidator = (rule, value, callback) =&gt; {</font></div><div><font style="font-size: 12pt;">      if (value.length &gt; 3) {</font></div><div><font style="font-size: 12pt;">        this.inputError = ''</font></div><div><font style="font-size: 12pt;">        this.inputValidateStatus = ''</font></div><div><font style="font-size: 12pt;">        callback()</font></div><div><font style="font-size: 12pt;">      } else {</font></div><div><font style="font-size: 12pt;">        callback(new Error('用户名长度必须大于3'))</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    const newRule = [</font></div><div><font style="font-size: 12pt;">      ...this.rules.user,</font></div><div><font style="font-size: 12pt;">      { validator: userValidator, trigger: 'change' }</font></div><div><font style="font-size: 12pt;">    ]</font></div><div><font style="font-size: 12pt;">    this.rules = Object.assign({}, this.rules, { user: newRule })</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">用法二：手动控制校验状态</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> validate-status：验证状态，枚举值，共四种：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">1、success：验证成功</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">2、error：验证失败</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">3、validating：验证中</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">4、 ( 空)：未验证</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> </span><span style="font-size: 12pt;">error：自定义错误提示</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;">设置 el-form-item 属性</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;el-form-item</font></div><div><font style="font-size: 12pt;">  label=&quot;用户名&quot;</font></div><div><font style="font-size: 12pt;">  prop=&quot;user&quot;</font></div><div><font style="font-size: 12pt;">  :error=&quot;error&quot;</font></div><div><font style="font-size: 12pt;">  :validate-status=&quot;status&quot;</font></div><div><font style="font-size: 12pt;">&gt;</font></div><div><font style="font-size: 12pt;">&lt;!-- ... --&gt;</font></div><div><font style="font-size: 12pt;">&lt;/el-form-item&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">自定义 status 和 error</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">showError() {</font></div><div><font style="font-size: 12pt;">  this.status = 'error'</font></div><div><font style="font-size: 12pt;">  this.error = '用户名输入有误'</font></div><div><font style="font-size: 12pt;">},</font></div><div><font style="font-size: 12pt;">showSuccess() {</font></div><div><font style="font-size: 12pt;">  this.status = 'success'</font></div><div><font style="font-size: 12pt;">  this.error = ''</font></div><div><font style="font-size: 12pt;">},</font></div><div><font style="font-size: 12pt;">showValidating() {</font></div><div><font style="font-size: 12pt;">  this.status = 'validating'</font></div><div><font style="font-size: 12pt;">  this.error = ''</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">表单属性解析</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> label-position：标签位置，枚举值，left 和 top</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> label-width：标签宽度</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> label-suffix：标签后缀</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> inline：行内表单</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> disabled: 设置整个 form 中的表单组件全部 disabled，优先级低于表单组件自身的 disabled</span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">/* el-input 源码 */</font></div><div><font style="font-size: 12pt;">inputDisabled() {</font></div><div><font style="font-size: 12pt;">  return this.disabled || (this.elForm || {}).disabled;</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> size：设置表单组件尺寸</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">/* el-input */</font></div><div><font style="font-size: 12pt;">inputSize() {</font></div><div><font style="font-size: 12pt;">  return this.size || this._elFormItemSize || (this.$ELEMENT || {}).size;</font></div><div><font style="font-size: 12pt;">},</font></div><div><font style="font-size: 12pt;">_elFormItemSize() {</font></div><div><font style="font-size: 12pt;">  return (this.elFormItem || {}).elFormItemSize;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">/* el-form-item */</font></div><div><font style="font-size: 12pt;">elFormItemSize() {</font></div><div><font style="font-size: 12pt;">  return this.size || this._formSize;</font></div><div><font style="font-size: 12pt;">},</font></div><div><font style="font-size: 12pt;">_formSize() {</font></div><div><font style="font-size: 12pt;">  return this.elForm.size;</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">案例</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;app&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;el-form</font></div><div><font style="font-size: 12pt;">        :model=&quot;data&quot;</font></div><div><font style="font-size: 12pt;">        style=&quot;width: 500px&quot;</font></div><div><font style="font-size: 12pt;">        label-position=&quot;left&quot;</font></div><div><font style="font-size: 12pt;">        label-width=&quot;100px&quot;</font></div><div><font style="font-size: 12pt;">        label-suffix=&quot;：&quot;</font></div><div><font style="font-size: 12pt;">        :inline=&quot;false&quot;</font></div><div><font style="font-size: 12pt;">        :rules=&quot;rules&quot;</font></div><div><font style="font-size: 12pt;">        :disabled=&quot;false&quot;</font></div><div><font style="font-size: 12pt;">        status-icon</font></div><div><font style="font-size: 12pt;">        validate-on-rule-change</font></div><div><font style="font-size: 12pt;">        hide-required-asterisk</font></div><div><font style="font-size: 12pt;">        :inline-message=&quot;false&quot;</font></div><div><font style="font-size: 12pt;">    &gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-form-item</font></div><div><font style="font-size: 12pt;">          label=&quot;用户名&quot;</font></div><div><font style="font-size: 12pt;">          prop=&quot;user&quot;</font></div><div><font style="font-size: 12pt;">          :error=&quot;error&quot;</font></div><div><font style="font-size: 12pt;">          :validate-status=&quot;status&quot;</font></div><div><font style="font-size: 12pt;">      &gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-input v-model=&quot;data.user&quot; placeholder=&quot;用户名&quot; clearable&gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-form-item label=&quot;活动区域&quot; prop=&quot;region&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-select v-model=&quot;data.region&quot; placeholder=&quot;活动区域&quot; style=&quot;width:100%&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-option label=&quot;区域一&quot; value=&quot;shanghai&quot;&gt;&lt;/el-option&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-option label=&quot;区域二&quot; value=&quot;beijing&quot;&gt;&lt;/el-option&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-select&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-form-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-button type=&quot;primary&quot; @click=&quot;onSubmit&quot;&gt;查询&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-button type=&quot;primary&quot; @click=&quot;addRule&quot;&gt;添加校验规则&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-button @click=&quot;showError&quot;&gt;错误状态&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-button @click=&quot;showSuccess&quot;&gt;正确状态&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-button @click=&quot;showValidating&quot;&gt;验证状态&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/el-form&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'app',</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        data: {</font></div><div><font style="font-size: 12pt;">          user: 'sam',</font></div><div><font style="font-size: 12pt;">          region: '区域二'</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        error: '',</font></div><div><font style="font-size: 12pt;">        status: '',</font></div><div><font style="font-size: 12pt;">        rules: {</font></div><div><font style="font-size: 12pt;">          user: [</font></div><div><font style="font-size: 12pt;">            { required: true, trigger: 'change', message: '用户名必须录入' }</font></div><div><font style="font-size: 12pt;">          ]</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      /* eslint-disable */</font></div><div><font style="font-size: 12pt;">      onSubmit() {</font></div><div><font style="font-size: 12pt;">        console.log(this.data)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      addRule() {</font></div><div><font style="font-size: 12pt;">        const userValidator = (rule, value, callback) =&gt; {</font></div><div><font style="font-size: 12pt;">          if (value.length &gt; 3) {</font></div><div><font style="font-size: 12pt;">            this.inputError = ''</font></div><div><font style="font-size: 12pt;">            this.inputValidateStatus = ''</font></div><div><font style="font-size: 12pt;">            callback()</font></div><div><font style="font-size: 12pt;">          } else {</font></div><div><font style="font-size: 12pt;">            callback(new Error('用户名长度必须大于3'))</font></div><div><font style="font-size: 12pt;">          }</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        const newRule = [</font></div><div><font style="font-size: 12pt;">          ...this.rules.user,</font></div><div><font style="font-size: 12pt;">          { validator: userValidator, trigger: 'change' }</font></div><div><font style="font-size: 12pt;">        ]</font></div><div><font style="font-size: 12pt;">        this.rules = Object.assign({}, this.rules, { user: newRule })</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      showError() {</font></div><div><font style="font-size: 12pt;">        this.status = 'error'</font></div><div><font style="font-size: 12pt;">        this.error = '用户名输入有误'</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      showSuccess() {</font></div><div><font style="font-size: 12pt;">        this.status = 'success'</font></div><div><font style="font-size: 12pt;">        this.error = ''</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      showValidating() {</font></div><div><font style="font-size: 12pt;">        this.status = 'validating'</font></div><div><font style="font-size: 12pt;">        this.error = ''</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;"><br/></span></div><hr/><div><br/></div><div><br/></div><div><span style="font-size: 12pt;"><a href="https://github.com/lin-xin/vue-manage-system" style="font-size: 12pt;">https://github.com/lin-xin/vue-manage-system</a></span></div><div><br/></div><div><span style="font-size: 12pt;">项目所需插件：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">以下插件是构建项目中所需要使用的：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">● npm/cnpm install vue-router --save：Vue 路由组件，用于实现建立 url 和页面之间的映射关系，根据需求自动跳转路由页面。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> npm/cnpm install element-ui --save：element-ui 框架，用于美化网页，帮助我们快速完成页面布局。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> npm/cnpm install axios --save：基于 promise 的 HTTP 库，用于发送请求。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> npm/cnpm install babel-polyfill --save：通过 Polyfill 方式在目标环境中添加缺失的特性。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">以下插件是对项目功能进行扩展所需要使用的：</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> npm/cnpm install vue-quill-editor --save：Vue2 封装的 Quill 富文本编辑器组件，用于实现富文本编辑。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">●</span><span style="font-size: 12pt;"> npm/cnpm install mavon-editor --save：基于 vue 的 markdown 编辑器，用于实现富文本编辑。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">v npm/cnpm install vue-schart --save：使用 vue.js 封装了 sChart.js 图表库的一个小组件，用于创建图表。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">* npm/cnpm install vue-cropperjs --save：Vue 图像裁剪器组件，用于裁剪的目标图像或画布元素。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">* npm/cnpm install vuedraggable --save：Vue 拖拽组件，用于实现拖拽功能。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">* npm/cnpm install vue-i18n --save：国际化插件，用于切换语言</span><span style="font-size: 12pt; color: unset; font-family: unset;">。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">我们可以使用 npm 完成插件安装，也可以通过 npm install -g cnpm 命令安装 cnpm 之后，使用 cnpm 对插件进行安装。</span></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"> </span></div><hr/><div><span style="font-size: 12pt;"><br/></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">net start MongoDB</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">npm run dev</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">Node 接口</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">server.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// 引入 express</font></div><div><font style="font-size: 12pt;">const express = require('express')</font></div><div><font style="font-size: 12pt;">const helmet = require('helmet')</font></div><div><font style="font-size: 12pt;">// 创建 express 实例</font></div><div><font style="font-size: 12pt;">const app = express()</font></div><div><font style="font-size: 12pt;">// 引入 mongoose</font></div><div><font style="font-size: 12pt;">const mongoose = require('mongoose')</font></div><div><font style="font-size: 12pt;">// 引入 body-parser中间件 获得 post 请求响应内容</font></div><div><font style="font-size: 12pt;">const bodyParser = require('body-parser')</font></div><div><font style="font-size: 12pt;">// 引入 passport中间件</font></div><div><font style="font-size: 12pt;">const passport = require('passport')</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const session = require('express-session')</font></div><div><font style="font-size: 12pt;">const MongoStore = require('connect-mongo')(session)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 引入 users 路由中间件</font></div><div><font style="font-size: 12pt;">const users = require('./routes/api/users')</font></div><div><font style="font-size: 12pt;">// 引入 profiles 路由中间件</font></div><div><font style="font-size: 12pt;">const profiles = require('./routes/api/profiles')</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 数据库地址</font></div><div><font style="font-size: 12pt;">const db = require('./config/key').mongoURI</font></div><div><font style="font-size: 12pt;">// 连接数据库</font></div><div><font style="font-size: 12pt;">mongoose</font></div><div><font style="font-size: 12pt;">  .set('useUnifiedTopology', true)</font></div><div><font style="font-size: 12pt;">  .connect(db, { useNewUrlParser: true, useFindAndModify: false })</font></div><div><font style="font-size: 12pt;">  .then(() =&gt; console.log('已连接数据库'))</font></div><div><font style="font-size: 12pt;">  .catch((err) =&gt; console.error('无法连接数据库', err))</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 设置跨域和相应数据格式</font></div><div><font style="font-size: 12pt;">app.all('/api/*', function (req, res, next) {</font></div><div><font style="font-size: 12pt;">  res.header('Access-Control-Allow-Origin', '*')</font></div><div><font style="font-size: 12pt;">  res.header(</font></div><div><font style="font-size: 12pt;">    'Access-Control-Allow-Headers',</font></div><div><font style="font-size: 12pt;">    'Content-Type, Authorization, X-Requested-With'</font></div><div><font style="font-size: 12pt;">  )</font></div><div><font style="font-size: 12pt;">  res.header('Access-Control-Allow-Methods', 'PUT,POST,GET,DELETE,OPTIONS')</font></div><div><font style="font-size: 12pt;">  res.header('Access-Control-Allow-Credentials', true) //可以带cookies</font></div><div><font style="font-size: 12pt;">  res.header('X-Powered-By', 'Express')</font></div><div><font style="font-size: 12pt;">  if (req.method === 'OPTIONS') res.sendStatus(200)</font></div><div><font style="font-size: 12pt;">  /*让 options 请求快速返回*/ else next()</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">app.use(helmet())</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">app.use(</font></div><div><font style="font-size: 12pt;">  session({</font></div><div><font style="font-size: 12pt;">    name: 'email',</font></div><div><font style="font-size: 12pt;">    secret: 'sendEmailCode', // 用来对 session id相关的 cookie进行签名</font></div><div><font style="font-size: 12pt;">    store: new MongoStore({</font></div><div><font style="font-size: 12pt;">      url: db,</font></div><div><font style="font-size: 12pt;">      touchAfter: 24 * 3600, // 不管发出多少请求，24小时内只更新一次 session，除非你改变 session</font></div><div><font style="font-size: 12pt;">    }), // 数据库存储session</font></div><div><font style="font-size: 12pt;">    saveUninitialized: false, // 强制将未初始化的 session 存储。当新建了一个 session 且未设定属性或值时，它就处于</font></div><div><font style="font-size: 12pt;">    //未初始化状态。在设定一个 cookie 前，这对于登录验证，减轻服务端存储压力，权限控制是有帮助的。这里建议 false</font></div><div><font style="font-size: 12pt;">    resave: false, // 是否每次都强制保存session</font></div><div><font style="font-size: 12pt;">    cookie: {</font></div><div><font style="font-size: 12pt;">      secure: false, // 只有https协议才设置为true</font></div><div><font style="font-size: 12pt;">      httpOnly: true, // 禁止客户端JavaScript的访问，不能使用document.cookie</font></div><div><font style="font-size: 12pt;">      maxAge: 10 * 60 * 1000, // 有效期，单位是毫秒，这里设为 10 分钟 10 * 60 * 1000</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // rolling: true // 每次请求都强制对 session 续期</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 使用 body-parser ，处理程序之前，在中间件中对 post请求的请求体进行解析</font></div><div><font style="font-size: 12pt;">// 使用 body-parser 中间件 必须写在路由中间件前面（问题解决）</font></div><div><font style="font-size: 12pt;">// 解析我们通常的 form 表单提交的数据，也就是请求头中包含这样的信息：</font></div><div><font style="font-size: 12pt;">// Content-Type 为 application/x-www-form-urlencoded ，为 false 表示使用系统模块 querystring 来解析成对象</font></div><div><font style="font-size: 12pt;">app.use(bodyParser.urlencoded({ extended: false }))</font></div><div><font style="font-size: 12pt;">// 请求 body 解析成 application/json ，解析 json 数据格式</font></div><div><font style="font-size: 12pt;">app.use(bodyParser.json())</font></div><div><font style="font-size: 12pt;">// 使用 passport 中间件，初始化 passport</font></div><div><font style="font-size: 12pt;">app.use(passport.initialize())</font></div><div><font style="font-size: 12pt;">// 头像上传</font></div><div><font style="font-size: 12pt;">app.use('/tmp_uploads', express.static('tmp_uploads'))</font></div><div><font style="font-size: 12pt;">// 使用 passport 中间件验证 token</font></div><div><font style="font-size: 12pt;">require('./config/passport')(passport)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 测试路由</font></div><div><font style="font-size: 12pt;">// app.get(&quot;/&quot;, (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">//   res.send(&quot;Hello World!&quot;)</font></div><div><font style="font-size: 12pt;">// })</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 使用 users 路由中间件</font></div><div><font style="font-size: 12pt;">app.use('/api/users', users)</font></div><div><font style="font-size: 12pt;">app.use('/api/profiles', profiles)</font></div><div><font style="font-size: 12pt;">// 生产环境使用 port 作为端口，开发环境使用 5001 作为端口</font></div><div><font style="font-size: 12pt;">// package.json 在生产环境使用 npm run start，在开发环境使用 npm run server</font></div><div><font style="font-size: 12pt;">const port = process.env.port || 5001</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 监听端口</font></div><div><font style="font-size: 12pt;">app.listen(port, () =&gt; {</font></div><div><font style="font-size: 12pt;">  console.log(`Server running on port ${port}`)</font></div><div><font style="font-size: 12pt;">})</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">config/key.js</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// 不同环境使用不同数据库</font></div><div><font style="font-size: 12pt;">module.exports = {</font></div><div><font style="font-size: 12pt;">  mongoURI: &quot;mongodb://localhost/backend&quot;, // backend 数据库</font></div><div><font style="font-size: 12pt;">  secretKey: &quot;secret&quot;,</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">config/passport.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// passport 是一个针对密码验证中间件，无缝衔接基于 Express的 web 服务</font></div><div><font style="font-size: 12pt;">// passport-jwt 是一个针对 jsonwebtoken 的插件，验证 token 通过后才能进行正常响应</font></div><div><font style="font-size: 12pt;">const JwtStrategy = require(&quot;passport-jwt&quot;).Strategy,</font></div><div><font style="font-size: 12pt;">ExtractJwt = require(&quot;passport-jwt&quot;).ExtractJwt;</font></div><div><font style="font-size: 12pt;">const User = require(&quot;../models/User&quot;);</font></div><div><font style="font-size: 12pt;">const keys = require(&quot;./key&quot;);</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const opts = {};</font></div><div><font style="font-size: 12pt;">opts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken(); // 从验证头中提取，模型默认是'Bearer '.</font></div><div><font style="font-size: 12pt;">opts.secretOrKey = keys.secretKey;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">module.exports = passport =&gt; {</font></div><div><font style="font-size: 12pt;">  // passport.js 有策略(strategy)设计模式的概念. strategy 是一些预定义的方法,</font></div><div><font style="font-size: 12pt;">  // 策略会在请求抵达真正的路由之前执行.</font></div><div><font style="font-size: 12pt;">  // 如果定义的 strategy（针对 jwt）认定某个请求非法, 则该路由不会被执行, 而是返回 401 Unauthorized.</font></div><div><font style="font-size: 12pt;">  // 第一个参数 opts 包含用于控制如何从请求中提取 token 的对象或者被验证的选项的对象</font></div><div><font style="font-size: 12pt;">  // 第二个参数是具有参数 (jwt_payload, done)的 verify函数</font></div><div><font style="font-size: 12pt;">  // 第三个参数是 callback, done 是 Passport 错误，第一个回调接受参数( 错误，用户，信息)</font></div><div><font style="font-size: 12pt;">  passport.use(</font></div><div><font style="font-size: 12pt;">    new JwtStrategy(opts, async function (jwt_payload, done) {</font></div><div><font style="font-size: 12pt;">      try {</font></div><div><font style="font-size: 12pt;">        // jwt_payload 返回的是登录时返回的数据 即 payload</font></div><div><font style="font-size: 12pt;">        const user = await User.findById(jwt_payload.id)</font></div><div><font style="font-size: 12pt;">        if (user) {</font></div><div><font style="font-size: 12pt;">          // 此处会将 user 信息写入 req.user</font></div><div><font style="font-size: 12pt;">          return done(null, user)</font></div><div><font style="font-size: 12pt;">        } else {</font></div><div><font style="font-size: 12pt;">          return done(null, false)</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      catch (ex) {</font></div><div><font style="font-size: 12pt;">        console.log(ex);</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">  )</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">models/Users.js</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 12pt;">// 引入 mongoose</span></div><div><span style="font-size: 12pt;">const mongoose = require(&quot;mongoose&quot;);</span></div><div><span style="font-size: 12pt;">// 引入 mongoose 的骨架</span></div><div><span style="font-size: 12pt;">const Schema = mongoose.Schema;</span></div><div><br/></div><div><span style="font-size: 12pt;">// 创建用户骨架 接口数据的字段与类型 用户所有信息的数据库字段</span></div><div><span style="font-size: 12pt;">const userSchema = new Schema({</span></div><div><span style="font-size: 12pt;">  name: {</span></div><div><span style="font-size: 12pt;">    type: String,</span></div><div><span style="font-size: 12pt;">    required: true,</span></div><div><span style="font-size: 12pt;">  },</span></div><div><span style="font-size: 12pt;">  email: {</span></div><div><span style="font-size: 12pt;">    type: String,</span></div><div><span style="font-size: 12pt;">    required: true,</span></div><div><span style="font-size: 12pt;">  },</span></div><div><span style="font-size: 12pt;">  password: {</span></div><div><span style="font-size: 12pt;">    type: String,</span></div><div><span style="font-size: 12pt;">    required: true,</span></div><div><span style="font-size: 12pt;">  },</span></div><div><span style="font-size: 12pt;">  avatar: {</span></div><div><span style="font-size: 12pt;">    type: String,</span></div><div><span style="font-size: 12pt;">  },</span></div><div><span style="font-size: 12pt;">  identity: {</span></div><div><span style="font-size: 12pt;">    type: String,</span></div><div><span style="font-size: 12pt;">    required: true,</span></div><div><span style="font-size: 12pt;">  },</span></div><div><span style="font-size: 12pt;">  date: {</span></div><div><span style="font-size: 12pt;">    type: String,</span></div><div><span style="font-size: 12pt;">    default: Date.now,</span></div><div><span style="font-size: 12pt;">  },</span></div><div><span style="font-size: 12pt;">})</span></div><div><br/></div><div><span style="font-size: 12pt;">// 使用 mongoose 创建用户模型</span></div><div><span style="font-size: 12pt;">const User = mongoose.model(&quot;user&quot;, userSchema);</span></div><div><span style="font-size: 12pt;">// 导出用户模型</span></div><div><span style="font-size: 12pt;">module.exports = User</span></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">models/Profile.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// 引入 mongoose</font></div><div><font style="font-size: 12pt;">const mongoose = require(&quot;mongoose&quot;)</font></div><div><font style="font-size: 12pt;">// 引入 mongoose 的骨架</font></div><div><font style="font-size: 12pt;">const Schema = mongoose.Schema</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 创建资金流水骨架 接口数据的字段与类型</font></div><div><font style="font-size: 12pt;">const profileSchema = new Schema({</font></div><div><font style="font-size: 12pt;">  type: {</font></div><div><font style="font-size: 12pt;">    type: String,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  desc: {</font></div><div><font style="font-size: 12pt;">    type: String,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  income: {</font></div><div><font style="font-size: 12pt;">    type: String,</font></div><div><font style="font-size: 12pt;">    required: true,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  expenses: {</font></div><div><font style="font-size: 12pt;">    type: String,</font></div><div><font style="font-size: 12pt;">    required: true,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  cash: {</font></div><div><font style="font-size: 12pt;">    type: String,</font></div><div><font style="font-size: 12pt;">    required: true,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  remark: {</font></div><div><font style="font-size: 12pt;">    type: String,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  date: {</font></div><div><font style="font-size: 12pt;">    type: Date,</font></div><div><font style="font-size: 12pt;">    default: Date.now,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 使用 mongoose 创建资金流水模型</font></div><div><font style="font-size: 12pt;">const Profile = mongoose.model(&quot;profile&quot;, profileSchema)</font></div><div><font style="font-size: 12pt;">// 导出资金流水模型</font></div><div><font style="font-size: 12pt;">module.exports = Profile</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">routes/users.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// 引入 express</font></div><div><font style="font-size: 12pt;">const express = require('express')</font></div><div><font style="font-size: 12pt;">// 创建路由实例</font></div><div><font style="font-size: 12pt;">const router = express.Router()</font></div><div><font style="font-size: 12pt;">// 引入 User 模型</font></div><div><font style="font-size: 12pt;">const User = require('../../models/User')</font></div><div><font style="font-size: 12pt;">// 引入 bcrypt</font></div><div><font style="font-size: 12pt;">const bcrypt = require('bcrypt')</font></div><div><font style="font-size: 12pt;">// 引入全球公认头像</font></div><div><font style="font-size: 12pt;">const gravatar = require('gravatar')</font></div><div><font style="font-size: 12pt;">// 引入 jwt</font></div><div><font style="font-size: 12pt;">const jwt = require('jsonwebtoken')</font></div><div><font style="font-size: 12pt;">// 引入原始 key</font></div><div><font style="font-size: 12pt;">const keys = require('../../config/key')</font></div><div><font style="font-size: 12pt;">// 引入 passport中间件</font></div><div><font style="font-size: 12pt;">const passport = require('passport')</font></div><div><font style="font-size: 12pt;">// 引入图片验证码</font></div><div><font style="font-size: 12pt;">const svgCaptcha = require('svg-captcha')</font></div><div><font style="font-size: 12pt;">// 引入发送验证码</font></div><div><font style="font-size: 12pt;">const { registerEmail, codeEmail } = require('./code')</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const fs = require('fs')</font></div><div><font style="font-size: 12pt;">const path = require('path')</font></div><div><font style="font-size: 12pt;">// multer是 express 官方推荐的文件上传中间件（另外还有 formidable），用于处理 multipart/form-data 类型的表单数据</font></div><div><font style="font-size: 12pt;">// 基于 busboy 开发</font></div><div><font style="font-size: 12pt;">const multer = require('multer')</font></div><div><font style="font-size: 12pt;">// 先自定义头像上传的路径</font></div><div><font style="font-size: 12pt;">const upload = multer({ dest: 'tmp_uploads/' })</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 创建测试路由</font></div><div><font style="font-size: 12pt;">// 公共接口  GET api/users/test</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">// router.get(&quot;/test&quot;, (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">//   res.json({msg: &quot;Test&quot;})</font></div><div><font style="font-size: 12pt;">// })</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 发送注册邮箱验证码</font></div><div><font style="font-size: 12pt;">router.get('/getRegisterCode', (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">  registerEmail(req, res)</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;">// 创建注册路由</font></div><div><font style="font-size: 12pt;">// 公共接口  Post api/users/register</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">router.post('/register', async (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">  // console.log(req.body)</font></div><div><font style="font-size: 12pt;">  const verifyCode = req.body.verifyCode // 邮箱验证码</font></div><div><font style="font-size: 12pt;">  if (verifyCode === '') {</font></div><div><font style="font-size: 12pt;">    return res.json({ error: true, message: '验证码不能为空!' })</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  // 查询数据库中是否已有该邮箱</font></div><div><font style="font-size: 12pt;">  const user = await User.findOne({ email: req.body.email })</font></div><div><font style="font-size: 12pt;">  // 接收返回的文档对象 user 后，继续处理</font></div><div><font style="font-size: 12pt;">  if (user) {</font></div><div><font style="font-size: 12pt;">    return res.status(400).send('邮箱已注册!')</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  if (req.session.registerCode === verifyCode) {</font></div><div><font style="font-size: 12pt;">    // 存放默认头像图片</font></div><div><font style="font-size: 12pt;">    const avatar = gravatar.url(req.body.email, {</font></div><div><font style="font-size: 12pt;">      s: '200',</font></div><div><font style="font-size: 12pt;">      r: 'g',</font></div><div><font style="font-size: 12pt;">      d: 'mm',</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">    const nowDate = String(new Date().getTime())</font></div><div><font style="font-size: 12pt;">    // 把表单的请求数据结合模型存进数据库</font></div><div><font style="font-size: 12pt;">    const newUser = new User({</font></div><div><font style="font-size: 12pt;">      name: req.body.name,</font></div><div><font style="font-size: 12pt;">      email: req.body.email,</font></div><div><font style="font-size: 12pt;">      avatar,</font></div><div><font style="font-size: 12pt;">      identity: req.body.identity,</font></div><div><font style="font-size: 12pt;">      password: req.body.password,</font></div><div><font style="font-size: 12pt;">      date: nowDate,</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">    // 加盐，对 newUser 密码进行哈希加密后返回 newUser 的 JSON 数据</font></div><div><font style="font-size: 12pt;">    bcrypt.genSalt(10, function (err, salt) {</font></div><div><font style="font-size: 12pt;">      bcrypt.hash(newUser.password, salt, function (err, hash) {</font></div><div><font style="font-size: 12pt;">        if (err) {</font></div><div><font style="font-size: 12pt;">          res.json({ error: true, message: '系统错误!' })</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        newUser.password = hash</font></div><div><font style="font-size: 12pt;">        newUser</font></div><div><font style="font-size: 12pt;">          .save()</font></div><div><font style="font-size: 12pt;">          .then((user) =&gt;</font></div><div><font style="font-size: 12pt;">            res.json({ user, success: true, message: '注册用户成功' })</font></div><div><font style="font-size: 12pt;">          )</font></div><div><font style="font-size: 12pt;">          .catch((err) =&gt; console.log(err))</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">    // 验证通过，删除保存的验证码</font></div><div><font style="font-size: 12pt;">    delete req.session.registerCode</font></div><div><font style="font-size: 12pt;">  } else {</font></div><div><font style="font-size: 12pt;">    if (!req.session.registerCode) {</font></div><div><font style="font-size: 12pt;">      res.json({</font></div><div><font style="font-size: 12pt;">        error: true,</font></div><div><font style="font-size: 12pt;">        message: '验证码已过期，请重新获取!',</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    } else {</font></div><div><font style="font-size: 12pt;">      res.json({</font></div><div><font style="font-size: 12pt;">        error: true,</font></div><div><font style="font-size: 12pt;">        message: '验证码错误!',</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 获取图片验证码</font></div><div><font style="font-size: 12pt;">// 公共接口  Get api/users/getCaptcha</font></div><div><font style="font-size: 12pt;">// 返回 cookie 和 验证码字符串</font></div><div><font style="font-size: 12pt;">router.get('/getCaptcha', (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">  var captcha = svgCaptcha.create({</font></div><div><font style="font-size: 12pt;">    // 字体大小</font></div><div><font style="font-size: 12pt;">    fontSize: 38,</font></div><div><font style="font-size: 12pt;">    // 验证码去掉模糊人眼容易认错的字符</font></div><div><font style="font-size: 12pt;">    ignoreChars: '0o1iLlI',</font></div><div><font style="font-size: 12pt;">    // 噪声线条数</font></div><div><font style="font-size: 12pt;">    noise: 3,</font></div><div><font style="font-size: 12pt;">    // 宽度</font></div><div><font style="font-size: 12pt;">    width: 80,</font></div><div><font style="font-size: 12pt;">    // 高度</font></div><div><font style="font-size: 12pt;">    height: 32,</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">  // 保存到 session,忽略大小写</font></div><div><font style="font-size: 12pt;">  req.session.captcha = captcha.text.toLowerCase()</font></div><div><font style="font-size: 12pt;">  // console.log(req.session) // 打印生成的验证码，如 0xtg</font></div><div><font style="font-size: 12pt;">  //保存到 cookie 方便前端调用验证</font></div><div><font style="font-size: 12pt;">  res.type('svg')</font></div><div><font style="font-size: 12pt;">  res.send(captcha.data)</font></div><div><font style="font-size: 12pt;">  res.end()</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;">// 创建登录路由</font></div><div><font style="font-size: 12pt;">// 公共接口  POST api/users/login</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">// 先查询数据库中该邮箱是否存在，再匹配密码是否一致，最后才登录成功</font></div><div><font style="font-size: 12pt;">router.post('/login', async (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">  const email = req.body.email</font></div><div><font style="font-size: 12pt;">  const password = req.body.password</font></div><div><font style="font-size: 12pt;">  const captcha = req.body.inputCaptcha.toLowerCase()</font></div><div><font style="font-size: 12pt;">  if (captcha !== req.session.captcha) {</font></div><div><font style="font-size: 12pt;">    return res.json({ error: true, message: '验证码错误!' })</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  // 验证通过，删除保存的验证码</font></div><div><font style="font-size: 12pt;">  delete req.session.captcha</font></div><div><font style="font-size: 12pt;">  const user = await User.findOne({ email })</font></div><div><font style="font-size: 12pt;">  if (!user) {</font></div><div><font style="font-size: 12pt;">    return res.json({ error: true, message: '邮箱或密码错误!' })</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  const isMatch = await bcrypt.compare(password, user.password)</font></div><div><font style="font-size: 12pt;">  // 如果登录密码一致</font></div><div><font style="font-size: 12pt;">  if (isMatch) {</font></div><div><font style="font-size: 12pt;">    const rule = {</font></div><div><font style="font-size: 12pt;">      id: user.id,</font></div><div><font style="font-size: 12pt;">      name: user.name,</font></div><div><font style="font-size: 12pt;">      identity: user.identity,</font></div><div><font style="font-size: 12pt;">      avatar: user.avatar,</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    // 数字签名生成 token</font></div><div><font style="font-size: 12pt;">    // 四个参数：认证依据,私有key, 过期时间, 生成 token 后的回调</font></div><div><font style="font-size: 12pt;">    jwt.sign(rule, keys.secretKey, { expiresIn: 3600 }, function (err, token) {</font></div><div><font style="font-size: 12pt;">      // 生成并返回 token</font></div><div><font style="font-size: 12pt;">      res.json({</font></div><div><font style="font-size: 12pt;">        success: true,</font></div><div><font style="font-size: 12pt;">        // 使用 passport时，token前面一定要有 Bearer 持有人</font></div><div><font style="font-size: 12pt;">        token: 'Bearer ' + token,</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">    // res.json({msg: &quot;success&quot;})</font></div><div><font style="font-size: 12pt;">  } else {</font></div><div><font style="font-size: 12pt;">    return res.json({ error: true, message: '邮箱或密码错误!' })</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 发送重置邮箱验证码</font></div><div><font style="font-size: 12pt;">router.get('/getEmailCode', (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">  codeEmail(req, res)</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;">// 重置密码</font></div><div><font style="font-size: 12pt;">router.put('/resetPass', async (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">  const email = req.body.email</font></div><div><font style="font-size: 12pt;">  const password = req.body.password2 //密码</font></div><div><font style="font-size: 12pt;">  const verifyCode = req.body.verifyCode // 邮箱验证码</font></div><div><font style="font-size: 12pt;">  // console.log(req.session.emailCode)</font></div><div><font style="font-size: 12pt;">  if (verifyCode === '') {</font></div><div><font style="font-size: 12pt;">    return res.json({ error: true, message: '验证码不能为空!' })</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  // 查询该账号是否存在</font></div><div><font style="font-size: 12pt;">  const user = await User.findOne({ email: email })</font></div><div><font style="font-size: 12pt;">  if (!user) {</font></div><div><font style="font-size: 12pt;">    return</font></div><div><font style="font-size: 12pt;">  } else {</font></div><div><font style="font-size: 12pt;">    // 判断验证码是否正确、验证码时间是否超过10分钟</font></div><div><font style="font-size: 12pt;">    if (req.session.emailCode === verifyCode) {</font></div><div><font style="font-size: 12pt;">      // 加盐，对 newUser 密码进行哈希加密后返回 newUser 的 JSON 数据</font></div><div><font style="font-size: 12pt;">      bcrypt.genSalt(10, function (err, salt) {</font></div><div><font style="font-size: 12pt;">        bcrypt.hash(password, salt, async (err, hash) =&gt; {</font></div><div><font style="font-size: 12pt;">          if (err) {</font></div><div><font style="font-size: 12pt;">            res.json({ error: true, message: '系统错误!' })</font></div><div><font style="font-size: 12pt;">          }</font></div><div><font style="font-size: 12pt;">          // 更新数据库的用户信息，把用户名密码也存进去</font></div><div><font style="font-size: 12pt;">          let nowDate = String(new Date().getTime()) //获取当前时间</font></div><div><font style="font-size: 12pt;">          const newUser = await User.findByIdAndUpdate(</font></div><div><font style="font-size: 12pt;">            user._id,</font></div><div><font style="font-size: 12pt;">            { password: hash, date: nowDate },</font></div><div><font style="font-size: 12pt;">            { new: true }</font></div><div><font style="font-size: 12pt;">          ) // new: true返回修改后的数据</font></div><div><font style="font-size: 12pt;">          if (newUser) {</font></div><div><font style="font-size: 12pt;">            res.status(200).json({</font></div><div><font style="font-size: 12pt;">              success: true,</font></div><div><font style="font-size: 12pt;">              message: '修改密码成功,请登录',</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">            // 验证通过，删除保存的验证码</font></div><div><font style="font-size: 12pt;">            delete req.session.emailCode</font></div><div><font style="font-size: 12pt;">          }</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    } else {</font></div><div><font style="font-size: 12pt;">      if (!req.session.emailCode) {</font></div><div><font style="font-size: 12pt;">        res.json({</font></div><div><font style="font-size: 12pt;">          error: true,</font></div><div><font style="font-size: 12pt;">          message: '验证码已过期，请重新获取!',</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      } else {</font></div><div><font style="font-size: 12pt;">        res.json({</font></div><div><font style="font-size: 12pt;">          error: true,</font></div><div><font style="font-size: 12pt;">          message: '验证码错误!',</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 创建 jwt 认证后生成当前用户的路由</font></div><div><font style="font-size: 12pt;">// 私有接口  GET api/users/login</font></div><div><font style="font-size: 12pt;">// 返回 当前 user</font></div><div><font style="font-size: 12pt;">// 认证请求很简单，只需要调用 passport.authenticate() 中间件并且指定要应用的策略</font></div><div><font style="font-size: 12pt;">// 成功认证之后，Passport 将建立一个持续的登录会话，请求提供凭证时不必要</font></div><div><font style="font-size: 12pt;">// 使用 jwt 就不再需要 session 保存用户数据了。</font></div><div><font style="font-size: 12pt;">router.get(</font></div><div><font style="font-size: 12pt;">  '/current',</font></div><div><font style="font-size: 12pt;">  passport.authenticate('jwt', { session: false }),</font></div><div><font style="font-size: 12pt;">  (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">    res.json({</font></div><div><font style="font-size: 12pt;">      id: req.user.name,</font></div><div><font style="font-size: 12pt;">      name: req.user.name,</font></div><div><font style="font-size: 12pt;">      email: req.user.email,</font></div><div><font style="font-size: 12pt;">      identity: req.user.identity,</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 创建上传头像的路由 单图上传</font></div><div><font style="font-size: 12pt;">// 路由中间件 upload.single() 接受一个 name 以 fieldname 命名的文件，如 &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;</font></div><div><font style="font-size: 12pt;">router.post('/updateAvatar/:id', upload.single('file'), async function (</font></div><div><font style="font-size: 12pt;">  req,</font></div><div><font style="font-size: 12pt;">  res,</font></div><div><font style="font-size: 12pt;">  next</font></div><div><font style="font-size: 12pt;">) {</font></div><div><font style="font-size: 12pt;">  // multer 会添加一个 body 对象 以及 file 或 files 对象 到 express 的 req 对象中。</font></div><div><font style="font-size: 12pt;">  // body 对象包含表单的文本域信息，file 或 files 对象包含对象表单上传的文件信息。</font></div><div><font style="font-size: 12pt;">  // file.originalname 用户上传的原始文件名</font></div><div><font style="font-size: 12pt;">  var fileExtArray = req.file.originalname.split('.') // ['e2b65d86bba4a9ca951767463a1b50b1', 'jpg']</font></div><div><font style="font-size: 12pt;">  // ext 上传文件的后缀</font></div><div><font style="font-size: 12pt;">  var ext = fileExtArray[fileExtArray.length - 1]</font></div><div><font style="font-size: 12pt;">  var targetPath = req.file.path + '.' + ext</font></div><div><font style="font-size: 12pt;">  // multer 会自动生成新的上传文件名</font></div><div><font style="font-size: 12pt;">  // req.file.path 要上传文件的路径：tmp_uploads\e2b65d86bba4a9ca951767463a1b50b1</font></div><div><font style="font-size: 12pt;">  // targetPath ：tmp_uploads\e2b65d86bba4a9ca951767463a1b50b1.jpg</font></div><div><font style="font-size: 12pt;">  // 将头像存进数据库</font></div><div><font style="font-size: 12pt;">  await User.findOneAndUpdate(</font></div><div><font style="font-size: 12pt;">    { _id: req.params.id },</font></div><div><font style="font-size: 12pt;">    { $set: { avatar: 'http://47.115.15.21:5001/' + targetPath } }</font></div><div><font style="font-size: 12pt;">  )</font></div><div><font style="font-size: 12pt;">  // 上传的文件由于不包含文件后缀，无法预览，所以需要重命名，req.file.path 变为 targetPath</font></div><div><font style="font-size: 12pt;">  // 异步地把 oldPath 文件重命名为 newPath 提供的路径名。如果 newPath 已存在，则覆盖它。</font></div><div><font style="font-size: 12pt;">  // 将头像存进服务器</font></div><div><font style="font-size: 12pt;">  fs.rename(path.join(req.file.path), path.join(targetPath), function (err) {</font></div><div><font style="font-size: 12pt;">    if (err) {</font></div><div><font style="font-size: 12pt;">      return res.json('上传文件失败!')</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    res.status(200).json({</font></div><div><font style="font-size: 12pt;">      tmp_path: targetPath,</font></div><div><font style="font-size: 12pt;">      url: 'http://47.115.15.21:5001/' + targetPath,</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;">// 导出路由中间件</font></div><div><font style="font-size: 12pt;">module.exports = router</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">routes/profiles.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// 引入 express</font></div><div><font style="font-size: 12pt;">const express = require('express')</font></div><div><font style="font-size: 12pt;">// 创建路由实例</font></div><div><font style="font-size: 12pt;">const router = express.Router()</font></div><div><font style="font-size: 12pt;">// 引入 Profile 模型</font></div><div><font style="font-size: 12pt;">const Profile = require('../../models/Profile')</font></div><div><font style="font-size: 12pt;">// 引入 passport中间件</font></div><div><font style="font-size: 12pt;">const passport = require('passport')</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 查询获取所有资金</font></div><div><font style="font-size: 12pt;">// 私有接口  Get api/profiles</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">router.get(</font></div><div><font style="font-size: 12pt;">  '/',</font></div><div><font style="font-size: 12pt;">  passport.authenticate('jwt', { session: false }),</font></div><div><font style="font-size: 12pt;">  async (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">    try {</font></div><div><font style="font-size: 12pt;">      const profiles = await Profile.find()</font></div><div><font style="font-size: 12pt;">      if (!profiles) {</font></div><div><font style="font-size: 12pt;">        return res.status(404).json('没有任何内容')</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      res.json(profiles)</font></div><div><font style="font-size: 12pt;">    } catch (ex) {</font></div><div><font style="font-size: 12pt;">      console.log(res.status(404).json(ex))</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 查询搜索单个资金 根据 id</font></div><div><font style="font-size: 12pt;">// 私有接口  Get api/profiles/:id</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">router.get(</font></div><div><font style="font-size: 12pt;">  '/:id',</font></div><div><font style="font-size: 12pt;">  passport.authenticate('jwt', { session: false }),</font></div><div><font style="font-size: 12pt;">  async (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">    try {</font></div><div><font style="font-size: 12pt;">      const profiles = await Profile.find({ _id: req.params.id })</font></div><div><font style="font-size: 12pt;">      if (!profiles) {</font></div><div><font style="font-size: 12pt;">        return res.status(404).json('没有任何内容')</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      res.json(profiles)</font></div><div><font style="font-size: 12pt;">    } catch (ex) {</font></div><div><font style="font-size: 12pt;">      console.log(res.status(404).json(ex))</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 创建测试路由</font></div><div><font style="font-size: 12pt;">// 公共接口  GET api/profiles/test</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">// router.get(&quot;/test&quot;, (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">//   res.json({msg: &quot;Test&quot;})</font></div><div><font style="font-size: 12pt;">// })</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 创建添加资金路由</font></div><div><font style="font-size: 12pt;">// 私有接口  Post api/profiles/add</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">router.post(</font></div><div><font style="font-size: 12pt;">  '/add',</font></div><div><font style="font-size: 12pt;">  passport.authenticate('jwt', { session: false }),</font></div><div><font style="font-size: 12pt;">  async (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">    const profileFields = {}</font></div><div><font style="font-size: 12pt;">    if (req.body.type) profileFields.type = req.body.type</font></div><div><font style="font-size: 12pt;">    if (req.body.desc) profileFields.desc = req.body.desc</font></div><div><font style="font-size: 12pt;">    if (req.body.income) profileFields.income = req.body.income</font></div><div><font style="font-size: 12pt;">    if (req.body.expenses) profileFields.expenses = req.body.expenses</font></div><div><font style="font-size: 12pt;">    if (req.body.cash) profileFields.cash = req.body.cash</font></div><div><font style="font-size: 12pt;">    if (req.body.remark) profileFields.remark = req.body.remark</font></div><div><font style="font-size: 12pt;">    const profile = await new Profile(profileFields).save()</font></div><div><font style="font-size: 12pt;">    res.json(profile)</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 编辑资金</font></div><div><font style="font-size: 12pt;">// 私有接口  Post api/profiles/edit</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">router.post(</font></div><div><font style="font-size: 12pt;">  '/edit/:id',</font></div><div><font style="font-size: 12pt;">  passport.authenticate('jwt', { session: false }),</font></div><div><font style="font-size: 12pt;">  async (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">    const profileFields = {}</font></div><div><font style="font-size: 12pt;">    if (req.body.type) profileFields.type = req.body.type</font></div><div><font style="font-size: 12pt;">    if (req.body.desc) profileFields.desc = req.body.desc</font></div><div><font style="font-size: 12pt;">    if (req.body.income) profileFields.income = req.body.income</font></div><div><font style="font-size: 12pt;">    if (req.body.expenses) profileFields.expenses = req.body.expenses</font></div><div><font style="font-size: 12pt;">    if (req.body.cash) profileFields.cash = req.body.cash</font></div><div><font style="font-size: 12pt;">    if (req.body.remark) profileFields.remark = req.body.remark</font></div><div><font style="font-size: 12pt;">    const profile = await Profile.findOneAndUpdate(</font></div><div><font style="font-size: 12pt;">      { _id: req.params.id },</font></div><div><font style="font-size: 12pt;">      { $set: profileFields },</font></div><div><font style="font-size: 12pt;">      { new: true }</font></div><div><font style="font-size: 12pt;">    )</font></div><div><font style="font-size: 12pt;">    res.json(profile)</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 删除一条资金</font></div><div><font style="font-size: 12pt;">// 私有接口  Delete api/profiles/delete/:id</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">router.delete(</font></div><div><font style="font-size: 12pt;">  '/delete/:id',</font></div><div><font style="font-size: 12pt;">  passport.authenticate('jwt', { session: false }),</font></div><div><font style="font-size: 12pt;">  async (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">    try {</font></div><div><font style="font-size: 12pt;">      // 问题 删除之后不需要 save</font></div><div><font style="font-size: 12pt;">      const profile = await Profile.findByIdAndRemove({ _id: req.params.id })</font></div><div><font style="font-size: 12pt;">      res.json(profile)</font></div><div><font style="font-size: 12pt;">    } catch (ex) {</font></div><div><font style="font-size: 12pt;">      console.log(res.status(404).json('删除失败'))</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 批量删除多条资金</font></div><div><font style="font-size: 12pt;">// 私有接口  Delete api/profiles/multiDelete</font></div><div><font style="font-size: 12pt;">// 返回 json 数据</font></div><div><font style="font-size: 12pt;">router.post(</font></div><div><font style="font-size: 12pt;">  '/multiDelete',</font></div><div><font style="font-size: 12pt;">  passport.authenticate('jwt', { session: false }),</font></div><div><font style="font-size: 12pt;">  async (req, res) =&gt; {</font></div><div><font style="font-size: 12pt;">    let arr = req.body</font></div><div><font style="font-size: 12pt;">    const profile = await Profile.deleteMany({ _id: { $in: arr } }, (err) =&gt; {</font></div><div><font style="font-size: 12pt;">      if (err) {</font></div><div><font style="font-size: 12pt;">        console.log(res.status(404).json('删除失败'))</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">    res.json(profile)</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 导出路由中间件</font></div><div><font style="font-size: 12pt;">module.exports = router</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">routes/code.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// 引入 url模块解析 url 字符串</font></div><div><font style="font-size: 12pt;">const url = require('url')</font></div><div><font style="font-size: 12pt;">// 引入 querystring 模块处理 query 字符串</font></div><div><font style="font-size: 12pt;">const querystring = require('querystring')</font></div><div><font style="font-size: 12pt;">// 文件读写</font></div><div><font style="font-size: 12pt;">const fs = require('fs')</font></div><div><font style="font-size: 12pt;">// 路径配置</font></div><div><font style="font-size: 12pt;">const path = require('path')</font></div><div><font style="font-size: 12pt;">// 引入 nodemailer</font></div><div><font style="font-size: 12pt;">const nodemailer = require('nodemailer')</font></div><div><font style="font-size: 12pt;">// ejs模版引擎</font></div><div><font style="font-size: 12pt;">const ejs = require('ejs')</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 创建一个 SMTP 客户端配置</font></div><div><font style="font-size: 12pt;">const config = {</font></div><div><font style="font-size: 12pt;">  host: 'smtp.qq.com',</font></div><div><font style="font-size: 12pt;">  port: 465,</font></div><div><font style="font-size: 12pt;">  secure: true, // 使用SSL方式（安全方式，防止被窃取信息）</font></div><div><font style="font-size: 12pt;">  auth: {</font></div><div><font style="font-size: 12pt;">    user: '2067659951@qq.com', // 邮箱账号</font></div><div><font style="font-size: 12pt;">    pass: 'hannozbcpopfchch', // smtp 授权码，到邮箱设置下获取，不是注册时的密码</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 创建一个 SMTP 客户端对象</font></div><div><font style="font-size: 12pt;">const transporter = nodemailer.createTransport(config)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 发送注册邮件</font></div><div><font style="font-size: 12pt;">function registerEmail(req, res) {</font></div><div><font style="font-size: 12pt;">  let emailNum = Math.random().toString().slice(-6) // 随机数转字符串截取后6位，生成6位随机数验证码</font></div><div><font style="font-size: 12pt;">  // 获取返回的 url对象的 query 属性值，如： /getEmailCode?email=1570038342%40qq.com</font></div><div><font style="font-size: 12pt;">  let arg = url.parse(req.url).query</font></div><div><font style="font-size: 12pt;">  // 将arg参数字符串反序列化为一个对象（字符串转对象）</font></div><div><font style="font-size: 12pt;">  let params = querystring.parse(arg) // {email: '1570038342@qq.com'}</font></div><div><font style="font-size: 12pt;">  let email = params.email //邮箱</font></div><div><font style="font-size: 12pt;">  req.session.registerCode = emailNum //把验证码存储进session</font></div><div><font style="font-size: 12pt;">  //传给EJS的数据</font></div><div><font style="font-size: 12pt;">  let data = {</font></div><div><font style="font-size: 12pt;">    verification: emailNum,</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  let template = ejs.compile(</font></div><div><font style="font-size: 12pt;">    fs.readFileSync(</font></div><div><font style="font-size: 12pt;">      path.resolve(__dirname, '../../views/registerEmail.ejs'),</font></div><div><font style="font-size: 12pt;">      'utf8'</font></div><div><font style="font-size: 12pt;">    )</font></div><div><font style="font-size: 12pt;">  )</font></div><div><font style="font-size: 12pt;">  let html = template(data)</font></div><div><font style="font-size: 12pt;">  let mailOptions = {</font></div><div><font style="font-size: 12pt;">    from: '2067659951@qq.com', // 发送者</font></div><div><font style="font-size: 12pt;">    to: email, // 接受者,可以同时发送多个,以逗号隔开</font></div><div><font style="font-size: 12pt;">    subject: '注册验证码', // 标题</font></div><div><font style="font-size: 12pt;">    html: html, //也可以用html发送</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  transporter.sendMail(mailOptions, function (error, info) {</font></div><div><font style="font-size: 12pt;">    let succ = {}</font></div><div><font style="font-size: 12pt;">    if (error) {</font></div><div><font style="font-size: 12pt;">      succ.succ = false</font></div><div><font style="font-size: 12pt;">      succ.msg = '发送失败'</font></div><div><font style="font-size: 12pt;">    } else {</font></div><div><font style="font-size: 12pt;">      succ.succ = true</font></div><div><font style="font-size: 12pt;">      succ.msg = '发送成功'</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    res.json(succ)</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 发送重置密码邮件</font></div><div><font style="font-size: 12pt;">function codeEmail(req, res) {</font></div><div><font style="font-size: 12pt;">  // console.log(req)</font></div><div><font style="font-size: 12pt;">  let emailNum = Math.random().toString().slice(-6) // 随机数转字符串截取后6位，生成6位随机数验证码</font></div><div><font style="font-size: 12pt;">  // 获取返回的 url对象的 query 属性值，如： /getEmailCode?email=1570038342%40qq.com</font></div><div><font style="font-size: 12pt;">  let arg = url.parse(req.url).query</font></div><div><font style="font-size: 12pt;">  // 将 arg 参数字符串 email=1570038342%40qq.com 反序列化为一个对象，查询字符串中的百分比编码字符使用UTF-8编码</font></div><div><font style="font-size: 12pt;">  let params = querystring.parse(arg) // {email: '1570038342@qq.com'}</font></div><div><font style="font-size: 12pt;">  let email = params.email //邮箱</font></div><div><font style="font-size: 12pt;">  // console.log(email)</font></div><div><font style="font-size: 12pt;">  req.session.emailCode = emailNum //把验证码存储进session</font></div><div><font style="font-size: 12pt;">  // 传给EJS的验证码数据</font></div><div><font style="font-size: 12pt;">  let data = {</font></div><div><font style="font-size: 12pt;">    verification: emailNum,</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  let template = ejs.compile(</font></div><div><font style="font-size: 12pt;">    fs.readFileSync(path.resolve(__dirname, '../../views/email.ejs'), 'utf8')</font></div><div><font style="font-size: 12pt;">  )</font></div><div><font style="font-size: 12pt;">  // 使用验证码数据生成 html 模板</font></div><div><font style="font-size: 12pt;">  let html = template(data)</font></div><div><font style="font-size: 12pt;">  let mailOptions = {</font></div><div><font style="font-size: 12pt;">    from: '2067659951@qq.com', // 发送者</font></div><div><font style="font-size: 12pt;">    to: email, // 接受者,可以同时发送多个,以逗号隔开</font></div><div><font style="font-size: 12pt;">    subject: '重置账户密码', // 标题</font></div><div><font style="font-size: 12pt;">    // text: '邮箱验证码有效期为10分钟,验证码:' + req.session.emailCode,</font></div><div><font style="font-size: 12pt;">    html: html, //也可以用html发送</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  transporter.sendMail(mailOptions, function (error, info) {</font></div><div><font style="font-size: 12pt;">    let succ = {}</font></div><div><font style="font-size: 12pt;">    if (error) {</font></div><div><font style="font-size: 12pt;">      succ.succ = false</font></div><div><font style="font-size: 12pt;">      succ.msg = '发送失败'</font></div><div><font style="font-size: 12pt;">    } else {</font></div><div><font style="font-size: 12pt;">      succ.succ = true</font></div><div><font style="font-size: 12pt;">      succ.msg = '发送成功'</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    res.json(succ)</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">module.exports = {</font></div><div><font style="font-size: 12pt;">  registerEmail,</font></div><div><font style="font-size: 12pt;">  codeEmail,</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">client 前端</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">APP.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div id=&quot;app&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;!-- 路由出口 --&gt;</font></div><div><font style="font-size: 12pt;">    &lt;!-- 路由匹配到的组件将渲染在这里 --&gt;</font></div><div><font style="font-size: 12pt;">    &lt;!-- 渲染 / 下的所有子路由组件 --&gt;</font></div><div><font style="font-size: 12pt;">    &lt;router-view/&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import jwt_decode from &quot;jwt-decode&quot;;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'app',</font></div><div><font style="font-size: 12pt;">  created() {</font></div><div><font style="font-size: 12pt;">    // 这里可以设置自动登录</font></div><div><font style="font-size: 12pt;">    if (localStorage.eletoken) {</font></div><div><font style="font-size: 12pt;">      const decode = jwt_decode(localStorage.eletoken);</font></div><div><font style="font-size: 12pt;">      this.$store.dispatch(&quot;setIsAuthenticated&quot;, !this.isEmpty(decode));</font></div><div><font style="font-size: 12pt;">      this.$store.dispatch(&quot;setUser&quot;, decode);</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    isEmpty(value) {</font></div><div><font style="font-size: 12pt;">      return (</font></div><div><font style="font-size: 12pt;">        value === undefined ||</font></div><div><font style="font-size: 12pt;">        value === null ||</font></div><div><font style="font-size: 12pt;">        (typeof value === &quot;object&quot; &amp;&amp; Object.keys(value).length === 0) ||</font></div><div><font style="font-size: 12pt;">        (typeof value === &quot;string&quot; &amp;&amp; value.trim().length === 0)</font></div><div><font style="font-size: 12pt;">      );</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">html,</font></div><div><font style="font-size: 12pt;">body,</font></div><div><font style="font-size: 12pt;">#app {</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">main.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// 引入 vue</font></div><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">import {</font></div><div><font style="font-size: 12pt;">  Pagination,</font></div><div><font style="font-size: 12pt;">  Dialog,</font></div><div><font style="font-size: 12pt;">  Select,</font></div><div><font style="font-size: 12pt;">  Submenu,</font></div><div><font style="font-size: 12pt;">  Menu,</font></div><div><font style="font-size: 12pt;">  MenuItem,</font></div><div><font style="font-size: 12pt;">  Dropdown,</font></div><div><font style="font-size: 12pt;">  DropdownMenu,</font></div><div><font style="font-size: 12pt;">  DropdownItem,</font></div><div><font style="font-size: 12pt;">  Input,</font></div><div><font style="font-size: 12pt;">  Option,</font></div><div><font style="font-size: 12pt;">  Button,</font></div><div><font style="font-size: 12pt;">  Table,</font></div><div><font style="font-size: 12pt;">  TableColumn,</font></div><div><font style="font-size: 12pt;">  DatePicker,</font></div><div><font style="font-size: 12pt;">  Form,</font></div><div><font style="font-size: 12pt;">  FormItem,</font></div><div><font style="font-size: 12pt;">  Tabs,</font></div><div><font style="font-size: 12pt;">  TabPane,</font></div><div><font style="font-size: 12pt;">  Icon,</font></div><div><font style="font-size: 12pt;">  Row,</font></div><div><font style="font-size: 12pt;">  Col,</font></div><div><font style="font-size: 12pt;">  Upload,</font></div><div><font style="font-size: 12pt;">  Progress,</font></div><div><font style="font-size: 12pt;">  Card,</font></div><div><font style="font-size: 12pt;">  Loading,</font></div><div><font style="font-size: 12pt;">  MessageBox,</font></div><div><font style="font-size: 12pt;">  Message,</font></div><div><font style="font-size: 12pt;">  Checkbox,</font></div><div><font style="font-size: 12pt;">  Notification,</font></div><div><font style="font-size: 12pt;">} from 'element-ui'</font></div><div><font style="font-size: 12pt;">import 'element-ui/lib/theme-chalk/index.css'</font></div><div><font style="font-size: 12pt;">import App from './App.vue'</font></div><div><font style="font-size: 12pt;">// 引入 Vue Router</font></div><div><font style="font-size: 12pt;">import router from './router'</font></div><div><font style="font-size: 12pt;">// 引入 Vuex</font></div><div><font style="font-size: 12pt;">import store from './store'</font></div><div><font style="font-size: 12pt;">// 引入 axios</font></div><div><font style="font-size: 12pt;">import axios from './http'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.config.productionTip = false</font></div><div><font style="font-size: 12pt;">Vue.use(Pagination)</font></div><div><font style="font-size: 12pt;">Vue.use(Dialog)</font></div><div><font style="font-size: 12pt;">Vue.use(Menu)</font></div><div><font style="font-size: 12pt;">Vue.use(Submenu)</font></div><div><font style="font-size: 12pt;">Vue.use(MenuItem)</font></div><div><font style="font-size: 12pt;">Vue.use(Dropdown)</font></div><div><font style="font-size: 12pt;">Vue.use(DropdownMenu)</font></div><div><font style="font-size: 12pt;">Vue.use(DropdownItem)</font></div><div><font style="font-size: 12pt;">Vue.use(Input)</font></div><div><font style="font-size: 12pt;">Vue.use(Select)</font></div><div><font style="font-size: 12pt;">Vue.use(Option)</font></div><div><font style="font-size: 12pt;">Vue.use(Button)</font></div><div><font style="font-size: 12pt;">Vue.use(Table)</font></div><div><font style="font-size: 12pt;">Vue.use(TableColumn)</font></div><div><font style="font-size: 12pt;">Vue.use(DatePicker)</font></div><div><font style="font-size: 12pt;">Vue.use(Form)</font></div><div><font style="font-size: 12pt;">Vue.use(FormItem)</font></div><div><font style="font-size: 12pt;">Vue.use(Tabs)</font></div><div><font style="font-size: 12pt;">Vue.use(TabPane)</font></div><div><font style="font-size: 12pt;">Vue.use(Icon)</font></div><div><font style="font-size: 12pt;">Vue.use(Row)</font></div><div><font style="font-size: 12pt;">Vue.use(Col)</font></div><div><font style="font-size: 12pt;">Vue.use(Upload)</font></div><div><font style="font-size: 12pt;">Vue.use(Progress)</font></div><div><font style="font-size: 12pt;">Vue.use(Card)</font></div><div><font style="font-size: 12pt;">Vue.use(Checkbox)</font></div><div><font style="font-size: 12pt;">Vue.use(Loading.directive)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.prototype.$loading = Loading.service</font></div><div><font style="font-size: 12pt;">Vue.prototype.$msgbox = MessageBox</font></div><div><font style="font-size: 12pt;">Vue.prototype.$confirm = MessageBox.confirm</font></div><div><font style="font-size: 12pt;">Vue.prototype.$message = Message</font></div><div><font style="font-size: 12pt;">Vue.prototype.$notify = Notification</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.prototype.$axios = axios</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">new Vue({</font></div><div><font style="font-size: 12pt;">  router,</font></div><div><font style="font-size: 12pt;">  store,</font></div><div><font style="font-size: 12pt;">  render: (h) =&gt; h(App),</font></div><div><font style="font-size: 12pt;">}).$mount('#app')</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">http.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">const axios = require(&quot;axios&quot;)</font></div><div><font style="font-size: 12pt;">import { Message, Loading } from 'element-ui';</font></div><div><font style="font-size: 12pt;">import router from './router/index'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">let loading;</font></div><div><font style="font-size: 12pt;">// 加载动画</font></div><div><font style="font-size: 12pt;">function startLoading() {</font></div><div><font style="font-size: 12pt;">  loading = Loading.service({</font></div><div><font style="font-size: 12pt;">    lock: true,</font></div><div><font style="font-size: 12pt;">    text: &quot;加载中&quot;,</font></div><div><font style="font-size: 12pt;">    background: &quot;rgba(0, 0, 0, 0.75)&quot;</font></div><div><font style="font-size: 12pt;">  })</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">// 结束加载动画</font></div><div><font style="font-size: 12pt;">function endLoading() {</font></div><div><font style="font-size: 12pt;">  loading.close();</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">axios.defaults.baseURL = 'http://47.115.15.21:5001/api';</font></div><div><font style="font-size: 12pt;">axios.defaults.timeout = 5000;</font></div><div><font style="font-size: 12pt;">// cookie-session，请求需要凭证</font></div><div><font style="font-size: 12pt;">axios.defaults.withCredentials = true</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 添加请求拦截器</font></div><div><font style="font-size: 12pt;">axios.interceptors.request.use(config =&gt; {</font></div><div><font style="font-size: 12pt;">  // 在发送请求之前做些什么</font></div><div><font style="font-size: 12pt;">  // 请求开始时加载动画开始</font></div><div><font style="font-size: 12pt;">  startLoading();</font></div><div><font style="font-size: 12pt;">  // localStorage.eleToken 存在时设置统一的请求头 授权</font></div><div><font style="font-size: 12pt;">  if (localStorage.eleToken) {</font></div><div><font style="font-size: 12pt;">    config.headers.Authorization = localStorage.eleToken</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  return config;</font></div><div><font style="font-size: 12pt;">}, err =&gt; {</font></div><div><font style="font-size: 12pt;">  // 对请求错误做些什么</font></div><div><font style="font-size: 12pt;">  return Promise.reject(err)</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 添加响应拦截器</font></div><div><font style="font-size: 12pt;">axios.interceptors.response.use(</font></div><div><font style="font-size: 12pt;">  // 对响应数据做点什么</font></div><div><font style="font-size: 12pt;">  response =&gt; {</font></div><div><font style="font-size: 12pt;">    // 响应有结果了, 结束 loading 动画</font></div><div><font style="font-size: 12pt;">    endLoading()</font></div><div><font style="font-size: 12pt;">    return response</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  error =&gt; {</font></div><div><font style="font-size: 12pt;">    // 对响应数据做点什么</font></div><div><font style="font-size: 12pt;">    // 结束 loading</font></div><div><font style="font-size: 12pt;">    endLoading()</font></div><div><font style="font-size: 12pt;">    // 查看状态码是不是 401 ,如果是则表示 token 已过期</font></div><div><font style="font-size: 12pt;">    // 获取状态码</font></div><div><font style="font-size: 12pt;">    const {status} = error.response</font></div><div><font style="font-size: 12pt;">    if (status === 401) {</font></div><div><font style="font-size: 12pt;">      // 错误提醒</font></div><div><font style="font-size: 12pt;">      Message.error(&quot;登录已过期，请重新登录&quot;)</font></div><div><font style="font-size: 12pt;">      // 清除 token</font></div><div><font style="font-size: 12pt;">      localStorage.removeItem('eleToken');</font></div><div><font style="font-size: 12pt;">      // 跳转到登录页</font></div><div><font style="font-size: 12pt;">      router.push('/login');</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    return Promise.reject(error)</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default axios;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">vue.config.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">const CompressionPlugin = require('compression-webpack-plugin');</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">module.exports = {</font></div><div><font style="font-size: 12pt;">  publicPath: '/release/',</font></div><div><font style="font-size: 12pt;">  outputDir: 'release',</font></div><div><font style="font-size: 12pt;">  productionSourceMap: false,</font></div><div><font style="font-size: 12pt;">  filenameHashing: false,</font></div><div><font style="font-size: 12pt;">  chainWebpack: (config) =&gt; {</font></div><div><font style="font-size: 12pt;">    config.entry.app = ['babel-polyfill', './src/main.js']</font></div><div><font style="font-size: 12pt;">    // 移除 prefetch 插件</font></div><div><font style="font-size: 12pt;">    config.plugins.delete('prefetch')</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  configureWebpack: (config) =&gt; {</font></div><div><font style="font-size: 12pt;">    config.externals = {</font></div><div><font style="font-size: 12pt;">      echarts: 'echarts',</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">      // 生产环境删除console</font></div><div><font style="font-size: 12pt;">    config.optimization.minimizer[0].options.terserOptions.compress = {</font></div><div><font style="font-size: 12pt;">      drop_console: true,</font></div><div><font style="font-size: 12pt;">      drop_debugger: false,</font></div><div><font style="font-size: 12pt;">      pure_funcs: ['console.log'],</font></div><div><font style="font-size: 12pt;">    } // 移除console</font></div><div><font style="font-size: 12pt;">    config.optimization.splitChunks.cacheGroups = {</font></div><div><font style="font-size: 12pt;">      vendor: {</font></div><div><font style="font-size: 12pt;">        chunks: 'all',</font></div><div><font style="font-size: 12pt;">        test: /[\\/]node_modules[\\/]/,</font></div><div><font style="font-size: 12pt;">        name: 'vendor',</font></div><div><font style="font-size: 12pt;">        minChunks: 1,</font></div><div><font style="font-size: 12pt;">        maxInitialRequests: 5,</font></div><div><font style="font-size: 12pt;">        minSize: 0,</font></div><div><font style="font-size: 12pt;">        priority: 100,</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      common: {</font></div><div><font style="font-size: 12pt;">        chunks: 'all',</font></div><div><font style="font-size: 12pt;">        test: /[\\/]src[\\/]js[\\/]/,</font></div><div><font style="font-size: 12pt;">        name: 'common',</font></div><div><font style="font-size: 12pt;">        minChunks: 2,</font></div><div><font style="font-size: 12pt;">        maxInitialRequests: 5,</font></div><div><font style="font-size: 12pt;">        minSize: 0,</font></div><div><font style="font-size: 12pt;">        priority: 60,</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      styles: {</font></div><div><font style="font-size: 12pt;">        name: 'styles',</font></div><div><font style="font-size: 12pt;">        test: /\.(le|sa|sc|c)ss$/,</font></div><div><font style="font-size: 12pt;">        chunks: 'all',</font></div><div><font style="font-size: 12pt;">        reuseExistingChunk: true,</font></div><div><font style="font-size: 12pt;">        minChunks: 1,</font></div><div><font style="font-size: 12pt;">        enforce: true,</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">      //gzip压缩</font></div><div><font style="font-size: 12pt;">      config.plugins.push(</font></div><div><font style="font-size: 12pt;">        new CompressionPlugin({</font></div><div><font style="font-size: 12pt;">          //压缩算法</font></div><div><font style="font-size: 12pt;">          algorithm: 'gzip',</font></div><div><font style="font-size: 12pt;">          //匹配文件</font></div><div><font style="font-size: 12pt;">          test: /\.js$|\.css$|\.html$|\.woff$|\.ttf$|\.eot$|/,</font></div><div><font style="font-size: 12pt;">          //压缩超过此大小的文件,以字节为单位</font></div><div><font style="font-size: 12pt;">          threshold: 1024,</font></div><div><font style="font-size: 12pt;">          minRatio: 0.8,</font></div><div><font style="font-size: 12pt;">          //删除原始文件只保留压缩后的文件</font></div><div><font style="font-size: 12pt;">          deleteOriginalAssets: false,</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">      )</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  css: {</font></div><div><font style="font-size: 12pt;">    loaderOptions: {</font></div><div><font style="font-size: 12pt;">      postcss: {</font></div><div><font style="font-size: 12pt;">        plugins: [require('autoprefixer')({})],</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  devServer: {</font></div><div><font style="font-size: 12pt;">    open: true,</font></div><div><font style="font-size: 12pt;">    host: 'localhost',</font></div><div><font style="font-size: 12pt;">    port: 8080,</font></div><div><font style="font-size: 12pt;">    https: false,</font></div><div><font style="font-size: 12pt;">    hotOnly: false,</font></div><div><font style="font-size: 12pt;">    // proxy: {</font></div><div><font style="font-size: 12pt;">    //   // 配置跨域</font></div><div><font style="font-size: 12pt;">    //   '/api': {</font></div><div><font style="font-size: 12pt;">    //     target: 'http://47.115.15.21:5001/api/',</font></div><div><font style="font-size: 12pt;">    //     ws: true,</font></div><div><font style="font-size: 12pt;">    //     changeOrigin: true,</font></div><div><font style="font-size: 12pt;">    //     pathRewrite: {</font></div><div><font style="font-size: 12pt;">    //       '^/api': '', // target 地址替代 axios 请求接口的 /api</font></div><div><font style="font-size: 12pt;">    //     },</font></div><div><font style="font-size: 12pt;">    //   },</font></div><div><font style="font-size: 12pt;">    // },</font></div><div><font style="font-size: 12pt;">    before: (app) =&gt; {},</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">babel.config.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">module.exports = {</font></div><div><font style="font-size: 12pt;">  presets: [</font></div><div><font style="font-size: 12pt;">    '@vue/app'</font></div><div><font style="font-size: 12pt;">  ]</font></div><div><font style="font-size: 12pt;">}</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">router/index.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">// 引入 Vue</font></div><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">// 引入 Vue 路由</font></div><div><font style="font-size: 12pt;">import VueRouter from 'vue-router'</font></div><div><font style="font-size: 12pt;">import { Message } from 'element-ui'</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 使用 Vue 路由</font></div><div><font style="font-size: 12pt;">Vue.use(VueRouter)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 引入组件并懒加载</font></div><div><font style="font-size: 12pt;">const Register = () =&gt; import(/* webpackChunkName: &quot;chunk-all&quot; */ '../views/Register')</font></div><div><font style="font-size: 12pt;">const Login = () =&gt; import(/* webpackChunkName: &quot;chunk-all&quot; */ '../views/Login')</font></div><div><font style="font-size: 12pt;">const ForgotPassword = () =&gt; import(/* webpackChunkName: &quot;chunk-all&quot; */ '../views/ForgotPassword')</font></div><div><font style="font-size: 12pt;">const NotFound = () =&gt; import(/* webpackChunkName: &quot;chunk-all&quot; */ '../views/404')</font></div><div><font style="font-size: 12pt;">const Index = () =&gt; import(/* webpackChunkName: &quot;chunk-all&quot; */ '../views/Index')</font></div><div><font style="font-size: 12pt;">const Home = () =&gt; import(/* webpackChunkName: &quot;chunk-all&quot; */ '../views/Home')</font></div><div><font style="font-size: 12pt;">const Info = () =&gt; import(/* webpackChunkName: &quot;chunk-all&quot; */ '../views/Info')</font></div><div><font style="font-size: 12pt;">const FundList = () =&gt; import(/* webpackChunkName: &quot;chunk-all&quot; */ '../views/FundList')</font></div><div><font style="font-size: 12pt;">const Tabs = () =&gt; import(/* webpackChunkName: &quot;chunk-all&quot; */ '../views/Tabs')</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 创建 routes 路由与子路由组成的数组（各个路径对应的组件与子组件）</font></div><div><font style="font-size: 12pt;">const routes = [</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: '/',</font></div><div><font style="font-size: 12pt;">    redirect: '/login', // 如果路径为 / 重定向为登录页</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: '/index',</font></div><div><font style="font-size: 12pt;">    component: Index,</font></div><div><font style="font-size: 12pt;">    children: [</font></div><div><font style="font-size: 12pt;">      {</font></div><div><font style="font-size: 12pt;">        path: '',</font></div><div><font style="font-size: 12pt;">        component: Home, // /index 默认为首页</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      {</font></div><div><font style="font-size: 12pt;">        path: '/home',</font></div><div><font style="font-size: 12pt;">        name: 'home',</font></div><div><font style="font-size: 12pt;">        component: Home,</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      {</font></div><div><font style="font-size: 12pt;">        path: '/fundlist',</font></div><div><font style="font-size: 12pt;">        name: 'fundlist',</font></div><div><font style="font-size: 12pt;">        component: FundList,</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      {</font></div><div><font style="font-size: 12pt;">        path: '/info',</font></div><div><font style="font-size: 12pt;">        name: 'info',</font></div><div><font style="font-size: 12pt;">        component: Info,</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      {</font></div><div><font style="font-size: 12pt;">        path: '/tabs',</font></div><div><font style="font-size: 12pt;">        name: 'tabs',</font></div><div><font style="font-size: 12pt;">        component: Tabs,</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">    ],</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: '/login',</font></div><div><font style="font-size: 12pt;">    name: 'login',</font></div><div><font style="font-size: 12pt;">    component: Login,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: '/register',</font></div><div><font style="font-size: 12pt;">    name: 'register',</font></div><div><font style="font-size: 12pt;">    component: Register,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: '/forgot',</font></div><div><font style="font-size: 12pt;">    name: 'forgot',</font></div><div><font style="font-size: 12pt;">    component: ForgotPassword,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  {</font></div><div><font style="font-size: 12pt;">    path: '*',</font></div><div><font style="font-size: 12pt;">    name: '404',</font></div><div><font style="font-size: 12pt;">    component: NotFound, // 其他路径则为 404</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">]</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const router = new VueRouter({</font></div><div><font style="font-size: 12pt;">  mode: 'history',</font></div><div><font style="font-size: 12pt;">  base: '/release/',</font></div><div><font style="font-size: 12pt;">  routes,</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 路由守卫 没登录之前只能访问注册页和登录页</font></div><div><font style="font-size: 12pt;">router.beforeEach((to, from, next) =&gt; {</font></div><div><font style="font-size: 12pt;">  // 获取 token ，有 token 代表已登录</font></div><div><font style="font-size: 12pt;">  const isLogin = localStorage.eleToken</font></div><div><font style="font-size: 12pt;">  // 如果已注册或已登录则正常访问所有页面</font></div><div><font style="font-size: 12pt;">  if (</font></div><div><font style="font-size: 12pt;">    to.path === '/register' ||</font></div><div><font style="font-size: 12pt;">    to.path === '/login' ||</font></div><div><font style="font-size: 12pt;">    to.path === '/forgot'</font></div><div><font style="font-size: 12pt;">  ) {</font></div><div><font style="font-size: 12pt;">    // next() 正常访问</font></div><div><font style="font-size: 12pt;">    next()</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  // 否则想进入其他页面只能跳转到登录页</font></div><div><font style="font-size: 12pt;">  else {</font></div><div><font style="font-size: 12pt;">    isLogin ? next() : Message.error('请先登录') &amp;&amp; next('/login')</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 路由到登录界面时，强制页面reload</font></div><div><font style="font-size: 12pt;">// router.afterEach((to,from)=&gt;{</font></div><div><font style="font-size: 12pt;">//     if(from.path != '/login' &amp;&amp; from.path != '/' &amp;&amp; to.path == '/login'){</font></div><div><font style="font-size: 12pt;">//         window.location.reload();</font></div><div><font style="font-size: 12pt;">//     }</font></div><div><font style="font-size: 12pt;">// })</font></div><div><font style="font-size: 12pt;">export default router</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">store/index.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from 'vue'</font></div><div><font style="font-size: 12pt;">import Vuex from 'vuex'</font></div><div><font style="font-size: 12pt;">import createPersistedState from &quot;vuex-persistedstate&quot;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">Vue.use(Vuex)</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 设置 type 有利于调试</font></div><div><font style="font-size: 12pt;">const types = {</font></div><div><font style="font-size: 12pt;">  SET_AUTHENTICATED: &quot;SET_AUTHENTICATED&quot;,</font></div><div><font style="font-size: 12pt;">  SET_USER: &quot;SET_USER&quot;,</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const state = {</font></div><div><font style="font-size: 12pt;">  isAuthenticated: false,</font></div><div><font style="font-size: 12pt;">  user: {},</font></div><div><font style="font-size: 12pt;">  rememberPwd: '',</font></div><div><font style="font-size: 12pt;">  </font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const getters = {</font></div><div><font style="font-size: 12pt;">  isAuthenticated: state =&gt; state.isAuthenticated,</font></div><div><font style="font-size: 12pt;">  user: state =&gt; state.user</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const actions = {</font></div><div><font style="font-size: 12pt;">  setIsAuthenticated: ({ commit }, isAuthenticated) =&gt; {</font></div><div><font style="font-size: 12pt;">    commit(types.SET_AUTHENTICATED, isAuthenticated)</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  setUser: ({ commit }, user) =&gt; {</font></div><div><font style="font-size: 12pt;">    commit(types.SET_USER, user)</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  clearState: ({commit}) =&gt; {</font></div><div><font style="font-size: 12pt;">    commit(types.SET_AUTHENTICATED, false);</font></div><div><font style="font-size: 12pt;">    commit(types.SET_USER, null);</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">const mutations = {</font></div><div><font style="font-size: 12pt;">  [types.SET_AUTHENTICATED](state, isAuthenticated) {</font></div><div><font style="font-size: 12pt;">     if (isAuthenticated) {</font></div><div><font style="font-size: 12pt;">       state.isAuthenticated = isAuthenticated</font></div><div><font style="font-size: 12pt;">     }</font></div><div><font style="font-size: 12pt;">     else {</font></div><div><font style="font-size: 12pt;">       state.isAuthenticated = false</font></div><div><font style="font-size: 12pt;">     }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  [types.SET_USER](state, user) {</font></div><div><font style="font-size: 12pt;">    if (user) {</font></div><div><font style="font-size: 12pt;">      state.user = user</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    else {</font></div><div><font style="font-size: 12pt;">      state.user = {}</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default new Vuex.Store({</font></div><div><font style="font-size: 12pt;">  state,</font></div><div><font style="font-size: 12pt;">  getters,</font></div><div><font style="font-size: 12pt;">  mutations,</font></div><div><font style="font-size: 12pt;">  actions,</font></div><div><font style="font-size: 12pt;">  // 缓存 Vuex 数据，保证 F5刷新时 Vuex 数据不被清理</font></div><div><font style="font-size: 12pt;">  plugins: [createPersistedState({ storage: window.sessionStorage })],</font></div><div><font style="font-size: 12pt;">})</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">views/404.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;wscn-http404-container&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;wscn-http404&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;pic-404&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;img class=&quot;pic-404__parent&quot; src=&quot;../assets/404.png&quot; alt=&quot;404&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;img class=&quot;pic-404__child left&quot; src=&quot;../assets/404_cloud.png&quot; alt=&quot;404&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;img class=&quot;pic-404__child mid&quot; src=&quot;../assets/404_cloud.png&quot; alt=&quot;404&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;img class=&quot;pic-404__child right&quot; src=&quot;../assets/404_cloud.png&quot; alt=&quot;404&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;bullshit&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;bullshit__oops&quot;&gt;OOPS!&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;bullshit__info&quot;&gt;All rights reserved</font></div><div><font style="font-size: 12pt;">          &lt;a style=&quot;color:#20a0ff&quot; href=&quot;https://wallstreetcn.com&quot; target=&quot;_blank&quot;&gt;wallstreetcn&lt;/a&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;bullshit__headline&quot;&gt;{{ message }}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;bullshit__info&quot;&gt;Please check that the URL you entered is correct, or click the button below to return to the homepage.&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;a href=&quot;/release&quot; style=&quot;text-decoration:none;&quot; class=&quot;bullshit__return-home&quot;&gt;Back to home&lt;/a&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'Notfound',</font></div><div><font style="font-size: 12pt;">  computed: {</font></div><div><font style="font-size: 12pt;">    message() {</font></div><div><font style="font-size: 12pt;">      return 'The webmaster said that you can not enter this page...'</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style lang=&quot;scss&quot; scoped&gt;</font></div><div><font style="font-size: 12pt;">.wscn-http404-container{</font></div><div><font style="font-size: 12pt;">  transform: translate(-50%,-50%);</font></div><div><font style="font-size: 12pt;">  position: absolute;</font></div><div><font style="font-size: 12pt;">  top: 40%;</font></div><div><font style="font-size: 12pt;">  left: 50%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.wscn-http404 {</font></div><div><font style="font-size: 12pt;">  position: relative;</font></div><div><font style="font-size: 12pt;">  width: 1200px;</font></div><div><font style="font-size: 12pt;">  padding: 0 50px;</font></div><div><font style="font-size: 12pt;">  overflow: hidden;</font></div><div><font style="font-size: 12pt;">  .pic-404 {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    float: left;</font></div><div><font style="font-size: 12pt;">    width: 600px;</font></div><div><font style="font-size: 12pt;">    overflow: hidden;</font></div><div><font style="font-size: 12pt;">    &amp;__parent {</font></div><div><font style="font-size: 12pt;">      width: 100%;</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    &amp;__child {</font></div><div><font style="font-size: 12pt;">      position: absolute;</font></div><div><font style="font-size: 12pt;">      &amp;.left {</font></div><div><font style="font-size: 12pt;">        width: 80px;</font></div><div><font style="font-size: 12pt;">        top: 17px;</font></div><div><font style="font-size: 12pt;">        left: 220px;</font></div><div><font style="font-size: 12pt;">        opacity: 0;</font></div><div><font style="font-size: 12pt;">        animation-name: cloudLeft;</font></div><div><font style="font-size: 12pt;">        animation-duration: 2s;</font></div><div><font style="font-size: 12pt;">        animation-timing-function: linear;</font></div><div><font style="font-size: 12pt;">        animation-fill-mode: forwards;</font></div><div><font style="font-size: 12pt;">        animation-delay: 1s;</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      &amp;.mid {</font></div><div><font style="font-size: 12pt;">        width: 46px;</font></div><div><font style="font-size: 12pt;">        top: 10px;</font></div><div><font style="font-size: 12pt;">        left: 420px;</font></div><div><font style="font-size: 12pt;">        opacity: 0;</font></div><div><font style="font-size: 12pt;">        animation-name: cloudMid;</font></div><div><font style="font-size: 12pt;">        animation-duration: 2s;</font></div><div><font style="font-size: 12pt;">        animation-timing-function: linear;</font></div><div><font style="font-size: 12pt;">        animation-fill-mode: forwards;</font></div><div><font style="font-size: 12pt;">        animation-delay: 1.2s;</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      &amp;.right {</font></div><div><font style="font-size: 12pt;">        width: 62px;</font></div><div><font style="font-size: 12pt;">        top: 100px;</font></div><div><font style="font-size: 12pt;">        left: 500px;</font></div><div><font style="font-size: 12pt;">        opacity: 0;</font></div><div><font style="font-size: 12pt;">        animation-name: cloudRight;</font></div><div><font style="font-size: 12pt;">        animation-duration: 2s;</font></div><div><font style="font-size: 12pt;">        animation-timing-function: linear;</font></div><div><font style="font-size: 12pt;">        animation-fill-mode: forwards;</font></div><div><font style="font-size: 12pt;">        animation-delay: 1s;</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      @keyframes cloudLeft {</font></div><div><font style="font-size: 12pt;">        0% {</font></div><div><font style="font-size: 12pt;">          top: 17px;</font></div><div><font style="font-size: 12pt;">          left: 220px;</font></div><div><font style="font-size: 12pt;">          opacity: 0;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        20% {</font></div><div><font style="font-size: 12pt;">          top: 33px;</font></div><div><font style="font-size: 12pt;">          left: 188px;</font></div><div><font style="font-size: 12pt;">          opacity: 1;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        80% {</font></div><div><font style="font-size: 12pt;">          top: 81px;</font></div><div><font style="font-size: 12pt;">          left: 92px;</font></div><div><font style="font-size: 12pt;">          opacity: 1;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        100% {</font></div><div><font style="font-size: 12pt;">          top: 97px;</font></div><div><font style="font-size: 12pt;">          left: 60px;</font></div><div><font style="font-size: 12pt;">          opacity: 0;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      @keyframes cloudMid {</font></div><div><font style="font-size: 12pt;">        0% {</font></div><div><font style="font-size: 12pt;">          top: 10px;</font></div><div><font style="font-size: 12pt;">          left: 420px;</font></div><div><font style="font-size: 12pt;">          opacity: 0;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        20% {</font></div><div><font style="font-size: 12pt;">          top: 40px;</font></div><div><font style="font-size: 12pt;">          left: 360px;</font></div><div><font style="font-size: 12pt;">          opacity: 1;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        70% {</font></div><div><font style="font-size: 12pt;">          top: 130px;</font></div><div><font style="font-size: 12pt;">          left: 180px;</font></div><div><font style="font-size: 12pt;">          opacity: 1;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        100% {</font></div><div><font style="font-size: 12pt;">          top: 160px;</font></div><div><font style="font-size: 12pt;">          left: 120px;</font></div><div><font style="font-size: 12pt;">          opacity: 0;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      @keyframes cloudRight {</font></div><div><font style="font-size: 12pt;">        0% {</font></div><div><font style="font-size: 12pt;">          top: 100px;</font></div><div><font style="font-size: 12pt;">          left: 500px;</font></div><div><font style="font-size: 12pt;">          opacity: 0;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        20% {</font></div><div><font style="font-size: 12pt;">          top: 120px;</font></div><div><font style="font-size: 12pt;">          left: 460px;</font></div><div><font style="font-size: 12pt;">          opacity: 1;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        80% {</font></div><div><font style="font-size: 12pt;">          top: 180px;</font></div><div><font style="font-size: 12pt;">          left: 340px;</font></div><div><font style="font-size: 12pt;">          opacity: 1;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        100% {</font></div><div><font style="font-size: 12pt;">          top: 200px;</font></div><div><font style="font-size: 12pt;">          left: 300px;</font></div><div><font style="font-size: 12pt;">          opacity: 0;</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">  .bullshit {</font></div><div><font style="font-size: 12pt;">    position: relative;</font></div><div><font style="font-size: 12pt;">    float: left;</font></div><div><font style="font-size: 12pt;">    width: 300px;</font></div><div><font style="font-size: 12pt;">    padding: 30px 0;</font></div><div><font style="font-size: 12pt;">    overflow: hidden;</font></div><div><font style="font-size: 12pt;">    &amp;__oops {</font></div><div><font style="font-size: 12pt;">      font-size: 32px;</font></div><div><font style="font-size: 12pt;">      font-weight: bold;</font></div><div><font style="font-size: 12pt;">      line-height: 40px;</font></div><div><font style="font-size: 12pt;">      color: #1482f0;</font></div><div><font style="font-size: 12pt;">      opacity: 0;</font></div><div><font style="font-size: 12pt;">      margin-bottom: 20px;</font></div><div><font style="font-size: 12pt;">      animation-name: slideUp;</font></div><div><font style="font-size: 12pt;">      animation-duration: 0.5s;</font></div><div><font style="font-size: 12pt;">      animation-fill-mode: forwards;</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    &amp;__headline {</font></div><div><font style="font-size: 12pt;">      font-size: 20px;</font></div><div><font style="font-size: 12pt;">      line-height: 24px;</font></div><div><font style="font-size: 12pt;">      color: #222;</font></div><div><font style="font-size: 12pt;">      font-weight: bold;</font></div><div><font style="font-size: 12pt;">      opacity: 0;</font></div><div><font style="font-size: 12pt;">      margin-bottom: 10px;</font></div><div><font style="font-size: 12pt;">      animation-name: slideUp;</font></div><div><font style="font-size: 12pt;">      animation-duration: 0.5s;</font></div><div><font style="font-size: 12pt;">      animation-delay: 0.1s;</font></div><div><font style="font-size: 12pt;">      animation-fill-mode: forwards;</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    &amp;__info {</font></div><div><font style="font-size: 12pt;">      font-size: 13px;</font></div><div><font style="font-size: 12pt;">      line-height: 21px;</font></div><div><font style="font-size: 12pt;">      color: grey;</font></div><div><font style="font-size: 12pt;">      opacity: 0;</font></div><div><font style="font-size: 12pt;">      margin-bottom: 30px;</font></div><div><font style="font-size: 12pt;">      animation-name: slideUp;</font></div><div><font style="font-size: 12pt;">      animation-duration: 0.5s;</font></div><div><font style="font-size: 12pt;">      animation-delay: 0.2s;</font></div><div><font style="font-size: 12pt;">      animation-fill-mode: forwards;</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    &amp;__return-home {</font></div><div><font style="font-size: 12pt;">      display: block;</font></div><div><font style="font-size: 12pt;">      float: left;</font></div><div><font style="font-size: 12pt;">      width: 110px;</font></div><div><font style="font-size: 12pt;">      height: 36px;</font></div><div><font style="font-size: 12pt;">      background: #1482f0;</font></div><div><font style="font-size: 12pt;">      border-radius: 100px;</font></div><div><font style="font-size: 12pt;">      text-align: center;</font></div><div><font style="font-size: 12pt;">      color: #ffffff;</font></div><div><font style="font-size: 12pt;">      opacity: 0;</font></div><div><font style="font-size: 12pt;">      font-size: 14px;</font></div><div><font style="font-size: 12pt;">      line-height: 36px;</font></div><div><font style="font-size: 12pt;">      cursor: pointer;</font></div><div><font style="font-size: 12pt;">      animation-name: slideUp;</font></div><div><font style="font-size: 12pt;">      animation-duration: 0.5s;</font></div><div><font style="font-size: 12pt;">      animation-delay: 0.3s;</font></div><div><font style="font-size: 12pt;">      animation-fill-mode: forwards;</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    @keyframes slideUp {</font></div><div><font style="font-size: 12pt;">      0% {</font></div><div><font style="font-size: 12pt;">        transform: translateY(60px);</font></div><div><font style="font-size: 12pt;">        opacity: 0;</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      100% {</font></div><div><font style="font-size: 12pt;">        transform: translateY(0);</font></div><div><font style="font-size: 12pt;">        opacity: 1;</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">views/Register.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;register&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;section class=&quot;form_title&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;manage_title&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;span class=&quot;title&quot;&gt;影片资金后台管理系统&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!--</font></div><div><font style="font-size: 12pt;">          主要修改 :model rules ref v-model prop 添加 placeholder 与 html 代码无异</font></div><div><font style="font-size: 12pt;">          :model el-form 表单数据与 data 的 regisstreUser（整个表单数据，一个对象）双向绑定</font></div><div><font style="font-size: 12pt;">          rules 为表单 data 数据的校验规则</font></div><div><font style="font-size: 12pt;">          ref 标记 el-form 表单，用于在提交时判断用户输入验证是否有效 this.$refs[formName].validate</font></div><div><font style="font-size: 12pt;">          label-width 设置每个 el-form-item 的宽度</font></div><div><font style="font-size: 12pt;">          --&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-form</font></div><div><font style="font-size: 12pt;">          :model=&quot;registerUser&quot;</font></div><div><font style="font-size: 12pt;">          :rules=&quot;rules&quot;</font></div><div><font style="font-size: 12pt;">          ref=&quot;registerForm&quot;</font></div><div><font style="font-size: 12pt;">          label-width=&quot;80px&quot;</font></div><div><font style="font-size: 12pt;">          class=&quot;registerForm&quot;</font></div><div><font style="font-size: 12pt;">          hide-required-asterisk</font></div><div><font style="font-size: 12pt;">        &gt;</font></div><div><font style="font-size: 12pt;">          &lt;!--</font></div><div><font style="font-size: 12pt;">            prop 为 data 的数据，el-form 组件传值给子组件 el-form-item</font></div><div><font style="font-size: 12pt;">            每个 el-input 都使用 v-model 与 registerUser 其中的一个属性数据绑定</font></div><div><font style="font-size: 12pt;">            --&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;用户名&quot; prop=&quot;name&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input</font></div><div><font style="font-size: 12pt;">              v-model=&quot;registerUser.name&quot;</font></div><div><font style="font-size: 12pt;">              prefix-icon=&quot;el-icon-user&quot;</font></div><div><font style="font-size: 12pt;">              placeholder=&quot;请输入用户名&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;邮箱&quot; prop=&quot;email&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input</font></div><div><font style="font-size: 12pt;">              type=&quot;email&quot;</font></div><div><font style="font-size: 12pt;">              v-model=&quot;registerUser.email&quot;</font></div><div><font style="font-size: 12pt;">              prefix-icon=&quot;el-icon-message&quot;</font></div><div><font style="font-size: 12pt;">              placeholder=&quot;请输入邮箱&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;密码&quot; prop=&quot;password&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input</font></div><div><font style="font-size: 12pt;">              :type=&quot;pwdType&quot;</font></div><div><font style="font-size: 12pt;">              v-model=&quot;registerUser.password&quot;</font></div><div><font style="font-size: 12pt;">              prefix-icon=&quot;el-icon-lock&quot;</font></div><div><font style="font-size: 12pt;">              placeholder=&quot;请输入密码&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">              &lt;i</font></div><div><font style="font-size: 12pt;">                slot=&quot;suffix&quot;</font></div><div><font style="font-size: 12pt;">                title=&quot;显示或隐藏密码&quot;</font></div><div><font style="font-size: 12pt;">                :class=&quot;showPwd&quot;</font></div><div><font style="font-size: 12pt;">                :style=&quot;{ color: '#409eff', cursor: 'pointer' }&quot;</font></div><div><font style="font-size: 12pt;">                @click=&quot;togglePwd&quot;</font></div><div><font style="font-size: 12pt;">              &gt;</font></div><div><font style="font-size: 12pt;">              &lt;/i&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;确认密码&quot; prop=&quot;password2&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input</font></div><div><font style="font-size: 12pt;">              :type=&quot;pwdType&quot;</font></div><div><font style="font-size: 12pt;">              v-model=&quot;registerUser.password2&quot;</font></div><div><font style="font-size: 12pt;">              prefix-icon=&quot;el-icon-lock&quot;</font></div><div><font style="font-size: 12pt;">              placeholder=&quot;请确认密码&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">              &lt;i</font></div><div><font style="font-size: 12pt;">                slot=&quot;suffix&quot;</font></div><div><font style="font-size: 12pt;">                title=&quot;显示或隐藏密码&quot;</font></div><div><font style="font-size: 12pt;">                :class=&quot;showPwd&quot;</font></div><div><font style="font-size: 12pt;">                :style=&quot;{ color: '#409eff', cursor: 'pointer' }&quot;</font></div><div><font style="font-size: 12pt;">                @click=&quot;togglePwd&quot;</font></div><div><font style="font-size: 12pt;">              &gt;</font></div><div><font style="font-size: 12pt;">              &lt;/i&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;选择身份&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-select</font></div><div><font style="font-size: 12pt;">              v-model=&quot;registerUser.identity&quot;</font></div><div><font style="font-size: 12pt;">              placeholder=&quot;请选择身份&quot;</font></div><div><font style="font-size: 12pt;">              class=&quot;select-identity&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-option label=&quot;管理员&quot; value=&quot;manager&quot;&gt;&lt;/el-option&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-option label=&quot;员工&quot; value=&quot;employee&quot;&gt;&lt;/el-option&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-select&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;验证码&quot; prop=&quot;verifyCode&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;vertify&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-input</font></div><div><font style="font-size: 12pt;">                prefix-icon=&quot;el-icon-key&quot;</font></div><div><font style="font-size: 12pt;">                v-model=&quot;registerUser.verifyCode&quot;</font></div><div><font style="font-size: 12pt;">                placeholder=&quot;验证码&quot;</font></div><div><font style="font-size: 12pt;">                auto-complete=&quot;off&quot;</font></div><div><font style="font-size: 12pt;">              &gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">              &lt;!--</font></div><div><font style="font-size: 12pt;">                btnMsg 使用 data 数据插值，创建一个 time 初始为 30 秒，</font></div><div><font style="font-size: 12pt;">                setInterval --time ，按钮的 disabled 为 true, btnMsg 显示秒数</font></div><div><font style="font-size: 12pt;">                当 time &lt; 0 ,,按钮的 disabled 为 false, btnMsg 变回原来的数据</font></div><div><font style="font-size: 12pt;">                --&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-button</font></div><div><font style="font-size: 12pt;">                type=&quot;primary&quot;</font></div><div><font style="font-size: 12pt;">                plain</font></div><div><font style="font-size: 12pt;">                @click=&quot;getCode('registerForm')&quot;</font></div><div><font style="font-size: 12pt;">                :disabled=&quot;isDisabled&quot;</font></div><div><font style="font-size: 12pt;">                class=&quot;emailcode&quot;</font></div><div><font style="font-size: 12pt;">              &gt;</font></div><div><font style="font-size: 12pt;">                {{ btnMsg }}</font></div><div><font style="font-size: 12pt;">              &lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-button</font></div><div><font style="font-size: 12pt;">              type=&quot;primary&quot;</font></div><div><font style="font-size: 12pt;">              class=&quot;submit_btn&quot;</font></div><div><font style="font-size: 12pt;">              @click=&quot;submitForm('registerForm')&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">              注册</font></div><div><font style="font-size: 12pt;">            &lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;tip_area&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;p&gt;&lt;router-link to=&quot;/login&quot;&gt;已有账号？马上登录&lt;/router-link&gt;&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-form&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/section&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'register',</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    const validatePass2 = (rule, value, callback) =&gt; {</font></div><div><font style="font-size: 12pt;">      if (value !== this.registerUser.password) {</font></div><div><font style="font-size: 12pt;">        callback(new Error('两次输入密码不一致'))</font></div><div><font style="font-size: 12pt;">      } else {</font></div><div><font style="font-size: 12pt;">        callback()</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      pwdType: 'password',</font></div><div><font style="font-size: 12pt;">      isShowPwd: false,</font></div><div><font style="font-size: 12pt;">      btnMsg: '获取邮箱验证码',</font></div><div><font style="font-size: 12pt;">      isDisabled: false,</font></div><div><font style="font-size: 12pt;">      time: 30,</font></div><div><font style="font-size: 12pt;">      registerUser: {</font></div><div><font style="font-size: 12pt;">        name: '',</font></div><div><font style="font-size: 12pt;">        email: '',</font></div><div><font style="font-size: 12pt;">        password: '',</font></div><div><font style="font-size: 12pt;">        password2: '',</font></div><div><font style="font-size: 12pt;">        identity: '',</font></div><div><font style="font-size: 12pt;">        verifyCode: '',</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      rules: {</font></div><div><font style="font-size: 12pt;">        name: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '用户名不能为空', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            min: 2,</font></div><div><font style="font-size: 12pt;">            max: 8,</font></div><div><font style="font-size: 12pt;">            message: '用户名长度必须在2到8之间',</font></div><div><font style="font-size: 12pt;">            trigger: 'blur',</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        email: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '邮箱不能为空', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">          { type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        password: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '密码不能为空', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            min: 6,</font></div><div><font style="font-size: 12pt;">            max: 10,</font></div><div><font style="font-size: 12pt;">            message: '密码长度必须在6到10之间',</font></div><div><font style="font-size: 12pt;">            trigger: 'blur',</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        password2: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '确认密码不能为空', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            min: 6,</font></div><div><font style="font-size: 12pt;">            max: 10,</font></div><div><font style="font-size: 12pt;">            message: '确认密码长度必须在6到10之间',</font></div><div><font style="font-size: 12pt;">            trigger: 'blur',</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">          { validator: validatePass2, trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        identity: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '请选择身份', trigger: 'change' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  computed: {</font></div><div><font style="font-size: 12pt;">    showPwd() {</font></div><div><font style="font-size: 12pt;">      return this.isShowPwd ? 'third-icon-alieye' : 'third-icon-alino_eye'</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    togglePwd() {</font></div><div><font style="font-size: 12pt;">      this.pwdType === 'password'</font></div><div><font style="font-size: 12pt;">        ? (this.pwdType = '')</font></div><div><font style="font-size: 12pt;">        : (this.pwdType = 'password')</font></div><div><font style="font-size: 12pt;">      this.isShowPwd = !this.isShowPwd</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 验证码发送</font></div><div><font style="font-size: 12pt;">    getCode(formName) {</font></div><div><font style="font-size: 12pt;">      this.$refs[formName].validate((valid) =&gt; {</font></div><div><font style="font-size: 12pt;">        if (valid) {</font></div><div><font style="font-size: 12pt;">          // axios 的 get 请求使用 params 作为查询字符串，专门针对 GET 请求参数的拼接</font></div><div><font style="font-size: 12pt;">          this.$axios</font></div><div><font style="font-size: 12pt;">            .get('/users/getRegisterCode', {</font></div><div><font style="font-size: 12pt;">              params: {</font></div><div><font style="font-size: 12pt;">                email: this.registerUser.email,</font></div><div><font style="font-size: 12pt;">              },</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">            .then((res) =&gt; {</font></div><div><font style="font-size: 12pt;">              if (res.data.succ) {</font></div><div><font style="font-size: 12pt;">                this.$message({</font></div><div><font style="font-size: 12pt;">                  message: '邮件已发送，请查收',</font></div><div><font style="font-size: 12pt;">                  type: 'success',</font></div><div><font style="font-size: 12pt;">                })</font></div><div><font style="font-size: 12pt;">                this.isDisabled = true</font></div><div><font style="font-size: 12pt;">                let interval = setInterval(() =&gt; {</font></div><div><font style="font-size: 12pt;">                  this.btnMsg = '' + this.time + '秒'</font></div><div><font style="font-size: 12pt;">                  --this.time</font></div><div><font style="font-size: 12pt;">                  if (this.time &lt; 0) {</font></div><div><font style="font-size: 12pt;">                    this.btnMsg = '获取邮箱验证码'</font></div><div><font style="font-size: 12pt;">                    this.time = 30</font></div><div><font style="font-size: 12pt;">                    this.isDisabled = false</font></div><div><font style="font-size: 12pt;">                    clearInterval(interval)</font></div><div><font style="font-size: 12pt;">                  }</font></div><div><font style="font-size: 12pt;">                }, 1000)</font></div><div><font style="font-size: 12pt;">              }</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">            .catch((err) =&gt; {</font></div><div><font style="font-size: 12pt;">              this.$message({</font></div><div><font style="font-size: 12pt;">                message: '系统错误!',</font></div><div><font style="font-size: 12pt;">                type: 'error',</font></div><div><font style="font-size: 12pt;">              })</font></div><div><font style="font-size: 12pt;">              //  console.log('Error', err)</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    submitForm(formName) {</font></div><div><font style="font-size: 12pt;">      this.$refs[formName].validate((valid) =&gt; {</font></div><div><font style="font-size: 12pt;">        // post 只需要在 url 后添加第二个参数为 data</font></div><div><font style="font-size: 12pt;">        this.$axios</font></div><div><font style="font-size: 12pt;">          .post('/users/register', this.registerUser)</font></div><div><font style="font-size: 12pt;">          .then((res) =&gt; {</font></div><div><font style="font-size: 12pt;">            if (res.data.success) {</font></div><div><font style="font-size: 12pt;">              this.$message({</font></div><div><font style="font-size: 12pt;">                message: '账号注册成功',</font></div><div><font style="font-size: 12pt;">                type: 'success',</font></div><div><font style="font-size: 12pt;">              })</font></div><div><font style="font-size: 12pt;">              this.$router.push('/login')</font></div><div><font style="font-size: 12pt;">            } else {</font></div><div><font style="font-size: 12pt;">              this.$message({</font></div><div><font style="font-size: 12pt;">                message: res.data.message,</font></div><div><font style="font-size: 12pt;">                type: 'error',</font></div><div><font style="font-size: 12pt;">              })</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">          })</font></div><div><font style="font-size: 12pt;">          .catch((err) =&gt; {</font></div><div><font style="font-size: 12pt;">            this.$message({</font></div><div><font style="font-size: 12pt;">              message: '邮箱已注册!',</font></div><div><font style="font-size: 12pt;">              type: 'error',</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">            this.$router.push('/register')</font></div><div><font style="font-size: 12pt;">          })</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.register {</font></div><div><font style="font-size: 12pt;">  position: relative;</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">  background: url(../assets/login-bg.jpg) no-repeat center center;</font></div><div><font style="font-size: 12pt;">  background-size: 100% 100%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.form_title {</font></div><div><font style="font-size: 12pt;">  width: 370px;</font></div><div><font style="font-size: 12pt;">  height: 210px;</font></div><div><font style="font-size: 12pt;">  position: absolute;</font></div><div><font style="font-size: 12pt;">  top: 5%;</font></div><div><font style="font-size: 12pt;">  left: 34%;</font></div><div><font style="font-size: 12pt;">  padding: 25px;</font></div><div><font style="font-size: 12pt;">  border-radius: 5px;</font></div><div><font style="font-size: 12pt;">  text-align: center;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.form_title .title {</font></div><div><font style="font-size: 12pt;">  font-family: 'Microsoft YaHei';</font></div><div><font style="font-size: 12pt;">  font-weight: bold;</font></div><div><font style="font-size: 12pt;">  font-size: 26px;</font></div><div><font style="font-size: 12pt;">  color: #111;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.registerForm {</font></div><div><font style="font-size: 12pt;">  margin-top: 20px;</font></div><div><font style="font-size: 12pt;">  background-color: #fff;</font></div><div><font style="font-size: 12pt;">  padding: 20px 40px 20px 20px;</font></div><div><font style="font-size: 12pt;">  border-radius: 5px;</font></div><div><font style="font-size: 12pt;">  box-shadow: 0px 5px 10px #cccc;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.vertify {</font></div><div><font style="font-size: 12pt;">  display: flex;</font></div><div><font style="font-size: 12pt;">  justify-content: space-between;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.vertify &gt;&gt;&gt; .emailcode {</font></div><div><font style="font-size: 12pt;">  margin-left: 10px;</font></div><div><font style="font-size: 12pt;">  font-size: 10px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.tip_area {</font></div><div><font style="font-size: 12pt;">  text-align: left;</font></div><div><font style="font-size: 12pt;">  font-size: 12px;</font></div><div><font style="font-size: 12pt;">  color: #333;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.tip_area a {</font></div><div><font style="font-size: 12pt;">  color: #409eff;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.submit_btn {</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">.select-identity input {</font></div><div><font style="font-size: 12pt;">  padding-left: 30px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">views/Login.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;login&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;section class=&quot;form_container&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;manage_tip&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;span class=&quot;title&quot;&gt;影片资金后台管理系统&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-form</font></div><div><font style="font-size: 12pt;">        label-position=&quot;top&quot;</font></div><div><font style="font-size: 12pt;">        :model=&quot;loginUser&quot;</font></div><div><font style="font-size: 12pt;">        :rules=&quot;rules&quot;</font></div><div><font style="font-size: 12pt;">        ref=&quot;loginForm&quot;</font></div><div><font style="font-size: 12pt;">        class=&quot;loginForm&quot;</font></div><div><font style="font-size: 12pt;">        label-width=&quot;60px&quot;</font></div><div><font style="font-size: 12pt;">        hide-required-asterisk</font></div><div><font style="font-size: 12pt;">      &gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;login_title&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;h3&gt;账号密码登录&lt;/h3&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-form-item label=&quot;邮箱&quot; prop=&quot;email&quot; style=&quot;margin-bottom: 10px;&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-input</font></div><div><font style="font-size: 12pt;">            v-model=&quot;loginUser.email&quot;</font></div><div><font style="font-size: 12pt;">            prefix-icon=&quot;el-icon-message&quot;</font></div><div><font style="font-size: 12pt;">            placeholder=&quot;邮箱&quot;</font></div><div><font style="font-size: 12pt;">          &gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-form-item label=&quot;密码&quot; prop=&quot;password&quot; style=&quot;margin-bottom: 10px;&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-input</font></div><div><font style="font-size: 12pt;">            v-model=&quot;loginUser.password&quot;</font></div><div><font style="font-size: 12pt;">            prefix-icon=&quot;el-icon-lock&quot;</font></div><div><font style="font-size: 12pt;">            placeholder=&quot;密码&quot;</font></div><div><font style="font-size: 12pt;">            :type=&quot;pwdType&quot;</font></div><div><font style="font-size: 12pt;">          &gt;</font></div><div><font style="font-size: 12pt;">            &lt;i</font></div><div><font style="font-size: 12pt;">              slot=&quot;suffix&quot;</font></div><div><font style="font-size: 12pt;">              title=&quot;显示或隐藏密码&quot;</font></div><div><font style="font-size: 12pt;">              :class=&quot;showPwd&quot;</font></div><div><font style="font-size: 12pt;">              :style=&quot;{ color: '#409eff', cursor: 'pointer' }&quot;</font></div><div><font style="font-size: 12pt;">              @click=&quot;togglePwd&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">            &lt;/i&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-form-item</font></div><div><font style="font-size: 12pt;">          label=&quot;验证码&quot;</font></div><div><font style="font-size: 12pt;">          prop=&quot;inputCaptcha&quot;</font></div><div><font style="font-size: 12pt;">          style=&quot;margin-bottom: 21px;&quot;</font></div><div><font style="font-size: 12pt;">        &gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;verification&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input</font></div><div><font style="font-size: 12pt;">              prefix-icon=&quot;el-icon-key&quot;</font></div><div><font style="font-size: 12pt;">              v-model=&quot;loginUser.inputCaptcha&quot;</font></div><div><font style="font-size: 12pt;">              placeholder=&quot;验证码&quot;</font></div><div><font style="font-size: 12pt;">            &gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">            &lt;img</font></div><div><font style="font-size: 12pt;">              width=&quot;80&quot;</font></div><div><font style="font-size: 12pt;">              style=&quot;background:#EEE9E9;margin-left:30px;cursor:pointer;&quot;</font></div><div><font style="font-size: 12pt;">              ref=&quot;captcha&quot;</font></div><div><font style="font-size: 12pt;">              height=&quot;40&quot;</font></div><div><font style="font-size: 12pt;">              src=&quot;http://47.115.15.21:5001/api/users/getCaptcha&quot;</font></div><div><font style="font-size: 12pt;">              @click=&quot;refreshCaptcha&quot;</font></div><div><font style="font-size: 12pt;">            /&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;remember_pwd&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-checkbox v-model=&quot;checked&quot;&gt;记住密码&lt;/el-checkbox&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;login_btn&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-button</font></div><div><font style="font-size: 12pt;">            type=&quot;primary&quot;</font></div><div><font style="font-size: 12pt;">            @click=&quot;submitForm('loginForm')&quot;</font></div><div><font style="font-size: 12pt;">            class=&quot;submit_btn&quot;</font></div><div><font style="font-size: 12pt;">            &gt;登 录</font></div><div><font style="font-size: 12pt;">          &lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;tip_area&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;p&gt;&lt;router-link to=&quot;/forgot&quot;&gt;忘记密码&lt;/router-link&gt;&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">          &lt;p&gt;&lt;router-link to=&quot;/register&quot;&gt;还没有账号？现在注册&lt;/router-link&gt;&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-form&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/section&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import bus from '../components/bus'</font></div><div><font style="font-size: 12pt;">import jwt_decode from 'jwt-decode'</font></div><div><font style="font-size: 12pt;">import AES from 'crypto-js/aes'</font></div><div><font style="font-size: 12pt;">import ENC from 'crypto-js/enc-utf8'   </font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'login',</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    const validateCaptcha = (rule, value, callback) =&gt; {</font></div><div><font style="font-size: 12pt;">      if (!this.loginUser.inputCaptcha.trim().length) {</font></div><div><font style="font-size: 12pt;">        callback(new Error('请输入验证码'))</font></div><div><font style="font-size: 12pt;">      } else {</font></div><div><font style="font-size: 12pt;">        callback()</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      loginUser: {</font></div><div><font style="font-size: 12pt;">        email: '123452@qq.com',</font></div><div><font style="font-size: 12pt;">        password: '123452',</font></div><div><font style="font-size: 12pt;">        inputCaptcha: '',</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      pwdType: 'password',</font></div><div><font style="font-size: 12pt;">      isShowPwd: false,</font></div><div><font style="font-size: 12pt;">      checked: false,</font></div><div><font style="font-size: 12pt;">      reminder: null,</font></div><div><font style="font-size: 12pt;">      rules: {</font></div><div><font style="font-size: 12pt;">        email: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '邮箱不能为空', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">          { type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        password: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '密码不能为空', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            min: 6,</font></div><div><font style="font-size: 12pt;">            max: 10,</font></div><div><font style="font-size: 12pt;">            message: '密码长度为 6 到 10 个字符',</font></div><div><font style="font-size: 12pt;">            trigger: 'blur',</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        inputCaptcha: [</font></div><div><font style="font-size: 12pt;">          { required: true, validator: validateCaptcha, trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  computed: {</font></div><div><font style="font-size: 12pt;">    showPwd() {</font></div><div><font style="font-size: 12pt;">      return this.isShowPwd ? 'third-icon-alieye' : 'third-icon-alino_eye'</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  created() {</font></div><div><font style="font-size: 12pt;">    bus.$on('userLogout', this.loadAccountInfo())</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  mounted() {</font></div><div><font style="font-size: 12pt;">    // console.log('mounted调用了')</font></div><div><font style="font-size: 12pt;">    this.showTip()</font></div><div><font style="font-size: 12pt;">    bus.$on('refreshCaptcha', this.refreshCaptcha())</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    togglePwd() {</font></div><div><font style="font-size: 12pt;">      this.pwdType === 'password'</font></div><div><font style="font-size: 12pt;">        ? (this.pwdType = '')</font></div><div><font style="font-size: 12pt;">        : (this.pwdType = 'password')</font></div><div><font style="font-size: 12pt;">      this.isShowPwd = !this.isShowPwd</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    showTip() {</font></div><div><font style="font-size: 12pt;">      const h = this.$createElement</font></div><div><font style="font-size: 12pt;">      this.reminder = this.$notify({</font></div><div><font style="font-size: 12pt;">        title: '提示',</font></div><div><font style="font-size: 12pt;">        message: h(</font></div><div><font style="font-size: 12pt;">          'i',</font></div><div><font style="font-size: 12pt;">          { style: 'color: teal' },</font></div><div><font style="font-size: 12pt;">          '管理员账号和员工账号分别为：123452@qq.com 和 123453@qq.com，密码为邮箱账号名，注册和忘记密码需真实邮箱'</font></div><div><font style="font-size: 12pt;">        ),</font></div><div><font style="font-size: 12pt;">        duration: 6000,</font></div><div><font style="font-size: 12pt;">        iconClass: 'el-icon-s-opportunity',</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      // console.log('提示调用了')</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    submitForm(formName) {</font></div><div><font style="font-size: 12pt;">      this.$refs[formName].validate((valid) =&gt; {</font></div><div><font style="font-size: 12pt;">        if (valid) {</font></div><div><font style="font-size: 12pt;">          // console.log(this.loginUser.inputCaptcha)</font></div><div><font style="font-size: 12pt;">          // console.log(this.getCookie(&quot;captcha&quot;))</font></div><div><font style="font-size: 12pt;">          // 验证 验证码与邮箱、密码</font></div><div><font style="font-size: 12pt;">          this.$axios</font></div><div><font style="font-size: 12pt;">            .post('/users/login', this.loginUser)</font></div><div><font style="font-size: 12pt;">            .then((res) =&gt; {</font></div><div><font style="font-size: 12pt;">              if (res.data.error) {</font></div><div><font style="font-size: 12pt;">                this.$message({</font></div><div><font style="font-size: 12pt;">                  message: res.data.message,</font></div><div><font style="font-size: 12pt;">                  type: 'error',</font></div><div><font style="font-size: 12pt;">                })</font></div><div><font style="font-size: 12pt;">                this.refreshCaptcha()</font></div><div><font style="font-size: 12pt;">              }</font></div><div><font style="font-size: 12pt;">              // 登录成功</font></div><div><font style="font-size: 12pt;">              // 获取响应的 token</font></div><div><font style="font-size: 12pt;">              const { token } = res.data</font></div><div><font style="font-size: 12pt;">              // 将 token 存放到 localStorage</font></div><div><font style="font-size: 12pt;">              localStorage.setItem('eleToken', token)</font></div><div><font style="font-size: 12pt;">              // 使用 jwt_decode 解析token</font></div><div><font style="font-size: 12pt;">              const decode = jwt_decode(token)</font></div><div><font style="font-size: 12pt;">              // token 存储到 Vuex 中</font></div><div><font style="font-size: 12pt;">              // decode 不为空时才授权，将 Vuex 的 state 的 isAuthenticated 设为 true</font></div><div><font style="font-size: 12pt;">              this.$store.dispatch('setIsAuthenticated', !this.isEmpty(decode))</font></div><div><font style="font-size: 12pt;">              // 将 token 存储到 Vuex 的 state 的 user 里</font></div><div><font style="font-size: 12pt;">              this.$store.dispatch('setUser', decode)</font></div><div><font style="font-size: 12pt;">              this.$message.success('登录成功')</font></div><div><font style="font-size: 12pt;">              // 页面跳转</font></div><div><font style="font-size: 12pt;">              this.$router.push('/index')</font></div><div><font style="font-size: 12pt;">              if (this.reminder) {</font></div><div><font style="font-size: 12pt;">                this.reminder.close()</font></div><div><font style="font-size: 12pt;">              }</font></div><div><font style="font-size: 12pt;">              this.reminder = null</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">            .catch((err) =&gt; {</font></div><div><font style="font-size: 12pt;">              console.log('Error', err)</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">          //定义要存入cookie的对象</font></div><div><font style="font-size: 12pt;">          let accountInfo = ''</font></div><div><font style="font-size: 12pt;">          // 拿到输入框中的密码，使用AES加密</font></div><div><font style="font-size: 12pt;">          let pwd = this.loginUser.password</font></div><div><font style="font-size: 12pt;">          let newPwd = AES.encrypt(pwd, 'secret key 123')</font></div><div><font style="font-size: 12pt;">          // 若勾选记住密码</font></div><div><font style="font-size: 12pt;">          if (this.checked === true) {</font></div><div><font style="font-size: 12pt;">            // console.log('选择记住密码，checked == true')</font></div><div><font style="font-size: 12pt;">            accountInfo = this.loginUser.email + '&amp;' + newPwd //将加密后的密码存入cookie对象中</font></div><div><font style="font-size: 12pt;">            this.setUserCookie('accountInfo', accountInfo, 1440 * 7) //传入账号名，密码，和保存天数3个参数（7天）</font></div><div><font style="font-size: 12pt;">          } else {</font></div><div><font style="font-size: 12pt;">            // console.log('清空Cookie')</font></div><div><font style="font-size: 12pt;">            this.clearUserCookie('accountInfo') // 清空Cookie</font></div><div><font style="font-size: 12pt;">          }</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 工具函数，判断 token 是否为空，如果为空则为 true</font></div><div><font style="font-size: 12pt;">    isEmpty(value) {</font></div><div><font style="font-size: 12pt;">      return (</font></div><div><font style="font-size: 12pt;">        value === undefined ||</font></div><div><font style="font-size: 12pt;">        value === null ||</font></div><div><font style="font-size: 12pt;">        (typeof value === 'object' &amp;&amp; Object.keys(value).length === 0) ||</font></div><div><font style="font-size: 12pt;">        (typeof value === 'string' &amp;&amp; value.trim().length === 0)</font></div><div><font style="font-size: 12pt;">      )</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 刷新验证码</font></div><div><font style="font-size: 12pt;">    refreshCaptcha() {</font></div><div><font style="font-size: 12pt;">      this.loginUser.inputCaptcha = ''</font></div><div><font style="font-size: 12pt;">      this.$refs.captcha.src =</font></div><div><font style="font-size: 12pt;">        'http://47.115.15.21:5001/api/users/getCaptcha?d=' + Math.random()</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 获取验证码cookie</font></div><div><font style="font-size: 12pt;">    getCookie(cname) {</font></div><div><font style="font-size: 12pt;">      let name = cname + '='</font></div><div><font style="font-size: 12pt;">      let ca = document.cookie.split(';')</font></div><div><font style="font-size: 12pt;">      for (let i = 0; i &lt; ca.length; i++) {</font></div><div><font style="font-size: 12pt;">        let c = ca[i].trim()</font></div><div><font style="font-size: 12pt;">        if (c.indexOf(name) === 0) return c.substring(name.length, c.length)</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      return ''</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    setUserCookie(cookieName, value, expiremMinutes) {</font></div><div><font style="font-size: 12pt;">      var exdate = new Date()</font></div><div><font style="font-size: 12pt;">      exdate.setTime(exdate.getTime() + expiremMinutes * 60 * 1000)</font></div><div><font style="font-size: 12pt;">      document.cookie =</font></div><div><font style="font-size: 12pt;">        cookieName +</font></div><div><font style="font-size: 12pt;">        '=' +</font></div><div><font style="font-size: 12pt;">        escape(value) +</font></div><div><font style="font-size: 12pt;">        (expiremMinutes == null ? '' : ';expires=' + exdate.toGMTString())</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    getUserCookie(cookieName) {</font></div><div><font style="font-size: 12pt;">      if (document.cookie.length &gt; 0) {</font></div><div><font style="font-size: 12pt;">        var c_start = document.cookie.indexOf(cookieName + '=')</font></div><div><font style="font-size: 12pt;">        if (c_start != -1) {</font></div><div><font style="font-size: 12pt;">          c_start = c_start + cookieName.length + 1</font></div><div><font style="font-size: 12pt;">          var c_end = document.cookie.indexOf(';', c_start)</font></div><div><font style="font-size: 12pt;">          if (c_end == -1) c_end = document.cookie.length</font></div><div><font style="font-size: 12pt;">          return unescape(document.cookie.substring(c_start, c_end))</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      return ''</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    clearUserCookie(cookieName) {</font></div><div><font style="font-size: 12pt;">      var exp = new Date()</font></div><div><font style="font-size: 12pt;">      exp.setTime(exp.getTime() - 1)</font></div><div><font style="font-size: 12pt;">      var cval = this.getCookie(cookieName)</font></div><div><font style="font-size: 12pt;">      if (cval != null) {</font></div><div><font style="font-size: 12pt;">        document.cookie =</font></div><div><font style="font-size: 12pt;">          cookieName + '=' + cval + ';expires=' + exp.toGMTString()</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    //预读取cookie中用户信息</font></div><div><font style="font-size: 12pt;">    loadAccountInfo() {</font></div><div><font style="font-size: 12pt;">      let self = this</font></div><div><font style="font-size: 12pt;">      let accountInfo = self.getUserCookie('accountInfo')</font></div><div><font style="font-size: 12pt;">      // 如果cookie里没有账号信息</font></div><div><font style="font-size: 12pt;">      if (Boolean(accountInfo) === false) {</font></div><div><font style="font-size: 12pt;">        // console.log('cookie中没有检测到用户账号信息！')</font></div><div><font style="font-size: 12pt;">        return false</font></div><div><font style="font-size: 12pt;">      } else {</font></div><div><font style="font-size: 12pt;">        // 如果cookie里有账号信息</font></div><div><font style="font-size: 12pt;">        // console.log('cookie中检测到账号信息！现在开始预填写！')</font></div><div><font style="font-size: 12pt;">        let userEmail = ''</font></div><div><font style="font-size: 12pt;">        let pwd = ''</font></div><div><font style="font-size: 12pt;">        let index = accountInfo.indexOf('&amp;')</font></div><div><font style="font-size: 12pt;">        userEmail = accountInfo.substring(0, index)</font></div><div><font style="font-size: 12pt;">        pwd = accountInfo.substring(index + 1) // 拿到加密后的密码</font></div><div><font style="font-size: 12pt;">        // 解密</font></div><div><font style="font-size: 12pt;">        let bytes = AES.decrypt(pwd.toString(), 'secret key 123')</font></div><div><font style="font-size: 12pt;">        // 拿到解密后的密码（登录时输入的密码）</font></div><div><font style="font-size: 12pt;">        let newPwd = bytes.toString(ENC)</font></div><div><font style="font-size: 12pt;">        self.loginUser.email = userEmail</font></div><div><font style="font-size: 12pt;">        self.loginUser.password = newPwd</font></div><div><font style="font-size: 12pt;">        self.checked = true</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.login {</font></div><div><font style="font-size: 12pt;">  position: relative;</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">  background: url(../assets/login-bg.jpg) no-repeat center center;</font></div><div><font style="font-size: 12pt;">  background-size: 100% 100%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.form_container {</font></div><div><font style="font-size: 12pt;">  width: 370px;</font></div><div><font style="font-size: 12pt;">  height: 210px;</font></div><div><font style="font-size: 12pt;">  position: absolute;</font></div><div><font style="font-size: 12pt;">  top: 5%;</font></div><div><font style="font-size: 12pt;">  left: 34%;</font></div><div><font style="font-size: 12pt;">  padding: 25px;</font></div><div><font style="font-size: 12pt;">  border-radius: 5px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.manage_tip {</font></div><div><font style="font-size: 12pt;">  text-align: center;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.manage_tip .title {</font></div><div><font style="font-size: 12pt;">  font-family: 'Microsoft YaHei';</font></div><div><font style="font-size: 12pt;">  font-weight: bold;</font></div><div><font style="font-size: 12pt;">  font-size: 26px;</font></div><div><font style="font-size: 12pt;">  color: #111;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.loginForm {</font></div><div><font style="font-size: 12pt;">  margin-top: 20px;</font></div><div><font style="font-size: 12pt;">  background-color: #fff;</font></div><div><font style="font-size: 12pt;">  padding: 25px;</font></div><div><font style="font-size: 12pt;">  border-radius: 5px;</font></div><div><font style="font-size: 12pt;">  box-shadow: 0px 5px 10px #cccc;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.login_title {</font></div><div><font style="font-size: 12pt;">  margin-bottom: 7px;</font></div><div><font style="font-size: 12pt;">  text-align: center;</font></div><div><font style="font-size: 12pt;">  color: #505458;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.verification {</font></div><div><font style="font-size: 12pt;">  display: flex;</font></div><div><font style="font-size: 12pt;">  justify-content: space-between;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.remember_pwd {</font></div><div><font style="font-size: 12pt;">  text-align: left;</font></div><div><font style="font-size: 12pt;">  margin-bottom: 20px;</font></div><div><font style="font-size: 12pt;">  color: rgb(64, 158, 255);</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.login_btn {</font></div><div><font style="font-size: 12pt;">  margin-bottom: 20px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.submit_btn {</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.tip_area {</font></div><div><font style="font-size: 12pt;">  display: flex;</font></div><div><font style="font-size: 12pt;">  justify-content: space-between;</font></div><div><font style="font-size: 12pt;">  font-size: 12px;</font></div><div><font style="font-size: 12pt;">  color: #333;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.tip_area a {</font></div><div><font style="font-size: 12pt;">  color: #409eff;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.el-form--label-top &gt;&gt;&gt; .el-form-item__label {</font></div><div><font style="font-size: 12pt;">  float: none;</font></div><div><font style="font-size: 12pt;">  display: inline-block;</font></div><div><font style="font-size: 12pt;">  text-align: left;</font></div><div><font style="font-size: 12pt;">  padding: 0 0 0px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">.el-notification {</font></div><div><font style="font-size: 12pt;">  width: auto !important;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.el-notification .el-icon-s-opportunity {</font></div><div><font style="font-size: 12pt;">  color: #ffc107;</font></div><div><font style="font-size: 12pt;">  font-size: 22px;</font></div><div><font style="font-size: 12pt;">  margin-top: 2px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.el-notification__title {</font></div><div><font style="font-size: 12pt;">  margin: 5px 0px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.el-notification__content {</font></div><div><font style="font-size: 12pt;">  display: flex;</font></div><div><font style="font-size: 12pt;">  width: 270px !important;</font></div><div><font style="font-size: 12pt;">  justify-content: center;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">views/ForgotPassword.vue</span></span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;forgotpwd&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;section class=&quot;form_title&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;manage_title&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;span class=&quot;title&quot;&gt;影片资金后台管理系统&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 主要修改 :model rules ref v-model prop 添加 placeholder 与 html 代码无异--&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-form</font></div><div><font style="font-size: 12pt;">          :model=&quot;forgotPass&quot;</font></div><div><font style="font-size: 12pt;">          :rules=&quot;rules&quot;</font></div><div><font style="font-size: 12pt;">          ref=&quot;forgotPassForm&quot;</font></div><div><font style="font-size: 12pt;">          label-width=&quot;80px&quot;</font></div><div><font style="font-size: 12pt;">          class=&quot;registerForm&quot;</font></div><div><font style="font-size: 12pt;">          hide-required-asterisk</font></div><div><font style="font-size: 12pt;">          @submit.native.prevent=&quot;forgetPass('forgotPassForm')&quot;</font></div><div><font style="font-size: 12pt;">        &gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;forgot_title&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;h3&gt;忘记密码&lt;/h3&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;邮箱&quot; prop=&quot;email&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input</font></div><div><font style="font-size: 12pt;">              type=&quot;email&quot;</font></div><div><font style="font-size: 12pt;">              v-model=&quot;forgotPass.email&quot;</font></div><div><font style="font-size: 12pt;">              prefix-icon=&quot;el-icon-message&quot;</font></div><div><font style="font-size: 12pt;">              placeholder=&quot;请输入邮箱&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;密码&quot; prop=&quot;password&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input</font></div><div><font style="font-size: 12pt;">              :type=&quot;pwdType&quot;</font></div><div><font style="font-size: 12pt;">              v-model=&quot;forgotPass.password&quot;</font></div><div><font style="font-size: 12pt;">              prefix-icon=&quot;el-icon-lock&quot;</font></div><div><font style="font-size: 12pt;">              placeholder=&quot;请输入密码&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">              &lt;i</font></div><div><font style="font-size: 12pt;">                slot=&quot;suffix&quot;</font></div><div><font style="font-size: 12pt;">                title=&quot;显示或隐藏密码&quot;</font></div><div><font style="font-size: 12pt;">                :class=&quot;showPwd&quot;</font></div><div><font style="font-size: 12pt;">                :style=&quot;{ color: '#409eff', cursor: 'pointer' }&quot;</font></div><div><font style="font-size: 12pt;">                @click=&quot;togglePwd&quot;</font></div><div><font style="font-size: 12pt;">              &gt;</font></div><div><font style="font-size: 12pt;">              &lt;/i&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;确认密码&quot; prop=&quot;password2&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input</font></div><div><font style="font-size: 12pt;">              :type=&quot;pwdType&quot;</font></div><div><font style="font-size: 12pt;">              v-model=&quot;forgotPass.password2&quot;</font></div><div><font style="font-size: 12pt;">              prefix-icon=&quot;el-icon-lock&quot;</font></div><div><font style="font-size: 12pt;">              placeholder=&quot;请确认密码&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">              &lt;i</font></div><div><font style="font-size: 12pt;">                slot=&quot;suffix&quot;</font></div><div><font style="font-size: 12pt;">                title=&quot;显示或隐藏密码&quot;</font></div><div><font style="font-size: 12pt;">                :class=&quot;showPwd&quot;</font></div><div><font style="font-size: 12pt;">                :style=&quot;{ color: '#409eff', cursor: 'pointer' }&quot;</font></div><div><font style="font-size: 12pt;">                @click=&quot;togglePwd&quot;</font></div><div><font style="font-size: 12pt;">              &gt;</font></div><div><font style="font-size: 12pt;">              &lt;/i&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;验证码&quot; prop=&quot;verifyCode&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;vertify&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-input</font></div><div><font style="font-size: 12pt;">                prefix-icon=&quot;el-icon-key&quot;</font></div><div><font style="font-size: 12pt;">                v-model=&quot;forgotPass.verifyCode&quot;</font></div><div><font style="font-size: 12pt;">                placeholder=&quot;验证码&quot;</font></div><div><font style="font-size: 12pt;">                auto-complete=&quot;off&quot;</font></div><div><font style="font-size: 12pt;">              &gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-button</font></div><div><font style="font-size: 12pt;">                type=&quot;primary&quot;</font></div><div><font style="font-size: 12pt;">                plain</font></div><div><font style="font-size: 12pt;">                @click=&quot;getCode('forgotPassForm')&quot;</font></div><div><font style="font-size: 12pt;">                :disabled=&quot;isDisabled&quot;</font></div><div><font style="font-size: 12pt;">                class=&quot;emailcode&quot;</font></div><div><font style="font-size: 12pt;">              &gt;</font></div><div><font style="font-size: 12pt;">                {{ btnMsg }}</font></div><div><font style="font-size: 12pt;">              &lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;forgot_button&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-button type=&quot;primary&quot; native-type=&quot;submit&quot; class=&quot;confirm&quot;</font></div><div><font style="font-size: 12pt;">              &gt;确定&lt;/el-button</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">          &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;tip_area&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;router-link to=&quot;/&quot;&gt;想起密码，登录&lt;/router-link&gt;</font></div><div><font style="font-size: 12pt;">            &lt;p&gt;注：若未收到验证码，请查看垃圾箱&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-form&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/section&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'forgot',</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    const validatePass2 = (rule, value, callback) =&gt; {</font></div><div><font style="font-size: 12pt;">      if (value !== this.forgotPass.password) {</font></div><div><font style="font-size: 12pt;">        callback(new Error('两次输入密码不一致'))</font></div><div><font style="font-size: 12pt;">      } else {</font></div><div><font style="font-size: 12pt;">        callback()</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      pwdType: 'password',</font></div><div><font style="font-size: 12pt;">      isShowPwd: false,</font></div><div><font style="font-size: 12pt;">      btnMsg: '获取邮箱验证码',</font></div><div><font style="font-size: 12pt;">      isDisabled: false,</font></div><div><font style="font-size: 12pt;">      time: 30,</font></div><div><font style="font-size: 12pt;">      forgotPass: {</font></div><div><font style="font-size: 12pt;">        email: '',</font></div><div><font style="font-size: 12pt;">        password: '',</font></div><div><font style="font-size: 12pt;">        password2: '',</font></div><div><font style="font-size: 12pt;">        verifyCode: '',</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      rules: {</font></div><div><font style="font-size: 12pt;">        email: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '邮箱不能为空', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">          { type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        password: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '密码不能为空', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            min: 6,</font></div><div><font style="font-size: 12pt;">            max: 10,</font></div><div><font style="font-size: 12pt;">            message: '密码长度必须在6到10之间',</font></div><div><font style="font-size: 12pt;">            trigger: 'blur',</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        password2: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '确认密码不能为空', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            min: 6,</font></div><div><font style="font-size: 12pt;">            max: 10,</font></div><div><font style="font-size: 12pt;">            message: '确认密码长度必须在6到10之间',</font></div><div><font style="font-size: 12pt;">            trigger: 'blur',</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">          { validator: validatePass2, trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  computed: {</font></div><div><font style="font-size: 12pt;">    showPwd() {</font></div><div><font style="font-size: 12pt;">      return this.isShowPwd ? 'third-icon-alieye' : 'third-icon-alino_eye'</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    togglePwd() {</font></div><div><font style="font-size: 12pt;">      this.pwdType === 'password'</font></div><div><font style="font-size: 12pt;">        ? (this.pwdType = '')</font></div><div><font style="font-size: 12pt;">        : (this.pwdType = 'password')</font></div><div><font style="font-size: 12pt;">      this.isShowPwd = !this.isShowPwd</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 验证码发送</font></div><div><font style="font-size: 12pt;">    getCode(formName) {</font></div><div><font style="font-size: 12pt;">      this.$refs[formName].validate((valid) =&gt; {</font></div><div><font style="font-size: 12pt;">        if (valid) {</font></div><div><font style="font-size: 12pt;">          this.$axios</font></div><div><font style="font-size: 12pt;">            .get('/users/getEmailCode', {</font></div><div><font style="font-size: 12pt;">              params: {</font></div><div><font style="font-size: 12pt;">                email: this.forgotPass.email,</font></div><div><font style="font-size: 12pt;">              },</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">            .then((res) =&gt; {</font></div><div><font style="font-size: 12pt;">              // console.log(res)</font></div><div><font style="font-size: 12pt;">              if (res.data.succ) {</font></div><div><font style="font-size: 12pt;">                this.$message({</font></div><div><font style="font-size: 12pt;">                  message: '邮件已发送，请查收',</font></div><div><font style="font-size: 12pt;">                  type: 'success',</font></div><div><font style="font-size: 12pt;">                })</font></div><div><font style="font-size: 12pt;">                this.isDisabled = true</font></div><div><font style="font-size: 12pt;">                let interval = setInterval(() =&gt; {</font></div><div><font style="font-size: 12pt;">                  this.btnMsg = '' + this.time + '秒'</font></div><div><font style="font-size: 12pt;">                  --this.time</font></div><div><font style="font-size: 12pt;">                  if (this.time &lt; 0) {</font></div><div><font style="font-size: 12pt;">                    this.btnMsg = '获取邮箱验证码'</font></div><div><font style="font-size: 12pt;">                    this.time = 30</font></div><div><font style="font-size: 12pt;">                    this.isDisabled = false</font></div><div><font style="font-size: 12pt;">                    clearInterval(interval)</font></div><div><font style="font-size: 12pt;">                  }</font></div><div><font style="font-size: 12pt;">                }, 1000)</font></div><div><font style="font-size: 12pt;">              }</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 修改密码</font></div><div><font style="font-size: 12pt;">    forgetPass(formName) {</font></div><div><font style="font-size: 12pt;">      this.$refs[formName].validate((valid) =&gt; {</font></div><div><font style="font-size: 12pt;">        if (valid) {</font></div><div><font style="font-size: 12pt;">          this.$axios</font></div><div><font style="font-size: 12pt;">            .put('/users/resetPass', this.forgotPass)</font></div><div><font style="font-size: 12pt;">            .then((res) =&gt; {</font></div><div><font style="font-size: 12pt;">              // console.log(res)</font></div><div><font style="font-size: 12pt;">              if (res.data.success) {</font></div><div><font style="font-size: 12pt;">                this.$message({</font></div><div><font style="font-size: 12pt;">                  message: res.data.message,</font></div><div><font style="font-size: 12pt;">                  type: 'success',</font></div><div><font style="font-size: 12pt;">                })</font></div><div><font style="font-size: 12pt;">                // setTimeout(() =&gt; {</font></div><div><font style="font-size: 12pt;">                //   history.pushState({}, '', '/login') //跳转到登录界面</font></div><div><font style="font-size: 12pt;">                //   location.reload()</font></div><div><font style="font-size: 12pt;">                // }, 1000)</font></div><div><font style="font-size: 12pt;">                this.$router.push('/login')</font></div><div><font style="font-size: 12pt;">              } else {</font></div><div><font style="font-size: 12pt;">                this.$message({</font></div><div><font style="font-size: 12pt;">                  message: res.data.message,</font></div><div><font style="font-size: 12pt;">                  type: 'error',</font></div><div><font style="font-size: 12pt;">                })</font></div><div><font style="font-size: 12pt;">              }</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">            .catch((err) =&gt; {</font></div><div><font style="font-size: 12pt;">              this.$message({</font></div><div><font style="font-size: 12pt;">                message: '系统错误!',</font></div><div><font style="font-size: 12pt;">                type: 'error',</font></div><div><font style="font-size: 12pt;">              })</font></div><div><font style="font-size: 12pt;">              console.log('Error', err)</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.forgotpwd {</font></div><div><font style="font-size: 12pt;">  position: relative;</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">  background: url(../assets/login-bg.jpg) no-repeat center center;</font></div><div><font style="font-size: 12pt;">  background-size: 100% 100%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.form_title {</font></div><div><font style="font-size: 12pt;">  width: 370px;</font></div><div><font style="font-size: 12pt;">  height: 210px;</font></div><div><font style="font-size: 12pt;">  position: absolute;</font></div><div><font style="font-size: 12pt;">  top: 5%;</font></div><div><font style="font-size: 12pt;">  left: 34%;</font></div><div><font style="font-size: 12pt;">  padding: 25px;</font></div><div><font style="font-size: 12pt;">  border-radius: 5px;</font></div><div><font style="font-size: 12pt;">  text-align: center;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.form_title .manage_title .title {</font></div><div><font style="font-size: 12pt;">  font-family: 'Microsoft YaHei';</font></div><div><font style="font-size: 12pt;">  font-weight: bold;</font></div><div><font style="font-size: 12pt;">  font-size: 26px;</font></div><div><font style="font-size: 12pt;">  color: #111;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.forgot_title {</font></div><div><font style="font-size: 12pt;">  margin-bottom: 20px;</font></div><div><font style="font-size: 12pt;">  text-align: center;</font></div><div><font style="font-size: 12pt;">  color: #505458;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.registerForm {</font></div><div><font style="font-size: 12pt;">  margin-top: 20px;</font></div><div><font style="font-size: 12pt;">  background-color: #fff;</font></div><div><font style="font-size: 12pt;">  padding: 20px 40px 20px 20px;</font></div><div><font style="font-size: 12pt;">  border-radius: 5px;</font></div><div><font style="font-size: 12pt;">  box-shadow: 0px 5px 10px #cccc;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.vertify {</font></div><div><font style="font-size: 12pt;">  display: flex;</font></div><div><font style="font-size: 12pt;">  justify-content: space-between;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.vertify &gt;&gt;&gt; .emailcode {</font></div><div><font style="font-size: 12pt;">  margin-left: 10px;</font></div><div><font style="font-size: 12pt;">  font-size: 10px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.forgot_button {</font></div><div><font style="font-size: 12pt;">  padding-left: 80px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.confirm {</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.tip_area {</font></div><div><font style="font-size: 12pt;">  text-align: left;</font></div><div><font style="font-size: 12pt;">  font-size: 12px;</font></div><div><font style="font-size: 12pt;">  color: #333;</font></div><div><font style="font-size: 12pt;">  margin-top: 20px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.tip_area a {</font></div><div><font style="font-size: 12pt;">  color: #409eff;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.tip_area p {</font></div><div><font style="font-size: 12pt;">  margin-top: 15px;</font></div><div><font style="font-size: 12pt;">  color: gray;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">views/Index.vue</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;index&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;Header-Nav&gt;&lt;/Header-Nav&gt;</font></div><div><font style="font-size: 12pt;">    &lt;!-- 其实样式绑定放到 LeftMenu 的 &lt;el-row&gt; 也是一样的--&gt;</font></div><div><font style="font-size: 12pt;">    &lt;Left-Menu :class=&quot;{ 'menu-collapse': collapse }&quot;&gt;&lt;/Left-Menu&gt;   </font></div><div><font style="font-size: 12pt;">    &lt;!-- 右侧内容区 --&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;rightContainer&quot; :class=&quot;{ 'content-collapse': collapse }&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;transition name=&quot;move&quot; mode=&quot;out-in&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 路由出口 --&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 路由匹配到的组件将渲染在这里 --&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- router-view 渲染 Index.vue 的子路由组件 --&gt;</font></div><div><font style="font-size: 12pt;">        &lt;router-view&gt;&lt;/router-view&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/transition&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import HeaderNav from '../components/HeaderNav'</font></div><div><font style="font-size: 12pt;">import LeftMenu from '../components/LeftMenu'</font></div><div><font style="font-size: 12pt;">import bus from '../components/bus'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'index',</font></div><div><font style="font-size: 12pt;">  components: {</font></div><div><font style="font-size: 12pt;">    HeaderNav,</font></div><div><font style="font-size: 12pt;">    LeftMenu,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      collapse: false,</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  created() {</font></div><div><font style="font-size: 12pt;">    bus.$on('collapse-content', (msg) =&gt; {</font></div><div><font style="font-size: 12pt;">      this.collapse = msg</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.index {</font></div><div><font style="font-size: 12pt;">  position: relative;</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">  overflow: hidden;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.rightContainer {</font></div><div><font style="font-size: 12pt;">  position: absolute;</font></div><div><font style="font-size: 12pt;">  top: 70px;</font></div><div><font style="font-size: 12pt;">  left: 180px;</font></div><div><font style="font-size: 12pt;">  right: 0;</font></div><div><font style="font-size: 12pt;">  bottom: 0;</font></div><div><font style="font-size: 12pt;">  transition: ease-in-out all 0.3s;</font></div><div><font style="font-size: 12pt;">  overflow: auto;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.menu-collapse {</font></div><div><font style="font-size: 12pt;">  width: 64px;</font></div><div><font style="font-size: 12pt;">  /* 不能乱改折叠侧边栏收缩的宽度，否则展开宽度不够则会出现白边 */</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.content-collapse {</font></div><div><font style="font-size: 12pt;">  left: 64px;</font></div><div><font style="font-size: 12pt;">  /* transition: ease-in-out all .3s; */</font></div><div><font style="font-size: 12pt;">  /* transition: ease-in-out all .3s; */</font></div><div><font style="font-size: 12pt;">  /*问题 控制右边内容宽度不超出 */</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.move-enter,</font></div><div><font style="font-size: 12pt;">.move-leave {</font></div><div><font style="font-size: 12pt;">  opacity: 0;</font></div><div><font style="font-size: 12pt;">  /* 显示/隐藏 */</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.move-enter-active,</font></div><div><font style="font-size: 12pt;">.move-leave-active {</font></div><div><font style="font-size: 12pt;">  transition: opacity 0.3s;</font></div><div><font style="font-size: 12pt;">  /* 过渡 慢慢显示/隐藏 */</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">components/HeaderNav.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;header class=&quot;head-nav&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;el-row&gt;</font></div><div><font style="font-size: 12pt;">      &lt;!-- 一行分为 24份 --&gt;</font></div><div><font style="font-size: 12pt;">      &lt;!-- 一列占 6 份 --&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-col :span=&quot;6&quot; class=&quot;logo-container&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 折叠按钮 --&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;collapse-btn&quot; @click=&quot;collapseChage&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;i v-if=&quot;collapse&quot; class=&quot;el-icon-s-fold&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">          &lt;i v-else class=&quot;el-icon-s-unfold&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;img src=&quot;../assets/logo.png&quot; alt=&quot;logo&quot; class=&quot;logo&quot; /&gt;</font></div><div><font style="font-size: 12pt;">        &lt;h1 class=&quot;title&quot;&gt;影片资金后台管理系统&lt;/h1&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-col&gt;</font></div><div><font style="font-size: 12pt;">       &lt;!-- 一列占 6 份 --&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-col :span=&quot;6&quot; class=&quot;user&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;userinfo&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;img class=&quot;avatar&quot; :src=&quot;user.avatar&quot; alt=&quot;avatar&quot; /&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;welcome&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;p class=&quot;name comename&quot;&gt;欢迎&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">            &lt;p class=&quot;name avatarname&quot;&gt;{{ user.name }}&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">          &lt;span class=&quot;username&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-dropdown trigger=&quot;click&quot; @command=&quot;setDialogInfo&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;span class=&quot;el-dropdown-link&quot;&gt;</font></div><div><font style="font-size: 12pt;">                下拉菜单&lt;i class=&quot;el-icon-caret-bottom el-icon--right&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">              &lt;/span&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-dropdown-menu slot=&quot;dropdown&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;el-dropdown-item command=&quot;info&quot;&gt;个人信息&lt;/el-dropdown-item&gt;</font></div><div><font style="font-size: 12pt;">                &lt;el-dropdown-item command=&quot;logout&quot;&gt;退出&lt;/el-dropdown-item&gt;</font></div><div><font style="font-size: 12pt;">              &lt;/el-dropdown-menu&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-dropdown&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/span&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-col&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/el-row&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/header&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import bus from './bus'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'header-nav',</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      collapse: false,</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  computed: {</font></div><div><font style="font-size: 12pt;">    user() {</font></div><div><font style="font-size: 12pt;">      return this.$store.getters.user</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    // 侧边栏折叠</font></div><div><font style="font-size: 12pt;">    collapseChage() {</font></div><div><font style="font-size: 12pt;">      this.collapse = !this.collapse</font></div><div><font style="font-size: 12pt;">      bus.$emit('collapse', this.collapse)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 点击指令为 info 时调用 showInfo ，点击指令为 logout 时调用 logout</font></div><div><font style="font-size: 12pt;">    setDialogInfo(cmdItem) {</font></div><div><font style="font-size: 12pt;">      switch (cmdItem) {</font></div><div><font style="font-size: 12pt;">        case 'info':</font></div><div><font style="font-size: 12pt;">          this.showInfo()</font></div><div><font style="font-size: 12pt;">          break</font></div><div><font style="font-size: 12pt;">        case 'logout':</font></div><div><font style="font-size: 12pt;">          this.logout()</font></div><div><font style="font-size: 12pt;">          break</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    showInfo() {</font></div><div><font style="font-size: 12pt;">      // 跳转到个人信息页</font></div><div><font style="font-size: 12pt;">      this.$router.push('/info')</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    logout() {</font></div><div><font style="font-size: 12pt;">      bus.$emit('userLogout')</font></div><div><font style="font-size: 12pt;">      bus.$emit('refreshCaptcha')</font></div><div><font style="font-size: 12pt;">      // 清除 token</font></div><div><font style="font-size: 12pt;">      localStorage.removeItem('eleToken')</font></div><div><font style="font-size: 12pt;">      // 清除 vuex 的 state</font></div><div><font style="font-size: 12pt;">      this.$store.dispatch('clearState')</font></div><div><font style="font-size: 12pt;">      // 跳转到登录页</font></div><div><font style="font-size: 12pt;">      this.$router.push('/login')</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  mounted() {</font></div><div><font style="font-size: 12pt;">    // 默认左侧菜单栏折叠</font></div><div><font style="font-size: 12pt;">    if (document.body.clientWidth &lt; 1500) {</font></div><div><font style="font-size: 12pt;">      this.collapseChage()</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.head-nav {</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 60px;</font></div><div><font style="font-size: 12pt;">  min-width: 600px;</font></div><div><font style="font-size: 12pt;">  padding: 5px;</font></div><div><font style="font-size: 12pt;">  background: #324057;</font></div><div><font style="font-size: 12pt;">  color: #fff;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.collapse-btn {</font></div><div><font style="font-size: 12pt;">  float: left;</font></div><div><font style="font-size: 12pt;">  width: 22px;</font></div><div><font style="font-size: 12pt;">  font-size: 18px;</font></div><div><font style="font-size: 12pt;">  padding: 0 15px;</font></div><div><font style="font-size: 12pt;">  cursor: pointer;</font></div><div><font style="font-size: 12pt;">  line-height: 65px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.logo-container {</font></div><div><font style="font-size: 12pt;">  line-height: 60px;</font></div><div><font style="font-size: 12pt;">  min-width: 400px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.logo {</font></div><div><font style="font-size: 12pt;">  height: 40px;</font></div><div><font style="font-size: 12pt;">  width: 40px;</font></div><div><font style="font-size: 12pt;">  margin-left: 7px;</font></div><div><font style="font-size: 12pt;">  margin-right: 5px;</font></div><div><font style="font-size: 12pt;">  vertical-align: middle;</font></div><div><font style="font-size: 12pt;">  display: inline-block;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.title {</font></div><div><font style="font-size: 12pt;">  display: inline-block;</font></div><div><font style="font-size: 12pt;">  vertical-align: middle;</font></div><div><font style="font-size: 12pt;">  font-size: 22px;</font></div><div><font style="font-size: 12pt;">  font-family: 'Microsoft YaHei';</font></div><div><font style="font-size: 12pt;">  letter-spacing: 3px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.user {</font></div><div><font style="font-size: 12pt;">  line-height: 60px;</font></div><div><font style="font-size: 12pt;">  text-align: right;</font></div><div><font style="font-size: 12pt;">  float: right;</font></div><div><font style="font-size: 12pt;">  padding-right: 10px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.avatar {</font></div><div><font style="font-size: 12pt;">  width: 40px;</font></div><div><font style="font-size: 12pt;">  height: 40px;</font></div><div><font style="font-size: 12pt;">  border-radius: 50%;</font></div><div><font style="font-size: 12pt;">  vertical-align: middle;</font></div><div><font style="font-size: 12pt;">  display: inline-block;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.welcome {</font></div><div><font style="font-size: 12pt;">  display: inline-block;</font></div><div><font style="font-size: 12pt;">  width: auto;</font></div><div><font style="font-size: 12pt;">  vertical-align: middle;</font></div><div><font style="font-size: 12pt;">  padding: 0 16px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.name {</font></div><div><font style="font-size: 12pt;">  line-height: 20px;</font></div><div><font style="font-size: 12pt;">  text-align: center;</font></div><div><font style="font-size: 12pt;">  font-size: 16px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.comename {</font></div><div><font style="font-size: 12pt;">  font-size: 16px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.avatarname {</font></div><div><font style="font-size: 12pt;">  color: #409eff;</font></div><div><font style="font-size: 12pt;">  font-weight: bolder;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.username {</font></div><div><font style="font-size: 12pt;">  cursor: pointer;</font></div><div><font style="font-size: 12pt;">  margin-right: 5px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.el-dropdown {</font></div><div><font style="font-size: 12pt;">  color: #fff;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">components/LeftMenu.vue</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;el-row class=&quot;menu_page&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;el-col&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-menu</font></div><div><font style="font-size: 12pt;">        class=&quot;el-menu-vertical-demo&quot;</font></div><div><font style="font-size: 12pt;">        :collapse=&quot;collapse&quot;</font></div><div><font style="font-size: 12pt;">        background-color=&quot;#324057&quot;</font></div><div><font style="font-size: 12pt;">        text-color=&quot;#fff&quot;</font></div><div><font style="font-size: 12pt;">        active-text-color=&quot;#409eff&quot;</font></div><div><font style="font-size: 12pt;">        :unique-opened=&quot;false&quot;</font></div><div><font style="font-size: 12pt;">        mode=&quot;vertical&quot;</font></div><div><font style="font-size: 12pt;">        :collapse-transition=&quot;true&quot;</font></div><div><font style="font-size: 12pt;">      &gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 二级路由的数据结构：一个数组包含两个对象，两个对象有包含自己的子集（数组） --&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 一级路由 --&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 路由跳转到首页 --&gt;       </font></div><div><font style="font-size: 12pt;">        &lt;router-link to=&quot;/home&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-menu-item index=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;i class=&quot;fa fa-margin el-icon-menu&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">            &lt;span slot=&quot;title&quot;&gt;首页&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-menu-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/router-link&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 循环所有二级路由 --&gt;</font></div><div><font style="font-size: 12pt;">        &lt;template v-for=&quot;item in items&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;!-- 有子项的菜单 --&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-submenu v-if=&quot;item.children&quot; :index=&quot;item.path&quot; :key=&quot;item.path&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;template slot=&quot;title&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;i :class=&quot;'fa fa-margin ' + item.icon&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">              &lt;span slot=&quot;title&quot;&gt;{{ item.name }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">            &lt;!-- 显示二级路由的子项 --&gt;</font></div><div><font style="font-size: 12pt;">            &lt;router-link</font></div><div><font style="font-size: 12pt;">              v-for=&quot;(citem, cindex) in item.children&quot;</font></div><div><font style="font-size: 12pt;">              :to=&quot;citem.path&quot;</font></div><div><font style="font-size: 12pt;">              :key=&quot;cindex&quot;</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-menu-item :index=&quot;citem.path&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;span slot=&quot;title&quot;&gt;{{ citem.name }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">              &lt;/el-menu-item&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/router-link&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-submenu&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 一级路由 --&gt;</font></div><div><font style="font-size: 12pt;">        &lt;!-- 路由跳转到消息管理 --&gt;    </font></div><div><font style="font-size: 12pt;">        &lt;router-link to=&quot;/tabs&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-menu-item index=&quot;tabs&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;i class=&quot;fa fa-margin el-icon-s-comment&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">            &lt;span slot=&quot;title&quot;&gt;消息&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-menu-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/router-link&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-menu&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/el-col&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/el-row&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import bus from './bus'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'left-menu',</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      collapse: false,</font></div><div><font style="font-size: 12pt;">      items: [</font></div><div><font style="font-size: 12pt;">        {</font></div><div><font style="font-size: 12pt;">          icon: 'el-icon-s-finance',</font></div><div><font style="font-size: 12pt;">          name: '资金管理',</font></div><div><font style="font-size: 12pt;">          path: 'fund',</font></div><div><font style="font-size: 12pt;">          children: [{ path: 'fundlist', name: '资金流水' }],</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        {</font></div><div><font style="font-size: 12pt;">          icon: 'el-icon-s-order',</font></div><div><font style="font-size: 12pt;">          name: '信息管理',</font></div><div><font style="font-size: 12pt;">          path: 'info',</font></div><div><font style="font-size: 12pt;">          children: [{ path: 'info', name: '个人信息' }],</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">      ],</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  created() {</font></div><div><font style="font-size: 12pt;">    // 通过 Event Bus 进行组件间通信，来折叠侧边栏</font></div><div><font style="font-size: 12pt;">    bus.$on('collapse', (msg) =&gt; {</font></div><div><font style="font-size: 12pt;">      this.collapse = msg</font></div><div><font style="font-size: 12pt;">      bus.$emit('collapse-content', msg)</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.menu_page {</font></div><div><font style="font-size: 12pt;">  position: absolute;</font></div><div><font style="font-size: 12pt;">  top: 70px;</font></div><div><font style="font-size: 12pt;">  left: 0;</font></div><div><font style="font-size: 12pt;">  min-height: 600px;</font></div><div><font style="font-size: 12pt;">  /*问题 一定要设置好最小高度，收缩侧边栏高度才不会变小 */</font></div><div><font style="font-size: 12pt;">  background-color: #324057;</font></div><div><font style="font-size: 12pt;">  /* z-index: 2; */</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.el-menu {</font></div><div><font style="font-size: 12pt;">  border: none;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.fa {</font></div><div><font style="font-size: 12pt;">  font-size: 18px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.fa-margin {</font></div><div><font style="font-size: 12pt;">  margin-right: 5px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.el-menu-vertical-demo:not(.el-menu--collapse) {</font></div><div><font style="font-size: 12pt;">  width: 180px;</font></div><div><font style="font-size: 12pt;">  min-height: 600px;</font></div><div><font style="font-size: 12pt;">  /*问题 一定要设置好宽度，展开侧边栏过渡动画才不会有白框的问题 */</font></div><div><font style="font-size: 12pt;">  /*问题 一定要设置好最小高度，收缩侧边栏过渡动画才不会有上下不一致、缺边的问题 */</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">/*</font></div><div><font style="font-size: 12pt;">不能乱改折叠侧边栏收缩的宽度，否则展开宽度不够则会出现白边</font></div><div><font style="font-size: 12pt;">.el-menu-vertical-demo {</font></div><div><font style="font-size: 12pt;">  width: 80px;</font></div><div><font style="font-size: 12pt;">} */</font></div><div><font style="font-size: 12pt;">.el-submenu .el-menu-item {</font></div><div><font style="font-size: 12pt;">  min-width: 180px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.hiddenDropdown,</font></div><div><font style="font-size: 12pt;">.hiddenDropname {</font></div><div><font style="font-size: 12pt;">  display: none;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">a {</font></div><div><font style="font-size: 12pt;">  text-decoration: none;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">components/bus.js</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">import Vue from &quot;vue&quot;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">// 使用 Event Bus</font></div><div><font style="font-size: 12pt;">const bus = new Vue()</font></div><div><font style="font-size: 12pt;">// 导出 bus</font></div><div><font style="font-size: 12pt;">export default bus</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">views/Home.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;home&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;container&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;h1 class=&quot;title&quot;&gt;电 影&lt;/h1&gt;</font></div><div><font style="font-size: 12pt;">      &lt;p class=&quot;slogan&quot;&gt;&lt;/p&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import Typed from 'typed.js'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'home',</font></div><div><font style="font-size: 12pt;">  mounted() {</font></div><div><font style="font-size: 12pt;">    let typed = new Typed('.slogan', {</font></div><div><font style="font-size: 12pt;">      strings: ['窗户和镜子、故事和梦'],</font></div><div><font style="font-size: 12pt;">      typeSpeed: 250,</font></div><div><font style="font-size: 12pt;">      backSpeed: 250,</font></div><div><font style="font-size: 12pt;">      loop: true,</font></div><div><font style="font-size: 12pt;">    })</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.home {</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">  background: url(../assets/showcase.jpg) no-repeat center center;</font></div><div><font style="font-size: 12pt;">  background-size: 100% 100%;</font></div><div><font style="font-size: 12pt;">  overflow: hidden;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.container {</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">  box-sizing: border-box;</font></div><div><font style="font-size: 12pt;">  padding-top: 100px;</font></div><div><font style="font-size: 12pt;">  background-color: rgba(0, 0, 0, 0.7);</font></div><div><font style="font-size: 12pt;">  text-align: center;</font></div><div><font style="font-size: 12pt;">  color: white;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.title {</font></div><div><font style="font-size: 12pt;">  font-size: 30px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.slogan {</font></div><div><font style="font-size: 12pt;">  display: inline-block;</font></div><div><font style="font-size: 12pt;">  margin-top: 50px;</font></div><div><font style="font-size: 12pt;">  font-size: 22px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">utils/</span><span style="font-size: 12pt; font-weight: bold;">formatDate.js</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">export function formatDate(value) {</font></div><div><font style="font-size: 12pt;">  if (value === &quot;&quot;) {</font></div><div><font style="font-size: 12pt;">    //解决 value 为空传1970-01-01 00:00:00</font></div><div><font style="font-size: 12pt;">    return &quot;&quot;</font></div><div><font style="font-size: 12pt;">  } else {</font></div><div><font style="font-size: 12pt;">    const d = new Date(value).toJSON()</font></div><div><font style="font-size: 12pt;">    const date = new Date(+new Date(d) + 8 * 3600 * 1000)</font></div><div><font style="font-size: 12pt;">      .toISOString()</font></div><div><font style="font-size: 12pt;">      .replace(/T/g, &quot; &quot;)</font></div><div><font style="font-size: 12pt;">      .replace(/\.[\d]{3}Z/, &quot;&quot;)</font></div><div><font style="font-size: 12pt;">    return date</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">};</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">views/FundList.vue</span></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;fillContainer&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;fundList-content&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;!-- 设置 inline 属性让表单域变为一行显示--&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-form :inline=&quot;true&quot; ref=&quot;add_data&quot; :model=&quot;searchData&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-form-item label=&quot;按时间筛选:&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-date-picker</font></div><div><font style="font-size: 12pt;">            v-model=&quot;searchData.startTime&quot;</font></div><div><font style="font-size: 12pt;">            type=&quot;datetime&quot;</font></div><div><font style="font-size: 12pt;">            placeholder=&quot;选择开始时间&quot;</font></div><div><font style="font-size: 12pt;">            @change=&quot;changeStart&quot;</font></div><div><font style="font-size: 12pt;">          &gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-date-picker&gt;</font></div><div><font style="font-size: 12pt;">          --</font></div><div><font style="font-size: 12pt;">          &lt;el-date-picker</font></div><div><font style="font-size: 12pt;">            v-model=&quot;searchData.endTime&quot;</font></div><div><font style="font-size: 12pt;">            type=&quot;datetime&quot;</font></div><div><font style="font-size: 12pt;">            placeholder=&quot;选择结束时间&quot;</font></div><div><font style="font-size: 12pt;">            @change=&quot;changeEnd&quot;</font></div><div><font style="font-size: 12pt;">          &gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-date-picker&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-button</font></div><div><font style="font-size: 12pt;">            class=&quot;search&quot;</font></div><div><font style="font-size: 12pt;">            type=&quot;primary&quot;</font></div><div><font style="font-size: 12pt;">            size=&quot;small&quot;</font></div><div><font style="font-size: 12pt;">            @click=&quot;handleSearch&quot;</font></div><div><font style="font-size: 12pt;">            &gt;筛选&lt;/el-button</font></div><div><font style="font-size: 12pt;">          &gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-form-item&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-input placeholder=&quot;输入描述&quot; v-model=&quot;search&quot; clearable&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-button</font></div><div><font style="font-size: 12pt;">              slot=&quot;append&quot;</font></div><div><font style="font-size: 12pt;">              icon=&quot;el-icon-search&quot;</font></div><div><font style="font-size: 12pt;">              @click=&quot;searchItem&quot;</font></div><div><font style="font-size: 12pt;">            &gt;&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-form-item class=&quot;btnRight&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-button</font></div><div><font style="font-size: 12pt;">            v-if=&quot;user.identity === 'manager'&quot;</font></div><div><font style="font-size: 12pt;">            type=&quot;primary&quot;</font></div><div><font style="font-size: 12pt;">            size=&quot;small&quot;</font></div><div><font style="font-size: 12pt;">            @click=&quot;handleAdd&quot;</font></div><div><font style="font-size: 12pt;">            &gt;添加&lt;/el-button</font></div><div><font style="font-size: 12pt;">          &gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-button</font></div><div><font style="font-size: 12pt;">            v-if=&quot;user.identity === 'manager'&quot;</font></div><div><font style="font-size: 12pt;">            :disabled=&quot;!multipleSelectionFlag&quot;</font></div><div><font style="font-size: 12pt;">            type=&quot;danger&quot;</font></div><div><font style="font-size: 12pt;">            size=&quot;small&quot;</font></div><div><font style="font-size: 12pt;">            icon=&quot;el-icon-delete&quot;</font></div><div><font style="font-size: 12pt;">            class=&quot;handle-del ml10&quot;</font></div><div><font style="font-size: 12pt;">            @click=&quot;delAllSelection&quot;</font></div><div><font style="font-size: 12pt;">            &gt;批量删除&lt;/el-button</font></div><div><font style="font-size: 12pt;">          &gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-form&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;!-- 设置最大高度 400 ，宽度 100% --&gt;</font></div><div><font style="font-size: 12pt;">    &lt;!-- data 为显示的数据 --&gt;</font></div><div><font style="font-size: 12pt;">    &lt;el-table</font></div><div><font style="font-size: 12pt;">      v-if=&quot;tableData.length &gt; 0&quot;</font></div><div><font style="font-size: 12pt;">      :default-sort=&quot;{ prop: 'date', order: 'ascending' }&quot;</font></div><div><font style="font-size: 12pt;">      max-height=&quot;400&quot;</font></div><div><font style="font-size: 12pt;">      border</font></div><div><font style="font-size: 12pt;">      :data=&quot;tableData&quot;</font></div><div><font style="font-size: 12pt;">      style=&quot;width: 100%&quot;</font></div><div><font style="font-size: 12pt;">      @selection-change=&quot;handleSelectionChange&quot;</font></div><div><font style="font-size: 12pt;">      @row-click=&quot;rowClick&quot;</font></div><div><font style="font-size: 12pt;">      :row-style=&quot;rowStyle&quot;</font></div><div><font style="font-size: 12pt;">      :row-class-name=&quot;rowClassName&quot;</font></div><div><font style="font-size: 12pt;">      ref=&quot;multipleTable&quot;</font></div><div><font style="font-size: 12pt;">    &gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column type=&quot;selection&quot; width=&quot;50&quot; align=&quot;center&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column type=&quot;index&quot; label=&quot;序号&quot; width=&quot;50&quot; align=&quot;center&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column</font></div><div><font style="font-size: 12pt;">        prop=&quot;date&quot;</font></div><div><font style="font-size: 12pt;">        label=&quot;创建时间&quot;</font></div><div><font style="font-size: 12pt;">        align=&quot;center&quot;</font></div><div><font style="font-size: 12pt;">        width=&quot;190&quot;</font></div><div><font style="font-size: 12pt;">        sortable</font></div><div><font style="font-size: 12pt;">      &gt;</font></div><div><font style="font-size: 12pt;">        &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-icon name=&quot;time&quot;&gt;&lt;/el-icon&gt;</font></div><div><font style="font-size: 12pt;">          &lt;span style=&quot;margin-left: 10px&quot;&gt;{{ scope.row.date | showDate }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column prop=&quot;type&quot; label=&quot;收支类型&quot; align=&quot;center&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column prop=&quot;desc&quot; label=&quot;收支描述&quot; align=&quot;center&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;span&gt;{{ scope.row.desc }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column prop=&quot;income&quot; label=&quot;收入&quot; align=&quot;center&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;span style=&quot;color:#00d053&quot;&gt;+ {{ scope.row.income }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column prop=&quot;expenses&quot; label=&quot;支出&quot; align=&quot;center&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;span style=&quot;color:#f56767&quot;&gt;- {{ scope.row.expenses }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column prop=&quot;cash&quot; label=&quot;账户现金&quot; align=&quot;center&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;span style=&quot;color:#4db3ff&quot;&gt;{{ scope.row.cash }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column prop=&quot;remark&quot; label=&quot;备注&quot; align=&quot;center&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; fixed=&quot;right&quot; width=&quot;150&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-button</font></div><div><font style="font-size: 12pt;">            v-if=&quot;user.identity === 'manager'&quot;</font></div><div><font style="font-size: 12pt;">            size=&quot;small&quot;</font></div><div><font style="font-size: 12pt;">            type=&quot;info&quot;</font></div><div><font style="font-size: 12pt;">            @click=&quot;handleEdit(scope.$index, scope.row)&quot;</font></div><div><font style="font-size: 12pt;">            &gt;编辑&lt;/el-button</font></div><div><font style="font-size: 12pt;">          &gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-button</font></div><div><font style="font-size: 12pt;">            v-if=&quot;user.identity === 'manager'&quot;</font></div><div><font style="font-size: 12pt;">            size=&quot;small&quot;</font></div><div><font style="font-size: 12pt;">            type=&quot;danger&quot;</font></div><div><font style="font-size: 12pt;">            @click=&quot;handleDelete(scope.$index, scope.row)&quot;</font></div><div><font style="font-size: 12pt;">            &gt;删除&lt;/el-button</font></div><div><font style="font-size: 12pt;">          &gt;</font></div><div><font style="font-size: 12pt;">        &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/el-table&gt;</font></div><div><font style="font-size: 12pt;">    &lt;!-- 分页 --&gt;</font></div><div><font style="font-size: 12pt;">    &lt;el-row&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-col :span=&quot;24&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;div class=&quot;pagination&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-pagination</font></div><div><font style="font-size: 12pt;">            v-if=&quot;paginations.total &gt; 0&quot;</font></div><div><font style="font-size: 12pt;">            :total=&quot;paginations.total&quot;</font></div><div><font style="font-size: 12pt;">            :page-size=&quot;paginations.page_size&quot;</font></div><div><font style="font-size: 12pt;">            :current-page.sync=&quot;paginations.page_index&quot;</font></div><div><font style="font-size: 12pt;">            :page-sizes=&quot;paginations.page_sizes&quot;</font></div><div><font style="font-size: 12pt;">            :layout=&quot;paginations.layout&quot;</font></div><div><font style="font-size: 12pt;">            @size-change=&quot;handleSizeChange&quot;</font></div><div><font style="font-size: 12pt;">            @current-change=&quot;handleCurrentChange&quot;</font></div><div><font style="font-size: 12pt;">          &gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-pagination&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-col&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/el-row&gt;</font></div><div><font style="font-size: 12pt;">    &lt;Add-Dialog</font></div><div><font style="font-size: 12pt;">      :dialog=&quot;dialog&quot;</font></div><div><font style="font-size: 12pt;">      :formData=&quot;formData&quot;</font></div><div><font style="font-size: 12pt;">      @update=&quot;getFundList&quot;</font></div><div><font style="font-size: 12pt;">    &gt;&lt;/Add-Dialog&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">import AddDialog from '../components/AddDialog'</font></div><div><font style="font-size: 12pt;">import { formatDate } from '../utils/formatDate'</font></div><div><font style="font-size: 12pt;">// import bus from '../components/bus'</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'fundlist',</font></div><div><font style="font-size: 12pt;">  components: {</font></div><div><font style="font-size: 12pt;">    AddDialog,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  computed: {</font></div><div><font style="font-size: 12pt;">    user() {</font></div><div><font style="font-size: 12pt;">      return this.$store.getters.user</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      // 根据日期搜索的时间数据</font></div><div><font style="font-size: 12pt;">      searchData: {</font></div><div><font style="font-size: 12pt;">        startTime: '',</font></div><div><font style="font-size: 12pt;">        endTime: '',</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // 默认是否折叠</font></div><div><font style="font-size: 12pt;">      // collapse: false,</font></div><div><font style="font-size: 12pt;">      // 搜索描述字符串</font></div><div><font style="font-size: 12pt;">      search: '',</font></div><div><font style="font-size: 12pt;">      // start: false,</font></div><div><font style="font-size: 12pt;">      // end: false,</font></div><div><font style="font-size: 12pt;">      // 搜索（过滤）表单的数据</font></div><div><font style="font-size: 12pt;">      filterTableData: [],</font></div><div><font style="font-size: 12pt;">      // 所有分页的数据</font></div><div><font style="font-size: 12pt;">      allTableData: [],</font></div><div><font style="font-size: 12pt;">      // 当前分页的数据</font></div><div><font style="font-size: 12pt;">      tableData: [],</font></div><div><font style="font-size: 12pt;">      // 删除的表单数据</font></div><div><font style="font-size: 12pt;">      delList: [],</font></div><div><font style="font-size: 12pt;">      // 选中的表格行</font></div><div><font style="font-size: 12pt;">      selectionRow: [],</font></div><div><font style="font-size: 12pt;">      multipleSelection: [],</font></div><div><font style="font-size: 12pt;">      multipleSelectionFlag: false,</font></div><div><font style="font-size: 12pt;">      // 表单数据</font></div><div><font style="font-size: 12pt;">      formData: {</font></div><div><font style="font-size: 12pt;">        type: '',</font></div><div><font style="font-size: 12pt;">        desc: '',</font></div><div><font style="font-size: 12pt;">        income: '',</font></div><div><font style="font-size: 12pt;">        expenses: '',</font></div><div><font style="font-size: 12pt;">        cash: '',</font></div><div><font style="font-size: 12pt;">        remark: '',</font></div><div><font style="font-size: 12pt;">        id: '',</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // 弹出框默认为编辑弹出框且不显示</font></div><div><font style="font-size: 12pt;">      dialog: {</font></div><div><font style="font-size: 12pt;">        show: false,</font></div><div><font style="font-size: 12pt;">        title: '',</font></div><div><font style="font-size: 12pt;">        option: 'edit',</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // 分页器</font></div><div><font style="font-size: 12pt;">      paginations: {</font></div><div><font style="font-size: 12pt;">        total: 0,      // 总页数</font></div><div><font style="font-size: 12pt;">        page_size: 5,  // 一页显示多少条</font></div><div><font style="font-size: 12pt;">        page_index: 1, // 当前位于哪页，默认显示第一页</font></div><div><font style="font-size: 12pt;">        page_sizes: [5, 10, 15, 20], // 选择一页显示多少条</font></div><div><font style="font-size: 12pt;">        layout: 'total, sizes, prev, pager, next, jumper', // 组件分页布局</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  // 创建组件时显示资金流水</font></div><div><font style="font-size: 12pt;">  created() {</font></div><div><font style="font-size: 12pt;">    this.getFundList()</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  // 当搜索描述没有值时刷新表单，watch专门处理异步</font></div><div><font style="font-size: 12pt;">  watch: {</font></div><div><font style="font-size: 12pt;">    search: function(newVal) {</font></div><div><font style="font-size: 12pt;">      if (newVal === '') {</font></div><div><font style="font-size: 12pt;">        this.getFundList()</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    // 获取列表数据</font></div><div><font style="font-size: 12pt;">    getFundList() {</font></div><div><font style="font-size: 12pt;">      this.$axios</font></div><div><font style="font-size: 12pt;">        .get('/profiles')</font></div><div><font style="font-size: 12pt;">        .then((res) =&gt; {</font></div><div><font style="font-size: 12pt;">          this.allTableData = res.data</font></div><div><font style="font-size: 12pt;">          // 先获取所有数据作为要过滤的数据</font></div><div><font style="font-size: 12pt;">          this.filterTableData = res.data</font></div><div><font style="font-size: 12pt;">          // console.log(res.data)</font></div><div><font style="font-size: 12pt;">          // 显示分页数据</font></div><div><font style="font-size: 12pt;">          this.setPagination()</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">        .catch((err) =&gt; console.log(err))</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 初始化第一页数据和分页器数据</font></div><div><font style="font-size: 12pt;">    setPagination() {</font></div><div><font style="font-size: 12pt;">      // 根据表单的数据总数来决定分页数据的总数</font></div><div><font style="font-size: 12pt;">      this.paginations.total = this.allTableData.length</font></div><div><font style="font-size: 12pt;">      // 初始一页显示的数据条数为 5</font></div><div><font style="font-size: 12pt;">      this.paginations.page_size = 5</font></div><div><font style="font-size: 12pt;">      // 初始分页数据为第一页数据</font></div><div><font style="font-size: 12pt;">      this.tableData = this.allTableData.filter((item, index) =&gt; {</font></div><div><font style="font-size: 12pt;">        return index &lt; this.paginations.page_size</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">      // console.log(this.tableData)</font></div><div><font style="font-size: 12pt;">      // 当跳转到其他分页时执行 handleCurrentChange</font></div><div><font style="font-size: 12pt;">      this.handleCurrentChange(this.paginations.page_index)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // page 前往第几页的页数，即当前页</font></div><div><font style="font-size: 12pt;">    handleCurrentChange(page) {</font></div><div><font style="font-size: 12pt;">      // console.log(this.paginations.page_index)</font></div><div><font style="font-size: 12pt;">      // 获取当前页（第 page 页）的第一条数据 第一页第一条数据：5 * 0 = 0，第二页第一条数据：5 * 1 = 5</font></div><div><font style="font-size: 12pt;">      let index = this.paginations.page_size * (page - 1)</font></div><div><font style="font-size: 12pt;">      // 获取当前页（第 page 页）最大条数（即下一页第一条数据） 第一页数据最大条数：5 * 1 = 5</font></div><div><font style="font-size: 12pt;">      let nums = this.paginations.page_size * page</font></div><div><font style="font-size: 12pt;">      // tables 数组当前页的所有数据</font></div><div><font style="font-size: 12pt;">      let tables = []</font></div><div><font style="font-size: 12pt;">      for (let i = index; i &lt; nums; i++) {</font></div><div><font style="font-size: 12pt;">        // 如果 this.allTableData 有当前页的数据，则存放在 tables 里</font></div><div><font style="font-size: 12pt;">        if (this.allTableData[i]) {</font></div><div><font style="font-size: 12pt;">          tables.push(this.allTableData[i])</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      this.tableData = tables</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 过滤日期格式</font></div><div><font style="font-size: 12pt;">    filters: {</font></div><div><font style="font-size: 12pt;">      showDate: function(value) {</font></div><div><font style="font-size: 12pt;">        let date = new Date(value * 1000)</font></div><div><font style="font-size: 12pt;">        return formatDate(value)</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // size 切换一页显示多少条的条数 例如 5 条切换为 10 条</font></div><div><font style="font-size: 12pt;">    handleSizeChange(size) {</font></div><div><font style="font-size: 12pt;">      this.paginations.page_index = 1</font></div><div><font style="font-size: 12pt;">      this.paginations.page_size = size</font></div><div><font style="font-size: 12pt;">      // 初始分页数据为第一页数据</font></div><div><font style="font-size: 12pt;">      this.tableData = this.allTableData.filter((item, index) =&gt; {</font></div><div><font style="font-size: 12pt;">        return index &lt; size</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 当选择项发生变化时会触发选择高亮操作</font></div><div><font style="font-size: 12pt;">    handleSelectionChange(val) {</font></div><div><font style="font-size: 12pt;">      this.selectionRow = val      // 数组保存已选择行</font></div><div><font style="font-size: 12pt;">      this.multipleSelection = val // 数组保存已选择行</font></div><div><font style="font-size: 12pt;">      // console.log(this.multipleSelection)</font></div><div><font style="font-size: 12pt;">      if (this.multipleSelection.length &gt; 1) {</font></div><div><font style="font-size: 12pt;">        this.multipleSelectionFlag = true</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      if (this.multipleSelection.length === 0) {</font></div><div><font style="font-size: 12pt;">        this.multipleSelectionFlag = false</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 高亮选中行</font></div><div><font style="font-size: 12pt;">    rowClick(row, column, event) {</font></div><div><font style="font-size: 12pt;">      let refsTable = this.$refs.multipleTable // 获取表格对象</font></div><div><font style="font-size: 12pt;">      let findRow = this.selectionRow.find(</font></div><div><font style="font-size: 12pt;">        (item) =&gt; item.rowIndex === row.rowIndex</font></div><div><font style="font-size: 12pt;">      )</font></div><div><font style="font-size: 12pt;">      if (findRow) {</font></div><div><font style="font-size: 12pt;">        refsTable.toggleRowSelection(row, false)</font></div><div><font style="font-size: 12pt;">        return</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      refsTable.clearSelection()</font></div><div><font style="font-size: 12pt;">      refsTable.toggleRowSelection(row) // 调用选中行方法</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    rowStyle({ row, rowIndex }) {</font></div><div><font style="font-size: 12pt;">      Object.defineProperty(row, 'rowIndex', {</font></div><div><font style="font-size: 12pt;">        //给每一行添加不可枚举属性 rowIndex 来标识当前行</font></div><div><font style="font-size: 12pt;">        value: rowIndex,</font></div><div><font style="font-size: 12pt;">        writable: true,</font></div><div><font style="font-size: 12pt;">        enumerable: false,</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    rowClassName({ row, rowIndex }) {</font></div><div><font style="font-size: 12pt;">      let rowName = '',</font></div><div><font style="font-size: 12pt;">        findRow = this.selectionRow.find((c) =&gt; c.rowIndex === row.rowIndex)</font></div><div><font style="font-size: 12pt;">      if (findRow) {</font></div><div><font style="font-size: 12pt;">        rowName = 'current-row ' // elementUI 默认高亮行的class类 不用再样式了^-^,也可通过css覆盖改变背景颜色</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      return rowName //也可以再加上其他类名 如果有需求的话</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 添加操作</font></div><div><font style="font-size: 12pt;">    handleAdd() {</font></div><div><font style="font-size: 12pt;">      this.dialog.show = true</font></div><div><font style="font-size: 12pt;">      this.dialog = {</font></div><div><font style="font-size: 12pt;">        show: true,</font></div><div><font style="font-size: 12pt;">        title: '添加资金信息',</font></div><div><font style="font-size: 12pt;">        option: 'add',</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      this.formData = {</font></div><div><font style="font-size: 12pt;">        type: '',</font></div><div><font style="font-size: 12pt;">        desc: '',</font></div><div><font style="font-size: 12pt;">        income: '',</font></div><div><font style="font-size: 12pt;">        expenses: '',</font></div><div><font style="font-size: 12pt;">        cash: '',</font></div><div><font style="font-size: 12pt;">        remark: '',</font></div><div><font style="font-size: 12pt;">        _id: '',</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 编辑操作</font></div><div><font style="font-size: 12pt;">    handleEdit(index, row) {</font></div><div><font style="font-size: 12pt;">      // 编辑弹出框</font></div><div><font style="font-size: 12pt;">      this.dialog = {</font></div><div><font style="font-size: 12pt;">        show: true,</font></div><div><font style="font-size: 12pt;">        title: '修改资金信息',</font></div><div><font style="font-size: 12pt;">        option: 'edit',</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">      this.formData = {</font></div><div><font style="font-size: 12pt;">        type: row.type,</font></div><div><font style="font-size: 12pt;">        desc: row.desc,</font></div><div><font style="font-size: 12pt;">        income: row.income,</font></div><div><font style="font-size: 12pt;">        expenses: row.expenses,</font></div><div><font style="font-size: 12pt;">        cash: row.cash,</font></div><div><font style="font-size: 12pt;">        remark: row.remark,</font></div><div><font style="font-size: 12pt;">        _id: row._id,</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 删除操作</font></div><div><font style="font-size: 12pt;">    handleDelete(index, row) {</font></div><div><font style="font-size: 12pt;">      // 二次确认删除</font></div><div><font style="font-size: 12pt;">      this.$confirm('确定要删除吗？', '提示', {</font></div><div><font style="font-size: 12pt;">        type: 'warning',</font></div><div><font style="font-size: 12pt;">        cancelButtonClass: 'btn-custom-cancel',</font></div><div><font style="font-size: 12pt;">        confirmButtonText: '确定',</font></div><div><font style="font-size: 12pt;">        cancelButtonText: '取消',</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">        .then(() =&gt; {</font></div><div><font style="font-size: 12pt;">          this.$axios.delete(`/profiles/delete/${row._id}`).then((res) =&gt; {</font></div><div><font style="font-size: 12pt;">            this.$message({</font></div><div><font style="font-size: 12pt;">              message: '数据删除成功',</font></div><div><font style="font-size: 12pt;">              type: 'success',</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">            this.jumpRefresh()</font></div><div><font style="font-size: 12pt;">          })</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">        .catch(() =&gt; {</font></div><div><font style="font-size: 12pt;">          this.$message({</font></div><div><font style="font-size: 12pt;">            type: 'info',</font></div><div><font style="font-size: 12pt;">            message: '已取消删除',</font></div><div><font style="font-size: 12pt;">          })</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 批量删除操作</font></div><div><font style="font-size: 12pt;">    delAllSelection() {</font></div><div><font style="font-size: 12pt;">      // 二次确认删除</font></div><div><font style="font-size: 12pt;">      this.$confirm('确定要批量删除吗？', '提示', {</font></div><div><font style="font-size: 12pt;">        type: 'warning',</font></div><div><font style="font-size: 12pt;">        cancelButtonClass: 'btn-custom-cancel',</font></div><div><font style="font-size: 12pt;">        confirmButtonText: '确定',</font></div><div><font style="font-size: 12pt;">        cancelButtonText: '取消',</font></div><div><font style="font-size: 12pt;">      }).then(() =&gt; {</font></div><div><font style="font-size: 12pt;">        let checkArr = this.multipleSelection // multipleSelection存储了勾选到的数据</font></div><div><font style="font-size: 12pt;">        let params = []</font></div><div><font style="font-size: 12pt;">        checkArr.forEach(function(item) {</font></div><div><font style="font-size: 12pt;">          params.push(item._id) // 添加所有需要删除数据的id到一个数组，post提交过去</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">        this.$axios</font></div><div><font style="font-size: 12pt;">          .post('/profiles/multiDelete', params)</font></div><div><font style="font-size: 12pt;">          .then((res) =&gt; {</font></div><div><font style="font-size: 12pt;">            this.$message({</font></div><div><font style="font-size: 12pt;">              message: '数据批量删除成功',</font></div><div><font style="font-size: 12pt;">              type: 'success',</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">            this.jumpRefresh()</font></div><div><font style="font-size: 12pt;">          })</font></div><div><font style="font-size: 12pt;">          .catch(() =&gt; {</font></div><div><font style="font-size: 12pt;">            this.$message({</font></div><div><font style="font-size: 12pt;">              type: 'info',</font></div><div><font style="font-size: 12pt;">              message: '已取消删除',</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">          })</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 删除后自动跳转刷新</font></div><div><font style="font-size: 12pt;">    jumpRefresh() {</font></div><div><font style="font-size: 12pt;">      // totalPage 获取删除后的总页数，Math.ceil 返回大于或等于一个给定数字的最小整数</font></div><div><font style="font-size: 12pt;">      // const totalPage = Math.ceil(</font></div><div><font style="font-size: 12pt;">      //   (this.allTableData.length - 1) / this.paginations.page_size</font></div><div><font style="font-size: 12pt;">      // )</font></div><div><font style="font-size: 12pt;">      // // pageNum 获取删除后要跳转的页码 如果当前页码大于总页数，则删除后要跳转的页码为总页数</font></div><div><font style="font-size: 12pt;">      // const pageNum =</font></div><div><font style="font-size: 12pt;">      //   this.paginations.page_index &gt; totalPage</font></div><div><font style="font-size: 12pt;">      //     ? totalPage</font></div><div><font style="font-size: 12pt;">      //     : this.paginations.page_index</font></div><div><font style="font-size: 12pt;">      // // 删除后要跳转的页码只可以大于或等于 1</font></div><div><font style="font-size: 12pt;">      // this.pageIndex = pageNum &lt; 1 ? 1 : pageNum</font></div><div><font style="font-size: 12pt;">      this.getFundList()</font></div><div><font style="font-size: 12pt;">      this.handleCurrentChange(this.paginations.page_index)</font></div><div><font style="font-size: 12pt;">      this.getFundList()</font></div><div><font style="font-size: 12pt;">    },    </font></div><div><font style="font-size: 12pt;">    // 按时间筛选操作</font></div><div><font style="font-size: 12pt;">    handleSearch() {</font></div><div><font style="font-size: 12pt;">      if (!this.searchData.startTime || !this.searchData.endTime) {</font></div><div><font style="font-size: 12pt;">        this.$message({</font></div><div><font style="font-size: 12pt;">          type: 'warning',</font></div><div><font style="font-size: 12pt;">          message: '请选择时间区间',</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">        this.getFundList()</font></div><div><font style="font-size: 12pt;">        return</font></div><div><font style="font-size: 12pt;">      } else {</font></div><div><font style="font-size: 12pt;">        // 获取开始时间（毫秒数）</font></div><div><font style="font-size: 12pt;">        const sTime = this.searchData.startTime.getTime()</font></div><div><font style="font-size: 12pt;">        // 获取结束时间（毫秒数）</font></div><div><font style="font-size: 12pt;">        const eTime = this.searchData.endTime.getTime()</font></div><div><font style="font-size: 12pt;">        // 过滤数据</font></div><div><font style="font-size: 12pt;">        this.allTableData = this.filterTableData.filter((item) =&gt; {</font></div><div><font style="font-size: 12pt;">          // 获取每条数据的毫秒数</font></div><div><font style="font-size: 12pt;">          let date = new Date(item.date)</font></div><div><font style="font-size: 12pt;">          let time = date.getTime()</font></div><div><font style="font-size: 12pt;">          // 筛选出大于等于开始时间并小于等于结束时间的数据</font></div><div><font style="font-size: 12pt;">          return time &gt;= sTime &amp;&amp; time &lt;= eTime</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">        this.setPagination()</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 当开始时间为空时则刷新列表</font></div><div><font style="font-size: 12pt;">    changeStart(val) {</font></div><div><font style="font-size: 12pt;">      if (val === null) {</font></div><div><font style="font-size: 12pt;">        val = ''</font></div><div><font style="font-size: 12pt;">        this.getFundList()</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    // 当结束时间为空时则刷新列表</font></div><div><font style="font-size: 12pt;">    changeEnd(val) {</font></div><div><font style="font-size: 12pt;">      if (val === null) {</font></div><div><font style="font-size: 12pt;">        val = ''</font></div><div><font style="font-size: 12pt;">        this.getFundList()</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },      </font></div><div><font style="font-size: 12pt;">    // 搜索描述</font></div><div><font style="font-size: 12pt;">    searchItem() {</font></div><div><font style="font-size: 12pt;">      // 如果没有输入内容则提示</font></div><div><font style="font-size: 12pt;">      if (!this.search) {</font></div><div><font style="font-size: 12pt;">        this.$message({</font></div><div><font style="font-size: 12pt;">          type: 'warning',</font></div><div><font style="font-size: 12pt;">          message: '请输入描述',</font></div><div><font style="font-size: 12pt;">        })</font></div><div><font style="font-size: 12pt;">        this.getFundList()</font></div><div><font style="font-size: 12pt;">        return</font></div><div><font style="font-size: 12pt;">      } else {</font></div><div><font style="font-size: 12pt;">        this.allTableData = this.filterTableData.filter((data) =&gt;</font></div><div><font style="font-size: 12pt;">          data.desc.toLowerCase().includes(this.search.toLowerCase())</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">        // 如果没有搜索到内容则提示</font></div><div><font style="font-size: 12pt;">        if (this.allTableData.length === 0) {</font></div><div><font style="font-size: 12pt;">          this.$message({</font></div><div><font style="font-size: 12pt;">            type: 'warning',</font></div><div><font style="font-size: 12pt;">            message: '没有搜索结果',</font></div><div><font style="font-size: 12pt;">          })</font></div><div><font style="font-size: 12pt;">          this.search = ''</font></div><div><font style="font-size: 12pt;">          this.getFundList()</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        this.setPagination()</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.fillContainer {</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">  padding: 16px;</font></div><div><font style="font-size: 12pt;">  box-sizing: border-box;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.fundList-content {</font></div><div><font style="font-size: 12pt;">  padding: 10px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.btnRight {</font></div><div><font style="font-size: 12pt;">  float: right;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.pagination {</font></div><div><font style="font-size: 12pt;">  text-align: right;</font></div><div><font style="font-size: 12pt;">  margin-top: 10px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.search {</font></div><div><font style="font-size: 12pt;">  margin-left: 10px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.ml10 {</font></div><div><font style="font-size: 12pt;">  margin-left: 10px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">.btn-custom-cancel {</font></div><div><font style="font-size: 12pt;">  float: right;</font></div><div><font style="font-size: 12pt;">  margin-left: 10px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">components/AddDialog.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;dialog&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;el-dialog</font></div><div><font style="font-size: 12pt;">      :title=&quot;dialog.title&quot;</font></div><div><font style="font-size: 12pt;">      :visible.sync=&quot;dialog.show&quot;</font></div><div><font style="font-size: 12pt;">      :close-on-click-modal=&quot;false&quot;</font></div><div><font style="font-size: 12pt;">      :close-on-press-escape=&quot;false&quot;</font></div><div><font style="font-size: 12pt;">      :modal-append-to-body=&quot;false&quot;</font></div><div><font style="font-size: 12pt;">      class=&quot;above_dialog&quot;</font></div><div><font style="font-size: 12pt;">    &gt;</font></div><div><font style="font-size: 12pt;">      &lt;div class=&quot;form&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-form</font></div><div><font style="font-size: 12pt;">          ref=&quot;form&quot;</font></div><div><font style="font-size: 12pt;">          :model=&quot;formData&quot;</font></div><div><font style="font-size: 12pt;">          :rules=&quot;form_rules&quot;</font></div><div><font style="font-size: 12pt;">          label-width=&quot;120px&quot;</font></div><div><font style="font-size: 12pt;">          style=&quot;margin:10px&quot;</font></div><div><font style="font-size: 12pt;">        &gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-formItem label=&quot;收支类型:&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-select v-model=&quot;formData.type&quot; placeholder=&quot;收支类型&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-option</font></div><div><font style="font-size: 12pt;">                v-for=&quot;(formtype, index) in form_type_list&quot;</font></div><div><font style="font-size: 12pt;">                :key=&quot;index&quot;</font></div><div><font style="font-size: 12pt;">                :label=&quot;formtype&quot;</font></div><div><font style="font-size: 12pt;">                :value=&quot;formtype&quot;</font></div><div><font style="font-size: 12pt;">              &gt;</font></div><div><font style="font-size: 12pt;">              &lt;/el-option&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-select&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-formItem&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">          &lt;el-formItem label=&quot;收支描述:&quot; prop=&quot;desc&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input type=&quot;desc&quot; v-model=&quot;formData.desc&quot;&gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-formItem&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;收入:&quot; prop=&quot;income&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input type=&quot;income&quot; v-model=&quot;formData.income&quot;&gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;支出:&quot; prop=&quot;expenses&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input type=&quot;expenses&quot; v-model=&quot;formData.expenses&quot;&gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;账户现金:&quot; prop=&quot;cash&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input type=&quot;cash&quot; v-model=&quot;formData.cash&quot;&gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">          &lt;el-form-item label=&quot;备注:&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-input</font></div><div><font style="font-size: 12pt;">              type=&quot;textarea remark&quot;</font></div><div><font style="font-size: 12pt;">              v-model=&quot;formData.remark&quot;</font></div><div><font style="font-size: 12pt;">            &gt;&lt;/el-input&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">          &lt;el-form-item class=&quot;&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm('form')&quot;</font></div><div><font style="font-size: 12pt;">              &gt;提 交&lt;/el-button</font></div><div><font style="font-size: 12pt;">            &gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-button @click=&quot;dialog.show = false&quot;&gt;取 消&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-form-item&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-form&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/el-dialog&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  // 问题 组件名不可以与 html元素同名</font></div><div><font style="font-size: 12pt;">  name: 'add-dialog',</font></div><div><font style="font-size: 12pt;">  props: {</font></div><div><font style="font-size: 12pt;">    dialog: Object,</font></div><div><font style="font-size: 12pt;">    formData: Object,</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      form_type_list: [</font></div><div><font style="font-size: 12pt;">        '电影',</font></div><div><font style="font-size: 12pt;">        '提现',</font></div><div><font style="font-size: 12pt;">        '提现手续费',</font></div><div><font style="font-size: 12pt;">        '充值',</font></div><div><font style="font-size: 12pt;">        '优惠券',</font></div><div><font style="font-size: 12pt;">        '充值礼券',</font></div><div><font style="font-size: 12pt;">        '转账',</font></div><div><font style="font-size: 12pt;">      ],</font></div><div><font style="font-size: 12pt;">      form_rules: {</font></div><div><font style="font-size: 12pt;">        desc: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '收支描述不能为空！', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        income: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '收入不能为空！', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        expenses: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '支出不能为空！', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        cash: [</font></div><div><font style="font-size: 12pt;">          { required: true, message: '账户现金不能为空！', trigger: 'blur' },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      message: '',</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    submitForm(form) {</font></div><div><font style="font-size: 12pt;">      this.$refs[form].validate((valid) =&gt; {</font></div><div><font style="font-size: 12pt;">        if (valid) {</font></div><div><font style="font-size: 12pt;">          // console.log(this.formData)</font></div><div><font style="font-size: 12pt;">          const url =</font></div><div><font style="font-size: 12pt;">            this.dialog.option === 'add' ? 'add' : `edit/${this.formData._id}`</font></div><div><font style="font-size: 12pt;">          this.message = url === 'add' ? '添加' : '编辑'</font></div><div><font style="font-size: 12pt;">          this.$axios</font></div><div><font style="font-size: 12pt;">            .post(`/profiles/${url}`, this.formData)</font></div><div><font style="font-size: 12pt;">            .then((res) =&gt; {</font></div><div><font style="font-size: 12pt;">              this.$message({</font></div><div><font style="font-size: 12pt;">                message: `数据${this.message}成功`,</font></div><div><font style="font-size: 12pt;">                type: 'success',</font></div><div><font style="font-size: 12pt;">              })</font></div><div><font style="font-size: 12pt;">              this.dialog.show = false</font></div><div><font style="font-size: 12pt;">              this.$emit('update')</font></div><div><font style="font-size: 12pt;">            })</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.above_dialog {</font></div><div><font style="font-size: 12pt;">  display: flex;</font></div><div><font style="font-size: 12pt;">  justify-content: center;</font></div><div><font style="font-size: 12pt;">  align-items: center;</font></div><div><font style="font-size: 12pt;">  overflow: hidden;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.form {</font></div><div><font style="font-size: 12pt;">  height: 70%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div><div><font style="font-size: 12pt;">// 修改 element UI 默认样式</font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">.el-dialog__body {</font></div><div><font style="font-size: 12pt;">  padding: 6px 20px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">components/Echars/barEcharts.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div :id=&quot;id&quot; :style=&quot;{ width: width, height: height }&quot;&gt;&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">// let echarts = require('echarts/lib/echarts')</font></div><div><font style="font-size: 12pt;">// 引入需要使用的图表类型，标题，提示信息等</font></div><div><font style="font-size: 12pt;">// require('echarts/lib/chart/bar')</font></div><div><font style="font-size: 12pt;">// require('echarts/lib/component/legend')</font></div><div><font style="font-size: 12pt;">// require('echarts/lib/component/title')</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'barEchart',</font></div><div><font style="font-size: 12pt;">  props: {</font></div><div><font style="font-size: 12pt;">    id: {</font></div><div><font style="font-size: 12pt;">      type: String,</font></div><div><font style="font-size: 12pt;">      default: 'myChart',</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    width: {</font></div><div><font style="font-size: 12pt;">      type: String,</font></div><div><font style="font-size: 12pt;">      default: '100%',</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    height: {</font></div><div><font style="font-size: 12pt;">      type: String,</font></div><div><font style="font-size: 12pt;">      default: '100%',</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      chart: null,</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  mounted() {</font></div><div><font style="font-size: 12pt;">    this.initChart()</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    initChart() {</font></div><div><font style="font-size: 12pt;">      this.chart = echarts.init(document.getElementById(this.id))</font></div><div><font style="font-size: 12pt;">      this.chart.setOption({</font></div><div><font style="font-size: 12pt;">        title: {</font></div><div><font style="font-size: 12pt;">          text: '最近一周销售统计',</font></div><div><font style="font-size: 12pt;">          left: 'center',</font></div><div><font style="font-size: 12pt;">          top: 2,</font></div><div><font style="font-size: 12pt;">          textStyle: {</font></div><div><font style="font-size: 12pt;">            fontSize: 20,</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        color: ['#4A90E2', '#F5A623', '#FF5858', '#64D572'],</font></div><div><font style="font-size: 12pt;">        grid: {</font></div><div><font style="font-size: 12pt;">          left: '3%',</font></div><div><font style="font-size: 12pt;">          right: '4%',</font></div><div><font style="font-size: 12pt;">          bottom: '10%',</font></div><div><font style="font-size: 12pt;">          containLabel: true,</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        legend: {</font></div><div><font style="font-size: 12pt;">          left: 'center',</font></div><div><font style="font-size: 12pt;">          bottom: '2%',</font></div><div><font style="font-size: 12pt;">          data: ['可口可乐', '爆米花', '薯片'],</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        xAxis: [</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            type: 'category',</font></div><div><font style="font-size: 12pt;">            data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],</font></div><div><font style="font-size: 12pt;">            axisTick: {</font></div><div><font style="font-size: 12pt;">              alignWithLabel: true,</font></div><div><font style="font-size: 12pt;">            },</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        yAxis: [</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            type: 'value',</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">        series: [</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            name: '可口可乐',</font></div><div><font style="font-size: 12pt;">            type: 'bar',</font></div><div><font style="font-size: 12pt;">            data: [10, 52, 200, 334, 390, 330, 220],</font></div><div><font style="font-size: 12pt;">            itemStyle: {</font></div><div><font style="font-size: 12pt;">              normal: {</font></div><div><font style="font-size: 12pt;">                label: {</font></div><div><font style="font-size: 12pt;">                  show: true, //开启显示</font></div><div><font style="font-size: 12pt;">                  position: 'top', //在上方显示</font></div><div><font style="font-size: 12pt;">                  textStyle: { //数值样式</font></div><div><font style="font-size: 12pt;">                    color: '#4A90E2',</font></div><div><font style="font-size: 12pt;">                    fontSize: 12</font></div><div><font style="font-size: 12pt;">                  }</font></div><div><font style="font-size: 12pt;">                }</font></div><div><font style="font-size: 12pt;">              }</font></div><div><font style="font-size: 12pt;">            },</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            name: '爆米花',</font></div><div><font style="font-size: 12pt;">            type: 'bar',</font></div><div><font style="font-size: 12pt;">            data: [10, 52, 200, 334, 390, 330, 220],</font></div><div><font style="font-size: 12pt;">            itemStyle: {</font></div><div><font style="font-size: 12pt;">              normal: {</font></div><div><font style="font-size: 12pt;">                label: {</font></div><div><font style="font-size: 12pt;">                  show: true, //开启显示</font></div><div><font style="font-size: 12pt;">                  position: 'top', //在上方显示</font></div><div><font style="font-size: 12pt;">                  textStyle: { //数值样式</font></div><div><font style="font-size: 12pt;">                    color: '#F5A623',</font></div><div><font style="font-size: 12pt;">                    fontSize: 12</font></div><div><font style="font-size: 12pt;">                  }</font></div><div><font style="font-size: 12pt;">                }</font></div><div><font style="font-size: 12pt;">              }</font></div><div><font style="font-size: 12pt;">            },</font></div><div><font style="font-size: 12pt;">          },</font></div><div><font style="font-size: 12pt;">          {</font></div><div><font style="font-size: 12pt;">            name: '薯片',</font></div><div><font style="font-size: 12pt;">            type: 'bar',</font></div><div><font style="font-size: 12pt;">            data: [10, 52, 200, 334, 390, 330, 220],</font></div><div><font style="font-size: 12pt;">            itemStyle: {</font></div><div><font style="font-size: 12pt;">              normal: {</font></div><div><font style="font-size: 12pt;">                label: {</font></div><div><font style="font-size: 12pt;">                  show: true, //开启显示</font></div><div><font style="font-size: 12pt;">                  position: 'top', //在上方显示</font></div><div><font style="font-size: 12pt;">                  textStyle: { //数值样式</font></div><div><font style="font-size: 12pt;">                    color: '#FF5858',</font></div><div><font style="font-size: 12pt;">                    fontSize: 12</font></div><div><font style="font-size: 12pt;">                  }</font></div><div><font style="font-size: 12pt;">                }</font></div><div><font style="font-size: 12pt;">              }</font></div><div><font style="font-size: 12pt;">            },</font></div><div><font style="font-size: 12pt;">          }          </font></div><div><font style="font-size: 12pt;">        ],</font></div><div><font style="font-size: 12pt;">      })</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">views/Info.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;info&quot;&gt;</font></div><div><font style="font-size: 12pt;">   &lt;el-row :gutter=&quot;20&quot;&gt;</font></div><div><font style="font-size: 12pt;">     &lt;el-col :span=&quot;8&quot;&gt;</font></div><div><font style="font-size: 12pt;">         &lt;el-card shadow=&quot;hover&quot; class=&quot;mgb20&quot; style=&quot;height:252px;&quot;&gt;</font></div><div><font style="font-size: 12pt;">             &lt;div class=&quot;user-info&quot;&gt;</font></div><div><font style="font-size: 12pt;">                 &lt;img :src=&quot;avatar&quot; class=&quot;user-avatar&quot; alt /&gt;</font></div><div><font style="font-size: 12pt;">                 &lt;div class=&quot;user-info-container&quot;&gt;</font></div><div><font style="font-size: 12pt;">                   &lt;div class=&quot;placeholder no-content&quot;&gt;</font></div><div><font style="font-size: 12pt;">                   &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                   &lt;div class=&quot;user-info-cont&quot;&gt;</font></div><div><font style="font-size: 12pt;">                     &lt;div class=&quot;user-info-name&quot;&gt;{{user}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                     &lt;div&gt;{{role}}&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                   &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                   &lt;el-upload</font></div><div><font style="font-size: 12pt;">                     class=&quot;upload&quot;</font></div><div><font style="font-size: 12pt;">                     :action=&quot;uploadUrl + id&quot;</font></div><div><font style="font-size: 12pt;">                     :on-success=&quot;uploadImg&quot;</font></div><div><font style="font-size: 12pt;">                     :before-upload=&quot;beforeImgUpload&quot;</font></div><div><font style="font-size: 12pt;">                     :show-file-list=&quot;false&quot;</font></div><div><font style="font-size: 12pt;">                     multiple&gt;</font></div><div><font style="font-size: 12pt;">                     &lt;el-button size=&quot;small&quot; type=&quot;primary&quot;&gt;&lt;i class=&quot;el-icon-upload&quot;&gt;&lt;/i&gt; 更换头像&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">                   &lt;/el-upload&gt;  </font></div><div><font style="font-size: 12pt;">                 &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">             &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">             &lt;div class=&quot;user-info-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                 上次登录时间：</font></div><div><font style="font-size: 12pt;">                 &lt;span&gt;2020-01-01&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">             &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">             &lt;div class=&quot;user-info-list&quot;&gt;</font></div><div><font style="font-size: 12pt;">                 上次登录地点：</font></div><div><font style="font-size: 12pt;">                 &lt;span&gt;广州&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">             &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">         &lt;/el-card&gt;</font></div><div><font style="font-size: 12pt;">         &lt;el-card shadow=&quot;hover&quot; style=&quot;height:252px;&quot;&gt;</font></div><div><font style="font-size: 12pt;">             &lt;div slot=&quot;header&quot; class=&quot;clearfix&quot;&gt;</font></div><div><font style="font-size: 12pt;">                 &lt;span&gt;语言详情&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">             &lt;/div&gt;Vue</font></div><div><font style="font-size: 12pt;">             &lt;el-progress :percentage=&quot;71.3&quot; color=&quot;#42b983&quot;&gt;&lt;/el-progress&gt;JavaScript</font></div><div><font style="font-size: 12pt;">             &lt;el-progress :percentage=&quot;24.1&quot; color=&quot;#f1e05a&quot;&gt;&lt;/el-progress&gt;CSS</font></div><div><font style="font-size: 12pt;">             &lt;el-progress :percentage=&quot;13.7&quot;&gt;&lt;/el-progress&gt;HTML</font></div><div><font style="font-size: 12pt;">             &lt;el-progress :percentage=&quot;5.9&quot; color=&quot;#f56c6c&quot;&gt;&lt;/el-progress&gt;</font></div><div><font style="font-size: 12pt;">         &lt;/el-card&gt;</font></div><div><font style="font-size: 12pt;">     &lt;/el-col&gt;</font></div><div><font style="font-size: 12pt;">     &lt;el-col :span=&quot;16&quot;&gt;</font></div><div><font style="font-size: 12pt;">         &lt;el-row :gutter=&quot;20&quot; class=&quot;mgb20&quot;&gt;</font></div><div><font style="font-size: 12pt;">             &lt;el-col :span=&quot;8&quot;&gt;</font></div><div><font style="font-size: 12pt;">                 &lt;el-card shadow=&quot;hover&quot; :body-style=&quot;{padding: '0px'}&quot;&gt;</font></div><div><font style="font-size: 12pt;">                     &lt;div class=&quot;grid-content grid-con-1&quot;&gt;</font></div><div><font style="font-size: 12pt;">                         &lt;i class=&quot;el-icon-user grid-con-icon&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">                         &lt;div class=&quot;grid-cont-right&quot;&gt;</font></div><div><font style="font-size: 12pt;">                             &lt;div class=&quot;grid-num&quot;&gt;1234&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                             &lt;div&gt;用户访问量&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                         &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                     &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                 &lt;/el-card&gt;</font></div><div><font style="font-size: 12pt;">             &lt;/el-col&gt;</font></div><div><font style="font-size: 12pt;">             &lt;el-col :span=&quot;8&quot;&gt;</font></div><div><font style="font-size: 12pt;">                 &lt;el-card shadow=&quot;hover&quot; :body-style=&quot;{padding: '0px'}&quot;&gt;</font></div><div><font style="font-size: 12pt;">                     &lt;div class=&quot;grid-content grid-con-2&quot;&gt;</font></div><div><font style="font-size: 12pt;">                         &lt;i class=&quot;el-icon-bell grid-con-icon&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">                         &lt;div class=&quot;grid-cont-right&quot;&gt;</font></div><div><font style="font-size: 12pt;">                             &lt;div class=&quot;grid-num&quot;&gt;321&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                             &lt;div&gt;系统消息&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                         &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                     &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                 &lt;/el-card&gt;</font></div><div><font style="font-size: 12pt;">             &lt;/el-col&gt;</font></div><div><font style="font-size: 12pt;">             &lt;el-col :span=&quot;8&quot;&gt;</font></div><div><font style="font-size: 12pt;">                 &lt;el-card shadow=&quot;hover&quot; :body-style=&quot;{padding: '0px'}&quot;&gt;</font></div><div><font style="font-size: 12pt;">                     &lt;div class=&quot;grid-content grid-con-3&quot;&gt;</font></div><div><font style="font-size: 12pt;">                         &lt;i class=&quot;el-icon-goods grid-con-icon&quot;&gt;&lt;/i&gt;</font></div><div><font style="font-size: 12pt;">                         &lt;div class=&quot;grid-cont-right&quot;&gt;</font></div><div><font style="font-size: 12pt;">                             &lt;div class=&quot;grid-num&quot;&gt;5000&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                             &lt;div&gt;数量&lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                         &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                     &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">                 &lt;/el-card&gt;</font></div><div><font style="font-size: 12pt;">             &lt;/el-col&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-row&gt;     </font></div><div><font style="font-size: 12pt;">        &lt;el-row :gutter=&quot;20&quot; class=&quot;mgb20&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-col :span=&quot;24&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-card shadow=&quot;hover&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;bar-echart id=&quot;barEcharts&quot; height=&quot;365px&quot; ref=&quot;echarts&quot;&gt;&lt;/bar-echart&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-card&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-col&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-row&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-col&gt;       </font></div><div><font style="font-size: 12pt;">    &lt;/el-row&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">  import BarEchart from '../components/ECharts/barEchart'</font></div><div><font style="font-size: 12pt;">  export default {</font></div><div><font style="font-size: 12pt;">    name: 'info',</font></div><div><font style="font-size: 12pt;">    components: {</font></div><div><font style="font-size: 12pt;">      BarEchart</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    data() {</font></div><div><font style="font-size: 12pt;">      return {</font></div><div><font style="font-size: 12pt;">        uploadUrl: 'http://47.115.15.21:5001/api/users/updateAvatar/'</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    computed: {</font></div><div><font style="font-size: 12pt;">      avatar() {</font></div><div><font style="font-size: 12pt;">        return this.$store.getters.user.avatar</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      user() {</font></div><div><font style="font-size: 12pt;">        return this.$store.getters.user.identity === 'manager' ? 'admin' : 'staff'</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      role() {</font></div><div><font style="font-size: 12pt;">        return this.$store.getters.user.identity === 'manager' ? '管理员' : '普通员工'</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      id() {</font></div><div><font style="font-size: 12pt;">        return this.$store.getters.user.id</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    mounted () {</font></div><div><font style="font-size: 12pt;">      this.selfAdaption()</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    methods: {</font></div><div><font style="font-size: 12pt;">      uploadImg(res, file) {</font></div><div><font style="font-size: 12pt;">        // console.log(res)</font></div><div><font style="font-size: 12pt;">        // console.log(file)</font></div><div><font style="font-size: 12pt;">        this.$store.getters.user.avatar = res.url</font></div><div><font style="font-size: 12pt;">        this.$message({type: 'success', message: '更换头像成功'})  </font></div><div><font style="font-size: 12pt;">      },      </font></div><div><font style="font-size: 12pt;">      beforeImgUpload(file) {</font></div><div><font style="font-size: 12pt;">        const isRightType = (file.type === 'image/jpeg') || (file.type === 'image/png') || (file.type === 'image/gif');</font></div><div><font style="font-size: 12pt;">        const isLt2M = file.size / 1024 / 1024 &lt; 2;</font></div><div><font style="font-size: 12pt;">        if (!isRightType) {</font></div><div><font style="font-size: 12pt;">            this.$message.error('上传头像图片只能是 JPG/PNG/GIF 格式!');</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        if (!isLt2M) {</font></div><div><font style="font-size: 12pt;">            this.$message.error('上传头像图片大小不能超过 2MB!');</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">        return isRightType &amp;&amp; isLt2M;</font></div><div><font style="font-size: 12pt;">      },</font></div><div><font style="font-size: 12pt;">      // echart自适应</font></div><div><font style="font-size: 12pt;">      selfAdaption () {</font></div><div><font style="font-size: 12pt;">        let that = this</font></div><div><font style="font-size: 12pt;">        setTimeout(() =&gt; {</font></div><div><font style="font-size: 12pt;">          window.onresize = function () {</font></div><div><font style="font-size: 12pt;">            if (that.$refs.echarts) {</font></div><div><font style="font-size: 12pt;">              that.$refs.echarts.chart.resize()</font></div><div><font style="font-size: 12pt;">            }</font></div><div><font style="font-size: 12pt;">          }</font></div><div><font style="font-size: 12pt;">        }, 10)</font></div><div><font style="font-size: 12pt;">      }</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  }</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style scoped&gt;</font></div><div><font style="font-size: 12pt;">.user-info-container {</font></div><div><font style="font-size: 12pt;">  display: flex;</font></div><div><font style="font-size: 12pt;">  height: 120px;</font></div><div><font style="font-size: 12pt;">  justify-content: space-between;</font></div><div><font style="font-size: 12pt;">  flex-direction: column;</font></div><div><font style="font-size: 12pt;">  padding-left: 50px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.info {</font></div><div><font style="font-size: 12pt;">  width: 100%;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">  background-color: #eee;</font></div><div><font style="font-size: 12pt;">  padding: 20px;</font></div><div><font style="font-size: 12pt;">  box-sizing: border-box;</font></div><div><font style="font-size: 12pt;">  overflow: hidden;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.el-row {</font></div><div><font style="font-size: 12pt;">    margin-bottom: 20px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.grid-content {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    align-items: center;</font></div><div><font style="font-size: 12pt;">    height: 100px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.grid-cont-right {</font></div><div><font style="font-size: 12pt;">    flex: 1;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">    font-size: 14px;</font></div><div><font style="font-size: 12pt;">    color: #999;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.grid-num {</font></div><div><font style="font-size: 12pt;">    font-size: 30px;</font></div><div><font style="font-size: 12pt;">    font-weight: bold;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.grid-con-icon {</font></div><div><font style="font-size: 12pt;">    font-size: 50px;</font></div><div><font style="font-size: 12pt;">    width: 100px;</font></div><div><font style="font-size: 12pt;">    height: 100px;</font></div><div><font style="font-size: 12pt;">    text-align: center;</font></div><div><font style="font-size: 12pt;">    line-height: 100px;</font></div><div><font style="font-size: 12pt;">    color: #fff;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.grid-num {</font></div><div><font style="font-size: 12pt;">  margin-bottom: 5px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.grid-con-1 .grid-con-icon {</font></div><div><font style="font-size: 12pt;">    background: rgb(45, 140, 240);</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.grid-con-1 .grid-num {</font></div><div><font style="font-size: 12pt;">    color: rgb(45, 140, 240);</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.grid-con-2 .grid-con-icon {</font></div><div><font style="font-size: 12pt;">    background: rgb(100, 213, 114);</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.grid-con-2 .grid-num {</font></div><div><font style="font-size: 12pt;">    color: rgb(45, 140, 240);</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.grid-con-3 .grid-con-icon {</font></div><div><font style="font-size: 12pt;">    background: rgb(242, 94, 67);</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.grid-con-3 .grid-num {</font></div><div><font style="font-size: 12pt;">    color: rgb(242, 94, 67);</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.user-info {</font></div><div><font style="font-size: 12pt;">    display: flex;</font></div><div><font style="font-size: 12pt;">    align-items: center;</font></div><div><font style="font-size: 12pt;">    padding-bottom: 20px;</font></div><div><font style="font-size: 12pt;">    border-bottom: 2px solid #ccc;</font></div><div><font style="font-size: 12pt;">    margin-bottom: 20px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.user-avatar {</font></div><div><font style="font-size: 12pt;">    width: 120px;</font></div><div><font style="font-size: 12pt;">    height: 120px;</font></div><div><font style="font-size: 12pt;">    border-radius: 50%;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.user-info-cont {</font></div><div><font style="font-size: 12pt;">    font-size: 16px solid;</font></div><div><font style="font-size: 12pt;">    color: #999;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.user-info-cont div:first-child {</font></div><div><font style="font-size: 12pt;">    font-size: 26px;</font></div><div><font style="font-size: 12pt;">    margin-bottom: 5px;</font></div><div><font style="font-size: 12pt;">    color: #222;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.user-info-list {</font></div><div><font style="font-size: 12pt;">    font-size: 14px;</font></div><div><font style="font-size: 12pt;">    color: #999;</font></div><div><font style="font-size: 12pt;">    line-height: 25px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.user-info-list span {</font></div><div><font style="font-size: 12pt;">    margin-left: 70px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">.mgb20 {</font></div><div><font style="font-size: 12pt;">    margin-bottom: 20px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">views/Tabs.vue</span></font></div><div><font style="font-size: 12pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">&lt;template&gt;</font></div><div><font style="font-size: 12pt;">  &lt;div class=&quot;message-container&quot;&gt;</font></div><div><font style="font-size: 12pt;">    &lt;div class=&quot;message-content&quot;&gt;</font></div><div><font style="font-size: 12pt;">      &lt;el-tabs v-model=&quot;message&quot;&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-tab-pane :label=&quot;`未读消息(${unread.length})`&quot; name=&quot;first&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;el-table :data=&quot;unread&quot; :show-header=&quot;false&quot; style=&quot;width: 100%&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-table-column&gt;</font></div><div><font style="font-size: 12pt;">              &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;span class=&quot;message-title&quot;&gt;{{ scope.row.title }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">              &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-table-column prop=&quot;date&quot; width=&quot;180&quot;&gt;&lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-table-column width=&quot;120&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;el-button size=&quot;small&quot; @click=&quot;handleRead(scope.$index)&quot;</font></div><div><font style="font-size: 12pt;">                  &gt;标为已读&lt;/el-button</font></div><div><font style="font-size: 12pt;">                &gt;</font></div><div><font style="font-size: 12pt;">              &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/el-table&gt;</font></div><div><font style="font-size: 12pt;">          &lt;div class=&quot;handle-row&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-button type=&quot;primary&quot;&gt;全部标为已读&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-tab-pane&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-tab-pane :label=&quot;`已读消息(${read.length})`&quot; name=&quot;second&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;template v-if=&quot;message === 'second'&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-table :data=&quot;read&quot; :show-header=&quot;false&quot; style=&quot;width: 100%&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-table-column&gt;</font></div><div><font style="font-size: 12pt;">                &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">                  &lt;span class=&quot;message-title&quot;&gt;{{ scope.row.title }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">              &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-table-column prop=&quot;date&quot; width=&quot;150&quot;&gt;&lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-table-column width=&quot;120&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">                  &lt;el-button type=&quot;danger&quot; @click=&quot;handleDel(scope.$index)&quot;</font></div><div><font style="font-size: 12pt;">                    &gt;删除&lt;/el-button</font></div><div><font style="font-size: 12pt;">                  &gt;</font></div><div><font style="font-size: 12pt;">                &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">              &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-table&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;handle-row&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-button type=&quot;danger&quot;&gt;删除全部&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-tab-pane&gt;</font></div><div><font style="font-size: 12pt;">        &lt;el-tab-pane :label=&quot;`回收站(${recycle.length})`&quot; name=&quot;third&quot;&gt;</font></div><div><font style="font-size: 12pt;">          &lt;template v-if=&quot;message === 'third'&quot;&gt;</font></div><div><font style="font-size: 12pt;">            &lt;el-table :data=&quot;recycle&quot; :show-header=&quot;false&quot; style=&quot;width: 100%&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-table-column&gt;</font></div><div><font style="font-size: 12pt;">                &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">                  &lt;span class=&quot;message-title&quot;&gt;{{ scope.row.title }}&lt;/span&gt;</font></div><div><font style="font-size: 12pt;">                &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">              &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-table-column prop=&quot;date&quot; width=&quot;150&quot;&gt;&lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-table-column width=&quot;120&quot;&gt;</font></div><div><font style="font-size: 12pt;">                &lt;template slot-scope=&quot;scope&quot;&gt;</font></div><div><font style="font-size: 12pt;">                  &lt;el-button @click=&quot;handleRestore(scope.$index)&quot;</font></div><div><font style="font-size: 12pt;">                    &gt;还原&lt;/el-button</font></div><div><font style="font-size: 12pt;">                  &gt;</font></div><div><font style="font-size: 12pt;">                &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">              &lt;/el-table-column&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/el-table&gt;</font></div><div><font style="font-size: 12pt;">            &lt;div class=&quot;handle-row&quot;&gt;</font></div><div><font style="font-size: 12pt;">              &lt;el-button type=&quot;danger&quot;&gt;清空回收站&lt;/el-button&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">          &lt;/template&gt;</font></div><div><font style="font-size: 12pt;">        &lt;/el-tab-pane&gt;</font></div><div><font style="font-size: 12pt;">      &lt;/el-tabs&gt;</font></div><div><font style="font-size: 12pt;">    &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">  &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">&lt;/template&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;script&gt;</font></div><div><font style="font-size: 12pt;">export default {</font></div><div><font style="font-size: 12pt;">  name: 'tabs',</font></div><div><font style="font-size: 12pt;">  data() {</font></div><div><font style="font-size: 12pt;">    return {</font></div><div><font style="font-size: 12pt;">      message: 'first',</font></div><div><font style="font-size: 12pt;">      showHeader: false,</font></div><div><font style="font-size: 12pt;">      unread: [</font></div><div><font style="font-size: 12pt;">        {</font></div><div><font style="font-size: 12pt;">          date: '2018-04-19 20:00:00',</font></div><div><font style="font-size: 12pt;">          title: '【系统通知】该系统将于今晚凌晨2点到5点进行升级维护',</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">        {</font></div><div><font style="font-size: 12pt;">          date: '2018-04-19 21:00:00',</font></div><div><font style="font-size: 12pt;">          title: '今晚12点整发大红包，先到先得',</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">      ],</font></div><div><font style="font-size: 12pt;">      read: [</font></div><div><font style="font-size: 12pt;">        {</font></div><div><font style="font-size: 12pt;">          date: '2018-04-19 20:00:00',</font></div><div><font style="font-size: 12pt;">          title: '【系统通知】该系统将于今晚凌晨2点到5点进行升级维护',</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">      ],</font></div><div><font style="font-size: 12pt;">      recycle: [</font></div><div><font style="font-size: 12pt;">        {</font></div><div><font style="font-size: 12pt;">          date: '2018-04-19 20:00:00',</font></div><div><font style="font-size: 12pt;">          title: '【系统通知】该系统将于今晚凌晨2点到5点进行升级维护',</font></div><div><font style="font-size: 12pt;">        },</font></div><div><font style="font-size: 12pt;">      ],</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  methods: {</font></div><div><font style="font-size: 12pt;">    handleRead(index) {</font></div><div><font style="font-size: 12pt;">      const item = this.unread.splice(index, 1)</font></div><div><font style="font-size: 12pt;">      console.log(item)</font></div><div><font style="font-size: 12pt;">      this.read = item.concat(this.read)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    handleDel(index) {</font></div><div><font style="font-size: 12pt;">      const item = this.read.splice(index, 1)</font></div><div><font style="font-size: 12pt;">      this.recycle = item.concat(this.recycle)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    handleRestore(index) {</font></div><div><font style="font-size: 12pt;">      const item = this.recycle.splice(index, 1)</font></div><div><font style="font-size: 12pt;">      this.read = item.concat(this.read)</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">  computed: {</font></div><div><font style="font-size: 12pt;">    unreadNum() {</font></div><div><font style="font-size: 12pt;">      return this.unread.length</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  },</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/script&gt;</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">&lt;style&gt;</font></div><div><font style="font-size: 12pt;">.message-container {</font></div><div><font style="font-size: 12pt;">  width: auto;</font></div><div><font style="font-size: 12pt;">  height: 100%;</font></div><div><font style="font-size: 12pt;">  padding: 10px;</font></div><div><font style="font-size: 12pt;">  box-sizing: border-box;</font></div><div><font style="font-size: 12pt;">  background: #f0f0f0;</font></div><div><font style="font-size: 12pt;">  border: 1px solid #ddd;</font></div><div><font style="font-size: 12pt;">  border-radius: 5px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.message-content {</font></div><div><font style="font-size: 12pt;">  padding: 30px;</font></div><div><font style="font-size: 12pt;">  background: #fff;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.message-title {</font></div><div><font style="font-size: 12pt;">  cursor: pointer;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">.handle-row {</font></div><div><font style="font-size: 12pt;">  margin-top: 30px;</font></div><div><font style="font-size: 12pt;">}</font></div><div><font style="font-size: 12pt;">&lt;/style&gt;</font></div></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div></div><div><br/></div></span>
</div></body></html> 